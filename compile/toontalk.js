window.TOONTALK.copy=function(){return{create:function(f,d){var g=Object.create(this);g.robot=f;g.path=d;return g},run:function(f){f=window.TOONTALK.UTILITIES.dereference_path(this.path,f);if(!f)return!1;this.robot.thing_in_hand=f.copy();return!0}}}();window.TOONTALK.copy_constant=function(){return{create:function(f,d){var g=Object.create(this);g.robot=f;g.constant_object=d;return g},run:function(f){this.robot.thing_in_hand=this.constant_object.copy();return!0}}}();window.TOONTALK.drop_on=function(){return{create:function(f,d){var g=Object.create(this);g.robot=f;g.path=d;return g},run:function(f){return(f=window.TOONTALK.UTILITIES.dereference_path(this.path,f))?(this.robot.thing_in_hand.drop_on(f),!0):!1}}}();window.TOONTALK.pick_up=function(){return{create:function(f,d){var g=Object.create(this);g.robot=f;g.path=d;return g},run:function(f){f=window.TOONTALK.UTILITIES.dereference_path(this.path,f);if(!f)return!1;this.robot.thing_in_hand=f;return!0}}}();window.TOONTALK.pick_up_constant=function(){return{create:function(f,d){var g=Object.create(this);g.robot=f;g.constant_object=d;return g},run:function(f){this.robot.thing_in_hand=this.constant_object;return!0}}}();window.TOONTALK.widget=function(){return{add_sides_functionality:function(f){var d,g;f.get_frontside=function(g){g&&!d&&(d=window.TOONTALK.frontside.create(f));return d};f.get_backside=function(d){d&&!g&&(g=f.create_backside());return g};return f},dereference:function(){return this},copy:function(){console.assert(!1,"copy not implemented")},equals:function(f){console.assert(!1,"equals not implemented")},match:function(f){console.assert(!1,"copy not implemented")},drop_on:function(f,d){console.assert(!1,
"drop_on not implemented")},update_display:function(){console.assert(!1,"update_display not implemented")},to_HTML:function(){console.assert(!1,"to_HTML not implemented")},equals_box:function(){return!1},equals_number:function(){return!1},match_box:function(){return"not matched"},match_number:function(){return"not matched"},number_dropped_on_me:function(f){console.assert("No handler for drop of "+this.toString()+" on "+f.toString())}}}();window.TOONTALK.condition=function(){return{create:function(f){var d=Object.create(this);d.items=f;return d},copy:function(){return this.create(this.items)},match:function(f){return this.items.match(f)}}}();window.TOONTALK.frontside=function(){return{create:function(f){var d=Object.create(this),g=document.createElement("div");g.className="toontalk-frontside";d.get_element=function(){return g};d.get_object=function(){return f};return d},update_display:function(){return this.get_object().update_display()}}}();window.TOONTALK.number=function(){var f=window.TOONTALK,d=Object.create(f.widget),g=function(d,g,f){var c="",p=100;g=(g-1)/g;if(f)for(f=0;1<=p&&f<d.length;)c=c+"<span class='toontalk-digit' style='font-size:"+p+"%'>"+d[f]+"</span>",f+=1,p*=g;else for(f=d.length-1;1<=p&&0<f;)c="<span class='toontalk-digit' style='font-size:"+p+"%'>"+d[f]+"</span>"+c,f-=1,p*=g;return c},r=function(d,f){if(d.length<=f)return d;if(4>f)return d[0]+"<span class='toontalk-three-dots-in-number' style='font-size: 33%'>...</span>"+
d[d.length-1];var m=f/2;return g(d,m,!0)+g(d,m,!1)},q=function(d,f){f||(f=1);if(!("number"!==typeof d&&"string"!==typeof d||"number"!==typeof f&&"string"!==typeof f))return bigrat.fromValues(d,f);var g=bigrat.create();1===f?bigrat.set(g,bigrat.toBigInteger(d.get_value()),BigInteger.ONE):d.get_value&&f.get_value?bigrat.set(g,bigrat.toBigInteger(d.get_value()),bigrat.toBigInteger(f.get_value())):bigrat.set(g,d,f);return g};d.create=function(g,A){var m=Object.create(d),c=q(g,A),p="improper_fraction";
m.set_value=function(d,e){var g,a;c=d;e?this.update_display():(g=this.get_frontside(),a=this.get_backside(),g&&f.DISPLAY_UPDATES.add_dirty_side(g),a&&f.DISPLAY_UPDATES.add_dirty_side(a));return this};m.get_value=function(){return c};m.set_format=function(c,e){p=c;e&&this.update_display();return this};m.get_format=function(){return p};return d.add_sides_functionality(m)};d.create_backside=function(){return f.number_backside.create(this)};d.set_from_values=function(d,f,g){return this.set_value(q(d,
f),g)};d.ONE=function(){return this.create(1)};d.ZERO=function(){return this.create(0)};d.copy=function(){var f=d.create(this.get_value()[0],this.get_value()[1]);this.erased&&(f.erased=this.erased);this.operator&&(f.operator=this.operator);return f};d.is_number=function(){return!0};d.equals=function(d){return d.equals_number(this)};d.equals_number=function(d){return bigrat.equals(this.get_value(),d.get_value())};d.update_display=function(){var d=this.get_frontside();if(d){var d=d.get_element(),f,
g;f=d.clientWidth;g=0.8*d.clientHeight;f=this.to_HTML(f/(0.64*g),g,this.get_format());d.firstChild||d.appendChild(document.createElement("div"));d.firstChild.innerHTML=f}};d.drop_on=function(d,f){return d.number_dropped_on_me(this,f)};d.number_dropped_on_me=function(d){switch(d.get_operator()){case "+":return this.add(d);case "-":return this.subtract(d);case "*":return this.multiply(d);case "/":return this.divide(d);case "^":return this.power(d);default:return console.log("Number received a number with unsupported operator: "+
d.get_operator()),this}};d.to_HTML_with_operator=function(){switch(this.get_operator()){case "+":return this.to_HTML();case "-":return"&minus"+this.to_HTML();case "*":return"&times;"+this.to_HTML();case "/":return"&divide;"+this.to_HTML();case "^":return"^<sup>"+this.toHTML()+"</sub>";default:return console.log("Number has an unsupported operator: "+this.get_operator()),this}};d.get_operator=function(){this.operator||(this.operator="+");return this.operator};d.set_operator=function(d){this.operator=
d;return this};d.add=function(d){this.set_value(bigrat.add(bigrat.create(),this.get_value(),d.get_value()));return this};d.subtract=function(d){this.set_value(bigrat.subtract(bigrat.create(),this.get_value(),d.get_value()));return this};d.multiply=function(d){this.set_value(bigrat.multiply(bigrat.create(),this.get_value(),d.get_value()));return this};d.divide=function(d){this.set_value(bigrat.divide(bigrat.create(),this.get_value(),d.get_value()));return this};d.power=function(d){this.set_value(bigrat.power(bigrat.create(),
this.get_value(),bigrat.toInteger(d.get_value())));return this};d.absolute_value=function(){this.set_value(bigrat.abs(bigrat.create(),this.get_value()));return this};d.is_zero=function(){return bigrat.equals(this.get_value(),bigrat.ZERO)};d.toString=function(){var d="+"===this.get_operator()?"":this.get_operator();return(this.erased?"erased: ":"")+d+bigrat.str(this.get_value())};d.to_HTML=function(d,f,g,c){var p;c=!1!==c?" toontalk-top-level-number":"";d||(d=4);f||(f=16);if(this.is_integer())return g=
bigrat.toBigInteger(this.get_value()).toString(),'<div class="toontalk-number toontalk-integer'+c+'" style="font-size: '+f+'px;">'+r(g,d)+"</div>";if("improper_fraction"===g||!g)return'<table class="toontalk-number toontalk-improper-fraction '+c+'" style="font-size: '+0.5*f+'px;"><tr class="toontalk-numerator"><td align="center" class="toontalk-number">'+r(this.numerator_string(),2*d)+'</td></tr><tr class="toontalk-fraction-line-as-row"><td  class="toontalk-fraction-line-as-table-entry"><hr class="toontalk-fraction-line"></td></tr><tr class="toontalk-denominator"><td align="center" class="toontalk-number">'+
r(this.denominator_string(),2*d)+"</td></tr></table>";if("proper_fraction"===g){g=this.integer_part();if(g.is_zero())return this.to_HTML(d,"improper_fraction",!1);p=this.copy().subtract(g).absolute_value();return'<table class="toontalk-number toontalk-improper_fraction '+c+'" style="font-size: '+0.5*f+'px;"><tr><td class="toontalk-number toontalk-integer-part-of-proper-fraction">'+g.to_HTML(d,f,"",!1)+'</td><td class="toontalk-number toontalk-fraction-part-of-proper_fraction">'+p.to_HTML(d,f,"improper_fraction",
!1)+"</td></tr></table>"}if("decimal"===g)return'<div class="toontalk-number toontalk-decimal'+c+'" style="font-size: '+f+'px;">'+this.decimal_string(d)+"</div>"};d.is_integer=function(){return 0===this.get_value()[1].compare(BigInteger.ONE)};d.numerator=function(){var d=bigrat.create();return bigrat.set(d,this.get_value()[0],BigInteger.ONE)};d.denominator=function(){var d=bigrat.create();return bigrat.set(d,this.get_value()[1],BigInteger.ONE)};d.numerator_string=function(){return this.get_value()[0].toString()};
d.denominator_string=function(){return this.get_value()[1].toString()};d.integer_part=function(){return this.create(this)};d.decimal_string=function(d){if(this.is_integer())return this.numerator_string();var f=this.copy(),m=f.integer_part(),c=m.toString(),p=f.subtract(m),f=Math.min(c.length,d/2),m=d-f,q;a:{var e;q=2*m;e=p.absolute_value();p=e.get_value()[0];e=e.get_value()[1];for(var k=new BigInteger(10),a="";q>a.length;)if(p=p.multiply(k),0>p.compare(e))a+="0";else if(a+=p.divide(e).toString(),p=
p.remainder(e).multiply(k),p.isZero()){q=a;break a}q=a}q.length<m&&(f=d-q.length);return r(c,f)+"<span class='toontalk-decimal-point' style='font-family: serif'>.</span>"+g(q,d/2,!0)};d.match=function(d){return this.erased?d.match_with_any_number():d.match_with_this_number(this)};d.match_with_any_number=function(){return"matched"};d.match_with_this_number=function(d){return d.equals(this)?"matched":"not matched"};return d}();window.TOONTALK.number_backside=function(){var f=function(d,f,c){var g=document.createElement("input");g.type="text";g.className=f;g.value=d;g.title=c;return g},d=function(d,f,c){var g=document.createElement("button");g.className=f;g.innerHTML=d;g.title=c;return g},g=function(d,f){var c=document.createElement("input");c.type="radio";c.className="toontalk-radio-button";c.name=d;c.value=f;return c},r=function(d,f){var c=document.createElement("div"),g=document.createElement("span");g.innerHTML=f;c.appendChild(d);
c.appendChild(g);return c},q=function(){var d;for(d=0;d<arguments.length;d+=1)if(arguments[d].checked)return arguments[d]},y=function(f,g){var c=d("add "+g+" robot","test","just testing");c.onclick=function(){if(c.robot)c.robot.stop(),c.robot=void 0,c.innerHTML="resume "+g;else{var d;switch(g){case "add-one":d=TOONTALK.tests.add_one_robot();break;case "double":d=TOONTALK.tests.double_robot()}c.robot=d;d.run(f.get_number());c.innerHTML="stop "+g}};f.get_element().appendChild(c)};return{create:function(d){var m=
document.createElement("div");m.className="toontalk-backside";var c=Object.create(this),p=f(d.numerator_string(),"toontalk-numerator-input","Type here to edit the numerator"),z=f(d.denominator_string(),"toontalk-denominator-input","Type here to edit the denominator"),e=g("number_format","decimal"),k=g("number_format","proper_fraction"),a=g("number_format","improper_fraction"),b=function(){d.set_from_values(p.value.trim(),z.value.trim(),!0)},h=function(){d.set_format(q(e,k,a).value,!0)};c.get_element=
function(){return m};c.get_number=function(){return d};p.onchange=b;z.onchange=b;e.onchange=h;k.onchange=h;a.onchange=h;a.checked=!0;m.appendChild(p);m.appendChild(z);m.appendChild(r(e,"&nbsp;Display number as a decimal."));m.appendChild(r(k,"&nbsp;Display number as a proper fraction."));m.appendChild(r(a,"&nbsp;Display number as a simple fraction."));y(c,"add-one");y(c,"double");return c},update_display:function(){var d=window.TOONTALK.UTILITIES.get_first_child_with_class(this.get_element(),"toontalk-numerator-input"),
f=window.TOONTALK.UTILITIES.get_first_child_with_class(this.get_element(),"toontalk-denominator-input"),c=this.get_number();d.value=c.numerator_string();f.value=c.denominator_string()}}}();window.TOONTALK.robot=function(){var f=Object.create(window.TOONTALK.widget);f.create=function(d,f){var r=Object.create(this);r.get_bubble=function(){return d};r.get_body=function(){return f};f.set_robot(r);return r};f.copy=function(){return this.create(this.get_bubble().copy(),this.get_body())};f.run=function(d,f){var r,q;if(this.stopped)return"not matched";r=this.get_bubble().match(d);switch(r){case "matched":return f||(f=window.TOONTALK.QUEUE),f.enqueue({robot:this,context:d,queue:f}),r;case "not matched":return this.next_robot?
this.next_robot.run(d,f):r;default:for(q=0;q<r.length;q+=1)r[q].run_when_non_empty(this);return r}};f.stop=function(){this.stopped=!0};f.run_actions=function(d,f){return this.get_body().run(d,f)};return f}();window.TOONTALK.DISPLAY_UPDATES=function(){var f=[];return{add_dirty_side:function(d){var g;for(g=0;g<f.length;g+=1)if(f[g]===d)return;f.push(d)},update_display:function(){var d;for(d=0;d<f.length;d+=1)f[d].update_display();f=[]}}}();"function"!==typeof Object.create&&(Object.create=function(f){var d=function(){};d.prototype=f;return new d});String.prototype.trim||String.method("trim",function(){return this.replace(/^\s+|\s+$/g,"")});window.TOONTALK.pick_up=function(){return{create:function(f,d){var g=Object.create(this);g.robot=f;g.path=d;return g},run:function(f){this.robot.thing_in_hand=this.path.dereference(f);return!0}}}();window.TOONTALK.actions=function(){return{create:function(){var f=[],d,g=Object.create(this);g.get_steps=function(){return f};g.get_robot=function(){return d};g.set_robot=function(f){d=f};return g},add:function(f){this.get_steps()[this.get_steps().length]=f},run:function(f,d){var g,r=this.get_steps();for(g=0;g<r.length;g++)r[g].run(f);this.get_robot().run(f,d)}}}();window.TOONTALK.queue=function(){return{create:function(){var f=Object.create(this);f.to_run=[];return f},enqueue:function(f){return this.to_run.push(f)},dequeue:function(){return this.to_run.shift()},maximum_run:1,paused:!1,run:function(f,d){for(var g,r=(new Date).getTime()+this.maximum_run,q=this;0<this.to_run.length;){if(this.paused)return;g=(new Date).getTime();if(g>=r)break;g=this.dequeue();g.robot.run_actions(g.context,g.queue);if(f&&(f-=1,0===f)){this.to_run=[];window.TOONTALK.DISPLAY_UPDATES.update_display();
d&&d();return}}window.TOONTALK.DISPLAY_UPDATES.update_display();setTimeout(function(){q.run(f,d)},0)}}}();window.TOONTALK.QUEUE=window.TOONTALK.queue.create();window.TOONTALK.UTILITIES=function(){return{get_style_property:function(f,d){if(f.currentStyle)return f.currentStyle[d];if(window.getComputedStyle)return document.defaultView.getComputedStyle(f,null).getPropertyValue(d)},get_style_numeric_property:function(f,d){var g=this.get_style_property(f,d),r;return"string"===typeof g?(r=g.indexOf("px"),0<=r&&(g=g.substring(0,r)),parseInt(g,10)):g},get_first_child_with_class:function(f,d){var g;for(g=f.firstChild;g;g=g.nextSibling)if(g.className===d)return g},
dereference_path:function(f,d){var g;return f?((g=d.dereference(f))||console.log("Unable to dereference path: "+f.toString()+" in context: "+d.toString()),g):d}}}();(function(f){var d;"undefined"===typeof exports?"function"===typeof define&&"object"===typeof define.amd&&define.amd?(d={},define(function(){return d})):d="undefined"!==typeof window?window:f:d=exports;(function(d){var f={greatest_common_divisor:function(a,b){if(1===b||1===a)return 1;for(var h;0!==b;){h=b;b=a%b;if(!isFinite(b))return 0;a=h}return a}};f.gcd=f.greatest_common_divisor;f.fromRandom=function(a){return Math.random()*(1<<a)>>>0};f.fromMillitime=function(){return+new Date};f.fromUnixtime=
function(){return 0.001*f.fromMillitime()|0};"undefined"!==typeof d&&(d.integer=f);(function(a){function b(a,c,d){if(d!==h)return a instanceof b?a:"undefined"===typeof a?e:b.parse(a);for(a=a||[];a.length&&!a[a.length-1];)--a.length;this._d=a;this._s=a.length?c||1:0}var h={};b._construct=function(a,c){return new b(a,c,h)};var c=1E7;b.base=c;b.base_log10=7;var e=new b([],0,h);b.ZERO=e;var d=new b([1],1,h);b.ONE=d;var f=new b(d._d,-1,h);b.M_ONE=f;b._0=e;b._1=d;b.small=[e,d,new b([2],1,h),new b([3],1,
h),new b([4],1,h),new b([5],1,h),new b([6],1,h),new b([7],1,h),new b([8],1,h),new b([9],1,h),new b([10],1,h),new b([11],1,h),new b([12],1,h),new b([13],1,h),new b([14],1,h),new b([15],1,h),new b([16],1,h),new b([17],1,h),new b([18],1,h),new b([19],1,h),new b([20],1,h),new b([21],1,h),new b([22],1,h),new b([23],1,h),new b([24],1,h),new b([25],1,h),new b([26],1,h),new b([27],1,h),new b([28],1,h),new b([29],1,h),new b([30],1,h),new b([31],1,h),new b([32],1,h),new b([33],1,h),new b([34],1,h),new b([35],
1,h),new b([36],1,h)];b.digits="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");b.prototype.toString=function(a){a=+a||10;if(2>a||36<a)throw Error("illegal radix "+a+".");if(0===this._s)return"0";if(10===a){a=0>this._s?"-":"";a+=this._d[this._d.length-1].toString();for(var c=this._d.length-2;0<=c;c--){for(var h=this._d[c].toString();7>h.length;)h="0"+h;a+=h}return a}c=b.digits;a=b.small[a];for(var h=this._s,e=this.abs(),d=[],f;0!==e._s;)f=e.divRem(a),e=f[0],f=f[1],d.push(c[f.valueOf()]);return(0>
h?"-":"")+d.reverse().join("")};b.radixRegex=[/^$/,/^$/,/^[01]*$/,/^[012]*$/,/^[0-3]*$/,/^[0-4]*$/,/^[0-5]*$/,/^[0-6]*$/,/^[0-7]*$/,/^[0-8]*$/,/^[0-9]*$/,/^[0-9aA]*$/,/^[0-9abAB]*$/,/^[0-9abcABC]*$/,/^[0-9a-dA-D]*$/,/^[0-9a-eA-E]*$/,/^[0-9a-fA-F]*$/,/^[0-9a-gA-G]*$/,/^[0-9a-hA-H]*$/,/^[0-9a-iA-I]*$/,/^[0-9a-jA-J]*$/,/^[0-9a-kA-K]*$/,/^[0-9a-lA-L]*$/,/^[0-9a-mA-M]*$/,/^[0-9a-nA-N]*$/,/^[0-9a-oA-O]*$/,/^[0-9a-pA-P]*$/,/^[0-9a-qA-Q]*$/,/^[0-9a-rA-R]*$/,/^[0-9a-sA-S]*$/,/^[0-9a-tA-T]*$/,/^[0-9a-uA-U]*$/,
/^[0-9a-vA-V]*$/,/^[0-9a-wA-W]*$/,/^[0-9a-xA-X]*$/,/^[0-9a-yA-Y]*$/,/^[0-9a-zA-Z]*$/];b.parse=function(a,c){function d(a){a=a.replace(/\s*[*xX]\s*10\s*(\^|\*\*)\s*/,"e");return a.replace(/^([+\-])?(\d+)\.?(\d*)[eE]([+\-]?\d+)$/,function(a,b,c,h,e){e=+e;var d=0>e,f=c.length+e;a=(d?c:h).length;e=(e=Math.abs(e))>=a?e-a+d:0;a=Array(e+1).join("0");c+=h;return(b||"")+(d?c=a+c:c+=a).substr(0,f+=d?a.length:0)+(f<c.length?"."+c.substr(f):"")})}a=a.toString();if("undefined"===typeof c||10===+c)a=d(a);var f=
RegExp("^([+\\-]?)("+("undefined"===typeof c?"0[xcb]":16==c?"0x":8==c?"0c":2==c?"0b":"")+")?([0-9a-z]*)(?:\\.\\d*)?$","i").exec(a);if(f){var g=f[1]||"+",u=f[2]||"",f=f[3]||"";if("undefined"===typeof c)c="0x"===u||"0X"===u?16:"0c"===u||"0C"===u?8:"0b"===u||"0B"===u?2:10;else if(2>c||36<c)throw Error("Illegal radix "+c+".");c=+c;if(!b.radixRegex[c].test(f))throw Error("Bad digit for radix "+c);f=f.replace(/^0+/,"").split("");if(0===f.length)return e;g="-"===g?-1:1;if(10==c){for(u=[];7<=f.length;)u.push(parseInt(f.splice(f.length-
b.base_log10,b.base_log10).join(""),10));u.push(parseInt(f.join(""),10));return new b(u,g,h)}u=e;c=b.small[c];for(var n=b.small,l=0;l<f.length;l++)u=u.multiply(c).add(n[parseInt(f[l],36)]);return new b(u._d,g,h)}throw Error("Invalid BigInteger format: "+a);};b.prototype.add=function(a){if(0===this._s)return b(a);a=b(a);if(0===a._s)return this;if(this._s!==a._s)return a=a.negate(),this.subtract(a);var e=this._d;a=a._d;for(var d=e.length,f=a.length,g=Array(Math.max(d,f)+1),w=Math.min(d,f),n=0,l=0;l<
w;l++)n=e[l]+a[l]+n,g[l]=n%c,n=n/c|0;f>d&&(e=a,d=f);for(l=w;n&&l<d;l++)n=e[l]+n,g[l]=n%c,n=n/c|0;for(n&&(g[l]=n);l<d;l++)g[l]=e[l];return new b(g,this._s,h)};b.prototype.negate=function(){return new b(this._d,-this._s|0,h)};b.prototype.abs=function(){return 0>this._s?this.negate():this};b.prototype.subtract=function(a){if(0===this._s)return b(a).negate();a=b(a);if(0===a._s)return this;if(this._s!==a._s)return a=a.negate(),this.add(a);var d=this;0>this._s&&(d=new b(a._d,1,h),a=new b(this._d,1,h));
var f=d.compareAbs(a);if(0===f)return e;if(0>f){var g=a;a=d;d=g}d=d._d;a=a._d;var g=d.length,t=a.length,s=Array(g),n=0,l,k;for(l=0;l<t;l++)k=d[l]-n-a[l],0>k?(k+=c,n=1):n=0,s[l]=k;for(l=t;l<g;l++){k=d[l]-n;if(0>k)k+=c;else{s[l++]=k;break}s[l]=k}for(;l<g;l++)s[l]=d[l];return new b(s,f,h)};(function(){function a(e,d){for(var f=e._d,g=f.slice(),x=0;;){var w=(f[x]||0)+1;g[x]=w%c;if(w<=c-1)break;++x}return new b(g,d,h)}function e(a,d){for(var f=a._d,g=f.slice(),x=0;;){var w=(f[x]||0)-1;if(0>w)g[x]=w+c;
else{g[x]=w;break}++x}return new b(g,d,h)}b.prototype.next=function(){switch(this._s){case 0:return d;case -1:return e(this,-1);default:return a(this,1)}};b.prototype.prev=function(){switch(this._s){case 0:return f;case -1:return a(this,-1);default:return e(this,1)}}})();b.prototype.compareAbs=function(a){if(this===a)return 0;if(!(a instanceof b)){if(!isFinite(a))return isNaN(a)?a:-1;a=b(a)}if(0===this._s)return 0!==a._s?-1:0;if(0===a._s)return 1;var c=this._d.length,h=a._d.length;if(c<h)return-1;
if(c>h)return 1;h=this._d;a=a._d;for(c-=1;0<=c;c--)if(h[c]!==a[c])return h[c]<a[c]?-1:1;return 0};b.prototype.compare=function(a){if(this===a)return 0;a=b(a);return 0===this._s?-a._s:this._s===a._s?this.compareAbs(a)*this._s:this._s};b.prototype.isUnit=function(){return this===d||this===f||1===this._d.length&&1===this._d[0]};b.prototype.multiply=function(a){if(0===this._s)return e;a=b(a);if(0===a._s)return e;if(this.isUnit())return 0>this._s?a.negate():a;if(a.isUnit())return 0>a._s?this.negate():
this;if(this===a)return this.square();var d=this._d.length>=a._d.length,f=(d?this:a)._d,d=(d?a:this)._d,g=f.length,k=d.length,t=g+k,n=Array(t),l;for(l=0;l<t;l++)n[l]=0;for(l=0;l<k;l++){for(var t=0,p=d[l],r=g+l,q,m=l;m<r;m++)q=n[m]+p*f[m-l]+t,t=q/c|0,n[m]=q%c|0;t&&(q=n[m]+t,n[m]=q%c)}return new b(n,this._s*a._s,h)};b.prototype.multiplySingleDigit=function(a){if(0===a||0===this._s)return e;if(1===a)return this;var d;if(1===this._d.length)return d=this._d[0]*a,d>=c?new b([d%c|0,d/c|0],1,h):new b([d],
1,h);if(2===a)return this.add(this);if(this.isUnit())return new b([a],1,h);var f=this._d,g=f.length;d=g+1;for(var t=Array(d),k=0;k<d;k++)t[k]=0;for(var n=k=0;n<g;n++)d=a*f[n]+k,k=d/c|0,t[n]=d%c|0;k&&(t[n]=k);return new b(t,1,h)};b.prototype.square=function(){if(0===this._s)return e;if(this.isUnit())return d;var a=this._d,f=a.length,g=Array(f+f+1),k,v,s,n;for(n=0;n<f;n++)s=2*n,k=a[n]*a[n],v=k/c|0,g[s]=k%c,g[s+1]=v;for(n=0;n<f;n++){v=0;s=2*n+1;for(var l=n+1;l<f;l++,s++)k=a[l]*a[n]*2+g[s]+v,v=k/c|0,
g[s]=k%c;s=f+n;k=v+g[s];v=k/c|0;g[s]=k%c;g[s+1]+=v}return new b(g,1,h)};b.prototype.quotient=function(a){return this.divRem(a)[0]};b.prototype.divide=b.prototype.quotient;b.prototype.remainder=function(a){return this.divRem(a)[1]};b.prototype.divRem=function(a){a=b(a);if(0===a._s)throw Error("Divide by zero");if(0===this._s)return[e,e];if(1===a._d.length)return this.divRemSmall(a._s*a._d[0]);switch(this.compareAbs(a)){case 0:return[this._s===a._s?d:f,e];case -1:return[e,this]}var g=this._s*a._s,k=
a.abs(),B=this._d,v=B.length,s=[],n,l=new b([],0,h);for(l._s=1;v;)if(l._d.unshift(B[--v]),0>l.compareAbs(a))s.push(0);else{if(0===l._s)n=0;else{var m=l._d.length;n=k._d.length;m=l._d[m-1]*c+l._d[m-2];n=k._d[n-1]*c+k._d[n-2];l._d.length>k._d.length&&(m=(m+1)*c);n=Math.ceil(m/n)}do{m=k.multiplySingleDigit(n);if(0>=m.compareAbs(l))break;n--}while(n);s.push(n);n&&(n=l.subtract(m),l._d=n._d.slice(),0===l._d.length&&(l._s=0))}return[new b(s.reverse(),g,h),new b(l._d,this._s,h)]};b.prototype.divRemSmall=
function(a){a=+a;if(0===a)throw Error("Divide by zero");var d=this._s*(0>a?-1:1);a=Math.abs(a);if(1>a||a>=c)throw Error("Argument out of range");if(0===this._s)return[e,e];if(1===a||-1===a)return[1===d?this.abs():new b(this._d,d,h),e];if(1===this._d.length){var f=new b([this._d[0]/a|0],1,h);a=new b([this._d[0]%a|0],1,h);0>d&&(f=f.negate());0>this._s&&(a=a.negate());return[f,a]}for(var g=this._d.slice(),f=Array(g.length),k=0,t=0,n=0,l;g.length;)k=k*c+g[g.length-1],k<a?(f[n++]=0,g.pop(),t=c*t+k):(l=
0===k?0:k/a|0,t=k-a*l,(f[n++]=l)?(g.pop(),k=t):g.pop());a=new b([t],1,h);0>this._s&&(a=a.negate());return[new b(f.reverse(),d,h),a]};b.prototype.isEven=function(){var a=this._d;return 0===this._s||0===a.length||0===a[0]%2};b.prototype.isOdd=function(){return!this.isEven()};b.prototype.sign=function(){return this._s};b.prototype.isPositive=function(){return 0<this._s};b.prototype.isNegative=function(){return 0>this._s};b.prototype.isZero=function(){return 0===this._s};b.prototype.exp10=function(a){a=
+a;if(0===a)return this;if(Math.abs(a)>Number(g))throw Error("exponent too large in BigInteger.exp10");if(0<a){for(var c=new b(this._d.slice(),this._s,h);7<=a;a-=7)c._d.unshift(0);if(0==a)return c;c._s=1;c=c.multiplySingleDigit(Math.pow(10,a));return 0>this._s?c.negate():c}if(-a>=7*this._d.length)return e;c=new b(this._d.slice(),this._s,h);for(a=-a;7<=a;a-=7)c._d.shift();return 0==a?c:c.divRemSmall(Math.pow(10,a))[0]};b.prototype.pow=function(a){if(this.isUnit())return 0<this._s?this:b(a).isOdd()?
this:this.negate();a=b(a);if(0===a._s)return d;if(0>a._s){if(0===this._s)throw Error("Divide by zero");return e}if(0===this._s)return e;if(a.isUnit())return this;if(0<a.compareAbs(g))throw Error("exponent too large in BigInteger.pow");for(var c=this,h=d,f=b.small[2];a.isPositive()&&(!a.isOdd()||(h=h.multiply(c),!a.isUnit()));)c=c.square(),a=a.quotient(f);return h};b.prototype.modPow=function(a,c){for(var h=d,e=this;a.isPositive();)a.isOdd()&&(h=h.multiply(e).remainder(c)),a=a.quotient(b.small[2]),
a.isPositive()&&(e=e.square().remainder(c));return h};b.prototype.log=function(){switch(this._s){case 0:return-Infinity;case -1:return NaN}var a=this._d.length;if(30>7*a)return Math.log(this.valueOf());var e=Math.ceil(30/7),d=this._d.slice(a-e);return Math.log((new b(d,1,h)).valueOf())+(a-e)*Math.log(c)};b.prototype.valueOf=function(){return parseInt(this.toString(),10)};b.prototype.toJSValue=function(){return parseInt(this.toString(),10)};var g=b(2147483647);b.MAX_EXP=g;(function(){function a(c){return function(a){return c.call(b(a))}}
function c(a){return function(c,h){return a.call(b(c),b(h))}}function h(a){return function(c,h,e){return a.call(b(c),b(h),b(e))}}(function(){var e,d,f="toJSValue isEven isOdd sign isZero isNegative abs isUnit square negate isPositive toString next prev log".split(" "),g="compare remainder divRem subtract add quotient divide multiply pow compareAbs".split(" "),u=["modPow"];for(e=0;e<f.length;e++)d=f[e],b[d]=a(b.prototype[d]);for(e=0;e<g.length;e++)d=g[e],b[d]=c(b.prototype[d]);for(e=0;e<u.length;e++)d=
u[e],b[d]=h(b.prototype[d]);b.exp10=function(a,c){return b(a).exp10(c)}})()})();a.BigInteger=b})("undefined"!==typeof d?d:this);var q={greatest_common_divisor:function(a,b){if(b.isUnit()||a.isUnit())return BigInteger.ONE;for(var c;!b.isZero();)c=b,b=a.remainder(b),a=c;return a},create:function(){return[0]},clone:function(a){for(var b=[],c=0,e=a.length;c<e;c++)b[c]=a[c];return b},copy:function(a,b){a=[];for(var c=0,e=b.length;c<e;c++)a[c]=b[c];return a},abs:function(a,b){a[0]=Math.abs(b[0]);return a},
str:function(a){return a[0].toString()},toInteger:function(a){return out[0]},fromInteger:function(a){return[parseInt(a)]}};q.ZERO=q.fromInteger(0);q.ONE=q.fromInteger(1);"undefined"!==typeof d&&(d.bigint=q);if(!y)var y=Array;if(!A)var A=Math.pow(2,56);if(!m)var m=16777216;var c={EPSILON:2E-16};c.MAX_LOOPS=m;c.create=function(){var a=new y(2);a[0]=0;a[1]=1;return a};c.clone=function(a){var b=new y(2);b[0]=a[0];b[1]=a[1];return b};c.fromValues=function(a,b){var h=new y(2);h[0]=a;h[1]=b;return c.normalize(h,
h)};c.copy=function(a,b){a[0]=b[0];a[1]=b[1];return a};c.set=function(a,b,h){a[0]=b;a[1]=h;return c.normalize(a,a)};c.abs=function(a,b){a[0]=Math.abs(b[0]);a[1]=b[1];return a};c.invert=function(a,b){var c=b[0];a[0]=b[1];a[1]=c;return a};c.reciprocal=c.invert;c.add=function(a,b,h){b[1]===h[1]?(a[0]=b[0]+h[0],a[1]=b[1]):(a[0]=b[0]*h[1]+h[0]*b[1],a[1]=b[1]*h[1]);return c.normalize(a,a)};c.subtract=function(a,b,h){b[1]===h[1]?(a[0]=b[0]-h[0],a[1]=b[1]):(a[0]=b[0]*h[1]-h[0]*b[1],a[1]=b[1]*h[1]);return c.normalize(a,
a)};c.sub=c.subtract;c.multiply=function(a,b,h){a[0]=b[0]*h[0];a[1]=b[1]*h[1];return c.normalize(a,a)};c.mul=c.multiply;c.mediant=function(a,b,h){a[0]=b[0]+h[0];a[1]=b[1]+h[1];return c.normalize(a,a)};c.divide=function(a,b,h){a[0]=b[0]*h[1];a[1]=b[1]*h[0];return c.normalize(a,a)};c.div=c.divide;c.equals=function(a,b){return 0===a[0]&&0===b[0]||0===a[1]&&0===b[1]?!0:a[0]===b[0]&&a[1]===b[1]};c.approximates=function(a,b){if(c.equals(a,b))return!0;var h=c.create();c.sub(h,a,b);c.abs(h,h);return c.isLessThan(h,
c.INFINITESIMAL)};c.isGreaterThan=function(a,b){return c.equals(a,b)?!1:a[0]*b[1]>b[0]*a[1]};c.isLessThan=function(a,b){return c.equals(a,b)?!1:a[0]*b[1]<b[0]*a[1]};c.isNegative=function(a){return 0>a[0]};c.min=function(a,b,h){c.isLessThan(b,h)?(a[0]=b[0],a[1]=b[1]):(a[0]=h[0],a[1]=h[1]);return a};c.max=function(a,b,h){c.isGreaterThan(b,h)?(a[0]=b[0],a[1]=b[1]):(a[0]=h[0],a[1]=h[1]);return a};c.scalar_multiply=function(a,b,h){a[0]=b[0]*h;a[1]=b[1];return c.normalize(a,a)};c.scalar_divide=function(a,
b,h){a[0]=b[0];a[1]=b[1]*h;return c.normalize(a,a)};c.normalize=function(a,b){if(isNaN(b[0])||isNaN(b[1])||0===b[0]&&0===b[1])return a[0]=0,a[1]=0,a;if(0===b[0])return a[0]=0,a[1]=1,a;if(0===b[1])return a[0]=1,a[1]=0,a;if(b[0]===b[1])return a[0]=1,a[1]=1,a;0<b[1]?(a[0]=b[0],a[1]=b[1]):(a[0]=-b[0],a[1]=-b[1]);var c=f.greatest_common_divisor(Math.abs(a[0]),a[1]);1<c&&(a[0]/=c,a[1]/=c);return a};c.opposite=function(a,b){a[0]=-b[0];a[1]=b[1];return a};c.negative=c.opposite;c.neg=c.opposite;c.power=function(a,
b,h){2===h?(a[0]=b[0]*b[0],a[1]=b[1]*b[1]):0<h?(a[0]=Math.pow(b[0],h),a[1]=Math.pow(b[1],h)):0>h?(h=Math.abs(h),a[0]=Math.pow(b[1],h),a[1]=Math.pow(b[0],h)):c.copy(a,c.ONE);return c.normalize(a,a)};c.pow=c.power;c.sqrt=function(a,b){return c.nthRoot(a,b,2)};c.nthRoot=function(a,b,h){if(c.equals(b,c.ZERO))return c.copy(a,c.ZERO);if(c.equals(b,c.ONE))return c.copy(a,c.ONE);if(c.equals(b,c.INFINITY))return c.copy(a,c.INFINITY);if(c.equals(b,c.INFINULL))return c.copy(a,c.INFINULL);var e=c.isNegative(b);
e&&(b[0]=-b[0]);a=c.copy(a,c.ONE);for(var d=[1,0,0,1],f=c.clone(c.ONE),g=c.MAX_LOOPS;!c.approximates(b,f)&&g--;)c.isLessThan(b,f)?(d[0]+=d[1],d[2]+=d[3]):(d[1]+=d[0],d[3]+=d[2]),a[0]=d[0]+d[1],a[1]=d[2]+d[3],c.pow(f,a,h);e&&(b[0]=-b[0],1===h%2&&c.neg(a,a));return a};c.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]};c.str=function(a){return 1===a[1]?a[0].toString():a[0]+"/"+a[1]};c.toDecimal=function(a){return a[0]/a[1]};c.dec=c.toDecimal;c.toInteger=function(a){return Math.round(c.toDecimal(a))};c.round=
c.toInteger;c.floor=function(a){return Math.floor(c.toDecimal(a))};c.ceil=function(a){return Math.ceil(c.toDecimal(a))};c.fromInteger_copy=function(a,b){a[0]=parseInt(b);a[1]=1;return a};c.fromInteger=function(a){return c.fromInteger_copy(c.create(),a)};c.fromIntegerInverse_copy=function(a,b){a[0]=1;a[1]=parseInt(b);0>a[1]&&(a[0]=-a[0],a[1]=-a[1]);return a};c.fromIntegerInverse=function(a){return c.fromIntegerInverse_copy(c.create(),a)};c.fromDecimal=function(a){return c.fromDecimal_copy(c.create(),
a)};c.fromDecimal_copy=function(a,b){b=parseFloat(b);if(isNaN(b))return c.copy(a,c.INFINULL);if(Infinity===b)return c.copy(a,c.INFINITY);if(Math.abs(b)<c.EPSILON)return c.copy(a,c.ZERO);if(Math.abs(b-1)<c.EPSILON)return c.copy(a,c.ONE);if(Math.abs(b%1)<c.EPSILON)return c.fromInteger_copy(a,b);if(Math.abs(1/b%1)<c.EPSILON)return c.fromIntegerInverse_copy(a,Math.round(1/b));c.copy(a,c.ONE);for(var h=[1,0,0,1],d=b,e=1,f=c.MAX_LOOPS;f--&&Math.abs(b-c.toDecimal(a))>c.EPSILON;)e=Math.floor(d),a[0]=e*h[0]+
h[2],a[1]=e*h[1]+h[3],d=1/(d-e),h[2]=h[0],h[3]=h[1],h[0]=a[0],h[1]=a[1];return a};c.fromRandom=function(a){a[0]=0xfffffffffffff*Math.random()<<0;a[1]=Math.abs(0xfffffffffffff*Math.random()<<0);return c.normalize(a,a)};c.sin=function(a,b){if(0===b[1])return c.copy(a,c.ZERO);c.scalar_multiply(a,b,2);var h=c.create();c.pow(h,b,2);c.add(h,h,c.ONE);c.divide(a,a,h);return a};c.cos=function(a,b){if(0===b[1])return c.neg(a,c.ONE);var h=c.create();c.pow(h,b,2);c.sub(a,c.ONE,h);var d=c.create();c.add(d,c.ONE,
h);c.divide(a,a,d);return a};c.tan=function(a,b){c.scalar_multiply(a,b,2);var h=c.create();c.pow(h,b,2);c.scalar_multiply(h,h,2);c.add(a,a,h);c.pow(h,b,4);c.sub(h,c.ONE,h);c.divide(a,a,h);return a};c.toEgyptian=function(a){a=c.clone(a);c.abs(a,a);var b=c.floor(a);b&&c.sub(a,a,c.fromInteger(b));if(!a[0])return b.toString();b||(b="");for(var h=1,d=c.create();1!==a[0];)h++,d=c.fromValues(1,h),c.isGreaterThan(a,d)&&(b&&(b+=" + "),b+=c.str(d),c.sub(a,a,d));return a?b?b+" + "+c.str(a):c.str(a):b?b:"0"};
c.toBabylonian=function(a){var b="",d=c.toDecimal(a);a=parseInt(d);for(var d=d-a,e=0,f=0;0<a;)(e=a%60)&&(b=e+" * 60^"+f+(b?" + ":"")+b),a=(a-e)/60,f++;for(f=-1;0<d;)d*=60,e=parseInt(d+1E-13),d-=e,-1E-13>d||(e&&(b+=(b?" + ":"")+e+" * 60^"+f),f--);return b?b:"0"};c.traceSternBrocot=function(a){var b="";if(c.equals(a,c.ZERO)||c.equals(a,c.ONE)||c.equals(a,c.INFINITY)||c.equals(a,c.INFINULL))return b;if(c.equals(a,c.ZERO))return c.copy(out,c.ZERO);if(c.equals(a,c.ONE))return c.copy(out,c.ONE);if(c.equals(a,
c.INFINITY))return c.copy(out,c.INFINITY);if(c.equals(a,c.INFINULL))return c.copy(out,c.INFINULL);a=c.clone(a);c.isNegative(a)&&(a[0]=-a[0]);for(var d=c.clone(c.ONE),e=[1,0,0,1],f=0,g=0,k=c.MAX_LOOPS;!c.approximates(a,d)&&k--;)c.isLessThan(a,d)?(e[0]+=e[1],e[2]+=e[3],g++,f&&(b+="R",1!==f&&(b+=f),f=0,b+=" ")):(e[1]+=e[0],e[3]+=e[2],f++,g&&(b+="L",1!==g&&(b+=g),g=0,b+=" ")),d[0]=e[0]+e[1],d[1]=e[2]+e[3];g?(b+="L",1!==g&&(b+=g)):f&&(b+="R",1!==f&&(b+=f));0>k&&(b+="...");return b};c.toContinuedFraction=
function(a,b){b="undefined"===typeof b?65536:parseInt(b);if(c.equals(a,c.ZERO))return[0];if(c.equals(a,c.ONE))return[1];if(c.equals(a,c.NEGONE))return[-1];if(c.equals(a,c.INFINITY))return[1,0];if(c.equals(a,c.INFINULL))return[0,0];var e=c.clone(a),d=c.isNegative(e);d&&(e[0]=-e[0]);for(var f=c.clone(c.ONE),g=[1,0,0,1],k=1,m=[0],p=m.length-1;!c.equals(e,f)&&b--;)c.isLessThan(e,f)?(-1===k?m[p]++:(k=-1,m.push(1),p++),g[0]+=g[1],g[2]+=g[3]):(1===k?m[p]++:(k=1,m.push(1),p++),g[1]+=g[0],g[3]+=g[2]),f[0]=
g[0]+g[1],f[1]=g[2]+g[3];0>b?m.push(0):m[p]++;if(d)for(var q in m)m[q]=-m[q];return m};c.fromContinuedFraction=function(a,b){c.fromInteger_copy(a,b[b.length-1]);for(var e=b.length-2;-1<e;e--)c.invert(a,a),c.add(a,c.fromInteger(b[e]),a);return a};c.dump=function(a){c.create();return"rat\t"+c.str(a)+"\n~\t"+c.toDecimal(a)+"\nCF:\t["+c.toContinuedFraction(a)+"]\n"};c.ZERO=c.fromInteger(0);c.ONE=c.fromInteger(1);c.NEGONE=c.fromInteger(-1);c.INFINITY=c.fromValues(1,0);c.INFINULL=c.fromValues(0,0);c.INFINITESIMAL=
c.clone([1,A]);c.PI=c.fromValues(1320192667429,420230377710);"undefined"!==typeof d&&(d.rat=c);if(!p)var p=new BigInteger("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF");if(!z)var z=1073741824;var e={EPSILON:2E-16};e.MAX_LOOPS=z;e.create=function(){var a=[];a[0]=BigInteger.ZERO;a[1]=BigInteger.ONE;return a};e.clone=function(a){var b=[];b[0]=a[0];b[1]=a[1];return b};e.fromValues=function(a,b){var c=[];c[0]=new BigInteger(a);c[1]=new BigInteger(b);return e.normalize(c,c)};e.copy=function(a,b){a[0]=b[0];a[1]=
b[1];return a};e.set=function(a,b,c){a[0]=b;a[1]=c;return e.normalize(a,a)};e.toRat=function(a,b){return c.set(a,b[0].toJSValue(),b[1].toJSValue())};e.fromRat=function(a,b){return e.set(a,BigInteger(b[0]),BigInteger(b[1]))};e.abs=function(a,b){a[0]=b[0].abs();a[1]=b[1];return a};e.invert=function(a,b){var c=b[0];a[0]=b[1];a[1]=c;return a};e.reciprocal=e.invert;e.add=function(a,b,c){0===b[1].compare(c[1])?(a[0]=b[0].add(c[0]),a[1]=b[1]):(a[0]=b[0].multiply(c[1]).add(c[0].multiply(b[1])),a[1]=b[1].multiply(c[1]));
return e.normalize(a,a)};e.subtract=function(a,b,c){0===b[1].compare(c[1])?(a[0]=b[0].subtract(c[0]),a[1]=b[1]):(a[0]=b[0].multiply(c[1]).subtract(c[0].multiply(b[1])),a[1]=b[1].multiply(c[1]));return e.normalize(a,a)};e.sub=e.subtract;e.multiply=function(a,b,c){a[0]=b[0].multiply(c[0]);a[1]=b[1].multiply(c[1]);return e.normalize(a,a)};e.mul=e.multiply;e.mediant=function(a,b,c){a[0]=b[0].add(c[0]);a[1]=b[1].add(c[1]);return e.normalize(a,a)};e.divide=function(a,b,c){a[0]=b[0].multiply(c[1]);a[1]=
b[1].multiply(c[0]);return e.normalize(a,a)};e.div=e.divide;e.equals=function(a,b){return a[0].isZero()&&b[0].isZero()||a[1].isZero()&&b[1].isZero()?!0:0===a[0].compare(b[0])&&0===a[1].compare(b[1])};e.approximates=function(a,b){if(e.equals(a,b))return!0;var c=e.create();e.sub(c,a,b);e.abs(c,c);return e.isLessThan(c,e.INFINITESIMAL)};e.isGreaterThan=function(a,b){return e.equals(a,b)?!1:0<a[0].multiply(b[1]).compare(b[0].multiply(a[1]))};e.isLessThan=function(a,b){return e.equals(a,b)?!1:0>a[0].multiply(b[1]).compare(b[0].multiply(a[1]))};
e.isNegative=function(a){return a[0].isNegative()};e.min=function(a,b,c){e.isLessThan(b,c)?(a[0]=b[0],a[1]=b[1]):(a[0]=c[0],a[1]=c[1]);return a};e.max=function(a,b,c){e.isGreaterThan(b,c)?(a[0]=b[0],a[1]=b[1]):(a[0]=c[0],a[1]=c[1]);return a};e.scalar_multiply=function(a,b,c){a[0]=b[0].multiply(c);a[1]=b[1];return e.normalize(a,a)};e.scalar_divide=function(a,b,c){a[0]=b[0];a[1]=b[1].multiply(c);return e.normalize(a,a)};e.normalize=function(a,b){if(b[0].isZero()||b[1].isZero())return b;if(0===b[0].compare(b[1]))return e.clone(e.ONE);
if(b[1].isNegative())a[0]=b[0].negate(),a[1]=b[1].negate();else if(a[0]=b[0],a[1]=b[1],a[1].isZero())return a;var c=q.greatest_common_divisor(a[0].abs(),a[1]);0<c.compare(BigInteger.ONE)&&(a[0]=a[0].quotient(c),a[1]=a[1].quotient(c));return a};e.opposite=function(a,b){a[0]=b[0].negate();a[1]=b[1];return a};e.negative=e.opposite;e.neg=e.opposite;e.power=function(a,b,c){2===c?(a[0]=b[0].square(),a[1]=b[1].square()):0<c?(a[0]=b[0].pow(c),a[1]=b[1].pow(c)):0>c?(c=Math.abs(c),a[0]=b[1].pow(c),a[1]=b[0].pow(c)):
e.copy(a,e.ONE);return a};e.pow=e.power;e.sqrt=function(a,b){return e.nthRoot(a,b,2)};e.nthRoot=function(a,b,c){if(e.equals(b,e.ZERO))return e.copy(a,e.ZERO);if(e.equals(b,e.ONE))return e.copy(a,e.ONE);if(e.equals(b,e.INFINITY))return e.copy(a,e.INFINITY);if(e.equals(b,e.INFINULL))return e.copy(a,e.INFINULL);var d=e.isNegative(b);d&&(b[0]=b[0].negate());e.copy(a,e.ONE);for(var f=[BigInteger(1),BigInteger(0),BigInteger(0),BigInteger(1)],g=e.clone(e.ONE),k=z;!e.approximates(b,g)&&k--;)e.isLessThan(b,
g)?(f[0]=f[0].add(f[1]),f[2]=f[2].add(f[3])):(f[1]=f[1].add(f[0]),f[3]=f[3].add(f[2])),a[0]=f[0].add(f[1]),a[1]=f[2].add(f[3]),e.pow(g,a,c);d&&(b[0]=b[0].negate(),1===c%2&&e.neg(a,a));return a};e.dot=function(a,b){return a[0].multiply(b[0]).add(a[1].multiply(b[1]))};e.str=function(a){return 0===a[1].compare(BigInteger.ONE)?a[0].toString():a[0].toString()+"/"+a[1].toString()};e.toDecimal=function(a){return a[0].toJSValue()/a[1].toJSValue()};e.dec=e.toDecimal;e.toInteger=function(a){return a[0].quotient(a[1]).toJSValue()};
e.round=e.toInteger;e.toBigInteger=function(a){return a[0].quotient(a[1])};e.floor=function(a){return Math.floor(e.toDecimal(a))};e.ceil=function(a){return Math.ceil(e.toDecimal(a))};e.fromInteger_copy=function(a,b){a[0]=BigInteger(b);a[1]=BigInteger.ONE;return a};e.fromInteger=function(a){return e.fromInteger_copy(e.create(),a)};e.fromIntegerInverse_copy=function(a,b){a[0]=BigInteger.ONE;a[1]=BigInteger(b);a[1].isNegative()&&(a[0]=a[0].negate(),a[1]=a[1].negate());return a};e.fromIntegerInverse=
function(a){return e.fromIntegerInverse_copy(e.create(),a)};e.fromDecimal=function(a){return e.fromDecimal_copy(e.create(),a)};e.fromDecimal_copy=function(a,b){b=parseFloat(b);if(isNaN(b))return e.copy(a,e.INFINULL);if(Infinity===b)return e.copy(a,e.INFINITY);if(Math.abs(b)<e.EPSILON)return e.copy(a,e.ZERO);if(Math.abs(b-1)<e.EPSILON)return e.copy(a,e.ONE);if(Math.abs(b%1)<e.EPSILON)return e.fromInteger_copy(a,b);if(Math.abs(1/b%1)<e.EPSILON)return e.fromIntegerInverse_copy(a,Math.round(1/b));e.copy(a,
e.ONE);for(var c=[BigInteger(1),BigInteger(0),BigInteger(0),BigInteger(1)],d=b,f=1,g=e.MAX_LOOPS;g--&&Math.abs(b-e.toDecimal(a))>e.EPSILON;)f=Math.floor(d),a[0]=BigInteger(f*c[0]+c[2]),a[1]=BigInteger(f*c[1]+c[3]),d=1/(d-f),c[2]=c[0],c[3]=c[1],c[0]=a[0],c[1]=a[1];return a};e.fromRandom=function(a){a[0]=BigInteger(0xfffffffffffff*Math.random()<<0);a[1]=BigInteger(Math.abs(0xfffffffffffff*Math.random()<<0));return e.normalize(a,a)};e.sin=function(a,b){if(b[1].isZero())return e.copy(a,e.ZERO);e.scalar_multiply(a,
b,2);var c=e.create();e.pow(c,b,2);e.add(c,c,e.ONE);e.divide(a,a,c);return a};e.cos=function(a,b){if(b[1].isZero())return e.neg(a,e.ONE);var c=e.create();e.pow(c,b,2);e.sub(a,e.ONE,c);var d=e.create();e.add(d,e.ONE,c);e.divide(a,a,d);return a};e.tan=function(a,b){e.scalar_multiply(a,b,2);var c=e.create();e.pow(c,b,2);e.scalar_multiply(c,c,2);e.add(a,a,c);e.pow(c,b,4);e.sub(c,e.ONE,c);e.divide(a,a,c);return a};e.toEgyptian=function(a){a=e.clone(a);e.abs(a,a);var b=e.floor(a);b&&e.sub(a,a,e.fromInteger(b));
if(!a[0])return b.toString();b||(b="");for(var c=1,d=e.create();1!==a[0];)c++,d=e.fromValues(1,c),e.isGreaterThan(a,d)&&(b&&(b+=" + "),b+=e.str(d),e.sub(a,a,d));return a?b?b+" + "+e.str(a):e.str(a):b?b:"0"};e.toBabylonian=function(a){var b="",c=e.toDecimal(a);a=parseInt(c);for(var c=c-a,d=0,f=0;0<a;)(d=a%60)&&(b=d+" * 60^"+f+(b?" + ":"")+b),a=(a-d)/60,f++;for(f=-1;0<c;)c*=60,d=parseInt(c+1E-13),c-=d,-1E-13>c||(d&&(b+=(b?" + ":"")+d+" * 60^"+f),f--);return b?b:"0"};e.traceSternBrocot=function(a){var b=
"";if(e.equals(a,e.ZERO)||e.equals(a,e.ONE)||e.equals(a,e.INFINITY)||e.equals(a,e.INFINULL))return b;a=e.clone(a);e.isNegative(a)&&(a[0]=a[0].negate());for(var c=e.clone(e.ONE),d=[BigInteger(1),BigInteger(0),BigInteger(0),BigInteger(1)],f=0,g=0,k=65536;!e.equals(a,c)&&k--;)e.isLessThan(a,c)?(d[0]=d[0].add(d[1]),d[2]=d[2].add(d[3]),g++,f&&(b+="R",1!==f&&(b+=f),f=0,b+=" ")):(d[1]=d[1].add(d[0]),d[3]=d[3].add(d[2]),f++,g&&(b+="L",1!==g&&(b+=g),g=0,b+=" ")),c[0]=d[0].add(d[1]),c[1]=d[2].add(d[3]);g?(b+=
"L",1!==g&&(b+=g)):f&&(b+="R",1!==f&&(b+=f));0>k&&(b+="...");return b};e.toContinuedFraction=function(a,b){b="undefined"===typeof b?65536:parseInt(b);if(e.equals(a,e.ZERO))return[0];if(e.equals(a,e.ONE))return[1];if(e.equals(a,e.NEGONE))return[-1];if(e.equals(a,e.INFINITY))return[1,0];if(e.equals(a,e.INFINULL))return[0,0];var c=e.clone(a),d=e.isNegative(c);d&&(c[0]=c[0].negate());for(var f=e.clone(e.ONE),g=[BigInteger(1),BigInteger(0),BigInteger(0),BigInteger(1)],k=1,m=[0],p=m.length-1;!e.equals(c,
f)&&b--;)e.isLessThan(c,f)?(-1===k?m[p]++:(k=-1,m.push(1),p++),g[0]=g[0].add(g[1]),g[2]=g[2].add(g[3])):(1===k?m[p]++:(k=1,m.push(1),p++),g[1]=g[1].add(g[0]),g[3]=g[3].add(g[2])),f[0]=g[0].add(g[1]),f[1]=g[2].add(g[3]);0>b?m.push(0):m[p]++;if(d)for(var q in m)m[q]=-m[q];return m};e.fromContinuedFraction=function(a,b){e.fromInteger_copy(a,b[b.length-1]);for(var c=b.length-2;-1<c;c--)e.invert(a,a),e.add(a,e.fromInteger(b[c]),a);return a};e.fromFactorial=function(a,b){if("undefined"!==typeof factorial.PREPARED[b])return e.fromInteger_copy(a,
factorial.PREPARED[b]);var c=factorial.PREPARED.length-1;for(e.fromInteger_copy(a,factorial.PREPARED[c]);c<b;)e.scalar_multiply(a,a,++c);return a};e.dump=function(a){return"bigrat\t"+e.str(a)+"\n~\t"+e.toDecimal(a)+"\nCF:\t["+e.toContinuedFraction(a)+"]\n"};e.ZERO=e.fromInteger(0);e.ONE=e.fromInteger(1);e.NEGONE=e.fromInteger(-1);e.INFINITY=e.fromValues(1,0);e.INFINULL=e.fromValues(0,0);e.INFINITESIMAL=e.clone([new BigInteger(1),p]);e.PI=e.fromValues("3141592653589793238462643383279502884197169399375105820974944592307816406286208998628034825342117067982148086513282306647093844609550582231725359408128481117450284102701938521105559644622948954930381964428810975665933446128475648233786783165271201909145648566923460348610454326648213393607260249141273724587",
"1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000");"undefined"!==typeof d&&(d.bigrat=e);var k=function(a,b){this.a=c.fromValues(parseInt(a),parseInt(b))};k.prototype.toString=function(){return c.str(this.a)};k.prototype.toContinuedFraction=function(a){return c.toContinuedFraction(this.a,
a)};k.prototype.invert=function(){return c.invert(this.a)};k.prototype.reciprocal=k.prototype.invert;k.prototype.add=function(a){var b=c.create();c.add(b,this.a,a.a);return new k(b[0],b[1])};k.prototype.plus=k.prototype.add;k.prototype.subtract=function(a){var b=c.create();c.sub(b,this.a,a.a);return new k(b[0],b[1])};k.prototype.sub=k.prototype.subtract;k.prototype.minus=k.prototype.subtract;k.prototype.multiply=function(a){var b=c.create();c.mul(b,this.a,a.a);return new k(b[0],b[1])};k.prototype.mul=
k.prototype.multiply;k.prototype.times=k.prototype.multiply;k.prototype.mediant=function(a){var b=c.create();c.mediant(b,this.a,a.a);return new k(b[0],b[1])};k.prototype.divide=function(a){var b=c.create();c.div(b,this.a,a.a);return new k(b[0],b[1])};k.prototype.div=k.prototype.divide;k.prototype.divided_by=k.prototype.divide;k.prototype.power=function(a){var b=c.create();c.pow(b,this.a,a);return new k(b[0],b[1])};k.prototype.pow=k.prototype.power;k.prototype.dump=function(){return c.dump(this.a)};
k.prototype.toRat=function(){return c.clone(this.a)};k.prototype.toDecimal=function(){return c.toDecimal(this.a)};k.fromRat=function(a){var b=new k;b.a[0]=a[0];b.a[1]=a[1];return b};k.fromInteger=function(a){return k.fromRat(c.fromInteger(a))};k.fromIntegerInverse=function(a){return k.fromRat(c.fromIntegerInverse(a))};k.fromDecimal=function(a){return k.fromRat(c.fromDecimal(a))};k.fromContinuedFraction=function(a){return k.fromRat(c.fromContinuedFraction(c.create(),a))};"undefined"!==typeof d&&(d.rational=
k)})(d)})(this);
