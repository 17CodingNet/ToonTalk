'use strict';(function(k){var l;"undefined"===typeof exports?"function"===typeof define&&"object"===typeof define.amd&&define.amd?(l={},define(function(){return l})):l="undefined"!==typeof window?window:k:l=exports;(function(a){var b={greatest_common_divisor:function(c,r){if(1===r||1===c)return 1;for(var a;0!==r;){a=r;r=c%r;if(!isFinite(r))return 0;c=a}return c}};b.gcd=b.greatest_common_divisor;b.fromRandom=function(c){return Math.random()*(1<<c)>>>0};b.fromMillitime=function(){return+new Date};b.fromUnixtime=
function(){return.001*b.fromMillitime()|0};"undefined"!==typeof a&&(a.integer=b);(function(c){function r(c,b,f){if(f!==a)return c instanceof r?c:"undefined"===typeof c?d:r.parse(c);for(c=c||[];c.length&&!c[c.length-1];)--c.length;this._d=c;this._s=c.length?b||1:0}var a={};r._construct=function(c,d){return new r(c,d,a)};r.base=1E7;r.base_log10=7;var d=new r([],0,a);r.ZERO=d;var b=new r([1],1,a);r.ONE=b;var f=new r(b._d,-1,a);r.M_ONE=f;r._0=d;r._1=b;r.small=[d,b,new r([2],1,a),new r([3],1,a),new r([4],
1,a),new r([5],1,a),new r([6],1,a),new r([7],1,a),new r([8],1,a),new r([9],1,a),new r([10],1,a),new r([11],1,a),new r([12],1,a),new r([13],1,a),new r([14],1,a),new r([15],1,a),new r([16],1,a),new r([17],1,a),new r([18],1,a),new r([19],1,a),new r([20],1,a),new r([21],1,a),new r([22],1,a),new r([23],1,a),new r([24],1,a),new r([25],1,a),new r([26],1,a),new r([27],1,a),new r([28],1,a),new r([29],1,a),new r([30],1,a),new r([31],1,a),new r([32],1,a),new r([33],1,a),new r([34],1,a),new r([35],1,a),new r([36],
1,a)];r.digits="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");r.prototype.toString=function(c){c=+c||10;if(2>c||36<c)throw Error("illegal radix "+c+".");if(0===this._s)return"0";if(10===c){c=0>this._s?"-":"";c+=this._d[this._d.length-1].toString();for(var a=this._d.length-2;0<=a;a--){for(var d=this._d[a].toString();7>d.length;)d="0"+d;c+=d}return c}a=r.digits;c=r.small[c];for(var d=this._s,b=this.abs(),f=[],g;0!==b._s;)g=b.divRem(c),b=g[0],g=g[1],f.push(a[g.valueOf()]);return(0>d?"-":"")+f.reverse().join("")};
r.radixRegex=[/^$/,/^$/,/^[01]*$/,/^[012]*$/,/^[0-3]*$/,/^[0-4]*$/,/^[0-5]*$/,/^[0-6]*$/,/^[0-7]*$/,/^[0-8]*$/,/^[0-9]*$/,/^[0-9aA]*$/,/^[0-9abAB]*$/,/^[0-9abcABC]*$/,/^[0-9a-dA-D]*$/,/^[0-9a-eA-E]*$/,/^[0-9a-fA-F]*$/,/^[0-9a-gA-G]*$/,/^[0-9a-hA-H]*$/,/^[0-9a-iA-I]*$/,/^[0-9a-jA-J]*$/,/^[0-9a-kA-K]*$/,/^[0-9a-lA-L]*$/,/^[0-9a-mA-M]*$/,/^[0-9a-nA-N]*$/,/^[0-9a-oA-O]*$/,/^[0-9a-pA-P]*$/,/^[0-9a-qA-Q]*$/,/^[0-9a-rA-R]*$/,/^[0-9a-sA-S]*$/,/^[0-9a-tA-T]*$/,/^[0-9a-uA-U]*$/,/^[0-9a-vA-V]*$/,/^[0-9a-wA-W]*$/,
/^[0-9a-xA-X]*$/,/^[0-9a-yA-Y]*$/,/^[0-9a-zA-Z]*$/];r.parse=function(c,b){function f(c){c=c.replace(/\s*[*xX]\s*10\s*(\^|\*\*)\s*/,"e");return c.replace(/^([+\-])?(\d+)\.?(\d*)[eE]([+\-]?\d+)$/,function(c,a,r,m,d){d=+d;var b=0>d,f=r.length+d;c=(b?r:m).length;d=(d=Math.abs(d))>=c?d-c+b:0;c=Array(d+1).join("0");r+=m;return(a||"")+(b?r=c+r:r+=c).substr(0,f+=b?c.length:0)+(f<r.length?"."+r.substr(f):"")})}c=c.toString();if("undefined"===typeof b||10===+b)c=f(c);var g=RegExp("^([+\\-]?)("+("undefined"===
typeof b?"0[xcb]":16==b?"0x":8==b?"0c":2==b?"0b":"")+")?([0-9a-z]*)(?:\\.\\d*)?$","i").exec(c);if(g){var h=g[1]||"+",n=g[2]||"",g=g[3]||"";if("undefined"===typeof b)b="0x"===n||"0X"===n?16:"0c"===n||"0C"===n?8:"0b"===n||"0B"===n?2:10;else if(2>b||36<b)throw Error("Illegal radix "+b+".");b=+b;if(!r.radixRegex[b].test(g))throw Error("Bad digit for radix "+b);g=g.replace(/^0+/,"").split("");if(0===g.length)return d;h="-"===h?-1:1;if(10==b){for(n=[];7<=g.length;)n.push(parseInt(g.splice(g.length-r.base_log10,
r.base_log10).join(""),10));n.push(parseInt(g.join(""),10));return new r(n,h,a)}n=d;b=r.small[b];for(var k=r.small,m=0;m<g.length;m++)n=n.multiply(b).add(k[parseInt(g[m],36)]);return new r(n._d,h,a)}throw Error("Invalid BigInteger format: "+c);};r.prototype.add=function(c){if(0===this._s)return r(c);c=r(c);if(0===c._s)return this;if(this._s!==c._s)return c=c.negate(),this.subtract(c);var d=this._d;c=c._d;for(var b=d.length,f=c.length,g=Array(Math.max(b,f)+1),h=Math.min(b,f),n=0,m=0;m<h;m++)n=d[m]+
c[m]+n,g[m]=n%1E7,n=n/1E7|0;f>b&&(d=c,b=f);for(m=h;n&&m<b;m++)n=d[m]+n,g[m]=n%1E7,n=n/1E7|0;for(n&&(g[m]=n);m<b;m++)g[m]=d[m];return new r(g,this._s,a)};r.prototype.negate=function(){return new r(this._d,-this._s|0,a)};r.prototype.abs=function(){return 0>this._s?this.negate():this};r.prototype.subtract=function(c){if(0===this._s)return r(c).negate();c=r(c);if(0===c._s)return this;if(this._s!==c._s)return c=c.negate(),this.add(c);var b=this;0>this._s&&(b=new r(c._d,1,a),c=new r(this._d,1,a));var f=
b.compareAbs(c);if(0===f)return d;if(0>f){var g=c;c=b;b=g}b=b._d;c=c._d;var g=b.length,h=c.length,n=Array(g),k=0,m,q;for(m=0;m<h;m++)q=b[m]-k-c[m],0>q?(q+=1E7,k=1):k=0,n[m]=q;for(m=h;m<g;m++){q=b[m]-k;if(0>q)q+=1E7;else{n[m++]=q;break}n[m]=q}for(;m<g;m++)n[m]=b[m];return new r(n,f,a)};(function(){function c(b,d){for(var f=b._d,g=f.slice(),h=0;;){var m=(f[h]||0)+1;g[h]=m%1E7;if(9999999>=m)break;++h}return new r(g,d,a)}function d(c,b){for(var f=c._d,g=f.slice(),h=0;;){var m=(f[h]||0)-1;if(0>m)g[h]=
m+1E7;else{g[h]=m;break}++h}return new r(g,b,a)}r.prototype.next=function(){switch(this._s){case 0:return b;case -1:return d(this,-1);default:return c(this,1)}};r.prototype.prev=function(){switch(this._s){case 0:return f;case -1:return c(this,-1);default:return d(this,1)}}})();r.prototype.compareAbs=function(c){if(this===c)return 0;if(!(c instanceof r)){if(!isFinite(c))return isNaN(c)?c:-1;c=r(c)}if(0===this._s)return 0!==c._s?-1:0;if(0===c._s)return 1;var a=this._d.length,b=c._d.length;if(a<b)return-1;
if(a>b)return 1;b=this._d;c=c._d;for(--a;0<=a;a--)if(b[a]!==c[a])return b[a]<c[a]?-1:1;return 0};r.prototype.compare=function(c){if(this===c)return 0;c=r(c);return 0===this._s?-c._s:this._s===c._s?this.compareAbs(c)*this._s:this._s};r.prototype.isUnit=function(){return this===b||this===f||1===this._d.length&&1===this._d[0]};r.prototype.multiply=function(c){if(0===this._s)return d;c=r(c);if(0===c._s)return d;if(this.isUnit())return 0>this._s?c.negate():c;if(c.isUnit())return 0>c._s?this.negate():this;
if(this===c)return this.square();var b=this._d.length>=c._d.length,f=(b?this:c)._d,b=(b?c:this)._d,g=f.length,h=b.length,n=g+h,k=Array(n),m;for(m=0;m<n;m++)k[m]=0;for(m=0;m<h;m++){for(var n=0,q=b[m],l=g+m,u,t=m;t<l;t++)u=k[t]+q*f[t-m]+n,n=u/1E7|0,k[t]=u%1E7|0;n&&(u=k[t]+n,k[t]=u%1E7)}return new r(k,this._s*c._s,a)};r.prototype.multiplySingleDigit=function(c){if(0===c||0===this._s)return d;if(1===c)return this;var b;if(1===this._d.length)return b=this._d[0]*c,1E7<=b?new r([b%1E7|0,b/1E7|0],1,a):new r([b],
1,a);if(2===c)return this.add(this);if(this.isUnit())return new r([c],1,a);var f=this._d,g=f.length;b=g+1;for(var h=Array(b),n=0;n<b;n++)h[n]=0;for(var k=n=0;k<g;k++)b=c*f[k]+n,n=b/1E7|0,h[k]=b%1E7|0;n&&(h[k]=n);return new r(h,1,a)};r.prototype.square=function(){if(0===this._s)return d;if(this.isUnit())return b;var c=this._d,f=c.length,g=Array(f+f+1),h,n,k,q;for(q=0;q<f;q++)k=2*q,h=c[q]*c[q],n=h/1E7|0,g[k]=h%1E7,g[k+1]=n;for(q=0;q<f;q++){n=0;k=2*q+1;for(var m=q+1;m<f;m++,k++)h=c[m]*c[q]*2+g[k]+n,
n=h/1E7|0,g[k]=h%1E7;k=f+q;h=n+g[k];n=h/1E7|0;g[k]=h%1E7;g[k+1]+=n}return new r(g,1,a)};r.prototype.quotient=function(c){return this.divRem(c)[0]};r.prototype.divide=r.prototype.quotient;r.prototype.remainder=function(c){return this.divRem(c)[1]};r.prototype.divRem=function(c){c=r(c);if(0===c._s)throw Error("Divide by zero");if(0===this._s)return[d,d];if(1===c._d.length)return this.divRemSmall(c._s*c._d[0]);switch(this.compareAbs(c)){case 0:return[this._s===c._s?b:f,d];case -1:return[d,this]}var g=
this._s*c._s,h=c.abs(),n=this._d,k=n.length,q=[],l,m=new r([],0,a);for(m._s=1;k;)if(m._d.unshift(n[--k]),0>m.compareAbs(c))q.push(0);else{if(0===m._s)l=0;else{var A=m._d.length;l=h._d.length;A=1E7*m._d[A-1]+m._d[A-2];l=1E7*h._d[l-1]+h._d[l-2];m._d.length>h._d.length&&(A=1E7*(A+1));l=Math.ceil(A/l)}do{A=h.multiplySingleDigit(l);if(0>=A.compareAbs(m))break;l--}while(l);q.push(l);l&&(l=m.subtract(A),m._d=l._d.slice(),0===m._d.length&&(m._s=0))}return[new r(q.reverse(),g,a),new r(m._d,this._s,a)]};r.prototype.divRemSmall=
function(c){c=+c;if(0===c)throw Error("Divide by zero");var b=this._s*(0>c?-1:1);c=Math.abs(c);if(1>c||1E7<=c)throw Error("Argument out of range");if(0===this._s)return[d,d];if(1===c||-1===c)return[1===b?this.abs():new r(this._d,b,a),d];if(1===this._d.length){var g=new r([this._d[0]/c|0],1,a);c=new r([this._d[0]%c|0],1,a);0>b&&(g=g.negate());0>this._s&&(c=c.negate());return[g,c]}for(var f=this._d.slice(),g=Array(f.length),h=0,n=0,k=0,m;f.length;)h=1E7*h+f[f.length-1],h<c?(g[k++]=0,f.pop(),n=1E7*n+
h):(m=0===h?0:h/c|0,n=h-c*m,(g[k++]=m)?(f.pop(),h=n):f.pop());c=new r([n],1,a);0>this._s&&(c=c.negate());return[new r(g.reverse(),b,a),c]};r.prototype.isEven=function(){var c=this._d;return 0===this._s||0===c.length||0===c[0]%2};r.prototype.isOdd=function(){return!this.isEven()};r.prototype.sign=function(){return this._s};r.prototype.isPositive=function(){return 0<this._s};r.prototype.isNegative=function(){return 0>this._s};r.prototype.isZero=function(){return 0===this._s};r.prototype.exp10=function(c){c=
+c;if(0===c)return this;if(Math.abs(c)>Number(g))throw Error("exponent too large in BigInteger.exp10");if(0<c){for(var b=new r(this._d.slice(),this._s,a);7<=c;c-=7)b._d.unshift(0);if(0==c)return b;b._s=1;b=b.multiplySingleDigit(Math.pow(10,c));return 0>this._s?b.negate():b}if(-c>=7*this._d.length)return d;b=new r(this._d.slice(),this._s,a);for(c=-c;7<=c;c-=7)b._d.shift();return 0==c?b:b.divRemSmall(Math.pow(10,c))[0]};r.prototype.pow=function(c){if(this.isUnit())return 0<this._s?this:r(c).isOdd()?
this:this.negate();c=r(c);if(0===c._s)return b;if(0>c._s){if(0===this._s)throw Error("Divide by zero");return d}if(0===this._s)return d;if(c.isUnit())return this;if(0<c.compareAbs(g))throw Error("exponent too large in BigInteger.pow");for(var a=this,f=b,h=r.small[2];c.isPositive()&&(!c.isOdd()||(f=f.multiply(a),!c.isUnit()));)a=a.square(),c=c.quotient(h);return f};r.prototype.modPow=function(c,a){for(var d=b,f=this;c.isPositive();)c.isOdd()&&(d=d.multiply(f).remainder(a)),c=c.quotient(r.small[2]),
c.isPositive()&&(f=f.square().remainder(a));return d};r.prototype.log=function(){switch(this._s){case 0:return-Infinity;case -1:return NaN}var c=this._d.length;if(30>7*c)return Math.log(this.valueOf());var b=Math.ceil(30/7),d=this._d.slice(c-b);return Math.log((new r(d,1,a)).valueOf())+(c-b)*Math.log(1E7)};r.prototype.valueOf=function(){return parseInt(this.toString(),10)};r.prototype.toJSValue=function(){return parseInt(this.toString(),10)};var g=r(2147483647);r.MAX_EXP=g;(function(){function c(a){return function(c){return a.call(r(c))}}
function a(c){return function(a,b){return c.call(r(a),r(b))}}function b(c){return function(a,b,d){return c.call(r(a),r(b),r(d))}}(function(){var d,f,g="toJSValue isEven isOdd sign isZero isNegative abs isUnit square negate isPositive toString next prev log".split(" "),h="compare remainder divRem subtract add quotient divide multiply pow compareAbs".split(" "),m=["modPow"];for(d=0;d<g.length;d++)f=g[d],r[f]=c(r.prototype[f]);for(d=0;d<h.length;d++)f=h[d],r[f]=a(r.prototype[f]);for(d=0;d<m.length;d++)f=
m[d],r[f]=b(r.prototype[f]);r.exp10=function(c,a){return r(c).exp10(a)}})()})();c.BigInteger=r})("undefined"!==typeof a?a:this);var d={greatest_common_divisor:function(c,a){if(a.isUnit()||c.isUnit())return BigInteger.ONE;for(var b;!a.isZero();)b=a,a=c.remainder(a),c=b;return c},create:function(){return[0]},clone:function(c){for(var a=[],b=0,d=c.length;b<d;b++)a[b]=c[b];return a},copy:function(c,a){c=[];for(var b=0,d=a.length;b<d;b++)c[b]=a[b];return c},abs:function(c,a){c[0]=Math.abs(a[0]);return c},
str:function(c){return c[0].toString()},toInteger:function(c){return out[0]},fromInteger:function(c){return[parseInt(c)]}};d.ZERO=d.fromInteger(0);d.ONE=d.fromInteger(1);"undefined"!==typeof a&&(a.bigint=d);if(!f)var f=Array;if(!g)var g=Math.pow(2,56);if(!k)var k=16777216;var h={EPSILON:2E-16};h.MAX_LOOPS=k;h.create=function(){var c=new f(2);c[0]=0;c[1]=1;return c};h.clone=function(c){var a=new f(2);a[0]=c[0];a[1]=c[1];return a};h.fromValues=function(c,a){var b=new f(2);b[0]=c;b[1]=a;return h.normalize(b,
b)};h.copy=function(c,a){c[0]=a[0];c[1]=a[1];return c};h.set=function(c,a,b){c[0]=a;c[1]=b;return h.normalize(c,c)};h.abs=function(c,a){c[0]=Math.abs(a[0]);c[1]=a[1];return c};h.invert=function(c,a){var b=a[0];c[0]=a[1];c[1]=b;return c};h.reciprocal=h.invert;h.add=function(c,a,b){a[1]===b[1]?(c[0]=a[0]+b[0],c[1]=a[1]):(c[0]=a[0]*b[1]+b[0]*a[1],c[1]=a[1]*b[1]);return h.normalize(c,c)};h.subtract=function(c,a,b){a[1]===b[1]?(c[0]=a[0]-b[0],c[1]=a[1]):(c[0]=a[0]*b[1]-b[0]*a[1],c[1]=a[1]*b[1]);return h.normalize(c,
c)};h.sub=h.subtract;h.multiply=function(c,a,b){c[0]=a[0]*b[0];c[1]=a[1]*b[1];return h.normalize(c,c)};h.mul=h.multiply;h.mediant=function(c,a,b){c[0]=a[0]+b[0];c[1]=a[1]+b[1];return h.normalize(c,c)};h.divide=function(c,a,b){c[0]=a[0]*b[1];c[1]=a[1]*b[0];return h.normalize(c,c)};h.div=h.divide;h.equals=function(c,a){return 0===c[0]&&0===a[0]||0===c[1]&&0===a[1]?!0:c[0]===a[0]&&c[1]===a[1]};h.approximates=function(c,a){if(h.equals(c,a))return!0;var b=h.create();h.sub(b,c,a);h.abs(b,b);return h.isLessThan(b,
h.INFINITESIMAL)};h.isGreaterThan=function(c,a){return h.equals(c,a)?!1:c[0]*a[1]>a[0]*c[1]};h.isLessThan=function(c,a){return h.equals(c,a)?!1:c[0]*a[1]<a[0]*c[1]};h.isNegative=function(c){return 0>c[0]};h.min=function(c,a,b){h.isLessThan(a,b)?(c[0]=a[0],c[1]=a[1]):(c[0]=b[0],c[1]=b[1]);return c};h.max=function(c,a,b){h.isGreaterThan(a,b)?(c[0]=a[0],c[1]=a[1]):(c[0]=b[0],c[1]=b[1]);return c};h.scalar_multiply=function(c,a,b){c[0]=a[0]*b;c[1]=a[1];return h.normalize(c,c)};h.scalar_divide=function(c,
a,b){c[0]=a[0];c[1]=a[1]*b;return h.normalize(c,c)};h.normalize=function(c,a){if(isNaN(a[0])||isNaN(a[1])||0===a[0]&&0===a[1])return c[0]=0,c[1]=0,c;if(0===a[0])return c[0]=0,c[1]=1,c;if(0===a[1])return c[0]=1,c[1]=0,c;if(a[0]===a[1])return c[0]=1,c[1]=1,c;0<a[1]?(c[0]=a[0],c[1]=a[1]):(c[0]=-a[0],c[1]=-a[1]);var d=b.greatest_common_divisor(Math.abs(c[0]),c[1]);1<d&&(c[0]/=d,c[1]/=d);return c};h.opposite=function(c,a){c[0]=-a[0];c[1]=a[1];return c};h.negative=h.opposite;h.neg=h.opposite;h.power=function(c,
a,b){2===b?(c[0]=a[0]*a[0],c[1]=a[1]*a[1]):0<b?(c[0]=Math.pow(a[0],b),c[1]=Math.pow(a[1],b)):0>b?(b=Math.abs(b),c[0]=Math.pow(a[1],b),c[1]=Math.pow(a[0],b)):h.copy(c,h.ONE);return h.normalize(c,c)};h.pow=h.power;h.sqrt=function(c,a){return h.nthRoot(c,a,2)};h.nthRoot=function(c,a,b){if(h.equals(a,h.ZERO))return h.copy(c,h.ZERO);if(h.equals(a,h.ONE))return h.copy(c,h.ONE);if(h.equals(a,h.INFINITY))return h.copy(c,h.INFINITY);if(h.equals(a,h.INFINULL))return h.copy(c,h.INFINULL);var d=h.isNegative(a);
d&&(a[0]=-a[0]);c=h.copy(c,h.ONE);for(var f=[1,0,0,1],g=h.clone(h.ONE),n=h.MAX_LOOPS;!h.approximates(a,g)&&n--;)h.isLessThan(a,g)?(f[0]+=f[1],f[2]+=f[3]):(f[1]+=f[0],f[3]+=f[2]),c[0]=f[0]+f[1],c[1]=f[2]+f[3],h.pow(g,c,b);d&&(a[0]=-a[0],1===b%2&&h.neg(c,c));return c};h.dot=function(c,a){return c[0]*a[0]+c[1]*a[1]};h.str=function(c){return 1===c[1]?c[0].toString():c[0]+"/"+c[1]};h.toDecimal=function(c){return c[0]/c[1]};h.dec=h.toDecimal;h.toInteger=function(c){return Math.round(h.toDecimal(c))};h.round=
h.toInteger;h.floor=function(c){return Math.floor(h.toDecimal(c))};h.ceil=function(c){return Math.ceil(h.toDecimal(c))};h.fromInteger_copy=function(c,a){c[0]=parseInt(a);c[1]=1;return c};h.fromInteger=function(c){return h.fromInteger_copy(h.create(),c)};h.fromIntegerInverse_copy=function(c,a){c[0]=1;c[1]=parseInt(a);0>c[1]&&(c[0]=-c[0],c[1]=-c[1]);return c};h.fromIntegerInverse=function(c){return h.fromIntegerInverse_copy(h.create(),c)};h.fromDecimal=function(c){return h.fromDecimal_copy(h.create(),
c)};h.fromDecimal_copy=function(c,a){a=parseFloat(a);if(isNaN(a))return h.copy(c,h.INFINULL);if(Infinity===a)return h.copy(c,h.INFINITY);if(Math.abs(a)<h.EPSILON)return h.copy(c,h.ZERO);if(Math.abs(a-1)<h.EPSILON)return h.copy(c,h.ONE);if(Math.abs(a%1)<h.EPSILON)return h.fromInteger_copy(c,a);if(Math.abs(1/a%1)<h.EPSILON)return h.fromIntegerInverse_copy(c,Math.round(1/a));h.copy(c,h.ONE);for(var b=[1,0,0,1],d=a,f=1,g=h.MAX_LOOPS;g--&&Math.abs(a-h.toDecimal(c))>h.EPSILON;)f=Math.floor(d),c[0]=f*b[0]+
b[2],c[1]=f*b[1]+b[3],d=1/(d-f),b[2]=b[0],b[3]=b[1],b[0]=c[0],b[1]=c[1];return c};h.fromRandom=function(c){c[0]=0xfffffffffffff*Math.random()<<0;c[1]=Math.abs(0xfffffffffffff*Math.random()<<0);return h.normalize(c,c)};h.sin=function(c,a){if(0===a[1])return h.copy(c,h.ZERO);h.scalar_multiply(c,a,2);var b=h.create();h.pow(b,a,2);h.add(b,b,h.ONE);h.divide(c,c,b);return c};h.cos=function(c,a){if(0===a[1])return h.neg(c,h.ONE);var b=h.create();h.pow(b,a,2);h.sub(c,h.ONE,b);var d=h.create();h.add(d,h.ONE,
b);h.divide(c,c,d);return c};h.tan=function(c,a){h.scalar_multiply(c,a,2);var b=h.create();h.pow(b,a,2);h.scalar_multiply(b,b,2);h.add(c,c,b);h.pow(b,a,4);h.sub(b,h.ONE,b);h.divide(c,c,b);return c};h.toEgyptian=function(c){c=h.clone(c);h.abs(c,c);var a=h.floor(c);a&&h.sub(c,c,h.fromInteger(a));if(!c[0])return a.toString();a||(a="");for(var b=1,d=h.create();1!==c[0];)b++,d=h.fromValues(1,b),h.isGreaterThan(c,d)&&(a&&(a+=" + "),a+=h.str(d),h.sub(c,c,d));return c?a?a+" + "+h.str(c):h.str(c):a?a:"0"};
h.toBabylonian=function(c){var a="",b=h.toDecimal(c);c=parseInt(b);for(var b=b-c,d=0,f=0;0<c;)(d=c%60)&&(a=d+" * 60^"+f+(a?" + ":"")+a),c=(c-d)/60,f++;for(f=-1;0<b;)b*=60,d=parseInt(b+1E-13),b-=d,-1E-13>b||(d&&(a+=(a?" + ":"")+d+" * 60^"+f),f--);return a?a:"0"};h.traceSternBrocot=function(c){var a="";if(h.equals(c,h.ZERO)||h.equals(c,h.ONE)||h.equals(c,h.INFINITY)||h.equals(c,h.INFINULL))return a;if(h.equals(c,h.ZERO))return h.copy(out,h.ZERO);if(h.equals(c,h.ONE))return h.copy(out,h.ONE);if(h.equals(c,
h.INFINITY))return h.copy(out,h.INFINITY);if(h.equals(c,h.INFINULL))return h.copy(out,h.INFINULL);c=h.clone(c);h.isNegative(c)&&(c[0]=-c[0]);for(var b=h.clone(h.ONE),d=[1,0,0,1],f=0,g=0,n=h.MAX_LOOPS;!h.approximates(c,b)&&n--;)h.isLessThan(c,b)?(d[0]+=d[1],d[2]+=d[3],g++,f&&(a+="R",1!==f&&(a+=f),f=0,a+=" ")):(d[1]+=d[0],d[3]+=d[2],f++,g&&(a+="L",1!==g&&(a+=g),g=0,a+=" ")),b[0]=d[0]+d[1],b[1]=d[2]+d[3];g?(a+="L",1!==g&&(a+=g)):f&&(a+="R",1!==f&&(a+=f));0>n&&(a+="...");return a};h.toContinuedFraction=
function(c,a){a="undefined"===typeof a?65536:parseInt(a);if(h.equals(c,h.ZERO))return[0];if(h.equals(c,h.ONE))return[1];if(h.equals(c,h.NEGONE))return[-1];if(h.equals(c,h.INFINITY))return[1,0];if(h.equals(c,h.INFINULL))return[0,0];var b=h.clone(c),d=h.isNegative(b);d&&(b[0]=-b[0]);for(var f=h.clone(h.ONE),g=[1,0,0,1],n=1,k=[0],q=k.length-1;!h.equals(b,f)&&a--;)h.isLessThan(b,f)?(-1===n?k[q]++:(n=-1,k.push(1),q++),g[0]+=g[1],g[2]+=g[3]):(1===n?k[q]++:(n=1,k.push(1),q++),g[1]+=g[0],g[3]+=g[2]),f[0]=
g[0]+g[1],f[1]=g[2]+g[3];0>a?k.push(0):k[q]++;if(d)for(var l in k)k[l]=-k[l];return k};h.fromContinuedFraction=function(c,a){h.fromInteger_copy(c,a[a.length-1]);for(var b=a.length-2;-1<b;b--)h.invert(c,c),h.add(c,h.fromInteger(a[b]),c);return c};h.dump=function(c){h.create();return"rat\t"+h.str(c)+"\n~\t"+h.toDecimal(c)+"\nCF:\t["+h.toContinuedFraction(c)+"]\n"};h.ZERO=h.fromInteger(0);h.ONE=h.fromInteger(1);h.NEGONE=h.fromInteger(-1);h.INFINITY=h.fromValues(1,0);h.INFINULL=h.fromValues(0,0);h.INFINITESIMAL=
h.clone([1,g]);h.PI=h.fromValues(1320192667429,420230377710);"undefined"!==typeof a&&(a.rat=h);if(!l)var l=new BigInteger("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF");if(!t)var t=1073741824;var n={EPSILON:2E-16};n.MAX_LOOPS=t;n.create=function(){var c=[];c[0]=BigInteger.ZERO;c[1]=BigInteger.ONE;return c};n.clone=function(c){var a=[];a[0]=c[0];a[1]=c[1];return a};n.fromValues=function(c,a){var b=[];b[0]=new BigInteger(c);b[1]=new BigInteger(a);return n.normalize(b,b)};n.copy=function(c,a){c[0]=a[0];c[1]=
a[1];return c};n.set=function(c,a,b){c[0]=a;c[1]=b;return n.normalize(c,c)};n.toRat=function(c,a){return h.set(c,a[0].toJSValue(),a[1].toJSValue())};n.fromRat=function(c,a){return n.set(c,BigInteger(a[0]),BigInteger(a[1]))};n.abs=function(c,a){c[0]=a[0].abs();c[1]=a[1];return c};n.invert=function(c,a){var b=a[0];c[0]=a[1];c[1]=b;return c};n.reciprocal=n.invert;n.add=function(c,a,b){0===a[1].compare(b[1])?(c[0]=a[0].add(b[0]),c[1]=a[1]):(c[0]=a[0].multiply(b[1]).add(b[0].multiply(a[1])),c[1]=a[1].multiply(b[1]));
return n.normalize(c,c)};n.subtract=function(c,a,b){0===a[1].compare(b[1])?(c[0]=a[0].subtract(b[0]),c[1]=a[1]):(c[0]=a[0].multiply(b[1]).subtract(b[0].multiply(a[1])),c[1]=a[1].multiply(b[1]));return n.normalize(c,c)};n.sub=n.subtract;n.multiply=function(c,a,b){c[0]=a[0].multiply(b[0]);c[1]=a[1].multiply(b[1]);return n.normalize(c,c)};n.mul=n.multiply;n.mediant=function(c,a,b){c[0]=a[0].add(b[0]);c[1]=a[1].add(b[1]);return n.normalize(c,c)};n.divide=function(c,a,b){c[0]=a[0].multiply(b[1]);c[1]=
a[1].multiply(b[0]);return n.normalize(c,c)};n.div=n.divide;n.equals=function(c,a){return c[0].isZero()&&a[0].isZero()||c[1].isZero()&&a[1].isZero()?!0:0===c[0].compare(a[0])&&0===c[1].compare(a[1])};n.approximates=function(c,a){if(n.equals(c,a))return!0;var b=n.create();n.sub(b,c,a);n.abs(b,b);return n.isLessThan(b,n.INFINITESIMAL)};n.isGreaterThan=function(c,a){return n.equals(c,a)?!1:0<c[0].multiply(a[1]).compare(a[0].multiply(c[1]))};n.isLessThan=function(c,a){return n.equals(c,a)?!1:0>c[0].multiply(a[1]).compare(a[0].multiply(c[1]))};
n.isNegative=function(c){return c[0].isNegative()};n.min=function(c,a,b){n.isLessThan(a,b)?(c[0]=a[0],c[1]=a[1]):(c[0]=b[0],c[1]=b[1]);return c};n.max=function(c,a,b){n.isGreaterThan(a,b)?(c[0]=a[0],c[1]=a[1]):(c[0]=b[0],c[1]=b[1]);return c};n.scalar_multiply=function(c,a,b){c[0]=a[0].multiply(b);c[1]=a[1];return n.normalize(c,c)};n.scalar_divide=function(a,b,d){a[0]=b[0];a[1]=b[1].multiply(d);return n.normalize(a,a)};n.normalize=function(a,b){if(b[0].isZero()||b[1].isZero())return b;if(0===b[0].compare(b[1]))return n.clone(n.ONE);
if(b[1].isNegative())a[0]=b[0].negate(),a[1]=b[1].negate();else if(a[0]=b[0],a[1]=b[1],a[1].isZero())return a;var f=d.greatest_common_divisor(a[0].abs(),a[1]);0<f.compare(BigInteger.ONE)&&(a[0]=a[0].quotient(f),a[1]=a[1].quotient(f));return a};n.opposite=function(a,b){a[0]=b[0].negate();a[1]=b[1];return a};n.negative=n.opposite;n.neg=n.opposite;n.power=function(a,b,d){2===d?(a[0]=b[0].square(),a[1]=b[1].square()):0<d?(a[0]=b[0].pow(d),a[1]=b[1].pow(d)):0>d?(d=Math.abs(d),a[0]=b[1].pow(d),a[1]=b[0].pow(d)):
n.copy(a,n.ONE);return a};n.pow=n.power;n.sqrt=function(a,b){return n.nthRoot(a,b,2)};n.nthRoot=function(a,b,d){if(n.equals(b,n.ZERO))return n.copy(a,n.ZERO);if(n.equals(b,n.ONE))return n.copy(a,n.ONE);if(n.equals(b,n.INFINITY))return n.copy(a,n.INFINITY);if(n.equals(b,n.INFINULL))return n.copy(a,n.INFINULL);var f=n.isNegative(b);f&&(b[0]=b[0].negate());n.copy(a,n.ONE);for(var g=[BigInteger(1),BigInteger(0),BigInteger(0),BigInteger(1)],h=n.clone(n.ONE),k=t;!n.approximates(b,h)&&k--;)n.isLessThan(b,
h)?(g[0]=g[0].add(g[1]),g[2]=g[2].add(g[3])):(g[1]=g[1].add(g[0]),g[3]=g[3].add(g[2])),a[0]=g[0].add(g[1]),a[1]=g[2].add(g[3]),n.pow(h,a,d);f&&(b[0]=b[0].negate(),1===d%2&&n.neg(a,a));return a};n.dot=function(a,b){return a[0].multiply(b[0]).add(a[1].multiply(b[1]))};n.str=function(a){return 0===a[1].compare(BigInteger.ONE)?a[0].toString():a[0].toString()+"/"+a[1].toString()};n.toDecimal=function(a){return a[0].toJSValue()/a[1].toJSValue()};n.dec=n.toDecimal;n.toInteger=function(a){return a[0].quotient(a[1]).toJSValue()};
n.round=n.toInteger;n.toBigInteger=function(a){return a[0].quotient(a[1])};n.floor=function(a){return Math.floor(n.toDecimal(a))};n.ceil=function(a){return Math.ceil(n.toDecimal(a))};n.fromInteger_copy=function(a,b){a[0]=BigInteger(b);a[1]=BigInteger.ONE;return a};n.fromInteger=function(a){return n.fromInteger_copy(n.create(),a)};n.fromIntegerInverse_copy=function(a,b){a[0]=BigInteger.ONE;a[1]=BigInteger(b);a[1].isNegative()&&(a[0]=a[0].negate(),a[1]=a[1].negate());return a};n.fromIntegerInverse=
function(a){return n.fromIntegerInverse_copy(n.create(),a)};n.fromDecimal=function(a){return n.fromDecimal_copy(n.create(),a)};n.fromDecimal_copy=function(a,b){b=parseFloat(b);if(isNaN(b))return n.copy(a,n.INFINULL);if(Infinity===b)return n.copy(a,n.INFINITY);if(Math.abs(b)<n.EPSILON)return n.copy(a,n.ZERO);if(Math.abs(b-1)<n.EPSILON)return n.copy(a,n.ONE);if(Math.abs(b%1)<n.EPSILON)return n.fromInteger_copy(a,b);if(Math.abs(1/b%1)<n.EPSILON)return n.fromIntegerInverse_copy(a,Math.round(1/b));n.copy(a,
n.ONE);for(var d=[BigInteger(1),BigInteger(0),BigInteger(0),BigInteger(1)],f=b,g=1,h=n.MAX_LOOPS;h--&&Math.abs(b-n.toDecimal(a))>n.EPSILON;)g=Math.floor(f),a[0]=BigInteger(g*d[0]+d[2]),a[1]=BigInteger(g*d[1]+d[3]),f=1/(f-g),d[2]=d[0],d[3]=d[1],d[0]=a[0],d[1]=a[1];return a};n.fromRandom=function(a){a[0]=BigInteger(0xfffffffffffff*Math.random()<<0);a[1]=BigInteger(Math.abs(0xfffffffffffff*Math.random()<<0));return n.normalize(a,a)};n.sin=function(a,b){if(b[1].isZero())return n.copy(a,n.ZERO);n.scalar_multiply(a,
b,2);var d=n.create();n.pow(d,b,2);n.add(d,d,n.ONE);n.divide(a,a,d);return a};n.cos=function(a,b){if(b[1].isZero())return n.neg(a,n.ONE);var d=n.create();n.pow(d,b,2);n.sub(a,n.ONE,d);var f=n.create();n.add(f,n.ONE,d);n.divide(a,a,f);return a};n.tan=function(a,b){n.scalar_multiply(a,b,2);var d=n.create();n.pow(d,b,2);n.scalar_multiply(d,d,2);n.add(a,a,d);n.pow(d,b,4);n.sub(d,n.ONE,d);n.divide(a,a,d);return a};n.toEgyptian=function(a){a=n.clone(a);n.abs(a,a);var b=n.floor(a);b&&n.sub(a,a,n.fromInteger(b));
if(!a[0])return b.toString();b||(b="");for(var d=1,f=n.create();1!==a[0];)d++,f=n.fromValues(1,d),n.isGreaterThan(a,f)&&(b&&(b+=" + "),b+=n.str(f),n.sub(a,a,f));return a?b?b+" + "+n.str(a):n.str(a):b?b:"0"};n.toBabylonian=function(a){var b="",d=n.toDecimal(a);a=parseInt(d);for(var d=d-a,f=0,g=0;0<a;)(f=a%60)&&(b=f+" * 60^"+g+(b?" + ":"")+b),a=(a-f)/60,g++;for(g=-1;0<d;)d*=60,f=parseInt(d+1E-13),d-=f,-1E-13>d||(f&&(b+=(b?" + ":"")+f+" * 60^"+g),g--);return b?b:"0"};n.traceSternBrocot=function(a){var b=
"";if(n.equals(a,n.ZERO)||n.equals(a,n.ONE)||n.equals(a,n.INFINITY)||n.equals(a,n.INFINULL))return b;a=n.clone(a);n.isNegative(a)&&(a[0]=a[0].negate());for(var d=n.clone(n.ONE),f=[BigInteger(1),BigInteger(0),BigInteger(0),BigInteger(1)],g=0,h=0,k=65536;!n.equals(a,d)&&k--;)n.isLessThan(a,d)?(f[0]=f[0].add(f[1]),f[2]=f[2].add(f[3]),h++,g&&(b+="R",1!==g&&(b+=g),g=0,b+=" ")):(f[1]=f[1].add(f[0]),f[3]=f[3].add(f[2]),g++,h&&(b+="L",1!==h&&(b+=h),h=0,b+=" ")),d[0]=f[0].add(f[1]),d[1]=f[2].add(f[3]);h?(b+=
"L",1!==h&&(b+=h)):g&&(b+="R",1!==g&&(b+=g));0>k&&(b+="...");return b};n.toContinuedFraction=function(a,b){b="undefined"===typeof b?65536:parseInt(b);if(n.equals(a,n.ZERO))return[0];if(n.equals(a,n.ONE))return[1];if(n.equals(a,n.NEGONE))return[-1];if(n.equals(a,n.INFINITY))return[1,0];if(n.equals(a,n.INFINULL))return[0,0];var d=n.clone(a),f=n.isNegative(d);f&&(d[0]=d[0].negate());for(var g=n.clone(n.ONE),h=[BigInteger(1),BigInteger(0),BigInteger(0),BigInteger(1)],k=1,q=[0],l=q.length-1;!n.equals(d,
g)&&b--;)n.isLessThan(d,g)?(-1===k?q[l]++:(k=-1,q.push(1),l++),h[0]=h[0].add(h[1]),h[2]=h[2].add(h[3])):(1===k?q[l]++:(k=1,q.push(1),l++),h[1]=h[1].add(h[0]),h[3]=h[3].add(h[2])),g[0]=h[0].add(h[1]),g[1]=h[2].add(h[3]);0>b?q.push(0):q[l]++;if(f)for(var u in q)q[u]=-q[u];return q};n.fromContinuedFraction=function(a,b){n.fromInteger_copy(a,b[b.length-1]);for(var d=b.length-2;-1<d;d--)n.invert(a,a),n.add(a,n.fromInteger(b[d]),a);return a};n.fromFactorial=function(a,b){if("undefined"!==typeof factorial.PREPARED[b])return n.fromInteger_copy(a,
factorial.PREPARED[b]);var d=factorial.PREPARED.length-1;for(n.fromInteger_copy(a,factorial.PREPARED[d]);d<b;)n.scalar_multiply(a,a,++d);return a};n.dump=function(a){return"bigrat\t"+n.str(a)+"\n~\t"+n.toDecimal(a)+"\nCF:\t["+n.toContinuedFraction(a)+"]\n"};n.ZERO=n.fromInteger(0);n.ONE=n.fromInteger(1);n.NEGONE=n.fromInteger(-1);n.INFINITY=n.fromValues(1,0);n.INFINULL=n.fromValues(0,0);n.INFINITESIMAL=n.clone([new BigInteger(1),l]);n.PI=n.fromValues("3141592653589793238462643383279502884197169399375105820974944592307816406286208998628034825342117067982148086513282306647093844609550582231725359408128481117450284102701938521105559644622948954930381964428810975665933446128475648233786783165271201909145648566923460348610454326648213393607260249141273724587",
"1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000");"undefined"!==typeof a&&(a.bigrat=n);var u=function(a,b){this.a=h.fromValues(parseInt(a),parseInt(b))};u.prototype.toString=function(){return h.str(this.a)};u.prototype.toContinuedFraction=function(a){return h.toContinuedFraction(this.a,
a)};u.prototype.invert=function(){return h.invert(this.a)};u.prototype.reciprocal=u.prototype.invert;u.prototype.add=function(a){var b=h.create();h.add(b,this.a,a.a);return new u(b[0],b[1])};u.prototype.plus=u.prototype.add;u.prototype.subtract=function(a){var b=h.create();h.sub(b,this.a,a.a);return new u(b[0],b[1])};u.prototype.sub=u.prototype.subtract;u.prototype.minus=u.prototype.subtract;u.prototype.multiply=function(a){var b=h.create();h.mul(b,this.a,a.a);return new u(b[0],b[1])};u.prototype.mul=
u.prototype.multiply;u.prototype.times=u.prototype.multiply;u.prototype.mediant=function(a){var b=h.create();h.mediant(b,this.a,a.a);return new u(b[0],b[1])};u.prototype.divide=function(a){var b=h.create();h.div(b,this.a,a.a);return new u(b[0],b[1])};u.prototype.div=u.prototype.divide;u.prototype.divided_by=u.prototype.divide;u.prototype.power=function(a){var b=h.create();h.pow(b,this.a,a);return new u(b[0],b[1])};u.prototype.pow=u.prototype.power;u.prototype.dump=function(){return h.dump(this.a)};
u.prototype.toRat=function(){return h.clone(this.a)};u.prototype.toDecimal=function(){return h.toDecimal(this.a)};u.fromRat=function(a){var b=new u;b.a[0]=a[0];b.a[1]=a[1];return b};u.fromInteger=function(a){return u.fromRat(h.fromInteger(a))};u.fromIntegerInverse=function(a){return u.fromRat(h.fromIntegerInverse(a))};u.fromDecimal=function(a){return u.fromRat(h.fromDecimal(a))};u.fromContinuedFraction=function(a){return u.fromRat(h.fromContinuedFraction(h.create(),a))};"undefined"!==typeof a&&(a.rational=
u)})(l)})(this);(function(k,l){"object"===typeof module&&"object"===typeof module.exports?module.exports=k.document?l(k,!0):function(a){if(!a.document)throw Error("jQuery requires a window with a document");return l(a)}:l(k)})("undefined"!==typeof window?window:this,function(k,l){function a(a){var b=a.length,c=p.type(a);return"function"===c||p.isWindow(a)?!1:1===a.nodeType&&b?!0:"array"===c||0===b||"number"===typeof b&&0<b&&b-1 in a}function b(a,b,c){if(p.isFunction(b))return p.grep(a,function(a,N){return!!b.call(a,
N,a)!==c});if(b.nodeType)return p.grep(a,function(a){return a===b!==c});if("string"===typeof b){if(Ab.test(b))return p.filter(b,a,c);b=p.filter(b,a)}return p.grep(a,function(a){return 0<=za.call(b,a)!==c})}function d(a,b){for(;(a=a[b])&&1!==a.nodeType;);return a}function f(a){var b=kb[a]={};p.each(a.match(ia)||[],function(a,N){b[N]=!0});return b}function g(){U.removeEventListener("DOMContentLoaded",g,!1);k.removeEventListener("load",g,!1);p.ready()}function q(){Object.defineProperty(this.cache={},
0,{get:function(){return{}}});this.expando=p.expando+Math.random()}function h(a,b,c){if(void 0===c&&1===a.nodeType)if(c="data-"+b.replace(Pa,"-$1").toLowerCase(),c=a.getAttribute(c),"string"===typeof c){try{c="true"===c?!0:"false"===c?!1:"null"===c?null:+c+""===c?+c:Bb.test(c)?p.parseJSON(c):c}catch(d){}Z.set(a,b,c)}else c=void 0;return c}function v(){return!0}function t(){return!1}function n(){try{return U.activeElement}catch(a){}}function u(a,b){return p.nodeName(a,"table")&&p.nodeName(11!==b.nodeType?
b:b.firstChild,"tr")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function c(a){a.type=(null!==a.getAttribute("type"))+"/"+a.type;return a}function r(a){var b=ab.exec(a.type);b?a.type=b[1]:a.removeAttribute("type");return a}function y(a,b){for(var c=0,d=a.length;c<d;c++)O.set(a[c],"globalEval",!b||O.get(b[c],"globalEval"))}function z(a,b){var c,d,f,m;if(1===b.nodeType){if(O.hasData(a)&&(m=O.access(a),c=O.set(b,m),m=m.events))for(f in delete c.handle,
c.events={},m)for(c=0,d=m[f].length;c<d;c++)p.event.add(b,f,m[f][c]);Z.hasData(a)&&(f=Z.access(a),f=p.extend({},f),Z.set(b,f))}}function F(a,b){var c=a.getElementsByTagName?a.getElementsByTagName(b||"*"):a.querySelectorAll?a.querySelectorAll(b||"*"):[];return void 0===b||b&&p.nodeName(a,b)?p.merge([a],c):c}function H(a,b){var c,d=p(b.createElement(a)).appendTo(b.body),f=k.getDefaultComputedStyle&&(c=k.getDefaultComputedStyle(d[0]))?c.display:p.css(d[0],"display");d.detach();return f}function K(a){var b=
U,c=Qa[a];c||(c=H(a,b),"none"!==c&&c||(Ra=(Ra||p("<iframe frameborder='0' width='0' height='0'/>")).appendTo(b.documentElement),b=Ra[0].contentDocument,b.write(),b.close(),c=H(a,b),Ra.detach()),Qa[a]=c);return c}function D(a,b,c){var d,f,m=a.style;(c=c||Sa(a))&&(f=c.getPropertyValue(b)||c[b]);c&&(""!==f||p.contains(a.ownerDocument,a)||(f=p.style(a,b)),oa.test(f)&&Ga.test(b)&&(a=m.width,b=m.minWidth,d=m.maxWidth,m.minWidth=m.maxWidth=m.width=f,f=c.width,m.width=a,m.minWidth=b,m.maxWidth=d));return void 0!==
f?f+"":f}function J(a,b){return{get:function(){if(a())delete this.get;else return(this.get=b).apply(this,arguments)}}}function M(a,b){if(b in a)return b;for(var c=b[0].toUpperCase()+b.slice(1),d=b,f=pa.length;f--;)if(b=pa[f]+c,b in a)return b;return d}function C(a,b,c){return(a=ja.exec(b))?Math.max(0,a[1]-(c||0))+(a[2]||"px"):b}function L(a,b,c,d,f){b=c===(d?"border":"content")?4:"width"===b?1:0;for(var m=0;4>b;b+=2)"margin"===c&&(m+=p.css(a,c+Ca[b],!0,f)),d?("content"===c&&(m-=p.css(a,"padding"+
Ca[b],!0,f)),"margin"!==c&&(m-=p.css(a,"border"+Ca[b]+"Width",!0,f))):(m+=p.css(a,"padding"+Ca[b],!0,f),"padding"!==c&&(m+=p.css(a,"border"+Ca[b]+"Width",!0,f)));return m}function I(a,b,c){var d=!0,f="width"===b?a.offsetWidth:a.offsetHeight,m=Sa(a),g="border-box"===p.css(a,"boxSizing",!1,m);if(0>=f||null==f){f=D(a,b,m);if(0>f||null==f)f=a.style[b];if(oa.test(f))return f;d=g&&(ca.boxSizingReliable()||f===a.style[b]);f=parseFloat(f)||0}return f+L(a,b,c||(g?"border":"content"),d,m)+"px"}function S(a,
b){for(var c,d,f,m=[],g=0,h=a.length;g<h;g++)d=a[g],d.style&&(m[g]=O.get(d,"olddisplay"),c=d.style.display,b?(m[g]||"none"!==c||(d.style.display=""),""===d.style.display&&Ea(d)&&(m[g]=O.access(d,"olddisplay",K(d.nodeName)))):(f=Ea(d),"none"===c&&f||O.set(d,"olddisplay",f?c:p.css(d,"display"))));for(g=0;g<h;g++)d=a[g],!d.style||b&&"none"!==d.style.display&&""!==d.style.display||(d.style.display=b?m[g]||"":"none");return a}function m(a,b,c,d,f){return new m.prototype.init(a,b,c,d,f)}function A(){setTimeout(function(){Fa=
void 0});return Fa=p.now()}function B(a,b){var c,d=0,f={height:a};for(b=b?1:0;4>d;d+=2-b)c=Ca[d],f["margin"+c]=f["padding"+c]=a;b&&(f.opacity=f.width=a);return f}function E(a,b,c){for(var d,f=(Q[b]||[]).concat(Q["*"]),m=0,g=f.length;m<g;m++)if(d=f[m].call(c,b,a))return d}function T(a,b){var c,d,f,m,g;for(c in a)if(d=p.camelCase(c),f=b[d],m=a[c],p.isArray(m)&&(f=m[1],m=a[c]=m[0]),c!==d&&(a[d]=m,delete a[c]),(g=p.cssHooks[d])&&"expand"in g)for(c in m=g.expand(m),delete a[d],m)c in a||(a[c]=m[c],b[c]=
f);else b[d]=f}function V(a,b,c){var d,f=0,m=W.length,g=p.Deferred().always(function(){delete h.elem}),h=function(){if(d)return!1;for(var b=Fa||A(),b=Math.max(0,n.startTime+n.duration-b),w=1-(b/n.duration||0),c=0,f=n.tweens.length;c<f;c++)n.tweens[c].run(w);g.notifyWith(a,[n,w,b]);if(1>w&&f)return b;g.resolveWith(a,[n]);return!1},n=g.promise({elem:a,props:p.extend({},b),opts:p.extend(!0,{specialEasing:{}},c),originalProperties:b,originalOptions:c,startTime:Fa||A(),duration:c.duration,tweens:[],createTween:function(b,
w){var c=p.Tween(a,n.opts,b,w,n.opts.specialEasing[b]||n.opts.easing);n.tweens.push(c);return c},stop:function(b){var w=0,c=b?n.tweens.length:0;if(d)return this;for(d=!0;w<c;w++)n.tweens[w].run(1);b?g.resolveWith(a,[n,b]):g.rejectWith(a,[n,b]);return this}});c=n.props;for(T(c,n.opts.specialEasing);f<m;f++)if(b=W[f].call(n,a,c,n.opts))return b;p.map(c,E,n);p.isFunction(n.opts.start)&&n.opts.start.call(a,n);p.fx.timer(p.extend(h,{elem:a,anim:n,queue:n.opts.queue}));return n.progress(n.opts.progress).done(n.opts.done,
n.opts.complete).fail(n.opts.fail).always(n.opts.always)}function Y(a){return function(b,c){"string"!==typeof b&&(c=b,b="*");var d,f=0,m=b.toLowerCase().match(ia)||[];if(p.isFunction(c))for(;d=m[f++];)"+"===d[0]?(d=d.slice(1)||"*",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c)}}function la(a,b,c,d){function f(h){var n;m[h]=!0;p.each(a[h]||[],function(a,w){var N=w(b,c,d);if("string"===typeof N&&!g&&!m[N])return b.dataTypes.unshift(N),f(N),!1;if(g)return!(n=N)});return n}var m={},g=a===bb;return f(b.dataTypes[0])||
!m["*"]&&f("*")}function aa(a,b){var c,d,f=p.ajaxSettings.flatOptions||{};for(c in b)void 0!==b[c]&&((f[c]?a:d||(d={}))[c]=b[c]);d&&p.extend(!0,a,d);return a}function R(a,b,c,d){var f;if(p.isArray(b))p.each(b,function(b,f){c||La.test(a)?d(a,f):R(a+"["+("object"===typeof f?b:"")+"]",f,c,d)});else if(c||"object"!==p.type(b))d(a,b);else for(f in b)R(a+"["+f+"]",b[f],c,d)}function ma(a){return p.isWindow(a)?a:9===a.nodeType&&a.defaultView}var ga=[],ea=ga.slice,va=ga.concat,wa=ga.push,za=ga.indexOf,xa=
{},Ma=xa.toString,ra=xa.hasOwnProperty,ca={},U=k.document,p=function(a,b){return new p.fn.init(a,b)},Aa=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,lb=/^-ms-/,mb=/-([\da-z])/gi,cb=function(a,b){return b.toUpperCase()};p.fn=p.prototype={jquery:"2.1.1",constructor:p,selector:"",length:0,toArray:function(){return ea.call(this)},get:function(a){return null!=a?0>a?this[a+this.length]:this[a]:ea.call(this)},pushStack:function(a){a=p.merge(this.constructor(),a);a.prevObject=this;a.context=this.context;return a},
each:function(a,b){return p.each(this,a,b)},map:function(a){return this.pushStack(p.map(this,function(b,c){return a.call(b,c,b)}))},slice:function(){return this.pushStack(ea.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var b=this.length;a=+a+(0>a?b:0);return this.pushStack(0<=a&&a<b?[this[a]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:wa,sort:ga.sort,splice:ga.splice};p.extend=p.fn.extend=function(){var a,
b,c,d,f,m=arguments[0]||{},g=1,h=arguments.length,n=!1;"boolean"===typeof m&&(n=m,m=arguments[g]||{},g++);"object"===typeof m||p.isFunction(m)||(m={});g===h&&(m=this,g--);for(;g<h;g++)if(null!=(a=arguments[g]))for(b in a)c=m[b],d=a[b],m!==d&&(n&&d&&(p.isPlainObject(d)||(f=p.isArray(d)))?(f?(f=!1,c=c&&p.isArray(c)?c:[]):c=c&&p.isPlainObject(c)?c:{},m[b]=p.extend(n,c,d)):void 0!==d&&(m[b]=d));return m};p.extend({expando:"jQuery"+("2.1.1"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(a){throw Error(a);
},noop:function(){},isFunction:function(a){return"function"===p.type(a)},isArray:Array.isArray,isWindow:function(a){return null!=a&&a===a.window},isNumeric:function(a){return!p.isArray(a)&&0<=a-parseFloat(a)},isPlainObject:function(a){return"object"!==p.type(a)||a.nodeType||p.isWindow(a)||a.constructor&&!ra.call(a.constructor.prototype,"isPrototypeOf")?!1:!0},isEmptyObject:function(a){for(var b in a)return!1;return!0},type:function(a){return null==a?a+"":"object"===typeof a||"function"===typeof a?
xa[Ma.call(a)]||"object":typeof a},globalEval:function(a){var b;b=eval;if(a=p.trim(a))1===a.indexOf("use strict")?(b=U.createElement("script"),b.text=a,U.head.appendChild(b).parentNode.removeChild(b)):b(a)},camelCase:function(a){return a.replace(lb,"ms-").replace(mb,cb)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()},each:function(b,c,d){var f,m=0,g=b.length;f=a(b);if(d)if(f)for(;m<g&&(f=c.apply(b[m],d),!1!==f);m++);else for(m in b){if(f=c.apply(b[m],d),!1===
f)break}else if(f)for(;m<g&&(f=c.call(b[m],m,b[m]),!1!==f);m++);else for(m in b)if(f=c.call(b[m],m,b[m]),!1===f)break;return b},trim:function(a){return null==a?"":(a+"").replace(Aa,"")},makeArray:function(b,c){var d=c||[];null!=b&&(a(Object(b))?p.merge(d,"string"===typeof b?[b]:b):wa.call(d,b));return d},inArray:function(a,b,c){return null==b?-1:za.call(b,a,c)},merge:function(a,b){for(var c=+b.length,d=0,f=a.length;d<c;d++)a[f++]=b[d];a.length=f;return a},grep:function(a,b,c){for(var d=[],f=0,m=a.length,
g=!c;f<m;f++)c=!b(a[f],f),c!==g&&d.push(a[f]);return d},map:function(b,c,d){var f,m=0,g=b.length,h=[];if(a(b))for(;m<g;m++)f=c(b[m],m,d),null!=f&&h.push(f);else for(m in b)f=c(b[m],m,d),null!=f&&h.push(f);return va.apply([],h)},guid:1,proxy:function(a,b){var c,d;"string"===typeof b&&(c=a[b],b=a,a=c);if(p.isFunction(a))return d=ea.call(arguments,2),c=function(){return a.apply(b||this,d.concat(ea.call(arguments)))},c.guid=a.guid=a.guid||p.guid++,c},now:Date.now,support:ca});p.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),
function(a,b){xa["[object "+b+"]"]=b.toLowerCase()});var Ha=function(a){function b(a,c,d,f){var m,g,x,h,N;(c?c.ownerDocument||c:aa)!==I&&z(c);c=c||I;d=d||[];if(!a||"string"!==typeof a)return d;if(1!==(h=c.nodeType)&&9!==h)return[];if(F&&!f){if(m=qa.exec(a))if(x=m[1])if(9===h)if((g=c.getElementById(x))&&g.parentNode){if(g.id===x)return d.push(g),d}else return d;else{if(c.ownerDocument&&(g=c.ownerDocument.getElementById(x))&&M(c,g)&&g.id===x)return d.push(g),d}else{if(m[2])return Aa.apply(d,c.getElementsByTagName(a)),
d;if((x=m[3])&&E.getElementsByClassName&&c.getElementsByClassName)return Aa.apply(d,c.getElementsByClassName(x)),d}if(E.qsa&&(!K||!K.test(a))){g=m=R;x=c;N=9===h&&a;if(1===h&&"object"!==c.nodeName.toLowerCase()){h=T(a);(m=c.getAttribute("id"))?g=m.replace(ua,"\\$&"):c.setAttribute("id",g);g="[id='"+g+"'] ";for(x=h.length;x--;)h[x]=g+P(h[x]);x=oa.test(a)&&w(c.parentNode)||c;N=h.join(",")}if(N)try{return Aa.apply(d,x.querySelectorAll(N)),d}catch(n){}finally{m||c.removeAttribute("id")}}}return Y(a.replace(ba,
"$1"),c,d,f)}function c(){function a(c,w){b.push(c+" ")>t.cacheLength&&delete a[b.shift()];return a[c+" "]=w}var b=[];return a}function d(a){a[R]=!0;return a}function f(a){var b=I.createElement("div");try{return!!a(b)}catch(c){return!1}finally{b.parentNode&&b.parentNode.removeChild(b)}}function m(a,b){for(var c=a.split("|"),w=a.length;w--;)t.attrHandle[c[w]]=b}function g(a,b){var c=b&&a,w=c&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||-2147483648)-(~a.sourceIndex||-2147483648);if(w)return w;
if(c)for(;c=c.nextSibling;)if(c===b)return-1;return a?1:-1}function h(a){return function(b){return"input"===b.nodeName.toLowerCase()&&b.type===a}}function n(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}}function k(a){return d(function(b){b=+b;return d(function(c,w){for(var d,f=a([],c.length,b),m=f.length;m--;)c[d=f[m]]&&(c[d]=!(w[d]=c[d]))})})}function w(a){return a&&"undefined"!==typeof a.getElementsByTagName&&a}function x(){}function P(a){for(var b=
0,c=a.length,w="";b<c;b++)w+=a[b].value;return w}function q(a,b,c){var w=b.dir,d=c&&"parentNode"===w,f=ma++;return b.first?function(b,c,f){for(;b=b[w];)if(1===b.nodeType||d)return a(b,c,f)}:function(b,c,m){var g,x,h=[J,f];if(m)for(;b=b[w];){if((1===b.nodeType||d)&&a(b,c,m))return!0}else for(;b=b[w];)if(1===b.nodeType||d){x=b[R]||(b[R]={});if((g=x[w])&&g[0]===J&&g[1]===f)return h[2]=g[2];x[w]=h;if(h[2]=a(b,c,m))return!0}}}function l(a){return 1<a.length?function(b,c,w){for(var d=a.length;d--;)if(!a[d](b,
c,w))return!1;return!0}:a[0]}function A(a,b,c,w,d){for(var f,m=[],g=0,x=a.length,h=null!=b;g<x;g++)if(f=a[g])if(!c||c(f,w,d))m.push(f),h&&b.push(g);return m}function p(a,c,w,f,m,g){f&&!f[R]&&(f=p(f));m&&!m[R]&&(m=p(m,g));return d(function(d,g,x,h){var N,n,k=[],P=[],q=g.length,sa;if(!(sa=d)){sa=c||"*";for(var l=x.nodeType?[x]:x,p=[],r=0,u=l.length;r<u;r++)b(sa,l[r],p);sa=p}sa=!a||!d&&c?sa:A(sa,k,a,x,h);l=w?m||(d?a:q||f)?[]:g:sa;w&&w(sa,l,x,h);if(f)for(N=A(l,P),f(N,[],x,h),x=N.length;x--;)if(n=N[x])l[P[x]]=
!(sa[P[x]]=n);if(d){if(m||a){if(m){N=[];for(x=l.length;x--;)(n=l[x])&&N.push(sa[x]=n);m(null,l=[],N,h)}for(x=l.length;x--;)(n=l[x])&&-1<(N=m?ra.call(d,n):k[x])&&(d[N]=!(g[N]=n))}}else l=A(l===g?l.splice(q,l.length):l),m?m(null,g,l,h):Aa.apply(g,l)})}function r(a){var b,c,w,d=a.length,f=t.relative[a[0].type];c=f||t.relative[" "];for(var m=f?1:0,g=q(function(a){return a===b},c,!0),x=q(function(a){return-1<ra.call(b,a)},c,!0),h=[function(a,c,w){return!f&&(w||c!==V)||((b=c).nodeType?g(a,c,w):x(a,c,w))}];m<
d;m++)if(c=t.relative[a[m].type])h=[q(l(h),c)];else{c=t.filter[a[m].type].apply(null,a[m].matches);if(c[R]){for(w=++m;w<d&&!t.relative[a[w].type];w++);return p(1<m&&l(h),1<m&&P(a.slice(0,m-1).concat({value:" "===a[m-2].type?"*":""})).replace(ba,"$1"),c,m<w&&r(a.slice(m,w)),w<d&&r(a=a.slice(w)),w<d&&P(a))}h.push(c)}return l(h)}function B(a,c){var w=0<c.length,f=0<a.length,m=function(d,m,g,x,h){var N,n,k,P=0,q="0",sa=d&&[],l=[],p=V,r=d||f&&t.find.TAG("*",h),u=J+=null==p?1:Math.random()||.1,B=r.length;
for(h&&(V=m!==I&&m);q!==B&&null!=(N=r[q]);q++){if(f&&N){for(n=0;k=a[n++];)if(k(N,m,g)){x.push(N);break}h&&(J=u)}w&&((N=!k&&N)&&P--,d&&sa.push(N))}P+=q;if(w&&q!==P){for(n=0;k=c[n++];)k(sa,l,m,g);if(d){if(0<P)for(;q--;)sa[q]||l[q]||(l[q]=ca.call(x));l=A(l)}Aa.apply(x,l);h&&!d&&0<l.length&&1<P+c.length&&b.uniqueSort(x)}h&&(J=u,V=p);return sa};return w?d(m):m}var u,E,t,v,y,T,L,Y,V,C,H,z,I,D,F,K,S,la,M,R="sizzle"+-new Date,aa=a.document,J=0,ma=0,G=c(),ga=c(),ea=c(),U=function(a,b){a===b&&(H=!0);return 0},
Q={}.hasOwnProperty,O=[],ca=O.pop,wa=O.push,Aa=O.push,W=O.slice,ra=O.indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(this[b]===a)return b;return-1},X="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+".replace("w","w#"),va="\\[[\\x20\\t\\r\\n\\f]*((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)(?:[\\x20\\t\\r\\n\\f]*([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+X+"))|)[\\x20\\t\\r\\n\\f]*\\]",Z=":((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+
va+")*)|.*)\\)|)",ba=/^[\x20\t\r\n\f]+|((?:^|[^\\])(?:\\.)*)[\x20\t\r\n\f]+$/g,za=/^[\x20\t\r\n\f]*,[\x20\t\r\n\f]*/,da=/^[\x20\t\r\n\f]*([>+~]|[\x20\t\r\n\f])[\x20\t\r\n\f]*/,fa=/=[\x20\t\r\n\f]*([^\]'"]*?)[\x20\t\r\n\f]*\]/g,ka=new RegExp(Z),Ma=new RegExp("^"+X+"$"),xa={ID:/^#((?:\\.|[\w-]|[^\x00-\xa0])+)/,CLASS:/^\.((?:\\.|[\w-]|[^\x00-\xa0])+)/,TAG:new RegExp("^("+"(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+".replace("w","w*")+")"),ATTR:new RegExp("^"+va),PSEUDO:new RegExp("^"+Z),CHILD:/^:(only|first|last|nth|nth-last)-(child|of-type)(?:\([\x20\t\r\n\f]*(even|odd|(([+-]|)(\d*)n|)[\x20\t\r\n\f]*(?:([+-]|)[\x20\t\r\n\f]*(\d+)|))[\x20\t\r\n\f]*\)|)/i,
bool:/^(?:checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)$/i,needsContext:/^[\x20\t\r\n\f]*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\([\x20\t\r\n\f]*((?:-\d)?\d*)[\x20\t\r\n\f]*\)|)(?=[^-]|$)/i},na=/^(?:input|select|textarea|button)$/i,pa=/^h\d$/i,ja=/^[^{]+\{\s*\[native \w/,qa=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,oa=/[+~]/,ua=/'|\\/g,ha=/\\([\da-f]{1,6}[\x20\t\r\n\f]?|([\x20\t\r\n\f])|.)/ig,ia=function(a,b,c){a="0x"+b-65536;
return a!==a||c?b:0>a?String.fromCharCode(a+65536):String.fromCharCode(a>>10|55296,a&1023|56320)};try{Aa.apply(O=W.call(aa.childNodes),aa.childNodes),O[aa.childNodes.length].nodeType}catch(lb){Aa={apply:O.length?function(a,b){wa.apply(a,W.call(b))}:function(a,b){for(var c=a.length,w=0;a[c++]=b[w++];);a.length=c-1}}}E=b.support={};y=b.isXML=function(a){return(a=a&&(a.ownerDocument||a).documentElement)?"HTML"!==a.nodeName:!1};z=b.setDocument=function(a){var b=a?a.ownerDocument||a:aa;a=b.defaultView;
if(b===I||9!==b.nodeType||!b.documentElement)return I;I=b;D=b.documentElement;F=!y(b);a&&a!==a.top&&(a.addEventListener?a.addEventListener("unload",function(){z()},!1):a.attachEvent&&a.attachEvent("onunload",function(){z()}));E.attributes=f(function(a){a.className="i";return!a.getAttribute("className")});E.getElementsByTagName=f(function(a){a.appendChild(b.createComment(""));return!a.getElementsByTagName("*").length});E.getElementsByClassName=ja.test(b.getElementsByClassName)&&f(function(a){a.innerHTML=
"<div class='a'></div><div class='a i'></div>";a.firstChild.className="i";return 2===a.getElementsByClassName("i").length});E.getById=f(function(a){D.appendChild(a).id=R;return!b.getElementsByName||!b.getElementsByName(R).length});E.getById?(t.find.ID=function(a,b){if("undefined"!==typeof b.getElementById&&F){var c=b.getElementById(a);return c&&c.parentNode?[c]:[]}},t.filter.ID=function(a){var b=a.replace(ha,ia);return function(a){return a.getAttribute("id")===b}}):(delete t.find.ID,t.filter.ID=function(a){var b=
a.replace(ha,ia);return function(a){return(a="undefined"!==typeof a.getAttributeNode&&a.getAttributeNode("id"))&&a.value===b}});t.find.TAG=E.getElementsByTagName?function(a,b){if("undefined"!==typeof b.getElementsByTagName)return b.getElementsByTagName(a)}:function(a,b){var c,w=[],d=0,f=b.getElementsByTagName(a);if("*"===a){for(;c=f[d++];)1===c.nodeType&&w.push(c);return w}return f};t.find.CLASS=E.getElementsByClassName&&function(a,b){if("undefined"!==typeof b.getElementsByClassName&&F)return b.getElementsByClassName(a)};
S=[];K=[];if(E.qsa=ja.test(b.querySelectorAll))f(function(a){a.innerHTML="<select msallowclip=''><option selected=''></option></select>";a.querySelectorAll("[msallowclip^='']").length&&K.push("[*^$]=[\\x20\\t\\r\\n\\f]*(?:''|\"\")");a.querySelectorAll("[selected]").length||K.push("\\[[\\x20\\t\\r\\n\\f]*(?:value|checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)");a.querySelectorAll(":checked").length||K.push(":checked")}),f(function(a){var c=
b.createElement("input");c.setAttribute("type","hidden");a.appendChild(c).setAttribute("name","D");a.querySelectorAll("[name=d]").length&&K.push("name[\\x20\\t\\r\\n\\f]*[*^$|!~]?=");a.querySelectorAll(":enabled").length||K.push(":enabled",":disabled");a.querySelectorAll("*,:x");K.push(",.*:")});(E.matchesSelector=ja.test(la=D.matches||D.webkitMatchesSelector||D.mozMatchesSelector||D.oMatchesSelector||D.msMatchesSelector))&&f(function(a){E.disconnectedMatch=la.call(a,"div");la.call(a,"[s!='']:x");
S.push("!=",Z)});K=K.length&&new RegExp(K.join("|"));S=S.length&&new RegExp(S.join("|"));M=(a=ja.test(D.compareDocumentPosition))||ja.test(D.contains)?function(a,b){var c=9===a.nodeType?a.documentElement:a,w=b&&b.parentNode;return a===w||!!(w&&1===w.nodeType&&(c.contains?c.contains(w):a.compareDocumentPosition&&a.compareDocumentPosition(w)&16))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1};U=a?function(a,c){if(a===c)return H=!0,0;var w=!a.compareDocumentPosition-!c.compareDocumentPosition;
if(w)return w;w=(a.ownerDocument||a)===(c.ownerDocument||c)?a.compareDocumentPosition(c):1;return w&1||!E.sortDetached&&c.compareDocumentPosition(a)===w?a===b||a.ownerDocument===aa&&M(aa,a)?-1:c===b||c.ownerDocument===aa&&M(aa,c)?1:C?ra.call(C,a)-ra.call(C,c):0:w&4?-1:1}:function(a,c){if(a===c)return H=!0,0;var w,d=0;w=a.parentNode;var f=c.parentNode,m=[a],x=[c];if(!w||!f)return a===b?-1:c===b?1:w?-1:f?1:C?ra.call(C,a)-ra.call(C,c):0;if(w===f)return g(a,c);for(w=a;w=w.parentNode;)m.unshift(w);for(w=
c;w=w.parentNode;)x.unshift(w);for(;m[d]===x[d];)d++;return d?g(m[d],x[d]):m[d]===aa?-1:x[d]===aa?1:0};return b};b.matches=function(a,c){return b(a,null,null,c)};b.matchesSelector=function(a,c){(a.ownerDocument||a)!==I&&z(a);c=c.replace(fa,"='$1']");if(!(!E.matchesSelector||!F||S&&S.test(c)||K&&K.test(c)))try{var w=la.call(a,c);if(w||E.disconnectedMatch||a.document&&11!==a.document.nodeType)return w}catch(d){}return 0<b(c,I,null,[a]).length};b.contains=function(a,b){(a.ownerDocument||a)!==I&&z(a);
return M(a,b)};b.attr=function(a,b){(a.ownerDocument||a)!==I&&z(a);var c=t.attrHandle[b.toLowerCase()],c=c&&Q.call(t.attrHandle,b.toLowerCase())?c(a,b,!F):void 0;return void 0!==c?c:E.attributes||!F?a.getAttribute(b):(c=a.getAttributeNode(b))&&c.specified?c.value:null};b.error=function(a){throw Error("Syntax error, unrecognized expression: "+a);};b.uniqueSort=function(a){var b,c=[],w=0,d=0;H=!E.detectDuplicates;C=!E.sortStable&&a.slice(0);a.sort(U);if(H){for(;b=a[d++];)b===a[d]&&(w=c.push(d));for(;w--;)a.splice(c[w],
1)}C=null;return a};v=b.getText=function(a){var b,c="",w=0;b=a.nodeType;if(!b)for(;b=a[w++];)c+=v(b);else if(1===b||9===b||11===b){if("string"===typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=v(a)}else if(3===b||4===b)return a.nodeValue;return c};t=b.selectors={cacheLength:50,createPseudo:d,match:xa,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){a[1]=
a[1].replace(ha,ia);a[3]=(a[3]||a[4]||a[5]||"").replace(ha,ia);"~="===a[2]&&(a[3]=" "+a[3]+" ");return a.slice(0,4)},CHILD:function(a){a[1]=a[1].toLowerCase();"nth"===a[1].slice(0,3)?(a[3]||b.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&b.error(a[0]);return a},PSEUDO:function(a){var b,c=!a[6]&&a[2];if(xa.CHILD.test(a[0]))return null;a[3]?a[2]=a[4]||a[5]||"":c&&ka.test(c)&&(b=T(c,!0))&&(b=c.indexOf(")",c.length-b)-c.length)&&(a[0]=a[0].slice(0,
b),a[2]=c.slice(0,b));return a.slice(0,3)}},filter:{TAG:function(a){var b=a.replace(ha,ia).toLowerCase();return"*"===a?function(){return!0}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b}},CLASS:function(a){var b=G[a+" "];return b||(b=new RegExp("(^|[\\x20\\t\\r\\n\\f])"+a+"([\\x20\\t\\r\\n\\f]|$)"))&&G(a,function(a){return b.test("string"===typeof a.className&&a.className||"undefined"!==typeof a.getAttribute&&a.getAttribute("class")||"")})},ATTR:function(a,c,w){return function(d){d=
b.attr(d,a);if(null==d)return"!="===c;if(!c)return!0;d+="";return"="===c?d===w:"!="===c?d!==w:"^="===c?w&&0===d.indexOf(w):"*="===c?w&&-1<d.indexOf(w):"$="===c?w&&d.slice(-w.length)===w:"~="===c?-1<(" "+d+" ").indexOf(w):"|="===c?d===w||d.slice(0,w.length+1)===w+"-":!1}},CHILD:function(a,b,c,w,d){var f="nth"!==a.slice(0,3),m="last"!==a.slice(-4),g="of-type"===b;return 1===w&&0===d?function(a){return!!a.parentNode}:function(b,c,x){var h,N,n,k,P;c=f!==m?"nextSibling":"previousSibling";var q=b.parentNode,
l=g&&b.nodeName.toLowerCase();x=!x&&!g;if(q){if(f){for(;c;){for(N=b;N=N[c];)if(g?N.nodeName.toLowerCase()===l:1===N.nodeType)return!1;P=c="only"===a&&!P&&"nextSibling"}return!0}P=[m?q.firstChild:q.lastChild];if(m&&x)for(x=q[R]||(q[R]={}),h=x[a]||[],k=h[0]===J&&h[1],n=h[0]===J&&h[2],N=k&&q.childNodes[k];N=++k&&N&&N[c]||(n=k=0)||P.pop();){if(1===N.nodeType&&++n&&N===b){x[a]=[J,k,n];break}}else if(x&&(h=(b[R]||(b[R]={}))[a])&&h[0]===J)n=h[1];else for(;(N=++k&&N&&N[c]||(n=k=0)||P.pop())&&((g?N.nodeName.toLowerCase()!==
l:1!==N.nodeType)||!++n||(x&&((N[R]||(N[R]={}))[a]=[J,n]),N!==b)););n-=d;return n===w||0===n%w&&0<=n/w}}},PSEUDO:function(a,c){var w,f=t.pseudos[a]||t.setFilters[a.toLowerCase()]||b.error("unsupported pseudo: "+a);return f[R]?f(c):1<f.length?(w=[a,a,"",c],t.setFilters.hasOwnProperty(a.toLowerCase())?d(function(a,b){for(var w,d=f(a,c),m=d.length;m--;)w=ra.call(a,d[m]),a[w]=!(b[w]=d[m])}):function(a){return f(a,0,w)}):f}},pseudos:{not:d(function(a){var b=[],c=[],w=L(a.replace(ba,"$1"));return w[R]?
d(function(a,b,c,d){d=w(a,null,d,[]);for(var f=a.length;f--;)if(c=d[f])a[f]=!(b[f]=c)}):function(a,d,f){b[0]=a;w(b,null,f,c);return!c.pop()}}),has:d(function(a){return function(c){return 0<b(a,c).length}}),contains:d(function(a){return function(b){return-1<(b.textContent||b.innerText||v(b)).indexOf(a)}}),lang:d(function(a){Ma.test(a||"")||b.error("unsupported lang: "+a);a=a.replace(ha,ia).toLowerCase();return function(b){var c;do if(c=F?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang"))return c=
c.toLowerCase(),c===a||0===c.indexOf(a+"-");while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(b){var c=a.location&&a.location.hash;return c&&c.slice(1)===b.id},root:function(a){return a===D},focus:function(a){return a===I.activeElement&&(!I.hasFocus||I.hasFocus())&&!!(a.type||a.href||~a.tabIndex)},enabled:function(a){return!1===a.disabled},disabled:function(a){return!0===a.disabled},checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&
!!a.selected},selected:function(a){a.parentNode&&a.parentNode.selectedIndex;return!0===a.selected},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if(6>a.nodeType)return!1;return!0},parent:function(a){return!t.pseudos.empty(a)},header:function(a){return pa.test(a.nodeName)},input:function(a){return na.test(a.nodeName)},button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},text:function(a){var b;return"input"===a.nodeName.toLowerCase()&&"text"===
a.type&&(null==(b=a.getAttribute("type"))||"text"===b.toLowerCase())},first:k(function(){return[0]}),last:k(function(a,b){return[b-1]}),eq:k(function(a,b,c){return[0>c?c+b:c]}),even:k(function(a,b){for(var c=0;c<b;c+=2)a.push(c);return a}),odd:k(function(a,b){for(var c=1;c<b;c+=2)a.push(c);return a}),lt:k(function(a,b,c){for(b=0>c?c+b:c;0<=--b;)a.push(b);return a}),gt:k(function(a,b,c){for(c=0>c?c+b:c;++c<b;)a.push(c);return a})}};t.pseudos.nth=t.pseudos.eq;for(u in{radio:!0,checkbox:!0,file:!0,password:!0,
image:!0})t.pseudos[u]=h(u);for(u in{submit:!0,reset:!0})t.pseudos[u]=n(u);x.prototype=t.filters=t.pseudos;t.setFilters=new x;T=b.tokenize=function(a,c){var w,d,f,m,g,x,h;if(g=ga[a+" "])return c?0:g.slice(0);g=a;x=[];for(h=t.preFilter;g;){if(!w||(d=za.exec(g)))d&&(g=g.slice(d[0].length)||g),x.push(f=[]);w=!1;if(d=da.exec(g))w=d.shift(),f.push({value:w,type:d[0].replace(ba," ")}),g=g.slice(w.length);for(m in t.filter)!(d=xa[m].exec(g))||h[m]&&!(d=h[m](d))||(w=d.shift(),f.push({value:w,type:m,matches:d}),
g=g.slice(w.length));if(!w)break}return c?g.length:g?b.error(a):ga(a,x).slice(0)};L=b.compile=function(a,b){var c,w=[],d=[],f=ea[a+" "];if(!f){b||(b=T(a));for(c=b.length;c--;)f=r(b[c]),f[R]?w.push(f):d.push(f);f=ea(a,B(d,w));f.selector=a}return f};Y=b.select=function(a,b,c,d){var f,m,g,x,h="function"===typeof a&&a,N=!d&&T(a=h.selector||a);c=c||[];if(1===N.length){m=N[0]=N[0].slice(0);if(2<m.length&&"ID"===(g=m[0]).type&&E.getById&&9===b.nodeType&&F&&t.relative[m[1].type]){b=(t.find.ID(g.matches[0].replace(ha,
ia),b)||[])[0];if(!b)return c;h&&(b=b.parentNode);a=a.slice(m.shift().value.length)}for(f=xa.needsContext.test(a)?0:m.length;f--;){g=m[f];if(t.relative[x=g.type])break;if(x=t.find[x])if(d=x(g.matches[0].replace(ha,ia),oa.test(m[0].type)&&w(b.parentNode)||b)){m.splice(f,1);a=d.length&&P(m);if(!a)return Aa.apply(c,d),c;break}}}(h||L(a,N))(d,b,!F,c,oa.test(a)&&w(b.parentNode)||b);return c};E.sortStable=R.split("").sort(U).join("")===R;E.detectDuplicates=!!H;z();E.sortDetached=f(function(a){return a.compareDocumentPosition(I.createElement("div"))&
1});f(function(a){a.innerHTML="<a href='#'></a>";return"#"===a.firstChild.getAttribute("href")})||m("type|href|height|width",function(a,b,c){if(!c)return a.getAttribute(b,"type"===b.toLowerCase()?1:2)});E.attributes&&f(function(a){a.innerHTML="<input/>";a.firstChild.setAttribute("value","");return""===a.firstChild.getAttribute("value")})||m("value",function(a,b,c){if(!c&&"input"===a.nodeName.toLowerCase())return a.defaultValue});f(function(a){return null==a.getAttribute("disabled")})||m("checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",
function(a,b,c){var w;if(!c)return!0===a[b]?b.toLowerCase():(w=a.getAttributeNode(b))&&w.specified?w.value:null});return b}(k);p.find=Ha;p.expr=Ha.selectors;p.expr[":"]=p.expr.pseudos;p.unique=Ha.uniqueSort;p.text=Ha.getText;p.isXMLDoc=Ha.isXML;p.contains=Ha.contains;var nb=p.expr.match.needsContext,ob=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,Ab=/^.[^:#\[\.,]*$/;p.filter=function(a,b,c){var d=b[0];c&&(a=":not("+a+")");return 1===b.length&&1===d.nodeType?p.find.matchesSelector(d,a)?[d]:[]:p.find.matches(a,p.grep(b,
function(a){return 1===a.nodeType}))};p.fn.extend({find:function(a){var b,c=this.length,d=[],f=this;if("string"!==typeof a)return this.pushStack(p(a).filter(function(){for(b=0;b<c;b++)if(p.contains(f[b],this))return!0}));for(b=0;b<c;b++)p.find(a,f[b],d);d=this.pushStack(1<c?p.unique(d):d);d.selector=this.selector?this.selector+" "+a:a;return d},filter:function(a){return this.pushStack(b(this,a||[],!1))},not:function(a){return this.pushStack(b(this,a||[],!0))},is:function(a){return!!b(this,"string"===
typeof a&&nb.test(a)?p(a):a||[],!1).length}});var Ta,Eb=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/;(p.fn.init=function(a,b){var c;if(!a)return this;if("string"===typeof a){c="<"===a[0]&&">"===a[a.length-1]&&3<=a.length?[null,a,null]:Eb.exec(a);if(!c||!c[1]&&b)return!b||b.jquery?(b||Ta).find(a):this.constructor(b).find(a);if(c[1]){if(b=b instanceof p?b[0]:b,p.merge(this,p.parseHTML(c[1],b&&b.nodeType?b.ownerDocument||b:U,!0)),ob.test(c[1])&&p.isPlainObject(b))for(c in b)if(p.isFunction(this[c]))this[c](b[c]);
else this.attr(c,b[c])}else(c=U.getElementById(c[2]))&&c.parentNode&&(this.length=1,this[0]=c),this.context=U,this.selector=a;return this}if(a.nodeType)return this.context=this[0]=a,this.length=1,this;if(p.isFunction(a))return"undefined"!==typeof Ta.ready?Ta.ready(a):a(p);void 0!==a.selector&&(this.selector=a.selector,this.context=a.context);return p.makeArray(a,this)}).prototype=p.fn;Ta=p(U);var Ua=/^(?:parents|prev(?:Until|All))/,db={children:!0,contents:!0,next:!0,prev:!0};p.extend({dir:function(a,
b,c){for(var d=[],f=void 0!==c;(a=a[b])&&9!==a.nodeType;)if(1===a.nodeType){if(f&&p(a).is(c))break;d.push(a)}return d},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c}});p.fn.extend({has:function(a){var b=p(a,this),c=b.length;return this.filter(function(){for(var a=0;a<c;a++)if(p.contains(this,b[a]))return!0})},closest:function(a,b){for(var c,d=0,f=this.length,m=[],g=nb.test(a)||"string"!==typeof a?p(a,b||this.context):0;d<f;d++)for(c=this[d];c&&c!==
b;c=c.parentNode)if(11>c.nodeType&&(g?-1<g.index(c):1===c.nodeType&&p.find.matchesSelector(c,a))){m.push(c);break}return this.pushStack(1<m.length?p.unique(m):m)},index:function(a){return a?"string"===typeof a?za.call(p(a),this[0]):za.call(this,a.jquery?a[0]:a):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(a,b){return this.pushStack(p.unique(p.merge(this.get(),p(a,b))))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}});p.each({parent:function(a){return(a=
a.parentNode)&&11!==a.nodeType?a:null},parents:function(a){return p.dir(a,"parentNode")},parentsUntil:function(a,b,c){return p.dir(a,"parentNode",c)},next:function(a){return d(a,"nextSibling")},prev:function(a){return d(a,"previousSibling")},nextAll:function(a){return p.dir(a,"nextSibling")},prevAll:function(a){return p.dir(a,"previousSibling")},nextUntil:function(a,b,c){return p.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return p.dir(a,"previousSibling",c)},siblings:function(a){return p.sibling((a.parentNode||
{}).firstChild,a)},children:function(a){return p.sibling(a.firstChild)},contents:function(a){return a.contentDocument||p.merge([],a.childNodes)}},function(a,b){p.fn[a]=function(c,d){var f=p.map(this,b,c);"Until"!==a.slice(-5)&&(d=c);d&&"string"===typeof d&&(f=p.filter(d,f));1<this.length&&(db[a]||p.unique(f),Ua.test(a)&&f.reverse());return this.pushStack(f)}});var ia=/\S+/g,kb={};p.Callbacks=function(a){a="string"===typeof a?kb[a]||f(a):p.extend({},a);var b,c,d,m,g,h,n=[],k=!a.once&&[],q=function(f){b=
a.memory&&f;c=!0;h=m||0;m=0;g=n.length;for(d=!0;n&&h<g;h++)if(!1===n[h].apply(f[0],f[1])&&a.stopOnFalse){b=!1;break}d=!1;n&&(k?k.length&&q(k.shift()):b?n=[]:w.disable())},w={add:function(){if(n){var c=n.length;(function sa(b){p.each(b,function(b,c){var d=p.type(c);"function"===d?a.unique&&w.has(c)||n.push(c):c&&c.length&&"string"!==d&&sa(c)})})(arguments);d?g=n.length:b&&(m=c,q(b))}return this},remove:function(){n&&p.each(arguments,function(a,b){for(var c;-1<(c=p.inArray(b,n,c));)n.splice(c,1),d&&
(c<=g&&g--,c<=h&&h--)});return this},has:function(a){return a?-1<p.inArray(a,n):!(!n||!n.length)},empty:function(){n=[];g=0;return this},disable:function(){n=k=b=void 0;return this},disabled:function(){return!n},lock:function(){k=void 0;b||w.disable();return this},locked:function(){return!k},fireWith:function(a,b){!n||c&&!k||(b=b||[],b=[a,b.slice?b.slice():b],d?k.push(b):q(b));return this},fire:function(){w.fireWith(this,arguments);return this},fired:function(){return!!c}};return w};p.extend({Deferred:function(a){var b=
[["resolve","done",p.Callbacks("once memory"),"resolved"],["reject","fail",p.Callbacks("once memory"),"rejected"],["notify","progress",p.Callbacks("memory")]],c="pending",d={state:function(){return c},always:function(){f.done(arguments).fail(arguments);return this},then:function(){var a=arguments;return p.Deferred(function(c){p.each(b,function(b,m){var g=p.isFunction(a[b])&&a[b];f[m[1]](function(){var a=g&&g.apply(this,arguments);if(a&&p.isFunction(a.promise))a.promise().done(c.resolve).fail(c.reject).progress(c.notify);
else c[m[0]+"With"](this===d?c.promise():this,g?[a]:arguments)})});a=null}).promise()},promise:function(a){return null!=a?p.extend(a,d):d}},f={};d.pipe=d.then;p.each(b,function(a,m){var g=m[2],h=m[3];d[m[1]]=g.add;h&&g.add(function(){c=h},b[a^1][2].disable,b[2][2].lock);f[m[0]]=function(){f[m[0]+"With"](this===f?d:this,arguments);return this};f[m[0]+"With"]=g.fireWith});d.promise(f);a&&a.call(f,f);return f},when:function(a){var b=0,c=ea.call(arguments),d=c.length,f=1!==d||a&&p.isFunction(a.promise)?
d:0,m=1===f?a:p.Deferred(),g=function(a,b,c){return function(d){b[a]=this;c[a]=1<arguments.length?ea.call(arguments):d;c===h?m.notifyWith(b,c):--f||m.resolveWith(b,c)}},h,n,k;if(1<d)for(h=Array(d),n=Array(d),k=Array(d);b<d;b++)c[b]&&p.isFunction(c[b].promise)?c[b].promise().done(g(b,k,c)).fail(m.reject).progress(g(b,n,h)):--f;f||m.resolveWith(k,c);return m.promise()}});var Va;p.fn.ready=function(a){p.ready.promise().done(a);return this};p.extend({isReady:!1,readyWait:1,holdReady:function(a){a?p.readyWait++:
p.ready(!0)},ready:function(a){(!0===a?--p.readyWait:p.isReady)||(p.isReady=!0,!0!==a&&0<--p.readyWait||(Va.resolveWith(U,[p]),p.fn.triggerHandler&&(p(U).triggerHandler("ready"),p(U).off("ready"))))}});p.ready.promise=function(a){Va||(Va=p.Deferred(),"complete"===U.readyState?setTimeout(p.ready):(U.addEventListener("DOMContentLoaded",g,!1),k.addEventListener("load",g,!1)));return Va.promise(a)};p.ready.promise();var Ba=p.access=function(a,b,c,d,f,m,g){var h=0,n=a.length,k=null==c;if("object"===p.type(c))for(h in f=
!0,c)p.access(a,b,h,c[h],!0,m,g);else if(void 0!==d&&(f=!0,p.isFunction(d)||(g=!0),k&&(g?(b.call(a,d),b=null):(k=b,b=function(a,b,c){return k.call(p(a),c)})),b))for(;h<n;h++)b(a[h],c,g?d:d.call(a[h],h,b(a[h],c)));return f?a:k?b.call(a):n?b(a[0],c):m};p.acceptData=function(a){return 1===a.nodeType||9===a.nodeType||!+a.nodeType};q.uid=1;q.accepts=p.acceptData;q.prototype={key:function(a){if(!q.accepts(a))return 0;var b={},c=a[this.expando];if(!c){c=q.uid++;try{b[this.expando]={value:c},Object.defineProperties(a,
b)}catch(d){b[this.expando]=c,p.extend(a,b)}}this.cache[c]||(this.cache[c]={});return c},set:function(a,b,c){var d;a=this.key(a);var f=this.cache[a];if("string"===typeof b)f[b]=c;else if(p.isEmptyObject(f))p.extend(this.cache[a],b);else for(d in b)f[d]=b[d];return f},get:function(a,b){var c=this.cache[this.key(a)];return void 0===b?c:c[b]},access:function(a,b,c){if(void 0===b||b&&"string"===typeof b&&void 0===c)return c=this.get(a,b),void 0!==c?c:this.get(a,p.camelCase(b));this.set(a,b,c);return void 0!==
c?c:b},remove:function(a,b){var c,d;c=this.key(a);var f=this.cache[c];if(void 0===b)this.cache[c]={};else for(p.isArray(b)?d=b.concat(b.map(p.camelCase)):(c=p.camelCase(b),b in f?d=[b,c]:(d=c,d=d in f?[d]:d.match(ia)||[])),c=d.length;c--;)delete f[d[c]]},hasData:function(a){return!p.isEmptyObject(this.cache[a[this.expando]]||{})},discard:function(a){a[this.expando]&&delete this.cache[a[this.expando]]}};var O=new q,Z=new q,Bb=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Pa=/([A-Z])/g;p.extend({hasData:function(a){return Z.hasData(a)||
O.hasData(a)},data:function(a,b,c){return Z.access(a,b,c)},removeData:function(a,b){Z.remove(a,b)},_data:function(a,b,c){return O.access(a,b,c)},_removeData:function(a,b){O.remove(a,b)}});p.fn.extend({data:function(a,b){var c,d,f,m=this[0],g=m&&m.attributes;if(void 0===a){if(this.length&&(f=Z.get(m),1===m.nodeType&&!O.get(m,"hasDataAttrs"))){for(c=g.length;c--;)g[c]&&(d=g[c].name,0===d.indexOf("data-")&&(d=p.camelCase(d.slice(5)),h(m,d,f[d])));O.set(m,"hasDataAttrs",!0)}return f}return"object"===
typeof a?this.each(function(){Z.set(this,a)}):Ba(this,function(b){var c,d=p.camelCase(a);if(m&&void 0===b){c=Z.get(m,a);if(void 0!==c)return c;c=Z.get(m,d);if(void 0!==c)return c;c=h(m,d,void 0);if(void 0!==c)return c}else this.each(function(){var c=Z.get(this,d);Z.set(this,d,b);-1!==a.indexOf("-")&&void 0!==c&&Z.set(this,a,b)})},null,b,1<arguments.length,null,!0)},removeData:function(a){return this.each(function(){Z.remove(this,a)})}});p.extend({queue:function(a,b,c){var d;if(a)return b=(b||"fx")+
"queue",d=O.get(a,b),c&&(!d||p.isArray(c)?d=O.access(a,b,p.makeArray(c)):d.push(c)),d||[]},dequeue:function(a,b){b=b||"fx";var c=p.queue(a,b),d=c.length,f=c.shift(),m=p._queueHooks(a,b),g=function(){p.dequeue(a,b)};"inprogress"===f&&(f=c.shift(),d--);f&&("fx"===b&&c.unshift("inprogress"),delete m.stop,f.call(a,g,m));!d&&m&&m.empty.fire()},_queueHooks:function(a,b){var c=b+"queueHooks";return O.get(a,c)||O.access(a,c,{empty:p.Callbacks("once memory").add(function(){O.remove(a,[b+"queue",c])})})}});
p.fn.extend({queue:function(a,b){var c=2;"string"!==typeof a&&(b=a,a="fx",c--);return arguments.length<c?p.queue(this[0],a):void 0===b?this:this.each(function(){var c=p.queue(this,a,b);p._queueHooks(this,a);"fx"===a&&"inprogress"!==c[0]&&p.dequeue(this,a)})},dequeue:function(a){return this.each(function(){p.dequeue(this,a)})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,b){var c,d=1,f=p.Deferred(),m=this,g=this.length,h=function(){--d||f.resolveWith(m,[m])};"string"!==
typeof a&&(b=a,a=void 0);for(a=a||"fx";g--;)(c=O.get(m[g],a+"queueHooks"))&&c.empty&&(d++,c.empty.add(h));h();return f.promise(b)}});var ua=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Ca=["Top","Right","Bottom","Left"],Ea=function(a,b){a=b||a;return"none"===p.css(a,"display")||!p.contains(a.ownerDocument,a)},pb=/^(?:checkbox|radio)$/i;(function(){var a=U.createDocumentFragment().appendChild(U.createElement("div")),b=U.createElement("input");b.setAttribute("type","radio");b.setAttribute("checked",
"checked");b.setAttribute("name","t");a.appendChild(b);ca.checkClone=a.cloneNode(!0).cloneNode(!0).lastChild.checked;a.innerHTML="<textarea>x</textarea>";ca.noCloneChecked=!!a.cloneNode(!0).lastChild.defaultValue})();ca.focusinBubbles="onfocusin"in k;var Fb=/^key/,Gb=/^(?:mouse|pointer|contextmenu)|click/,qb=/^(?:focusinfocus|focusoutblur)$/,X=/^([^.]*)(?:\.(.+)|)$/;p.event={global:{},add:function(a,b,c,d,f){var m,g,h,n,k,w,x,P,q;if(k=O.get(a))for(c.handler&&(m=c,c=m.handler,f=m.selector),c.guid||
(c.guid=p.guid++),(n=k.events)||(n=k.events={}),(g=k.handle)||(g=k.handle=function(b){return"undefined"!==typeof p&&p.event.triggered!==b.type?p.event.dispatch.apply(a,arguments):void 0}),b=(b||"").match(ia)||[""],k=b.length;k--;)h=X.exec(b[k])||[],P=w=h[1],q=(h[2]||"").split(".").sort(),P&&(h=p.event.special[P]||{},P=(f?h.delegateType:h.bindType)||P,h=p.event.special[P]||{},w=p.extend({type:P,origType:w,data:d,handler:c,guid:c.guid,selector:f,needsContext:f&&p.expr.match.needsContext.test(f),namespace:q.join(".")},
m),(x=n[P])||(x=n[P]=[],x.delegateCount=0,h.setup&&!1!==h.setup.call(a,d,q,g)||a.addEventListener&&a.addEventListener(P,g,!1)),h.add&&(h.add.call(a,w),w.handler.guid||(w.handler.guid=c.guid)),f?x.splice(x.delegateCount++,0,w):x.push(w),p.event.global[P]=!0)},remove:function(a,b,c,d,f){var m,g,h,n,k,w,x,P,q,l,A,r=O.hasData(a)&&O.get(a);if(r&&(n=r.events)){b=(b||"").match(ia)||[""];for(k=b.length;k--;)if(h=X.exec(b[k])||[],q=A=h[1],l=(h[2]||"").split(".").sort(),q){x=p.event.special[q]||{};q=(d?x.delegateType:
x.bindType)||q;P=n[q]||[];h=h[2]&&new RegExp("(^|\\.)"+l.join("\\.(?:.*\\.|)")+"(\\.|$)");for(g=m=P.length;m--;)w=P[m],!f&&A!==w.origType||c&&c.guid!==w.guid||h&&!h.test(w.namespace)||d&&d!==w.selector&&("**"!==d||!w.selector)||(P.splice(m,1),w.selector&&P.delegateCount--,x.remove&&x.remove.call(a,w));g&&!P.length&&(x.teardown&&!1!==x.teardown.call(a,l,r.handle)||p.removeEvent(a,q,r.handle),delete n[q])}else for(q in n)p.event.remove(a,q+b[k],c,d,!0);p.isEmptyObject(n)&&(delete r.handle,O.remove(a,
"events"))}},trigger:function(a,b,c,d){var f,m,g,h,n,q,w=[c||U],x=ra.call(a,"type")?a.type:a;q=ra.call(a,"namespace")?a.namespace.split("."):[];m=f=c=c||U;if(3!==c.nodeType&&8!==c.nodeType&&!qb.test(x+p.event.triggered)&&(0<=x.indexOf(".")&&(q=x.split("."),x=q.shift(),q.sort()),h=0>x.indexOf(":")&&"on"+x,a=a[p.expando]?a:new p.Event(x,"object"===typeof a&&a),a.isTrigger=d?2:3,a.namespace=q.join("."),a.namespace_re=a.namespace?new RegExp("(^|\\.)"+q.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,a.result=void 0,
a.target||(a.target=c),b=null==b?[a]:p.makeArray(b,[a]),q=p.event.special[x]||{},d||!q.trigger||!1!==q.trigger.apply(c,b))){if(!d&&!q.noBubble&&!p.isWindow(c)){g=q.delegateType||x;qb.test(g+x)||(m=m.parentNode);for(;m;m=m.parentNode)w.push(m),f=m;f===(c.ownerDocument||U)&&w.push(f.defaultView||f.parentWindow||k)}for(f=0;(m=w[f++])&&!a.isPropagationStopped();)a.type=1<f?g:q.bindType||x,(n=(O.get(m,"events")||{})[a.type]&&O.get(m,"handle"))&&n.apply(m,b),(n=h&&m[h])&&n.apply&&p.acceptData(m)&&(a.result=
n.apply(m,b),!1===a.result&&a.preventDefault());a.type=x;d||a.isDefaultPrevented()||q._default&&!1!==q._default.apply(w.pop(),b)||!p.acceptData(c)||!h||!p.isFunction(c[x])||p.isWindow(c)||((f=c[h])&&(c[h]=null),p.event.triggered=x,c[x](),p.event.triggered=void 0,f&&(c[h]=f));return a.result}},dispatch:function(a){a=p.event.fix(a);var b,c,d,f,m=[],g=ea.call(arguments);b=(O.get(this,"events")||{})[a.type]||[];var h=p.event.special[a.type]||{};g[0]=a;a.delegateTarget=this;if(!h.preDispatch||!1!==h.preDispatch.call(this,
a)){m=p.event.handlers.call(this,a,b);for(b=0;(f=m[b++])&&!a.isPropagationStopped();)for(a.currentTarget=f.elem,c=0;(d=f.handlers[c++])&&!a.isImmediatePropagationStopped();)if(!a.namespace_re||a.namespace_re.test(d.namespace))a.handleObj=d,a.data=d.data,d=((p.event.special[d.origType]||{}).handle||d.handler).apply(f.elem,g),void 0!==d&&!1===(a.result=d)&&(a.preventDefault(),a.stopPropagation());h.postDispatch&&h.postDispatch.call(this,a);return a.result}},handlers:function(a,b){var c,d,f,m,g=[],h=
b.delegateCount,n=a.target;if(h&&n.nodeType&&(!a.button||"click"!==a.type))for(;n!==this;n=n.parentNode||this)if(!0!==n.disabled||"click"!==a.type){d=[];for(c=0;c<h;c++)m=b[c],f=m.selector+" ",void 0===d[f]&&(d[f]=m.needsContext?0<=p(f,this).index(n):p.find(f,this,null,[n]).length),d[f]&&d.push(m);d.length&&g.push({elem:n,handlers:d})}h<b.length&&g.push({elem:this,handlers:b.slice(h)});return g},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),
fixHooks:{},keyHooks:{props:["char","charCode","key","keyCode"],filter:function(a,b){null==a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode);return a}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,b){var c,d,f=b.button;null==a.pageX&&null!=b.clientX&&(c=a.target.ownerDocument||U,d=c.documentElement,c=c.body,a.pageX=b.clientX+(d&&d.scrollLeft||c&&c.scrollLeft||0)-(d&&d.clientLeft||c&&c.clientLeft||0),a.pageY=
b.clientY+(d&&d.scrollTop||c&&c.scrollTop||0)-(d&&d.clientTop||c&&c.clientTop||0));a.which||void 0===f||(a.which=f&1?1:f&2?3:f&4?2:0);return a}},fix:function(a){if(a[p.expando])return a;var b,c,d;b=a.type;var f=a,m=this.fixHooks[b];m||(this.fixHooks[b]=m=Gb.test(b)?this.mouseHooks:Fb.test(b)?this.keyHooks:{});d=m.props?this.props.concat(m.props):this.props;a=new p.Event(f);for(b=d.length;b--;)c=d[b],a[c]=f[c];a.target||(a.target=U);3===a.target.nodeType&&(a.target=a.target.parentNode);return m.filter?
m.filter(a,f):a},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==n()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===n()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&p.nodeName(this,"input"))return this.click(),!1},_default:function(a){return p.nodeName(a.target,"a")}},beforeunload:{postDispatch:function(a){void 0!==a.result&&a.originalEvent&&(a.originalEvent.returnValue=
a.result)}}},simulate:function(a,b,c,d){a=p.extend(new p.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?p.event.trigger(a,null,b):p.event.dispatch.call(b,a);a.isDefaultPrevented()&&c.preventDefault()}};p.removeEvent=function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)};p.Event=function(a,b){if(!(this instanceof p.Event))return new p.Event(a,b);a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&!1===a.returnValue?
v:t):this.type=a;b&&p.extend(this,b);this.timeStamp=a&&a.timeStamp||p.now();this[p.expando]=!0};p.Event.prototype={isDefaultPrevented:t,isPropagationStopped:t,isImmediatePropagationStopped:t,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=v;a&&a.preventDefault&&a.preventDefault()},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=v;a&&a.stopPropagation&&a.stopPropagation()},stopImmediatePropagation:function(){var a=this.originalEvent;this.isImmediatePropagationStopped=
v;a&&a.stopImmediatePropagation&&a.stopImmediatePropagation();this.stopPropagation()}};p.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(a,b){p.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=a.relatedTarget,f=a.handleObj;if(!d||d!==this&&!p.contains(this,d))a.type=f.origType,c=f.handler.apply(this,arguments),a.type=b;return c}}});ca.focusinBubbles||p.each({focus:"focusin",blur:"focusout"},function(a,b){var c=
function(a){p.event.simulate(b,a.target,p.event.fix(a),!0)};p.event.special[b]={setup:function(){var d=this.ownerDocument||this,f=O.access(d,b);f||d.addEventListener(a,c,!0);O.access(d,b,(f||0)+1)},teardown:function(){var d=this.ownerDocument||this,f=O.access(d,b)-1;f?O.access(d,b,f):(d.removeEventListener(a,c,!0),O.remove(d,b))}}});p.fn.extend({on:function(a,b,c,d,f){var m,g;if("object"===typeof a){"string"!==typeof b&&(c=c||b,b=void 0);for(g in a)this.on(g,b,c,a[g],f);return this}null==c&&null==
d?(d=b,c=b=void 0):null==d&&("string"===typeof b?(d=c,c=void 0):(d=c,c=b,b=void 0));if(!1===d)d=t;else if(!d)return this;1===f&&(m=d,d=function(a){p().off(a);return m.apply(this,arguments)},d.guid=m.guid||(m.guid=p.guid++));return this.each(function(){p.event.add(this,a,d,c,b)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,b,c){var d;if(a&&a.preventDefault&&a.handleObj)return d=a.handleObj,p(a.delegateTarget).off(d.namespace?d.origType+"."+d.namespace:d.origType,d.selector,d.handler),
this;if("object"===typeof a){for(d in a)this.off(d,b,a[d]);return this}if(!1===b||"function"===typeof b)c=b,b=void 0;!1===c&&(c=t);return this.each(function(){p.event.remove(this,a,c,b)})},trigger:function(a,b){return this.each(function(){p.event.trigger(a,b,this)})},triggerHandler:function(a,b){var c=this[0];if(c)return p.event.trigger(a,b,c,!0)}});var rb=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Ia=/<([\w:]+)/,Hb=/<|&#?\w+;/,Ib=/<(?:script|style|link)/i,sb=/checked\s*(?:[^=]|=\s*.checked.)/i,
eb=/^$|\/(?:java|ecma)script/i,ab=/^true\/(.*)/,Jb=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,qa={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};qa.optgroup=qa.option;qa.tbody=qa.tfoot=qa.colgroup=qa.caption=qa.thead;qa.th=qa.td;p.extend({clone:function(a,b,c){var d,f,m,g,h=a.cloneNode(!0),n=p.contains(a.ownerDocument,
a);if(!(ca.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||p.isXMLDoc(a)))for(g=F(h),m=F(a),d=0,f=m.length;d<f;d++){var k=m[d],w=g[d],x=w.nodeName.toLowerCase();if("input"===x&&pb.test(k.type))w.checked=k.checked;else if("input"===x||"textarea"===x)w.defaultValue=k.defaultValue}if(b)if(c)for(m=m||F(a),g=g||F(h),d=0,f=m.length;d<f;d++)z(m[d],g[d]);else z(a,h);g=F(h,"script");0<g.length&&y(g,!n&&F(a,"script"));return h},buildFragment:function(a,b,c,d){for(var f,m,g,h=b.createDocumentFragment(),n=[],
k=0,w=a.length;k<w;k++)if((f=a[k])||0===f)if("object"===p.type(f))p.merge(n,f.nodeType?[f]:f);else if(Hb.test(f)){m=m||h.appendChild(b.createElement("div"));g=(Ia.exec(f)||["",""])[1].toLowerCase();g=qa[g]||qa._default;m.innerHTML=g[1]+f.replace(rb,"<$1></$2>")+g[2];for(g=g[0];g--;)m=m.lastChild;p.merge(n,m.childNodes);m=h.firstChild;m.textContent=""}else n.push(b.createTextNode(f));h.textContent="";for(k=0;f=n[k++];)if(!d||-1===p.inArray(f,d))if(a=p.contains(f.ownerDocument,f),m=F(h.appendChild(f),
"script"),a&&y(m),c)for(g=0;f=m[g++];)eb.test(f.type||"")&&c.push(f);return h},cleanData:function(a){for(var b,c,d,f,m=p.event.special,g=0;void 0!==(c=a[g]);g++){if(p.acceptData(c)&&(f=c[O.expando])&&(b=O.cache[f])){if(b.events)for(d in b.events)m[d]?p.event.remove(c,d):p.removeEvent(c,d,b.handle);O.cache[f]&&delete O.cache[f]}delete Z.cache[c[Z.expando]]}}});p.fn.extend({text:function(a){return Ba(this,function(a){return void 0===a?p.text(this):this.empty().each(function(){if(1===this.nodeType||
11===this.nodeType||9===this.nodeType)this.textContent=a})},null,a,arguments.length)},append:function(){return this.domManip(arguments,function(a){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||u(this,a).appendChild(a)})},prepend:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=u(this,a);b.insertBefore(a,b.firstChild)}})},before:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,
this)})},after:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)})},remove:function(a,b){for(var c,d=a?p.filter(a,this):this,f=0;null!=(c=d[f]);f++)b||1!==c.nodeType||p.cleanData(F(c)),c.parentNode&&(b&&p.contains(c.ownerDocument,c)&&y(F(c,"script")),c.parentNode.removeChild(c));return this},empty:function(){for(var a,b=0;null!=(a=this[b]);b++)1===a.nodeType&&(p.cleanData(F(a,!1)),a.textContent="");return this},clone:function(a,
b){a=null==a?!1:a;b=null==b?a:b;return this.map(function(){return p.clone(this,a,b)})},html:function(a){return Ba(this,function(a){var b=this[0]||{},c=0,d=this.length;if(void 0===a&&1===b.nodeType)return b.innerHTML;if("string"===typeof a&&!Ib.test(a)&&!qa[(Ia.exec(a)||["",""])[1].toLowerCase()]){a=a.replace(rb,"<$1></$2>");try{for(;c<d;c++)b=this[c]||{},1===b.nodeType&&(p.cleanData(F(b,!1)),b.innerHTML=a);b=0}catch(f){}}b&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(){var a=
arguments[0];this.domManip(arguments,function(b){a=this.parentNode;p.cleanData(F(this));a&&a.replaceChild(b,this)});return a&&(a.length||a.nodeType)?this:this.remove()},detach:function(a){return this.remove(a,!0)},domManip:function(a,b){a=va.apply([],a);var d,f,m,g,h=0,n=this.length,k=this,q=n-1,w=a[0],x=p.isFunction(w);if(x||1<n&&"string"===typeof w&&!ca.checkClone&&sb.test(w))return this.each(function(c){var d=k.eq(c);x&&(a[0]=w.call(this,c,d.html()));d.domManip(a,b)});if(n&&(d=p.buildFragment(a,
this[0].ownerDocument,!1,this),f=d.firstChild,1===d.childNodes.length&&(d=f),f)){f=p.map(F(d,"script"),c);for(m=f.length;h<n;h++)g=d,h!==q&&(g=p.clone(g,!0,!0),m&&p.merge(f,F(g,"script"))),b.call(this[h],g,h);if(m)for(d=f[f.length-1].ownerDocument,p.map(f,r),h=0;h<m;h++)g=f[h],eb.test(g.type||"")&&!O.access(g,"globalEval")&&p.contains(d,g)&&(g.src?p._evalUrl&&p._evalUrl(g.src):p.globalEval(g.textContent.replace(Jb,"")))}return this}});p.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",
insertAfter:"after",replaceAll:"replaceWith"},function(a,b){p.fn[a]=function(a){for(var c=[],d=p(a),f=d.length-1,m=0;m<=f;m++)a=m===f?this:this.clone(!0),p(d[m])[b](a),wa.apply(c,a.get());return this.pushStack(c)}});var Ra,Qa={},Ga=/^margin/,oa=new RegExp("^("+ua+")(?!px)[a-z%]+$","i"),Sa=function(a){return a.ownerDocument.defaultView.getComputedStyle(a,null)};(function(){function a(){m.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute";
m.innerHTML="";d.appendChild(f);var g=k.getComputedStyle(m,null);b="1%"!==g.top;c="4px"===g.width;d.removeChild(f)}var b,c,d=U.documentElement,f=U.createElement("div"),m=U.createElement("div");m.style&&(m.style.backgroundClip="content-box",m.cloneNode(!0).style.backgroundClip="",ca.clearCloneStyle="content-box"===m.style.backgroundClip,f.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",f.appendChild(m),k.getComputedStyle&&p.extend(ca,{pixelPosition:function(){a();
return b},boxSizingReliable:function(){null==c&&a();return c},reliableMarginRight:function(){var a;a=m.appendChild(U.createElement("div"));a.style.cssText=m.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0";a.style.marginRight=a.style.width="0";m.style.width="1px";d.appendChild(f);a=!parseFloat(k.getComputedStyle(a,null).marginRight);d.removeChild(f);return a}}))})();p.swap=function(a,b,c,d){var f,m={};for(f in b)m[f]=
a.style[f],a.style[f]=b[f];c=c.apply(a,d||[]);for(f in b)a.style[f]=m[f];return c};var tb=/^(none|table(?!-c[ea]).+)/,ja=new RegExp("^("+ua+")(.*)$","i"),da=new RegExp("^([+-])=("+ua+")","i"),ub={position:"absolute",visibility:"hidden",display:"block"},fb={letterSpacing:"0",fontWeight:"400"},pa=["Webkit","O","Moz","ms"];p.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=D(a,"opacity");return""===c?"1":c}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,
opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(a,b,c,d){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var f,m,g,h=p.camelCase(b),n=a.style;b=p.cssProps[h]||(p.cssProps[h]=M(n,h));g=p.cssHooks[b]||p.cssHooks[h];if(void 0!==c)m=typeof c,"string"===m&&(f=da.exec(c))&&(c=(f[1]+1)*f[2]+parseFloat(p.css(a,b)),m="number"),null!=c&&c===c&&("number"!==m||p.cssNumber[h]||(c+="px"),ca.clearCloneStyle||""!==c||0!==b.indexOf("background")||(n[b]="inherit"),
g&&"set"in g&&void 0===(c=g.set(a,c,d))||(n[b]=c));else return g&&"get"in g&&void 0!==(f=g.get(a,!1,d))?f:n[b]}},css:function(a,b,c,d){var f,m;m=p.camelCase(b);b=p.cssProps[m]||(p.cssProps[m]=M(a.style,m));(m=p.cssHooks[b]||p.cssHooks[m])&&"get"in m&&(f=m.get(a,!0,c));void 0===f&&(f=D(a,b,d));"normal"===f&&b in fb&&(f=fb[b]);return""===c||c?(a=parseFloat(f),!0===c||p.isNumeric(a)?a||0:f):f}});p.each(["height","width"],function(a,b){p.cssHooks[b]={get:function(a,c,d){if(c)return tb.test(p.css(a,"display"))&&
0===a.offsetWidth?p.swap(a,ub,function(){return I(a,b,d)}):I(a,b,d)},set:function(a,c,d){var f=d&&Sa(a);return C(a,c,d?L(a,b,d,"border-box"===p.css(a,"boxSizing",!1,f),f):0)}}});p.cssHooks.marginRight=J(ca.reliableMarginRight,function(a,b){if(b)return p.swap(a,{display:"inline-block"},D,[a,"marginRight"])});p.each({margin:"",padding:"",border:"Width"},function(a,b){p.cssHooks[a+b]={expand:function(c){var d=0,f={};for(c="string"===typeof c?c.split(" "):[c];4>d;d++)f[a+Ca[d]+b]=c[d]||c[d-2]||c[0];return f}};
Ga.test(a)||(p.cssHooks[a+b].set=C)});p.fn.extend({css:function(a,b){return Ba(this,function(a,b,c){var d,f={},m=0;if(p.isArray(b)){c=Sa(a);for(d=b.length;m<d;m++)f[b[m]]=p.css(a,b[m],!1,c);return f}return void 0!==c?p.style(a,b,c):p.css(a,b)},a,b,1<arguments.length)},show:function(){return S(this,!0)},hide:function(){return S(this)},toggle:function(a){return"boolean"===typeof a?a?this.show():this.hide():this.each(function(){Ea(this)?p(this).show():p(this).hide()})}});p.Tween=m;m.prototype={constructor:m,
init:function(a,b,c,d,f,m){this.elem=a;this.prop=c;this.easing=f||"swing";this.options=b;this.start=this.now=this.cur();this.end=d;this.unit=m||(p.cssNumber[c]?"":"px")},cur:function(){var a=m.propHooks[this.prop];return a&&a.get?a.get(this):m.propHooks._default.get(this)},run:function(a){var b,c=m.propHooks[this.prop];this.pos=this.options.duration?b=p.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):b=a;this.now=(this.end-this.start)*b+this.start;this.options.step&&this.options.step.call(this.elem,
this.now,this);c&&c.set?c.set(this):m.propHooks._default.set(this);return this}};m.prototype.init.prototype=m.prototype;m.propHooks={_default:{get:function(a){return null==a.elem[a.prop]||a.elem.style&&null!=a.elem.style[a.prop]?(a=p.css(a.elem,a.prop,""))&&"auto"!==a?a:0:a.elem[a.prop]},set:function(a){if(p.fx.step[a.prop])p.fx.step[a.prop](a);else a.elem.style&&(null!=a.elem.style[p.cssProps[a.prop]]||p.cssHooks[a.prop])?p.style(a.elem,a.prop,a.now+a.unit):a.elem[a.prop]=a.now}}};m.propHooks.scrollTop=
m.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}};p.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2}};p.fx=m.prototype.init;p.fx.step={};var Fa,Wa,Kb=/^(?:toggle|show|hide)$/,G=new RegExp("^(?:([+-])=|)("+ua+")([a-z%]*)$","i"),ka=/queueHooks$/,W=[function(a,b,c){var d,f,m,g,h,n,k=this,w={},x=a.style,P=a.nodeType&&Ea(a),q=O.get(a,"fxshow");c.queue||(g=p._queueHooks(a,"fx"),null==g.unqueued&&(g.unqueued=0,h=g.empty.fire,
g.empty.fire=function(){g.unqueued||h()}),g.unqueued++,k.always(function(){k.always(function(){g.unqueued--;p.queue(a,"fx").length||g.empty.fire()})}));1===a.nodeType&&("height"in b||"width"in b)&&(c.overflow=[x.overflow,x.overflowX,x.overflowY],n=p.css(a,"display"),f="none"===n?O.get(a,"olddisplay")||K(a.nodeName):n,"inline"===f&&"none"===p.css(a,"float")&&(x.display="inline-block"));c.overflow&&(x.overflow="hidden",k.always(function(){x.overflow=c.overflow[0];x.overflowX=c.overflow[1];x.overflowY=
c.overflow[2]}));for(d in b)if(f=b[d],Kb.exec(f)){delete b[d];m=m||"toggle"===f;if(f===(P?"hide":"show"))if("show"===f&&q&&void 0!==q[d])P=!0;else continue;w[d]=q&&q[d]||p.style(a,d)}else n=void 0;if(p.isEmptyObject(w))"inline"===("none"===n?K(a.nodeName):n)&&(x.display=n);else for(d in q?"hidden"in q&&(P=q.hidden):q=O.access(a,"fxshow",{}),m&&(q.hidden=!P),P?p(a).show():k.done(function(){p(a).hide()}),k.done(function(){var b;O.remove(a,"fxshow");for(b in w)p.style(a,b,w[b])}),w)b=E(P?q[d]:0,d,k),
d in q||(q[d]=b.start,P&&(b.end=b.start,b.start="width"===d||"height"===d?1:0))}],Q={"*":[function(a,b){var c=this.createTween(a,b),d=c.cur(),f=G.exec(b),m=f&&f[3]||(p.cssNumber[a]?"":"px"),g=(p.cssNumber[a]||"px"!==m&&+d)&&G.exec(p.css(c.elem,a)),h=1,n=20;if(g&&g[3]!==m){m=m||g[3];f=f||[];g=+d||1;do h=h||".5",g/=h,p.style(c.elem,a,g+m);while(h!==(h=c.cur()/d)&&1!==h&&--n)}f&&(g=c.start=+g||+d||0,c.unit=m,c.end=f[1]?g+(f[1]+1)*f[2]:+f[2]);return c}]};p.Animation=p.extend(V,{tweener:function(a,b){p.isFunction(a)?
(b=a,a=["*"]):a=a.split(" ");for(var c,d=0,f=a.length;d<f;d++)c=a[d],Q[c]=Q[c]||[],Q[c].unshift(b)},prefilter:function(a,b){b?W.unshift(a):W.push(a)}});p.speed=function(a,b,c){var d=a&&"object"===typeof a?p.extend({},a):{complete:c||!c&&b||p.isFunction(a)&&a,duration:a,easing:c&&b||b&&!p.isFunction(b)&&b};d.duration=p.fx.off?0:"number"===typeof d.duration?d.duration:d.duration in p.fx.speeds?p.fx.speeds[d.duration]:p.fx.speeds._default;if(null==d.queue||!0===d.queue)d.queue="fx";d.old=d.complete;
d.complete=function(){p.isFunction(d.old)&&d.old.call(this);d.queue&&p.dequeue(this,d.queue)};return d};p.fn.extend({fadeTo:function(a,b,c,d){return this.filter(Ea).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var f=p.isEmptyObject(a),m=p.speed(b,c,d);b=function(){var b=V(this,p.extend({},a),m);(f||O.get(this,"finish"))&&b.stop(!0)};b.finish=b;return f||!1===m.queue?this.each(b):this.queue(m.queue,b)},stop:function(a,b,c){var d=function(a){var b=a.stop;delete a.stop;
b(c)};"string"!==typeof a&&(c=b,b=a,a=void 0);b&&!1!==a&&this.queue(a||"fx",[]);return this.each(function(){var b=!0,f=null!=a&&a+"queueHooks",m=p.timers,g=O.get(this);if(f)g[f]&&g[f].stop&&d(g[f]);else for(f in g)g[f]&&g[f].stop&&ka.test(f)&&d(g[f]);for(f=m.length;f--;)m[f].elem!==this||null!=a&&m[f].queue!==a||(m[f].anim.stop(c),b=!1,m.splice(f,1));!b&&c||p.dequeue(this,a)})},finish:function(a){!1!==a&&(a=a||"fx");return this.each(function(){var b,c=O.get(this),d=c[a+"queue"];b=c[a+"queueHooks"];
var f=p.timers,m=d?d.length:0;c.finish=!0;p.queue(this,a,[]);b&&b.stop&&b.stop.call(this,!0);for(b=f.length;b--;)f[b].elem===this&&f[b].queue===a&&(f[b].anim.stop(!0),f.splice(b,1));for(b=0;b<m;b++)d[b]&&d[b].finish&&d[b].finish.call(this);delete c.finish})}});p.each(["toggle","show","hide"],function(a,b){var c=p.fn[b];p.fn[b]=function(a,d,f){return null==a||"boolean"===typeof a?c.apply(this,arguments):this.animate(B(b,!0),a,d,f)}});p.each({slideDown:B("show"),slideUp:B("hide"),slideToggle:B("toggle"),
fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){p.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}});p.timers=[];p.fx.tick=function(){var a,b=0,c=p.timers;for(Fa=p.now();b<c.length;b++)a=c[b],a()||c[b]!==a||c.splice(b--,1);c.length||p.fx.stop();Fa=void 0};p.fx.timer=function(a){p.timers.push(a);a()?p.fx.start():p.timers.pop()};p.fx.interval=13;p.fx.start=function(){Wa||(Wa=setInterval(p.fx.tick,p.fx.interval))};p.fx.stop=function(){clearInterval(Wa);
Wa=null};p.fx.speeds={slow:600,fast:200,_default:400};p.fn.delay=function(a,b){a=p.fx?p.fx.speeds[a]||a:a;return this.queue(b||"fx",function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})};(function(){var a=U.createElement("input"),b=U.createElement("select"),c=b.appendChild(U.createElement("option"));a.type="checkbox";ca.checkOn=""!==a.value;ca.optSelected=c.selected;b.disabled=!0;ca.optDisabled=!c.disabled;a=U.createElement("input");a.value="t";a.type="radio";ca.radioValue="t"===
a.value})();var ba,Ja=p.expr.attrHandle;p.fn.extend({attr:function(a,b){return Ba(this,p.attr,a,b,1<arguments.length)},removeAttr:function(a){return this.each(function(){p.removeAttr(this,a)})}});p.extend({attr:function(a,b,c){var d,f,m=a.nodeType;if(a&&3!==m&&8!==m&&2!==m){if("undefined"===typeof a.getAttribute)return p.prop(a,b,c);1===m&&p.isXMLDoc(a)||(b=b.toLowerCase(),d=p.attrHooks[b]||(p.expr.match.bool.test(b)?ba:void 0));if(void 0!==c)if(null===c)p.removeAttr(a,b);else{if(d&&"set"in d&&void 0!==
(f=d.set(a,c,b)))return f;a.setAttribute(b,c+"");return c}else{if(d&&"get"in d&&null!==(f=d.get(a,b)))return f;f=p.find.attr(a,b);return null==f?void 0:f}}},removeAttr:function(a,b){var c,d,f=0,m=b&&b.match(ia);if(m&&1===a.nodeType)for(;c=m[f++];)d=p.propFix[c]||c,p.expr.match.bool.test(c)&&(a[d]=!1),a.removeAttribute(c)},attrHooks:{type:{set:function(a,b){if(!ca.radioValue&&"radio"===b&&p.nodeName(a,"input")){var c=a.value;a.setAttribute("type",b);c&&(a.value=c);return b}}}}});ba={set:function(a,
b,c){!1===b?p.removeAttr(a,c):a.setAttribute(c,c);return c}};p.each(p.expr.match.bool.source.match(/\w+/g),function(a,b){var c=Ja[b]||p.find.attr;Ja[b]=function(a,b,d){var f,m;d||(m=Ja[b],Ja[b]=f,f=null!=c(a,b,d)?b.toLowerCase():null,Ja[b]=m);return f}});var Lb=/^(?:input|select|textarea|button)$/i;p.fn.extend({prop:function(a,b){return Ba(this,p.prop,a,b,1<arguments.length)},removeProp:function(a){return this.each(function(){delete this[p.propFix[a]||a]})}});p.extend({propFix:{"for":"htmlFor","class":"className"},
prop:function(a,b,c){var d,f,m;m=a.nodeType;if(a&&3!==m&&8!==m&&2!==m){if(m=1!==m||!p.isXMLDoc(a))b=p.propFix[b]||b,f=p.propHooks[b];return void 0!==c?f&&"set"in f&&void 0!==(d=f.set(a,c,b))?d:a[b]=c:f&&"get"in f&&null!==(d=f.get(a,b))?d:a[b]}},propHooks:{tabIndex:{get:function(a){return a.hasAttribute("tabindex")||Lb.test(a.nodeName)||a.href?a.tabIndex:-1}}}});ca.optSelected||(p.propHooks.selected={get:function(a){(a=a.parentNode)&&a.parentNode&&a.parentNode.selectedIndex;return null}});p.each("tabIndex readOnly maxLength cellSpacing cellPadding rowSpan colSpan useMap frameBorder contentEditable".split(" "),
function(){p.propFix[this.toLowerCase()]=this});var Na=/[\t\r\n\f]/g;p.fn.extend({addClass:function(a){var b,c,d,f,m;b="string"===typeof a&&a;var g=0,h=this.length;if(p.isFunction(a))return this.each(function(b){p(this).addClass(a.call(this,b,this.className))});if(b)for(b=(a||"").match(ia)||[];g<h;g++)if(c=this[g],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(Na," "):" ")){for(m=0;f=b[m++];)0>d.indexOf(" "+f+" ")&&(d+=f+" ");d=p.trim(d);c.className!==d&&(c.className=d)}return this},
removeClass:function(a){var b,c,d,f,m;b=0===arguments.length||"string"===typeof a&&a;var g=0,h=this.length;if(p.isFunction(a))return this.each(function(b){p(this).removeClass(a.call(this,b,this.className))});if(b)for(b=(a||"").match(ia)||[];g<h;g++)if(c=this[g],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(Na," "):"")){for(m=0;f=b[m++];)for(;0<=d.indexOf(" "+f+" ");)d=d.replace(" "+f+" "," ");d=a?p.trim(d):"";c.className!==d&&(c.className=d)}return this},toggleClass:function(a,b){var c=
typeof a;return"boolean"===typeof b&&"string"===c?b?this.addClass(a):this.removeClass(a):p.isFunction(a)?this.each(function(c){p(this).toggleClass(a.call(this,c,this.className,b),b)}):this.each(function(){if("string"===c)for(var b,d=0,f=p(this),m=a.match(ia)||[];b=m[d++];)f.hasClass(b)?f.removeClass(b):f.addClass(b);else if("undefined"===c||"boolean"===c)this.className&&O.set(this,"__className__",this.className),this.className=this.className||!1===a?"":O.get(this,"__className__")||""})},hasClass:function(a){a=
" "+a+" ";for(var b=0,c=this.length;b<c;b++)if(1===this[b].nodeType&&0<=(" "+this[b].className+" ").replace(Na," ").indexOf(a))return!0;return!1}});var Qb=/\r/g;p.fn.extend({val:function(a){var b,c,d,f=this[0];if(arguments.length)return d=p.isFunction(a),this.each(function(c){1===this.nodeType&&(c=d?a.call(this,c,p(this).val()):a,null==c?c="":"number"===typeof c?c+="":p.isArray(c)&&(c=p.map(c,function(a){return null==a?"":a+""})),b=p.valHooks[this.type]||p.valHooks[this.nodeName.toLowerCase()],b&&
"set"in b&&void 0!==b.set(this,c,"value")||(this.value=c))});if(f){if((b=p.valHooks[f.type]||p.valHooks[f.nodeName.toLowerCase()])&&"get"in b&&void 0!==(c=b.get(f,"value")))return c;c=f.value;return"string"===typeof c?c.replace(Qb,""):null==c?"":c}}});p.extend({valHooks:{option:{get:function(a){var b=p.find.attr(a,"value");return null!=b?b:p.trim(p.text(a))}},select:{get:function(a){for(var b,c=a.options,d=a.selectedIndex,f=(a="select-one"===a.type||0>d)?null:[],m=a?d+1:c.length,g=0>d?m:a?d:0;g<m;g++)if(b=
c[g],!(!b.selected&&g!==d||(ca.optDisabled?b.disabled:null!==b.getAttribute("disabled"))||b.parentNode.disabled&&p.nodeName(b.parentNode,"optgroup"))){b=p(b).val();if(a)return b;f.push(b)}return f},set:function(a,b){for(var c,d,f=a.options,m=p.makeArray(b),g=f.length;g--;)if(d=f[g],d.selected=0<=p.inArray(d.value,m))c=!0;c||(a.selectedIndex=-1);return m}}}});p.each(["radio","checkbox"],function(){p.valHooks[this]={set:function(a,b){if(p.isArray(b))return a.checked=0<=p.inArray(p(a).val(),b)}};ca.checkOn||
(p.valHooks[this].get=function(a){return null===a.getAttribute("value")?"on":a.value})});p.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){p.fn[b]=function(a,c){return 0<arguments.length?this.on(b,null,a,c):this.trigger(b)}});p.fn.extend({hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)},bind:function(a,
b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,"**"):this.off(b,a||"**",c)}});var vb=p.now(),wb=/\?/;p.parseJSON=function(a){return JSON.parse(a+"")};p.parseXML=function(a){var b,c;if(!a||"string"!==typeof a)return null;try{c=new DOMParser,b=c.parseFromString(a,"text/xml")}catch(d){b=void 0}b&&!b.getElementsByTagName("parsererror").length||p.error("Invalid XML: "+
a);return b};var Da,na,Mb=/#.*$/,xb=/([?&])_=[^&]*/,yb=/^(.*?):[ \t]*([^\r\n]*)$/mg,Nb=/^(?:GET|HEAD)$/,ya=/^\/\//,Oa=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,Ka={},bb={},gb="*/".concat("*");try{na=location.href}catch(ha){na=U.createElement("a"),na.href="",na=na.href}Da=Oa.exec(na.toLowerCase())||[];p.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:na,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Da[1]),global:!0,processData:!0,async:!0,
contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":gb,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":p.parseJSON,"text xml":p.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,b){return b?aa(aa(a,p.ajaxSettings),b):aa(p.ajaxSettings,
a)},ajaxPrefilter:Y(Ka),ajaxTransport:Y(bb),ajax:function(a,b){function c(a,b,w,g){var n,u,B,t;t=b;if(2!==E){E=2;h&&clearTimeout(h);d=void 0;m=g||"";v.readyState=0<a?4:0;g=200<=a&&300>a||304===a;if(w){B=x;for(var y=v,T,L,Y,ta,C=B.contents,V=B.dataTypes;"*"===V[0];)V.shift(),void 0===T&&(T=B.mimeType||y.getResponseHeader("Content-Type"));if(T)for(L in C)if(C[L]&&C[L].test(T)){V.unshift(L);break}if(V[0]in w)Y=V[0];else{for(L in w){if(!V[0]||B.converters[L+" "+V[0]]){Y=L;break}ta||(ta=L)}Y=Y||ta}Y?(Y!==
V[0]&&V.unshift(Y),B=w[Y]):B=void 0}a:{w=x;T=B;L=v;Y=g;var Db,H,z,y={},C=w.dataTypes.slice();if(C[1])for(H in w.converters)y[H.toLowerCase()]=w.converters[H];for(ta=C.shift();ta;)if(w.responseFields[ta]&&(L[w.responseFields[ta]]=T),!z&&Y&&w.dataFilter&&(T=w.dataFilter(T,w.dataType)),z=ta,ta=C.shift())if("*"===ta)ta=z;else if("*"!==z&&z!==ta){H=y[z+" "+ta]||y["* "+ta];if(!H)for(Db in y)if(B=Db.split(" "),B[1]===ta&&(H=y[z+" "+B[0]]||y["* "+B[0]])){!0===H?H=y[Db]:!0!==y[Db]&&(ta=B[0],C.unshift(B[1]));
break}if(!0!==H)if(H&&w["throws"])T=H(T);else try{T=H(T)}catch(I){B={state:"parsererror",error:H?I:"No conversion from "+z+" to "+ta};break a}}B={state:"success",data:T}}if(g)x.ifModified&&((t=v.getResponseHeader("Last-Modified"))&&(p.lastModified[f]=t),(t=v.getResponseHeader("etag"))&&(p.etag[f]=t)),204===a||"HEAD"===x.type?t="nocontent":304===a?t="notmodified":(t=B.state,n=B.data,u=B.error,g=!u);else if(u=t,a||!t)t="error",0>a&&(a=0);v.status=a;v.statusText=(b||t)+"";g?l.resolveWith(P,[n,t,v]):
l.rejectWith(P,[v,t,u]);v.statusCode(r);r=void 0;k&&q.trigger(g?"ajaxSuccess":"ajaxError",[v,x,g?n:u]);A.fireWith(P,[v,t]);k&&(q.trigger("ajaxComplete",[v,x]),--p.active||p.event.trigger("ajaxStop"))}}"object"===typeof a&&(b=a,a=void 0);b=b||{};var d,f,m,g,h,n,k,w,x=p.ajaxSetup({},b),P=x.context||x,q=x.context&&(P.nodeType||P.jquery)?p(P):p.event,l=p.Deferred(),A=p.Callbacks("once memory"),r=x.statusCode||{},u={},B={},E=0,t="canceled",v={readyState:0,getResponseHeader:function(a){var b;if(2===E){if(!g)for(g=
{};b=yb.exec(m);)g[b[1].toLowerCase()]=b[2];b=g[a.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return 2===E?m:null},setRequestHeader:function(a,b){var c=a.toLowerCase();E||(a=B[c]=B[c]||a,u[a]=b);return this},overrideMimeType:function(a){E||(x.mimeType=a);return this},statusCode:function(a){var b;if(a)if(2>E)for(b in a)r[b]=[r[b],a[b]];else v.always(a[v.status]);return this},abort:function(a){a=a||t;d&&d.abort(a);c(0,a);return this}};l.promise(v).complete=A.add;v.success=
v.done;v.error=v.fail;x.url=((a||x.url||na)+"").replace(Mb,"").replace(ya,Da[1]+"//");x.type=b.method||b.type||x.method||x.type;x.dataTypes=p.trim(x.dataType||"*").toLowerCase().match(ia)||[""];null==x.crossDomain&&(n=Oa.exec(x.url.toLowerCase()),x.crossDomain=!(!n||n[1]===Da[1]&&n[2]===Da[2]&&(n[3]||("http:"===n[1]?"80":"443"))===(Da[3]||("http:"===Da[1]?"80":"443"))));x.data&&x.processData&&"string"!==typeof x.data&&(x.data=p.param(x.data,x.traditional));la(Ka,x,b,v);if(2===E)return v;(k=x.global)&&
0===p.active++&&p.event.trigger("ajaxStart");x.type=x.type.toUpperCase();x.hasContent=!Nb.test(x.type);f=x.url;x.hasContent||(x.data&&(f=x.url+=(wb.test(f)?"&":"?")+x.data,delete x.data),!1===x.cache&&(x.url=xb.test(f)?f.replace(xb,"$1_="+vb++):f+(wb.test(f)?"&":"?")+"_="+vb++));x.ifModified&&(p.lastModified[f]&&v.setRequestHeader("If-Modified-Since",p.lastModified[f]),p.etag[f]&&v.setRequestHeader("If-None-Match",p.etag[f]));(x.data&&x.hasContent&&!1!==x.contentType||b.contentType)&&v.setRequestHeader("Content-Type",
x.contentType);v.setRequestHeader("Accept",x.dataTypes[0]&&x.accepts[x.dataTypes[0]]?x.accepts[x.dataTypes[0]]+("*"!==x.dataTypes[0]?", "+gb+"; q=0.01":""):x.accepts["*"]);for(w in x.headers)v.setRequestHeader(w,x.headers[w]);if(x.beforeSend&&(!1===x.beforeSend.call(P,v,x)||2===E))return v.abort();t="abort";for(w in{success:1,error:1,complete:1})v[w](x[w]);if(d=la(bb,x,b,v)){v.readyState=1;k&&q.trigger("ajaxSend",[v,x]);x.async&&0<x.timeout&&(h=setTimeout(function(){v.abort("timeout")},x.timeout));
try{E=1,d.send(u,c)}catch(y){if(2>E)c(-1,y);else throw y;}}else c(-1,"No Transport");return v},getJSON:function(a,b,c){return p.get(a,b,c,"json")},getScript:function(a,b){return p.get(a,void 0,b,"script")}});p.each(["get","post"],function(a,b){p[b]=function(a,c,d,f){p.isFunction(c)&&(f=f||d,d=c,c=void 0);return p.ajax({url:a,type:b,dataType:f,data:c,success:d})}});p.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(a,b){p.fn[b]=function(a){return this.on(b,
a)}});p._evalUrl=function(a){return p.ajax({url:a,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})};p.fn.extend({wrapAll:function(a){var b;if(p.isFunction(a))return this.each(function(b){p(this).wrapAll(a.call(this,b))});this[0]&&(b=p(a,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){for(var a=this;a.firstElementChild;)a=a.firstElementChild;return a}).append(this));return this},wrapInner:function(a){return p.isFunction(a)?this.each(function(b){p(this).wrapInner(a.call(this,
b))}):this.each(function(){var b=p(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=p.isFunction(a);return this.each(function(c){p(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){p.nodeName(this,"body")||p(this).replaceWith(this.childNodes)}).end()}});p.expr.filters.hidden=function(a){return 0>=a.offsetWidth&&0>=a.offsetHeight};p.expr.filters.visible=function(a){return!p.expr.filters.hidden(a)};var Xa=/%20/g,La=/\[\]$/,Ya=
/\r?\n/g,Rb=/^(?:submit|button|image|reset|file)$/i,Sb=/^(?:input|select|textarea|keygen)/i;p.param=function(a,b){var c,d=[],f=function(a,b){b=p.isFunction(b)?b():null==b?"":b;d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};void 0===b&&(b=p.ajaxSettings&&p.ajaxSettings.traditional);if(p.isArray(a)||a.jquery&&!p.isPlainObject(a))p.each(a,function(){f(this.name,this.value)});else for(c in a)R(c,a[c],b,f);return d.join("&").replace(Xa,"+")};p.fn.extend({serialize:function(){return p.param(this.serializeArray())},
serializeArray:function(){return this.map(function(){var a=p.prop(this,"elements");return a?p.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!p(this).is(":disabled")&&Sb.test(this.nodeName)&&!Rb.test(a)&&(this.checked||!pb.test(a))}).map(function(a,b){var c=p(this).val();return null==c?null:p.isArray(c)?p.map(c,function(a){return{name:b.name,value:a.replace(Ya,"\r\n")}}):{name:b.name,value:c.replace(Ya,"\r\n")}}).get()}});p.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(a){}};
var Ob=0,fa={},Tb={0:200,1223:204},Za=p.ajaxSettings.xhr();if(k.ActiveXObject)p(k).on("unload",function(){for(var a in fa)fa[a]()});ca.cors=!!Za&&"withCredentials"in Za;ca.ajax=Za=!!Za;p.ajaxTransport(function(a){var b;if(ca.cors||Za&&!a.crossDomain)return{send:function(c,d){var f,m=a.xhr(),g=++Ob;m.open(a.type,a.url,a.async,a.username,a.password);if(a.xhrFields)for(f in a.xhrFields)m[f]=a.xhrFields[f];a.mimeType&&m.overrideMimeType&&m.overrideMimeType(a.mimeType);a.crossDomain||c["X-Requested-With"]||
(c["X-Requested-With"]="XMLHttpRequest");for(f in c)m.setRequestHeader(f,c[f]);b=function(a){return function(){b&&(delete fa[g],b=m.onload=m.onerror=null,"abort"===a?m.abort():"error"===a?d(m.status,m.statusText):d(Tb[m.status]||m.status,m.statusText,"string"===typeof m.responseText?{text:m.responseText}:void 0,m.getAllResponseHeaders()))}};m.onload=b();m.onerror=b("error");b=fa[g]=b("abort");try{m.send(a.hasContent&&a.data||null)}catch(h){if(b)throw h;}},abort:function(){b&&b()}}});p.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},
contents:{script:/(?:java|ecma)script/},converters:{"text script":function(a){p.globalEval(a);return a}}});p.ajaxPrefilter("script",function(a){void 0===a.cache&&(a.cache=!1);a.crossDomain&&(a.type="GET")});p.ajaxTransport("script",function(a){if(a.crossDomain){var b,c;return{send:function(d,f){b=p("<script>").prop({async:!0,charset:a.scriptCharset,src:a.url}).on("load error",c=function(a){b.remove();c=null;a&&f("error"===a.type?404:200,a.type)});U.head.appendChild(b[0])},abort:function(){c&&c()}}}});
var zb=[],$a=/(=)\?(?=&|$)|\?\?/;p.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=zb.pop()||p.expando+"_"+vb++;this[a]=!0;return a}});p.ajaxPrefilter("json jsonp",function(a,b,c){var d,f,m,g=!1!==a.jsonp&&($a.test(a.url)?"url":"string"===typeof a.data&&!(a.contentType||"").indexOf("application/x-www-form-urlencoded")&&$a.test(a.data)&&"data");if(g||"jsonp"===a.dataTypes[0])return d=a.jsonpCallback=p.isFunction(a.jsonpCallback)?a.jsonpCallback():a.jsonpCallback,g?a[g]=a[g].replace($a,"$1"+
d):!1!==a.jsonp&&(a.url+=(wb.test(a.url)?"&":"?")+a.jsonp+"="+d),a.converters["script json"]=function(){m||p.error(d+" was not called");return m[0]},a.dataTypes[0]="json",f=k[d],k[d]=function(){m=arguments},c.always(function(){k[d]=f;a[d]&&(a.jsonpCallback=b.jsonpCallback,zb.push(d));m&&p.isFunction(f)&&f(m[0]);m=f=void 0}),"script"});p.parseHTML=function(a,b,c){if(!a||"string"!==typeof a)return null;"boolean"===typeof b&&(c=b,b=!1);b=b||U;var d=ob.exec(a);c=!c&&[];if(d)return[b.createElement(d[1])];
d=p.buildFragment([a],b,c);c&&c.length&&p(c).remove();return p.merge([],d.childNodes)};var hb=p.fn.load;p.fn.load=function(a,b,c){if("string"!==typeof a&&hb)return hb.apply(this,arguments);var d,f,m,g=this,h=a.indexOf(" ");0<=h&&(d=p.trim(a.slice(h)),a=a.slice(0,h));p.isFunction(b)?(c=b,b=void 0):b&&"object"===typeof b&&(f="POST");0<g.length&&p.ajax({url:a,type:f,dataType:"html",data:b}).done(function(a){m=arguments;g.html(d?p("<div>").append(p.parseHTML(a)).find(d):a)}).complete(c&&function(a,b){g.each(c,
m||[a.responseText,b,a])});return this};p.expr.filters.animated=function(a){return p.grep(p.timers,function(b){return a===b.elem}).length};var ib=k.document.documentElement;p.offset={setOffset:function(a,b,c){var d,f,m,g=p.css(a,"position"),h=p(a),n={};"static"===g&&(a.style.position="relative");m=h.offset();f=p.css(a,"top");d=p.css(a,"left");("absolute"===g||"fixed"===g)&&-1<(f+d).indexOf("auto")?(d=h.position(),f=d.top,d=d.left):(f=parseFloat(f)||0,d=parseFloat(d)||0);p.isFunction(b)&&(b=b.call(a,
c,m));null!=b.top&&(n.top=b.top-m.top+f);null!=b.left&&(n.left=b.left-m.left+d);"using"in b?b.using.call(a,n):h.css(n)}};p.fn.extend({offset:function(a){if(arguments.length)return void 0===a?this:this.each(function(b){p.offset.setOffset(this,a,b)});var b,c;c=this[0];var d={top:0,left:0},f=c&&c.ownerDocument;if(f){b=f.documentElement;if(!p.contains(b,c))return d;"undefined"!==typeof c.getBoundingClientRect&&(d=c.getBoundingClientRect());c=ma(f);return{top:d.top+c.pageYOffset-b.clientTop,left:d.left+
c.pageXOffset-b.clientLeft}}},position:function(){if(this[0]){var a,b,c=this[0],d={top:0,left:0};"fixed"===p.css(c,"position")?b=c.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),p.nodeName(a[0],"html")||(d=a.offset()),d.top+=p.css(a[0],"borderTopWidth",!0),d.left+=p.css(a[0],"borderLeftWidth",!0));return{top:b.top-d.top-p.css(c,"marginTop",!0),left:b.left-d.left-p.css(c,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent||ib;a&&!p.nodeName(a,
"html")&&"static"===p.css(a,"position");)a=a.offsetParent;return a||ib})}});p.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,b){var c="pageYOffset"===b;p.fn[a]=function(d){return Ba(this,function(a,d,f){var m=ma(a);if(void 0===f)return m?m[b]:a[d];m?m.scrollTo(c?k.pageXOffset:f,c?f:k.pageYOffset):a[d]=f},a,d,arguments.length,null)}});p.each(["top","left"],function(a,b){p.cssHooks[b]=J(ca.pixelPosition,function(a,c){if(c)return c=D(a,b),oa.test(c)?p(a).position()[b]+"px":c})});
p.each({Height:"height",Width:"width"},function(a,b){p.each({padding:"inner"+a,content:b,"":"outer"+a},function(c,d){p.fn[d]=function(d,f){var m=arguments.length&&(c||"boolean"!==typeof d),g=c||(!0===d||!0===f?"margin":"border");return Ba(this,function(b,c,d){return p.isWindow(b)?b.document.documentElement["client"+a]:9===b.nodeType?(c=b.documentElement,Math.max(b.body["scroll"+a],c["scroll"+a],b.body["offset"+a],c["offset"+a],c["client"+a])):void 0===d?p.css(b,c,g):p.style(b,c,d,g)},b,m?d:void 0,
m,null)}})});p.fn.size=function(){return this.length};p.fn.andSelf=p.fn.addBack;"function"===typeof define&&define.amd&&define("jquery",[],function(){return p});var jb=k.jQuery,Ub=k.$;p.noConflict=function(a){k.$===p&&(k.$=Ub);a&&k.jQuery===p&&(k.jQuery=jb);return p};"undefined"===typeof l&&(k.jQuery=k.$=p);return p});/*
   Copyright 2008-2014 SpryMedia Ltd.

 This source file is free software, available under the following license:
   MIT license - http://datatables.net/license

 This source file is distributed in the hope that it will be useful, but
 WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY
 or FITNESS FOR A PARTICULAR PURPOSE. See the license files for details.

 For details please refer to: http://www.datatables.net
*/
(function(k,l,a){(function(a){"function"===typeof define&&define.amd?define("datatables",["jquery"],a):"object"===typeof exports?a(require("jquery")):jQuery&&!jQuery.fn.dataTable&&a(jQuery)})(function(b){function d(a){var c,f,m={};b.each(a,function(b,g){(c=b.match(/^([^A-Z]+?)([A-Z])/))&&-1!=="a aa ai ao as b fn i m o s ".indexOf(c[1]+" ")&&(f=b.replace(c[0],c[2].toLowerCase()),m[f]=b,"o"===c[1]&&d(a[b]))});a._hungarianMap=m}function f(c,m,g){c._hungarianMap||d(c);var h;b.each(m,function(d,n){h=c._hungarianMap[d];
h===a||!g&&m[h]!==a||("o"===h.charAt(0)?(m[h]||(m[h]={}),b.extend(!0,m[h],m[d]),f(c[h],m[h],g)):m[h]=m[d])})}function g(a){var b=G.defaults.oLanguage,c=a.sZeroRecords;!a.sEmptyTable&&c&&"No data available in table"===b.sEmptyTable&&oa(a,a,"sZeroRecords","sEmptyTable");!a.sLoadingRecords&&c&&"Loading..."===b.sLoadingRecords&&oa(a,a,"sZeroRecords","sLoadingRecords");a.sInfoThousands&&(a.sThousands=a.sInfoThousands);(a=a.sDecimal)&&Wa(a)}function q(a){ha(a,"ordering","bSort");ha(a,"orderMulti","bSortMulti");
ha(a,"orderClasses","bSortClasses");ha(a,"orderCellsTop","bSortCellsTop");ha(a,"order","aaSorting");ha(a,"orderFixed","aaSortingFixed");ha(a,"paging","bPaginate");ha(a,"pagingType","sPaginationType");ha(a,"pageLength","iDisplayLength");ha(a,"searching","bFilter");if(a=a.aoSearchCols)for(var b=0,c=a.length;b<c;b++)a[b]&&f(G.models.oSearch,a[b])}function h(a){ha(a,"orderable","bSortable");ha(a,"orderData","aDataSort");ha(a,"orderSequence","asSorting");ha(a,"orderDataType","sortDataType")}function v(a){a=
a.oBrowser;var c=b("<div/>").css({position:"absolute",top:0,left:0,height:1,width:1,overflow:"hidden"}).append(b("<div/>").css({position:"absolute",top:1,left:1,width:100,overflow:"scroll"}).append(b('<div class="test"/>').css({width:"100%",height:10}))).appendTo("body"),d=c.find(".test");a.bScrollOversize=100===d[0].offsetWidth;a.bScrollbarLeft=1!==d.offset().left;c.remove()}function t(b,c,d,f,m,g){var h,n=!1;d!==a&&(h=d,n=!0);for(;f!==m;)b.hasOwnProperty(f)&&(h=n?c(h,b[f],f,b):b[f],n=!0,f+=g);return h}
function n(a,c){var d=G.defaults.column,f=a.aoColumns.length,d=b.extend({},G.models.oColumn,d,{nTh:c?c:l.createElement("th"),sTitle:d.sTitle?d.sTitle:c?c.innerHTML:"",aDataSort:d.aDataSort?d.aDataSort:[f],mData:d.mData?d.mData:f,idx:f});a.aoColumns.push(d);d=a.aoPreSearchCols;d[f]=b.extend({},G.models.oSearch,d[f]);u(a,f,null)}function u(c,d,m){d=c.aoColumns[d];var g=c.oClasses,n=b(d.nTh);if(!d.sWidthOrig){d.sWidthOrig=n.attr("width")||null;var k=(n.attr("style")||"").match(/width:\s*(\d+[pxem%]+)/);
k&&(d.sWidthOrig=k[1])}m!==a&&null!==m&&(h(m),f(G.defaults.column,m),m.mDataProp===a||m.mData||(m.mData=m.mDataProp),m.sType&&(d._sManualType=m.sType),m.className&&!m.sClass&&(m.sClass=m.className),b.extend(d,m),oa(d,m,"sWidth","sWidthOrig"),"number"===typeof m.iDataSort&&(d.aDataSort=[m.iDataSort]),oa(d,m,"aDataSort"));var q=d.mData,l=I(q),r=d.mRender?I(d.mRender):null;m=function(a){return"string"===typeof a&&-1!==a.indexOf("@")};d._bAttrSrc=b.isPlainObject(q)&&(m(q.sort)||m(q.type)||m(q.filter));
d.fnGetData=function(b,c,d){var f=l(b,c,a,d);return r&&c?r(f,c,b,d):f};d.fnSetData=function(a,b,c){return S(q)(a,b,c)};"number"!==typeof q&&(c._rowReadObject=!0);c.oFeatures.bSort||(d.bSortable=!1,n.addClass(g.sSortableNone));c=-1!==b.inArray("asc",d.asSorting);m=-1!==b.inArray("desc",d.asSorting);d.bSortable&&(c||m)?c&&!m?(d.sSortingClass=g.sSortableAsc,d.sSortingClassJUI=g.sSortJUIAscAllowed):!c&&m?(d.sSortingClass=g.sSortableDesc,d.sSortingClassJUI=g.sSortJUIDescAllowed):(d.sSortingClass=g.sSortable,
d.sSortingClassJUI=g.sSortJUI):(d.sSortingClass=g.sSortableNone,d.sSortingClassJUI="")}function c(a){if(!1!==a.oFeatures.bAutoWidth){var b=a.aoColumns;Ca(a);for(var c=0,d=b.length;c<d;c++)b[c].nTh.style.width=b[c].sWidth}b=a.oScroll;""===b.sY&&""===b.sX||Pa(a);da(a,null,"column-sizing",[a])}function r(a,b){var c=F(a,"bVisible");return"number"===typeof c[b]?c[b]:null}function y(a,c){var d=F(a,"bVisible"),d=b.inArray(c,d);return-1!==d?d:null}function z(a){return F(a,"bVisible").length}function F(a,
c){var d=[];b.map(a.aoColumns,function(a,b){a[c]&&d.push(b)});return d}function H(b){var c=b.aoColumns,d=b.aoData,f=G.ext.type.detect,m,g,h,n,k,q,l,r,A;m=0;for(g=c.length;m<g;m++)if(l=c[m],A=[],!l.sType&&l._sManualType)l.sType=l._sManualType;else if(!l.sType){h=0;for(n=f.length;h<n;h++){k=0;for(q=d.length;k<q;k++){A[k]===a&&(A[k]=M(b,k,m,"type"));r=f[h](A[k],b);if(!r&&h!==f.length-1)break;if("html"===r)break}if(r){l.sType=r;break}}l.sType||(l.sType="string")}}function K(c,d,f,m){var g,h,k,q,l,r,A=
c.aoColumns;if(d)for(g=d.length-1;0<=g;g--){r=d[g];var p=r.targets!==a?r.targets:r.aTargets;b.isArray(p)||(p=[p]);h=0;for(k=p.length;h<k;h++)if("number"===typeof p[h]&&0<=p[h]){for(;A.length<=p[h];)n(c);m(p[h],r)}else if("number"===typeof p[h]&&0>p[h])m(A.length+p[h],r);else if("string"===typeof p[h])for(q=0,l=A.length;q<l;q++)("_all"==p[h]||b(A[q].nTh).hasClass(p[h]))&&m(q,r)}if(f)for(g=0,c=f.length;g<c;g++)m(g,f[g])}function D(a,c,d,f){var m=a.aoData.length,g=b.extend(!0,{},G.models.oRow,{src:d?
"dom":"data"});g._aData=c;a.aoData.push(g);c=a.aoColumns;for(var g=0,h=c.length;g<h;g++)d&&C(a,m,g,M(a,m,g)),c[g].sType=null;a.aiDisplayMaster.push(m);!d&&a.oFeatures.bDeferRender||V(a,m,d,f);return m}function J(a,c){var d;c instanceof b||(c=b(c));return c.map(function(b,c){d=T(a,c);return D(a,d.data,c,d.cells)})}function M(b,c,d,f){var m=b.iDraw,g=b.aoColumns[d],h=b.aoData[c]._aData,n=g.sDefaultContent;d=g.fnGetData(h,f,{settings:b,row:c,col:d});if(d===a)return b.iDrawError!=m&&null===n&&(Ga(b,0,
"Requested unknown parameter "+("function"==typeof g.mData?"{function}":"'"+g.mData+"'")+" for row "+c,4),b.iDrawError=m),n;if((d===h||null===d)&&null!==n)d=n;else if("function"===typeof d)return d.call(h);return null===d&&"display"==f?"":d}function C(a,b,c,d){a.aoColumns[c].fnSetData(a.aoData[b]._aData,d,{settings:a,row:b,col:c})}function L(a){return b.map(a.match(/(\\.|[^\.])+/g),function(a){return a.replace(/\\./g,".")})}function I(c){if(b.isPlainObject(c)){var d={};b.each(c,function(a,b){b&&(d[a]=
I(b))});return function(b,c,f,m){var w=d[c]||d._;return w!==a?w(b,c,f,m):b}}if(null===c)return function(a){return a};if("function"===typeof c)return function(a,b,d,f){return c(a,b,d,f)};if("string"!==typeof c||-1===c.indexOf(".")&&-1===c.indexOf("[")&&-1===c.indexOf("("))return function(a,b){return a[c]};var f=function(b,c,d){var m,w;if(""!==d){w=L(d);for(var g=0,h=w.length;g<h;g++){d=w[g].match(Xa);m=w[g].match(La);if(d){w[g]=w[g].replace(Xa,"");""!==w[g]&&(b=b[w[g]]);m=[];w.splice(0,g+1);w=w.join(".");
g=0;for(h=b.length;g<h;g++)m.push(f(b[g],c,w));b=d[0].substring(1,d[0].length-1);b=""===b?m:m.join(b);break}else if(m){w[g]=w[g].replace(La,"");b=b[w[g]]();continue}if(null===b||b[w[g]]===a)return a;b=b[w[g]]}}return b};return function(a,b){return f(a,b,c)}}function S(c){if(b.isPlainObject(c))return S(c._);if(null===c)return function(){};if("function"===typeof c)return function(a,b,d){c(a,"set",b,d)};if("string"!==typeof c||-1===c.indexOf(".")&&-1===c.indexOf("[")&&-1===c.indexOf("("))return function(a,
b){a[c]=b};var d=function(b,c,f){f=L(f);var m;m=f[f.length-1];for(var g,w,h=0,n=f.length-1;h<n;h++){g=f[h].match(Xa);w=f[h].match(La);if(g){f[h]=f[h].replace(Xa,"");b[f[h]]=[];m=f.slice();m.splice(0,h+1);g=m.join(".");w=0;for(n=c.length;w<n;w++)m={},d(m,c[w],g),b[f[h]].push(m);return}w&&(f[h]=f[h].replace(La,""),b=b[f[h]](c));if(null===b[f[h]]||b[f[h]]===a)b[f[h]]={};b=b[f[h]]}if(m.match(La))b[m.replace(La,"")](c);else b[m.replace(Xa,"")]=c};return function(a,b){return d(a,b,c)}}function m(a){return ya(a.aoData,
"_aData")}function A(a){a.aoData.length=0;a.aiDisplayMaster.length=0;a.aiDisplay.length=0}function B(b,c,d){for(var f=-1,m=0,g=b.length;m<g;m++)b[m]==c?f=m:b[m]>c&&b[m]--; -1!=f&&d===a&&b.splice(f,1)}function E(b,c,d,f){var m=b.aoData[c],g,h=function(a,d){for(;a.childNodes.length;)a.removeChild(a.firstChild);a.innerHTML=M(b,c,d,"display")};if("dom"!==d&&(d&&"auto"!==d||"dom"!==m.src)){var n=m.anCells;if(n)if(f!==a)h(n[f],f);else for(d=0,g=n.length;d<g;d++)h(n[d],d)}else m._aData=T(b,m,f,f===a?a:m._aData).data;
m._aSortData=null;m._aFilterData=null;h=b.aoColumns;if(f!==a)h[f].sType=null;else{d=0;for(g=h.length;d<g;d++)h[d].sType=null;Y(m)}}function T(c,d,f,m){var g=[],h=d.firstChild,n,k=0,q,l=c.aoColumns,r=c._rowReadObject;m=m||r?{}:[];var p=function(a,b){if("string"===typeof a){var c=a.indexOf("@");-1!==c&&(c=a.substring(c+1),S(a)(m,b.getAttribute(c)))}};c=function(c){if(f===a||f===k)n=l[k],q=b.trim(c.innerHTML),n&&n._bAttrSrc?(S(n.mData._)(m,q),p(n.mData.sort,c),p(n.mData.type,c),p(n.mData.filter,c)):
r?(n._setter||(n._setter=S(n.mData)),n._setter(m,q)):m[k]=q;k++};if(h)for(;h;){d=h.nodeName.toUpperCase();if("TD"==d||"TH"==d)c(h),g.push(h);h=h.nextSibling}else for(g=d.anCells,h=0,d=g.length;h<d;h++)c(g[h]);return{data:m,cells:g}}function V(a,b,c,d){var f=a.aoData[b],m=f._aData,g=[],h,n,k,q,r;if(null===f.nTr){h=c||l.createElement("tr");f.nTr=h;f.anCells=g;h._DT_RowIndex=b;Y(f);q=0;for(r=a.aoColumns.length;q<r;q++){k=a.aoColumns[q];n=c?d[q]:l.createElement(k.sCellType);g.push(n);if(!c||k.mRender||
k.mData!==q)n.innerHTML=M(a,b,q,"display");k.sClass&&(n.className+=" "+k.sClass);k.bVisible&&!c?h.appendChild(n):!k.bVisible&&c&&n.parentNode.removeChild(n);k.fnCreatedCell&&k.fnCreatedCell.call(a.oInstance,n,M(a,b,q),m,b,q)}da(a,"aoRowCreatedCallback",null,[h,m,b])}f.nTr.setAttribute("role","row")}function Y(a){var c=a.nTr,d=a._aData;if(c){d.DT_RowId&&(c.id=d.DT_RowId);if(d.DT_RowClass){var f=d.DT_RowClass.split(" ");a.__rowc=a.__rowc?gb(a.__rowc.concat(f)):f;b(c).removeClass(a.__rowc.join(" ")).addClass(d.DT_RowClass)}d.DT_RowData&&
b(c).data(d.DT_RowData)}}function la(a){var c,d,f,m,g,h=a.nTHead,n=a.nTFoot,k=0===b("th, td",h).length,q=a.oClasses,l=a.aoColumns;k&&(m=b("<tr/>").appendTo(h));c=0;for(d=l.length;c<d;c++)g=l[c],f=b(g.nTh).addClass(g.sClass),k&&f.appendTo(m),a.oFeatures.bSort&&(f.addClass(g.sSortingClass),!1!==g.bSortable&&(f.attr("tabindex",a.iTabIndex).attr("aria-controls",a.sTableId),eb(a,g.nTh,c))),g.sTitle!=f.html()&&f.html(g.sTitle),fb(a,"header")(a,f,g,q);k&&ea(a.aoHeader,h);b(h).find(">tr").attr("role","row");
b(h).find(">tr>th, >tr>td").addClass(q.sHeaderTH);b(n).find(">tr>th, >tr>td").addClass(q.sFooterTH);if(null!==n)for(a=a.aoFooter[0],c=0,d=a.length;c<d;c++)g=l[c],g.nTf=a[c].cell,g.sClass&&b(g.nTf).addClass(g.sClass)}function aa(c,d,f){var m,g,h,n=[],k=[],q=c.aoColumns.length,l;if(d){f===a&&(f=!1);m=0;for(g=d.length;m<g;m++){n[m]=d[m].slice();n[m].nTr=d[m].nTr;for(h=q-1;0<=h;h--)c.aoColumns[h].bVisible||f||n[m].splice(h,1);k.push([])}m=0;for(g=n.length;m<g;m++){if(c=n[m].nTr)for(;h=c.firstChild;)c.removeChild(h);
h=0;for(d=n[m].length;h<d;h++)if(l=q=1,k[m][h]===a){c.appendChild(n[m][h].cell);for(k[m][h]=1;n[m+q]!==a&&n[m][h].cell==n[m+q][h].cell;)k[m+q][h]=1,q++;for(;n[m][h+l]!==a&&n[m][h].cell==n[m][h+l].cell;){for(f=0;f<q;f++)k[m+f][h+l]=1;l++}b(n[m][h].cell).attr("rowspan",q).attr("colspan",l)}}}}function R(c){var d=da(c,"aoPreDrawCallback","preDraw",[c]);if(-1!==b.inArray(!1,d))Z(c,!1);else{var d=[],f=0,g=c.asStripeClasses,h=g.length,n=c.oLanguage,k=c.iInitDisplayStart,q="ssp"==pa(c),l=c.aiDisplay;c.bDrawing=
!0;k!==a&&-1!==k&&(c._iDisplayStart=q?k:k>=c.fnRecordsDisplay()?0:k,c.iInitDisplayStart=-1);var k=c._iDisplayStart,r=c.fnDisplayEnd();if(c.bDeferLoading)c.bDeferLoading=!1,c.iDraw++,Z(c,!1);else if(!q)c.iDraw++;else if(!c.bDestroying&&!za(c))return;if(0!==l.length)for(n=q?c.aoData.length:r,q=q?0:k;q<n;q++){var p=l[q],A=c.aoData[p];null===A.nTr&&V(c,p);p=A.nTr;if(0!==h){var B=g[f%h];A._sRowStripe!=B&&(b(p).removeClass(A._sRowStripe).addClass(B),A._sRowStripe=B)}da(c,"aoRowCallback",null,[p,A._aData,
f,q]);d.push(p);f++}else f=n.sZeroRecords,1==c.iDraw&&"ajax"==pa(c)?f=n.sLoadingRecords:n.sEmptyTable&&0===c.fnRecordsTotal()&&(f=n.sEmptyTable),d[0]=b("<tr/>",{"class":h?g[0]:""}).append(b("<td />",{valign:"top",colSpan:z(c),"class":c.oClasses.sRowEmpty}).html(f))[0];da(c,"aoHeaderCallback","header",[b(c.nTHead).children("tr")[0],m(c),k,r,l]);da(c,"aoFooterCallback","footer",[b(c.nTFoot).children("tr")[0],m(c),k,r,l]);g=b(c.nTBody);g.children().detach();g.append(b(d));da(c,"aoDrawCallback","draw",
[c]);c.bSorted=!1;c.bFiltered=!1;c.bDrawing=!1}}function ma(a,b){var c=a.oFeatures,d=c.bFilter;c.bSort&&Hb(a);d?U(a,a.oPreviousSearch):a.aiDisplay=a.aiDisplayMaster.slice();!0!==b&&(a._iDisplayStart=0);a._drawHold=b;R(a);a._drawHold=!1}function ga(a){var c=a.oClasses,d=b(a.nTable),d=b("<div/>").insertBefore(d),f=a.oFeatures,m=b("<div/>",{id:a.sTableId+"_wrapper","class":c.sWrapper+(a.nTFoot?"":" "+c.sNoFooter)});a.nHolding=d[0];a.nTableWrapper=m[0];a.nTableReinsertBefore=a.nTable.nextSibling;for(var g=
a.sDom.split(""),h,n,k,q,l,r,p=0;p<g.length;p++){h=null;n=g[p];if("<"==n){k=b("<div/>")[0];q=g[p+1];if("'"==q||'"'==q){l="";for(r=2;g[p+r]!=q;)l+=g[p+r],r++;"H"==l?l=c.sJUIHeader:"F"==l&&(l=c.sJUIFooter);-1!=l.indexOf(".")?(q=l.split("."),k.id=q[0].substr(1,q[0].length-1),k.className=q[1]):"#"==l.charAt(0)?k.id=l.substr(1,l.length-1):k.className=l;p+=r}m.append(k);m=b(k)}else if(">"==n)m=m.parent();else if("l"==n&&f.bPaginate&&f.bLengthChange)h=kb(a);else if("f"==n&&f.bFilter)h=ca(a);else if("r"==
n&&f.bProcessing)h=O(a);else if("t"==n)h=Bb(a);else if("i"==n&&f.bInfo)h=Ab(a);else if("p"==n&&f.bPaginate)h=Va(a);else if(0!==G.ext.feature.length)for(k=G.ext.feature,r=0,q=k.length;r<q;r++)if(n==k[r].cFeature){h=k[r].fnInit(a);break}h&&(k=a.aanFeatures,k[n]||(k[n]=[]),k[n].push(h),m.append(h))}d.replaceWith(m)}function ea(a,c){var d=b(c).children("tr"),f,m,g,h,n,k,q,l,r,p;a.splice(0,a.length);g=0;for(k=d.length;g<k;g++)a.push([]);g=0;for(k=d.length;g<k;g++)for(f=d[g],m=f.firstChild;m;){if("TD"==
m.nodeName.toUpperCase()||"TH"==m.nodeName.toUpperCase()){l=1*m.getAttribute("colspan");r=1*m.getAttribute("rowspan");l=l&&0!==l&&1!==l?l:1;r=r&&0!==r&&1!==r?r:1;h=0;for(n=a[g];n[h];)h++;q=h;p=1===l?!0:!1;for(n=0;n<l;n++)for(h=0;h<r;h++)a[g+h][q+n]={cell:m,unique:p},a[g+h].nTr=f}m=m.nextSibling}}function va(a,b,c){var d=[];c||(c=a.aoHeader,b&&(c=[],ea(c,b)));b=0;for(var f=c.length;b<f;b++)for(var m=0,g=c[b].length;m<g;m++)!c[b][m].unique||d[m]&&a.bSortCellsTop||(d[m]=c[b][m].cell);return d}function wa(a,
c,d){da(a,"aoServerParams","serverParams",[c]);if(c&&b.isArray(c)){var f={},m=/(.*?)\[\]$/;b.each(c,function(a,b){var c=b.name.match(m);c?(c=c[0],f[c]||(f[c]=[]),f[c].push(b.value)):f[b.name]=b.value});c=f}var g,h=a.ajax,n=a.oInstance;if(b.isPlainObject(h)&&h.data){g=h.data;var k=b.isFunction(g)?g(c):g;c=b.isFunction(g)&&k?k:b.extend(!0,c,k);delete h.data}k={data:c,success:function(b){var c=b.error||b.sError;c&&a.oApi._fnLog(a,0,c);a.json=b;da(a,null,"xhr",[a,b]);d(b)},dataType:"json",cache:!1,type:a.sServerMethod,
error:function(b,c,d){d=a.oApi._fnLog;"parsererror"==c?d(a,0,"Invalid JSON response",1):4===b.readyState&&d(a,0,"Ajax error",7);Z(a,!1)}};a.oAjaxData=c;da(a,null,"preXhr",[a,c]);a.fnServerData?a.fnServerData.call(n,a.sAjaxSource,b.map(c,function(a,b){return{name:b,value:a}}),d,a):a.sAjaxSource||"string"===typeof h?a.jqXHR=b.ajax(b.extend(k,{url:h||a.sAjaxSource})):b.isFunction(h)?a.jqXHR=h.call(n,c,d,a):(a.jqXHR=b.ajax(b.extend(k,h)),h.data=g)}function za(a){return a.bAjaxDataGet?(a.iDraw++,Z(a,!0),
wa(a,xa(a),function(b){Ma(a,b)}),!1):!0}function xa(a){var c=a.aoColumns,d=c.length,f=a.oFeatures,m=a.oPreviousSearch,g=a.aoPreSearchCols,h,n=[],k,q,l,r=Ia(a);h=a._iDisplayStart;k=!1!==f.bPaginate?a._iDisplayLength:-1;var p=function(a,b){n.push({name:a,value:b})};p("sEcho",a.iDraw);p("iColumns",d);p("sColumns",ya(c,"sName").join(","));p("iDisplayStart",h);p("iDisplayLength",k);var A={draw:a.iDraw,columns:[],order:[],start:h,length:k,search:{value:m.sSearch,regex:m.bRegex}};for(h=0;h<d;h++)q=c[h],
l=g[h],k="function"==typeof q.mData?"function":q.mData,A.columns.push({data:k,name:q.sName,searchable:q.bSearchable,orderable:q.bSortable,search:{value:l.sSearch,regex:l.bRegex}}),p("mDataProp_"+h,k),f.bFilter&&(p("sSearch_"+h,l.sSearch),p("bRegex_"+h,l.bRegex),p("bSearchable_"+h,q.bSearchable)),f.bSort&&p("bSortable_"+h,q.bSortable);f.bFilter&&(p("sSearch",m.sSearch),p("bRegex",m.bRegex));f.bSort&&(b.each(r,function(a,b){A.order.push({column:b.col,dir:b.dir});p("iSortCol_"+a,b.col);p("sSortDir_"+
a,b.dir)}),p("iSortingCols",r.length));c=G.ext.legacy.ajax;return null===c?a.sAjaxSource?n:A:c?n:A}function Ma(b,c){var d=function(b,d){return c[b]!==a?c[b]:c[d]},f=d("sEcho","draw"),m=d("iTotalRecords","recordsTotal"),d=d("iTotalDisplayRecords","recordsFiltered");if(f){if(1*f<b.iDraw)return;b.iDraw=1*f}A(b);b._iRecordsTotal=parseInt(m,10);b._iRecordsDisplay=parseInt(d,10);f=ra(b,c);m=0;for(d=f.length;m<d;m++)D(b,f[m]);b.aiDisplay=b.aiDisplayMaster.slice();b.bAjaxDataGet=!1;R(b);b._bInitComplete||
db(b,c);b.bAjaxDataGet=!0;Z(b,!1)}function ra(c,d){var f=b.isPlainObject(c.ajax)&&c.ajax.dataSrc!==a?c.ajax.dataSrc:c.sAjaxDataProp;return"data"===f?d.aaData||d[f]:""!==f?I(f)(d):d}function ca(a){var c=a.oClasses,d=a.sTableId,f=a.oLanguage,m=a.oPreviousSearch,g=a.aanFeatures,h='<input type="search" class="'+c.sFilterInput+'"/>',n=f.sSearch,n=n.match(/_INPUT_/)?n.replace("_INPUT_",h):n+h,c=b("<div/>",{id:g.f?null:d+"_filter","class":c.sFilter}).append(b("<label/>").append(n)),g=function(){var b=this.value?
this.value:"";b!=m.sSearch&&(U(a,{sSearch:b,bRegex:m.bRegex,bSmart:m.bSmart,bCaseInsensitive:m.bCaseInsensitive}),a._iDisplayStart=0,R(a))},h=null!==a.searchDelay?a.searchDelay:"ssp"===pa(a)?400:0,k=b("input",c).val(m.sSearch).attr("placeholder",f.sSearchPlaceholder).bind("keyup.DT search.DT input.DT paste.DT cut.DT",h?Ea(g,h):g).bind("keypress.DT",function(a){if(13==a.keyCode)return!1}).attr("aria-controls",d);b(a.nTable).on("search.dt.DT",function(b,c){if(a===c)try{k[0]!==l.activeElement&&k.val(m.sSearch)}catch(d){}});
return c[0]}function U(b,c,d){var f=b.oPreviousSearch,m=b.aoPreSearchCols,g=function(a){f.sSearch=a.sSearch;f.bRegex=a.bRegex;f.bSmart=a.bSmart;f.bCaseInsensitive=a.bCaseInsensitive},h=function(b){return b.bEscapeRegex!==a?!b.bEscapeRegex:b.bRegex};H(b);if("ssp"!=pa(b)){lb(b,c.sSearch,d,h(c),c.bSmart,c.bCaseInsensitive);g(c);for(c=0;c<m.length;c++)Aa(b,m[c].sSearch,c,h(m[c]),m[c].bSmart,m[c].bCaseInsensitive);p(b)}else g(c);b.bFiltered=!0;da(b,null,"search",[b])}function p(a){for(var b=G.ext.search,
c=a.aiDisplay,d,f,m=0,g=b.length;m<g;m++){for(var h=[],n=0,k=c.length;n<k;n++)f=c[n],d=a.aoData[f],b[m](a,d._aFilterData,f,d._aData,n)&&h.push(f);c.length=0;c.push.apply(c,h)}}function Aa(a,b,c,d,f,m){if(""!==b){var g=a.aiDisplay;d=mb(b,d,f,m);for(f=g.length-1;0<=f;f--)b=a.aoData[g[f]]._aFilterData[c],d.test(b)||g.splice(f,1)}}function lb(a,b,c,d,f,m){d=mb(b,d,f,m);f=a.oPreviousSearch.sSearch;m=a.aiDisplayMaster;var g;0!==G.ext.search.length&&(c=!0);g=Ha(a);if(0>=b.length)a.aiDisplay=m.slice();else{if(g||
c||f.length>b.length||0!==b.indexOf(f)||a.bSorted)a.aiDisplay=m.slice();b=a.aiDisplay;for(c=b.length-1;0<=c;c--)d.test(a.aoData[b[c]]._sFilterRow)||b.splice(c,1)}}function mb(a,c,d,f){a=c?a:cb(a);d&&(a="^(?=.*?"+b.map(a.match(/"[^"]+"|[^ ]+/g)||"",function(a){if('"'===a.charAt(0)){var b=a.match(/^"(.*)"$/);a=b?b[1]:a}return a.replace('"',"")}).join(")(?=.*?")+").*$");return new RegExp(a,f?"i":"")}function cb(a){return a.replace(wb,"\\$1")}function Ha(a){var b=a.aoColumns,c,d,f,m,g,h,n,k,q=G.ext.type.search;
c=!1;d=0;for(m=a.aoData.length;d<m;d++)if(k=a.aoData[d],!k._aFilterData){h=[];f=0;for(g=b.length;f<g;f++)c=b[f],c.bSearchable?(n=M(a,d,f,"filter"),q[c.sType]&&(n=q[c.sType](n)),null===n&&(n=""),"string"!==typeof n&&n.toString&&(n=n.toString())):n="",n.indexOf&&-1!==n.indexOf("&")&&(Ya.innerHTML=n,n=Rb?Ya.textContent:Ya.innerText),n.replace&&(n=n.replace(/[\r\n]/g,"")),h.push(n);k._aFilterData=h;k._sFilterRow=h.join("  ");c=!0}return c}function nb(a){return{search:a.sSearch,smart:a.bSmart,regex:a.bRegex,
caseInsensitive:a.bCaseInsensitive}}function ob(a){return{sSearch:a.search,bSmart:a.smart,bRegex:a.regex,bCaseInsensitive:a.caseInsensitive}}function Ab(a){var c=a.sTableId,d=a.aanFeatures.i,f=b("<div/>",{"class":a.oClasses.sInfo,id:d?null:c+"_info"});d||(a.aoDrawCallback.push({fn:Ta,sName:"information"}),f.attr("role","status").attr("aria-live","polite"),b(a.nTable).attr("aria-describedby",c+"_info"));return f[0]}function Ta(a){var c=a.aanFeatures.i;if(0!==c.length){var d=a.oLanguage,f=a._iDisplayStart+
1,m=a.fnDisplayEnd(),g=a.fnRecordsTotal(),h=a.fnRecordsDisplay(),n=h?d.sInfo:d.sInfoEmpty;h!==g&&(n+=" "+d.sInfoFiltered);n+=d.sInfoPostFix;n=Eb(a,n);d=d.fnInfoCallback;null!==d&&(n=d.call(a.oInstance,a,f,m,g,h,n));b(c).html(n)}}function Eb(a,b){var c=a.fnFormatNumber,d=a._iDisplayStart+1,f=a._iDisplayLength,m=a.fnRecordsDisplay(),g=-1===f;return b.replace(/_START_/g,c.call(a,d)).replace(/_END_/g,c.call(a,a.fnDisplayEnd())).replace(/_MAX_/g,c.call(a,a.fnRecordsTotal())).replace(/_TOTAL_/g,c.call(a,
m)).replace(/_PAGE_/g,c.call(a,g?1:Math.ceil(d/f))).replace(/_PAGES_/g,c.call(a,g?1:Math.ceil(m/f)))}function Ua(a){var b,c,d=a.iInitDisplayStart,f=a.aoColumns,m;c=a.oFeatures;if(a.bInitialised){ga(a);la(a);aa(a,a.aoHeader);aa(a,a.aoFooter);Z(a,!0);c.bAutoWidth&&Ca(a);b=0;for(c=f.length;b<c;b++)m=f[b],m.sWidth&&(m.nTh.style.width=X(m.sWidth));ma(a);f=pa(a);"ssp"!=f&&("ajax"==f?wa(a,[],function(c){var f=ra(a,c);for(b=0;b<f.length;b++)D(a,f[b]);a.iInitDisplayStart=d;ma(a);Z(a,!1);db(a,c)},a):(Z(a,!1),
db(a)))}else setTimeout(function(){Ua(a)},200)}function db(a,b){a._bInitComplete=!0;b&&c(a);da(a,"aoInitComplete","init",[a,b])}function ia(a,b){var c=parseInt(b,10);a._iDisplayLength=c;ub(a);da(a,null,"length",[a,c])}function kb(a){for(var c=a.oClasses,d=a.sTableId,f=a.aLengthMenu,m=b.isArray(f[0]),g=m?f[0]:f,f=m?f[1]:f,m=b("<select/>",{name:d+"_length","aria-controls":d,"class":c.sLengthSelect}),h=0,n=g.length;h<n;h++)m[0][h]=new Option(f[h],g[h]);var k=b("<div><label/></div>").addClass(c.sLength);
a.aanFeatures.l||(k[0].id=d+"_length");k.children().append(a.oLanguage.sLengthMenu.replace("_MENU_",m[0].outerHTML));b("select",k).val(a._iDisplayLength).bind("change.DT",function(c){ia(a,b(this).val());R(a)});b(a.nTable).bind("length.dt.DT",function(c,d,f){a===d&&b("select",k).val(f)});return k[0]}function Va(a){var c=a.sPaginationType,d=G.ext.pager[c],f="function"===typeof d,m=function(a){R(a)},c=b("<div/>").addClass(a.oClasses.sPaging+c)[0],g=a.aanFeatures;f||d.fnInit(a,c,m);g.p||(c.id=a.sTableId+
"_paginate",a.aoDrawCallback.push({fn:function(a){if(f){var b=a._iDisplayStart,c=a._iDisplayLength,h=a.fnRecordsDisplay(),n=-1===c,b=n?0:Math.ceil(b/c),c=n?1:Math.ceil(h/c),h=d(b,c),k,n=0;for(k=g.p.length;n<k;n++)fb(a,"pageButton")(a,g.p[n],n,h,b,c)}else d.fnUpdate(a,m)},sName:"pagination"}));return c}function Ba(a,b,c){var d=a._iDisplayStart,f=a._iDisplayLength,m=a.fnRecordsDisplay();0===m||-1===f?d=0:"number"===typeof b?(d=b*f,d>m&&(d=0)):"first"==b?d=0:"previous"==b?(d=0<=f?d-f:0,0>d&&(d=0)):"next"==
b?d+f<m&&(d+=f):"last"==b?d=Math.floor((m-1)/f)*f:Ga(a,0,"Unknown paging action: "+b,5);b=a._iDisplayStart!==d;a._iDisplayStart=d;b&&(da(a,null,"page",[a]),c&&R(a));return b}function O(a){return b("<div/>",{id:a.aanFeatures.r?null:a.sTableId+"_processing","class":a.oClasses.sProcessing}).html(a.oLanguage.sProcessing).insertBefore(a.nTable)[0]}function Z(a,c){a.oFeatures.bProcessing&&b(a.aanFeatures.r).css("display",c?"block":"none");da(a,null,"processing",[a,c])}function Bb(a){var c=b(a.nTable);c.attr("role",
"grid");var d=a.oScroll;if(""===d.sX&&""===d.sY)return a.nTable;var f=d.sX,m=d.sY,g=a.oClasses,h=c.children("caption"),n=h.length?h[0]._captionSide:null,k=b(c[0].cloneNode(!1)),q=b(c[0].cloneNode(!1)),l=c.children("tfoot");d.sX&&"100%"===c.attr("width")&&c.removeAttr("width");l.length||(l=null);d=b("<div/>",{"class":g.sScrollWrapper}).append(b("<div/>",{"class":g.sScrollHead}).css({overflow:"hidden",position:"relative",border:0,width:f?f?X(f):null:"100%"}).append(b("<div/>",{"class":g.sScrollHeadInner}).css({"box-sizing":"content-box",
width:d.sXInner||"100%"}).append(k.removeAttr("id").css("margin-left",0).append("top"===n?h:null).append(c.children("thead"))))).append(b("<div/>",{"class":g.sScrollBody}).css({overflow:"auto",height:m?X(m):null,width:f?X(f):null}).append(c));l&&d.append(b("<div/>",{"class":g.sScrollFoot}).css({overflow:"hidden",border:0,width:f?f?X(f):null:"100%"}).append(b("<div/>",{"class":g.sScrollFootInner}).append(q.removeAttr("id").css("margin-left",0).append("bottom"===n?h:null).append(c.children("tfoot")))));
var c=d.children(),p=c[0],g=c[1],r=l?c[2]:null;f&&b(g).scroll(function(a){a=this.scrollLeft;p.scrollLeft=a;l&&(r.scrollLeft=a)});a.nScrollHead=p;a.nScrollBody=g;a.nScrollFoot=r;a.aoDrawCallback.push({fn:Pa,sName:"scrolling"});return d[0]}function Pa(a){var c=a.oScroll,d=c.sX,f=c.sXInner,m=c.sY,g=c.iBarWidth,h=b(a.nScrollHead),n=h[0].style,k=h.children("div"),q=k[0].style,l=k.children("table"),k=a.nScrollBody,p=b(k),A=k.style,B=b(a.nScrollFoot).children("div"),u=B.children("table"),E=b(a.nTHead),t=
b(a.nTable),v=t[0],y=v.style,T=a.nTFoot?b(a.nTFoot):null,L=a.oBrowser,Y=L.bScrollOversize,V,C,H,z,I,K=[],D=[],F=[],S,la=function(a){a=a.style;a.paddingTop="0";a.paddingBottom="0";a.borderTopWidth="0";a.borderBottomWidth="0";a.height=0};t.children("thead, tfoot").remove();I=E.clone().prependTo(t);V=E.find("tr");H=I.find("tr");I.find("th, td").removeAttr("tabindex");T&&(z=T.clone().prependTo(t),C=T.find("tr"),z=z.find("tr"));d||(A.width="100%",h[0].style.width="100%");b.each(va(a,I),function(b,c){S=
r(a,b);c.style.width=a.aoColumns[S].sWidth});T&&ua(function(a){a.style.width=""},z);c.bCollapse&&""!==m&&(A.height=p[0].offsetHeight+E[0].offsetHeight+"px");h=t.outerWidth();""===d?(y.width="100%",Y&&(t.find("tbody").height()>k.offsetHeight||"scroll"==p.css("overflow-y"))&&(y.width=X(t.outerWidth()-g))):""!==f?y.width=X(f):h==p.width()&&p.height()<t.height()?(y.width=X(h-g),t.outerWidth()>h-g&&(y.width=X(h))):y.width=X(h);h=t.outerWidth();ua(la,H);ua(function(a){F.push(a.innerHTML);K.push(X(b(a).css("width")))},
H);ua(function(a,b){a.style.width=K[b]},V);b(H).height(0);T&&(ua(la,z),ua(function(a){D.push(X(b(a).css("width")))},z),ua(function(a,b){a.style.width=D[b]},C),b(z).height(0));ua(function(a,b){a.innerHTML='<div class="dataTables_sizing" style="height:0;overflow:hidden;">'+F[b]+"</div>";a.style.width=K[b]},H);T&&ua(function(a,b){a.innerHTML="";a.style.width=D[b]},z);t.outerWidth()<h?(C=k.scrollHeight>k.offsetHeight||"scroll"==p.css("overflow-y")?h+g:h,Y&&(k.scrollHeight>k.offsetHeight||"scroll"==p.css("overflow-y"))&&
(y.width=X(C-g)),""!==d&&""===f||Ga(a,1,"Possible column misalignment",6)):C="100%";A.width=X(C);n.width=X(C);T&&(a.nScrollFoot.style.width=X(C));!m&&Y&&(A.height=X(v.offsetHeight+g));m&&c.bCollapse&&(A.height=X(m),c=d&&v.offsetWidth>k.offsetWidth?g:0,v.offsetHeight<k.offsetHeight&&(A.height=X(v.offsetHeight+c)));c=t.outerWidth();l[0].style.width=X(c);q.width=X(c);l=t.height()>k.clientHeight||"scroll"==p.css("overflow-y");L="padding"+(L.bScrollbarLeft?"Left":"Right");q[L]=l?g+"px":"0px";T&&(u[0].style.width=
X(c),B[0].style.width=X(c),B[0].style[L]=l?g+"px":"0px");p.scroll();!a.bSorted&&!a.bFiltered||a._drawHold||(k.scrollTop=0)}function ua(a,b,c){for(var d=0,f=0,m=b.length,g,h;f<m;){g=b[f].firstChild;for(h=c?c[f].firstChild:null;g;)1===g.nodeType&&(c?a(g,h,d):a(g,d),d++),g=g.nextSibling,h=c?h.nextSibling:null;f++}}function Ca(a){var d=a.nTable,f=a.aoColumns,m=a.oScroll,g=m.sY,h=m.sX,n=m.sXInner,q=f.length,m=F(a,"bVisible"),l=b("th",a.nTHead),p=d.getAttribute("width"),r=d.parentNode,A=!1,B,u;for(B=0;B<
m.length;B++)u=f[m[B]],null!==u.sWidth&&(u.sWidth=pb(u.sWidthOrig,r),A=!0);if(A||h||g||q!=z(a)||q!=l.length){q=b(d).clone().empty().css("visibility","hidden").removeAttr("id").append(b(a.nTHead).clone(!1)).append(b(a.nTFoot).clone(!1)).append(b("<tbody><tr/></tbody>"));q.find("tfoot th, tfoot td").css("width","");var E=q.find("tbody tr"),l=va(a,q.find("thead")[0]);for(B=0;B<m.length;B++)u=f[m[B]],l[B].style.width=null!==u.sWidthOrig&&""!==u.sWidthOrig?X(u.sWidthOrig):"";if(a.aoData.length)for(B=0;B<
m.length;B++)A=m[B],u=f[A],b(Gb(a,A)).clone(!1).append(u.sContentPadding).appendTo(E);q.appendTo(r);h&&n?q.width(n):h?(q.css("width","auto"),q.width()<r.offsetWidth&&q.width(r.offsetWidth)):g?q.width(r.offsetWidth):p&&q.width(p);Fb(a,q[0]);if(h){for(B=n=0;B<m.length;B++)u=f[m[B]],g=b(l[B]).outerWidth(),n+=null===u.sWidthOrig?g:parseInt(u.sWidth,10)+g-b(l[B]).width();q.width(X(n));d.style.width=X(n)}for(B=0;B<m.length;B++)if(u=f[m[B]],g=b(l[B]).width())u.sWidth=X(g);d.style.width=X(q.css("width"));
q.remove()}else for(B=0;B<q;B++)f[B].sWidth=X(l.eq(B).width());p&&(d.style.width=X(p));!p&&!h||a._reszEvt||(b(k).bind("resize.DT-"+a.sInstance,Ea(function(){c(a)})),a._reszEvt=!0)}function Ea(b,c){var d=c!==a?c:200,f,m;return function(){var c=this,g=+new Date,h=arguments;f&&g<f+d?(clearTimeout(m),m=setTimeout(function(){f=a;b.apply(c,h)},d)):f?(f=g,b.apply(c,h)):f=g}}function pb(a,c){if(!a)return 0;var d=b("<div/>").css("width",X(a)).appendTo(c||l.body),f=d[0].offsetWidth;d.remove();return f}function Fb(a,
c){var d=a.oScroll;if(d.sX||d.sY)d=d.sX?0:d.iBarWidth,c.style.width=X(b(c).outerWidth()-d)}function Gb(a,c){var d=qb(a,c);if(0>d)return null;var f=a.aoData[d];return f.nTr?f.anCells[c]:b("<td/>").html(M(a,d,c,"display"))[0]}function qb(a,b){for(var c,d=-1,f=-1,m=0,g=a.aoData.length;m<g;m++)c=M(a,m,b,"display")+"",c=c.replace(Sb,""),c.length>d&&(d=c.length,f=m);return f}function X(a){return null===a?"0px":"number"==typeof a?0>a?"0px":a+"px":a.match(/\d$/)?a+"px":a}function rb(){if(!G.__scrollbarWidth){var a=
b("<p/>").css({width:"100%",height:200,padding:0})[0],c=b("<div/>").css({position:"absolute",top:0,left:0,width:200,height:150,padding:0,overflow:"hidden",visibility:"hidden"}).append(a).appendTo("body"),d=a.offsetWidth;c.css("overflow","scroll");a=a.offsetWidth;d===a&&(a=c[0].clientWidth);c.remove();G.__scrollbarWidth=d-a}return G.__scrollbarWidth}function Ia(c){var d,f,m=[],g=c.aoColumns,h,n,k,q;d=c.aaSortingFixed;f=b.isPlainObject(d);var l=[];h=function(a){a.length&&!b.isArray(a[0])?l.push(a):
l.push.apply(l,a)};b.isArray(d)&&h(d);f&&d.pre&&h(d.pre);h(c.aaSorting);f&&d.post&&h(d.post);for(c=0;c<l.length;c++)for(q=l[c][0],h=g[q].aDataSort,d=0,f=h.length;d<f;d++)n=h[d],k=g[n].sType||"string",l[c]._idx===a&&(l[c]._idx=b.inArray(l[c][1],g[n].asSorting)),m.push({src:q,col:n,dir:l[c][1],index:l[c]._idx,type:k,formatter:G.ext.type.order[k+"-pre"]});return m}function Hb(a){var b,c,d=[],f=G.ext.type.order,m=a.aoData,g=0,h,n=a.aiDisplayMaster,k;H(a);k=Ia(a);b=0;for(c=k.length;b<c;b++)h=k[b],h.formatter&&
g++,Jb(a,h.col);if("ssp"!=pa(a)&&0!==k.length){b=0;for(c=n.length;b<c;b++)d[n[b]]=b;g===k.length?n.sort(function(a,b){var c,f,g,h,n=k.length,q=m[a]._aSortData,w=m[b]._aSortData;for(g=0;g<n;g++)if(h=k[g],c=q[h.col],f=w[h.col],c=c<f?-1:c>f?1:0,0!==c)return"asc"===h.dir?c:-c;c=d[a];f=d[b];return c<f?-1:c>f?1:0}):n.sort(function(a,b){var c,g,h,n,q=k.length,w=m[a]._aSortData,l=m[b]._aSortData;for(h=0;h<q;h++)if(n=k[h],c=w[n.col],g=l[n.col],n=f[n.type+"-"+n.dir]||f["string-"+n.dir],c=n(c,g),0!==c)return c;
c=d[a];g=d[b];return c<g?-1:c>g?1:0})}a.bSorted=!0}function Ib(a){var b,c,d=a.aoColumns,f=Ia(a);a=a.oLanguage.oAria;for(var m=0,g=d.length;m<g;m++){c=d[m];var h=c.asSorting;b=c.sTitle.replace(/<.*?>/g,"");var n=c.nTh;n.removeAttribute("aria-sort");c.bSortable&&(0<f.length&&f[0].col==m?(n.setAttribute("aria-sort","asc"==f[0].dir?"ascending":"descending"),c=h[f[0].index+1]||h[0]):c=h[0],b+="asc"===c?a.sSortAscending:a.sSortDescending);n.setAttribute("aria-label",b)}}function sb(c,d,f,m){var g=c.aaSorting,
h=c.aoColumns[d].asSorting,n=function(c,d){var f=c._idx;f===a&&(f=b.inArray(c[1],h));return f+1<h.length?f+1:d?null:0};"number"===typeof g[0]&&(g=c.aaSorting=[g]);f&&c.oFeatures.bSortMulti?(f=b.inArray(d,ya(g,"0")),-1!==f?(d=n(g[f],!0),null===d?g.splice(f,1):(g[f][1]=h[d],g[f]._idx=d)):(g.push([d,h[0],0]),g[g.length-1]._idx=0)):g.length&&g[0][0]==d?(d=n(g[0]),g.length=1,g[0][1]=h[d],g[0]._idx=d):(g.length=0,g.push([d,h[0]]),g[0]._idx=0);ma(c);"function"==typeof m&&m(c)}function eb(a,b,c,d){var f=
a.aoColumns[c];tb(b,{},function(b){!1!==f.bSortable&&(a.oFeatures.bProcessing?(Z(a,!0),setTimeout(function(){sb(a,c,b.shiftKey,d);"ssp"!==pa(a)&&Z(a,!1)},0)):sb(a,c,b.shiftKey,d))})}function ab(a){var c=a.aLastSort,d=a.oClasses.sSortColumn,f=Ia(a),m=a.oFeatures,g,h;if(m.bSort&&m.bSortClasses){m=0;for(g=c.length;m<g;m++)h=c[m].src,b(ya(a.aoData,"anCells",h)).removeClass(d+(2>m?m+1:3));m=0;for(g=f.length;m<g;m++)h=f[m].src,b(ya(a.aoData,"anCells",h)).addClass(d+(2>m?m+1:3))}a.aLastSort=f}function Jb(a,
b){var c=a.aoColumns[b],d=G.ext.order[c.sSortDataType],f;d&&(f=d.call(a.oInstance,a,b,y(a,b)));for(var m,g=G.ext.type.order[c.sType+"-pre"],h=0,n=a.aoData.length;h<n;h++)if(c=a.aoData[h],c._aSortData||(c._aSortData=[]),!c._aSortData[b]||d)m=d?f[h]:M(a,h,b,"sort"),c._aSortData[b]=g?g(m):m}function qa(a){if(a.oFeatures.bStateSave&&!a.bDestroying){var c={time:+new Date,start:a._iDisplayStart,length:a._iDisplayLength,order:b.extend(!0,[],a.aaSorting),search:nb(a.oPreviousSearch),columns:b.map(a.aoColumns,
function(b,c){return{visible:b.bVisible,search:nb(a.aoPreSearchCols[c])}})};da(a,"aoStateSaveParams","stateSaveParams",[a,c]);a.oSavedState=c;a.fnStateSaveCallback.call(a.oInstance,a,c)}}function Ra(a,c){var d,f,m=a.aoColumns;if(a.oFeatures.bStateSave){var g=a.fnStateLoadCallback.call(a.oInstance,a);if(g&&g.time&&(d=da(a,"aoStateLoadParams","stateLoadParams",[a,g]),-1===b.inArray(!1,d)&&(d=a.iStateDuration,!(0<d&&g.time<+new Date-1E3*d)&&m.length===g.columns.length))){a.oLoadedState=b.extend(!0,{},
g);a._iDisplayStart=g.start;a.iInitDisplayStart=g.start;a._iDisplayLength=g.length;a.aaSorting=[];b.each(g.order,function(b,c){a.aaSorting.push(c[0]>=m.length?[0,c[1]]:c)});b.extend(a.oPreviousSearch,ob(g.search));d=0;for(f=g.columns.length;d<f;d++){var h=g.columns[d];m[d].bVisible=h.visible;b.extend(a.aoPreSearchCols[d],ob(h.search))}da(a,"aoStateLoaded","stateLoaded",[a,g])}}}function Qa(a){var c=G.settings;a=b.inArray(a,ya(c,"nTable"));return-1!==a?c[a]:null}function Ga(a,b,c,d){c="DataTables warning: "+
(null!==a?"table id="+a.sTableId+" - ":"")+c;d&&(c+=". For more information about this error, please see http://datatables.net/tn/"+d);if(b)k.console&&console.log&&console.log(c);else if(a=G.ext,"alert"==(a.sErrMode||a.errMode))alert(c);else throw Error(c);}function oa(c,d,f,m){b.isArray(f)?b.each(f,function(a,f){b.isArray(f)?oa(c,d,f[0],f[1]):oa(c,d,f)}):(m===a&&(m=f),d[f]!==a&&(c[m]=d[f]))}function Sa(a,c,d){var f,m;for(m in c)c.hasOwnProperty(m)&&(f=c[m],b.isPlainObject(f)?(b.isPlainObject(a[m])||
(a[m]={}),b.extend(!0,a[m],f)):d&&"data"!==m&&"aaData"!==m&&b.isArray(f)?a[m]=f.slice():a[m]=f);return a}function tb(a,c,d){b(a).bind("click.DT",c,function(b){a.blur();d(b)}).bind("keypress.DT",c,function(a){13===a.which&&(a.preventDefault(),d(a))}).bind("selectstart.DT",function(){return!1})}function ja(a,b,c,d){c&&a[b].push({fn:c,sName:d})}function da(a,c,d,f){var m=[];c&&(m=b.map(a[c].slice().reverse(),function(b,c){return b.fn.apply(a.oInstance,f)}));null!==d&&b(a.nTable).trigger(d+".dt",f);return m}
function ub(a){var b=a._iDisplayStart,c=a.fnDisplayEnd(),d=a._iDisplayLength;b>=c&&(b=c-d);b-=b%d;if(-1===d||0>b)b=0;a._iDisplayStart=b}function fb(a,c){var d=a.renderer,f=G.ext.renderer[c];return b.isPlainObject(d)&&d[c]?f[d[c]]||f._:"string"===typeof d?f[d]||f._:f._}function pa(a){return a.oFeatures.bServerSide?"ssp":a.ajax||a.sAjaxSource?"ajax":"dom"}function Fa(a,b){var c=[],c=Xb.numbers_length,d=Math.floor(c/2);b<=c?c=Ka(0,b):a<=d?(c=Ka(0,c-2),c.push("ellipsis"),c.push(b-1)):(a>=b-1-d?c=Ka(b-
(c-2),b):(c=Ka(a-1,a+2),c.push("ellipsis"),c.push(b-1)),c.splice(0,0,"ellipsis"),c.splice(0,0,0));c.DT_el="span";return c}function Wa(a){b.each({num:function(b){return Cb(b,a)},"num-fmt":function(b){return Cb(b,a,Da)},"html-num":function(b){return Cb(b,a,Na)},"html-num-fmt":function(b){return Cb(b,a,Na,Da)}},function(b,c){ka.type.order[b+a+"-pre"]=c;b.match(/^html\-/)&&(ka.type.search[b+a]=ka.type.search.html)})}function Kb(a){return function(){var b=[Qa(this[G.ext.iApiIndex])].concat(Array.prototype.slice.call(arguments));
return G.ext.internal[a].apply(this,b)}}var G,ka,W,Q,ba,Ja={},Lb=/[\r\n]/g,Na=/<.*?>/g,Qb=/^[\w\+\-]/,vb=/[\w\+\-]$/,wb=/(\/|\.|\*|\+|\?|\||\(|\)|\[|\]|\{|\}|\\|\$|\^|\-)/g,Da=/[',$\u00a3\u20ac\u00a5%\u2009\u202F]/g,na=function(a){return a&&!0!==a&&"-"!==a?!1:!0},Mb=function(a){var b=parseInt(a,10);return!isNaN(b)&&isFinite(a)?b:null},xb=function(a,b){Ja[b]||(Ja[b]=new RegExp(cb(b),"g"));return"string"===typeof a&&"."!==b?a.replace(/\./g,"").replace(Ja[b],"."):a},yb=function(a,b,c){var d="string"===
typeof a;b&&d&&(a=xb(a,b));c&&d&&(a=a.replace(Da,""));return na(a)||!isNaN(parseFloat(a))&&isFinite(a)},Nb=function(a,b,c){return na(a)?!0:na(a)||"string"===typeof a?yb(a.replace(Na,""),b,c)?!0:null:null},ya=function(b,c,d){var f=[],m=0,g=b.length;if(d!==a)for(;m<g;m++)b[m]&&b[m][c]&&f.push(b[m][c][d]);else for(;m<g;m++)b[m]&&f.push(b[m][c]);return f},Oa=function(b,c,d,f){var m=[],g=0,h=c.length;if(f!==a)for(;g<h;g++)b[c[g]][d]&&m.push(b[c[g]][d][f]);else for(;g<h;g++)m.push(b[c[g]][d]);return m},
Ka=function(b,c){var d=[],f;c===a?(c=0,f=b):(f=c,c=b);for(var m=c;m<f;m++)d.push(m);return d},bb=function(a){for(var b=[],c=0,d=a.length;c<d;c++)a[c]&&b.push(a[c]);return b},gb=function(a){var b=[],c,d,f=a.length,m,g=0;d=0;a:for(;d<f;d++){c=a[d];for(m=0;m<g;m++)if(b[m]===c)continue a;b.push(c);g++}return b},ha=function(b,c,d){b[c]!==a&&(b[d]=b[c])},Xa=/\[.*?\]$/,La=/\(\)$/,Ya=b("<div>")[0],Rb=Ya.textContent!==a,Sb=/<.*?>/g;G=function(c){this.$=function(a,b){return this.api(!0).$(a,b)};this._=function(a,
b){return this.api(!0).rows(a,b).data()};this.api=function(a){return a?new W(Qa(this[ka.iApiIndex])):new W(this)};this.fnAddData=function(c,d){var f=this.api(!0),m=b.isArray(c)&&(b.isArray(c[0])||b.isPlainObject(c[0]))?f.rows.add(c):f.row.add(c);(d===a||d)&&f.draw();return m.flatten().toArray()};this.fnAdjustColumnSizing=function(b){var c=this.api(!0).columns.adjust(),d=c.settings()[0],f=d.oScroll;b===a||b?c.draw(!1):""===f.sX&&""===f.sY||Pa(d)};this.fnClearTable=function(b){var c=this.api(!0).clear();
(b===a||b)&&c.draw()};this.fnClose=function(a){this.api(!0).row(a).child.hide()};this.fnDeleteRow=function(b,c,d){var f=this.api(!0);b=f.rows(b);var m=b.settings()[0],g=m.aoData[b[0][0]];b.remove();c&&c.call(this,m,g);(d===a||d)&&f.draw();return g};this.fnDestroy=function(a){this.api(!0).destroy(a)};this.fnDraw=function(a){this.api(!0).draw(!a)};this.fnFilter=function(b,c,d,f,m,g){m=this.api(!0);null===c||c===a?m.search(b,d,f,g):m.column(c).search(b,d,f,g);m.draw()};this.fnGetData=function(b,c){var d=
this.api(!0);if(b!==a){var f=b.nodeName?b.nodeName.toLowerCase():"";return c!==a||"td"==f||"th"==f?d.cell(b,c).data():d.row(b).data()||null}return d.data().toArray()};this.fnGetNodes=function(b){var c=this.api(!0);return b!==a?c.row(b).node():c.rows().nodes().flatten().toArray()};this.fnGetPosition=function(a){var b=this.api(!0),c=a.nodeName.toUpperCase();return"TR"==c?b.row(a).index():"TD"==c||"TH"==c?(a=b.cell(a).index(),[a.row,a.columnVisible,a.column]):null};this.fnIsOpen=function(a){return this.api(!0).row(a).child.isShown()};
this.fnOpen=function(a,b,c){return this.api(!0).row(a).child(b,c).show().child()[0]};this.fnPageChange=function(b,c){var d=this.api(!0).page(b);(c===a||c)&&d.draw(!1)};this.fnSetColumnVis=function(b,c,d){b=this.api(!0).column(b).visible(c);(d===a||d)&&b.columns.adjust().draw()};this.fnSettings=function(){return Qa(this[ka.iApiIndex])};this.fnSort=function(a){this.api(!0).order(a).draw()};this.fnSortListener=function(a,b,c){this.api(!0).order.listener(a,b,c)};this.fnUpdate=function(b,c,d,f,m){var g=
this.api(!0);d===a||null===d?g.row(c).data(b):g.cell(c,d).data(b);(m===a||m)&&g.columns.adjust();(f===a||f)&&g.draw();return 0};this.fnVersionCheck=ka.fnVersionCheck;var d=this,m=c===a,k=this.length;m&&(c={});this.oApi=this.internal=ka.internal;for(var l in G.ext.internal)l&&(this[l]=Kb(l));this.each(function(){var l={},l=1<k?Sa(l,c,!0):c,p=0,r,A=this.getAttribute("id"),B=!1,E=G.defaults;if("table"!=this.nodeName.toLowerCase())Ga(null,0,"Non-table node initialisation ("+this.nodeName+")",2);else{q(E);
h(E.column);f(E,E,!0);f(E.column,E.column,!0);f(E,l);var t=G.settings,p=0;for(r=t.length;p<r;p++){if(t[p].nTable==this){r=l.bRetrieve!==a?l.bRetrieve:E.bRetrieve;if(m||r)return t[p].oInstance;if(l.bDestroy!==a?l.bDestroy:E.bDestroy){t[p].oInstance.fnDestroy();break}else{Ga(t[p],0,"Cannot reinitialise DataTable",3);return}}if(t[p].sTableId==this.id){t.splice(p,1);break}}if(null===A||""===A)this.id=A="DataTables_Table_"+G.ext._unique++;var y=b.extend(!0,{},G.models.oSettings,{nTable:this,oApi:d.internal,
oInit:l,sDestroyWidth:b(this)[0].style.width,sInstance:A,sTableId:A});t.push(y);y.oInstance=1===d.length?d:b(this).dataTable();q(l);l.oLanguage&&g(l.oLanguage);l.aLengthMenu&&!l.iDisplayLength&&(l.iDisplayLength=b.isArray(l.aLengthMenu[0])?l.aLengthMenu[0][0]:l.aLengthMenu[0]);l=Sa(b.extend(!0,{},E),l);oa(y.oFeatures,l,"bPaginate bLengthChange bFilter bSort bSortMulti bInfo bProcessing bAutoWidth bSortClasses bServerSide bDeferRender".split(" "));oa(y,l,["asStripeClasses","ajax","fnServerData","fnFormatNumber",
"sServerMethod","aaSorting","aaSortingFixed","aLengthMenu","sPaginationType","sAjaxSource","sAjaxDataProp","iStateDuration","sDom","bSortCellsTop","iTabIndex","fnStateLoadCallback","fnStateSaveCallback","renderer","searchDelay",["iCookieDuration","iStateDuration"],["oSearch","oPreviousSearch"],["aoSearchCols","aoPreSearchCols"],["iDisplayLength","_iDisplayLength"],["bJQueryUI","bJUI"]]);oa(y.oScroll,l,[["sScrollX","sX"],["sScrollXInner","sXInner"],["sScrollY","sY"],["bScrollCollapse","bCollapse"]]);
oa(y.oLanguage,l,"fnInfoCallback");ja(y,"aoDrawCallback",l.fnDrawCallback,"user");ja(y,"aoServerParams",l.fnServerParams,"user");ja(y,"aoStateSaveParams",l.fnStateSaveParams,"user");ja(y,"aoStateLoadParams",l.fnStateLoadParams,"user");ja(y,"aoStateLoaded",l.fnStateLoaded,"user");ja(y,"aoRowCallback",l.fnRowCallback,"user");ja(y,"aoRowCreatedCallback",l.fnCreatedRow,"user");ja(y,"aoHeaderCallback",l.fnHeaderCallback,"user");ja(y,"aoFooterCallback",l.fnFooterCallback,"user");ja(y,"aoInitComplete",l.fnInitComplete,
"user");ja(y,"aoPreDrawCallback",l.fnPreDrawCallback,"user");A=y.oClasses;l.bJQueryUI?(b.extend(A,G.ext.oJUIClasses,l.oClasses),l.sDom===E.sDom&&"lfrtip"===E.sDom&&(y.sDom='<"H"lfr>t<"F"ip>'),y.renderer)?b.isPlainObject(y.renderer)&&!y.renderer.header&&(y.renderer.header="jqueryui"):y.renderer="jqueryui":b.extend(A,G.ext.classes,l.oClasses);b(this).addClass(A.sTable);if(""!==y.oScroll.sX||""!==y.oScroll.sY)y.oScroll.iBarWidth=rb();!0===y.oScroll.sX&&(y.oScroll.sX="100%");y.iInitDisplayStart===a&&
(y.iInitDisplayStart=l.iDisplayStart,y._iDisplayStart=l.iDisplayStart);null!==l.iDeferLoading&&(y.bDeferLoading=!0,p=b.isArray(l.iDeferLoading),y._iRecordsDisplay=p?l.iDeferLoading[0]:l.iDeferLoading,y._iRecordsTotal=p?l.iDeferLoading[1]:l.iDeferLoading);var L=y.oLanguage;b.extend(!0,L,l.oLanguage);""!==L.sUrl&&(b.ajax({dataType:"json",url:L.sUrl,success:function(a){g(a);f(E.oLanguage,a);b.extend(!0,L,a);Ua(y)},error:function(){Ua(y)}}),B=!0);null===l.asStripeClasses&&(y.asStripeClasses=[A.sStripeOdd,
A.sStripeEven]);var p=y.asStripeClasses,Y=b("tbody tr:eq(0)",this);-1!==b.inArray(!0,b.map(p,function(a,b){return Y.hasClass(a)}))&&(b("tbody tr",this).removeClass(p.join(" ")),y.asDestroyStripes=p.slice());var t=[],C,p=this.getElementsByTagName("thead");0!==p.length&&(ea(y.aoHeader,p[0]),t=va(y));if(null===l.aoColumns)for(C=[],p=0,r=t.length;p<r;p++)C.push(null);else C=l.aoColumns;p=0;for(r=C.length;p<r;p++)n(y,t?t[p]:null);K(y,l.aoColumnDefs,C,function(a,b){u(y,a,b)});if(Y.length){var V=function(a,
b){return a.getAttribute("data-"+b)?b:null};b.each(T(y,Y[0]).cells,function(b,c){var d=y.aoColumns[b];if(d.mData===b){var f=V(c,"sort")||V(c,"order"),m=V(c,"filter")||V(c,"search");if(null!==f||null!==m)d.mData={_:b+".display",sort:null!==f?b+".@data-"+f:a,type:null!==f?b+".@data-"+f:a,filter:null!==m?b+".@data-"+m:a},u(y,b)}})}var H=y.oFeatures;l.bStateSave&&(H.bStateSave=!0,Ra(y,l),ja(y,"aoDrawCallback",qa,"state_save"));if(l.aaSorting===a)for(t=y.aaSorting,p=0,r=t.length;p<r;p++)t[p][1]=y.aoColumns[p].asSorting[0];
ab(y);H.bSort&&ja(y,"aoDrawCallback",function(){if(y.bSorted){var a=Ia(y),c={};b.each(a,function(a,b){c[b.src]=b.dir});da(y,null,"order",[y,a,c]);Ib(y)}});ja(y,"aoDrawCallback",function(){(y.bSorted||"ssp"===pa(y)||H.bDeferRender)&&ab(y)},"sc");v(y);p=b(this).children("caption").each(function(){this._captionSide=b(this).css("caption-side")});r=b(this).children("thead");0===r.length&&(r=b("<thead/>").appendTo(this));y.nTHead=r[0];r=b(this).children("tbody");0===r.length&&(r=b("<tbody/>").appendTo(this));
y.nTBody=r[0];r=b(this).children("tfoot");0===r.length&&0<p.length&&(""!==y.oScroll.sX||""!==y.oScroll.sY)&&(r=b("<tfoot/>").appendTo(this));0===r.length||0===r.children().length?b(this).addClass(A.sNoFooter):0<r.length&&(y.nTFoot=r[0],ea(y.aoFooter,y.nTFoot));if(l.aaData)for(p=0;p<l.aaData.length;p++)D(y,l.aaData[p]);else(y.bDeferLoading||"dom"==pa(y))&&J(y,b(y.nTBody).children("tr"));y.aiDisplay=y.aiDisplayMaster.slice();y.bInitialised=!0;!1===B&&Ua(y)}});d=null;return this};var Ob=[],fa=Array.prototype,
Tb=function(a){var c,d,f=G.settings,m=b.map(f,function(a,b){return a.nTable});if(a){if(a.nTable&&a.oApi)return[a];if(a.nodeName&&"table"===a.nodeName.toLowerCase())return c=b.inArray(a,m),-1!==c?[f[c]]:null;if(a&&"function"===typeof a.settings)return a.settings().toArray();"string"===typeof a?d=b(a):a instanceof b&&(d=a)}else return[];if(d)return d.map(function(a){c=b.inArray(this,m);return-1!==c?f[c]:null}).toArray()};W=function(a,c){if(!this instanceof W)throw"DT API must be constructed as a new object";
var d=[],f=function(a){(a=Tb(a))&&d.push.apply(d,a)};if(b.isArray(a))for(var m=0,g=a.length;m<g;m++)f(a[m]);else f(a);this.context=gb(d);c&&this.push.apply(this,c.toArray?c.toArray():c);this.selector={rows:null,cols:null,opts:null};W.extend(this,this,Ob)};G.Api=W;W.prototype={concat:fa.concat,context:[],each:function(a){for(var b=0,c=this.length;b<c;b++)a.call(this,this[b],b,this);return this},eq:function(a){var b=this.context;return b.length>a?new W(b[a],this[a]):null},filter:function(a){var b=[];
if(fa.filter)b=fa.filter.call(this,a,this);else for(var c=0,d=this.length;c<d;c++)a.call(this,this[c],c,this)&&b.push(this[c]);return new W(this.context,b)},flatten:function(){var a=[];return new W(this.context,a.concat.apply(a,this.toArray()))},join:fa.join,indexOf:fa.indexOf||function(a,b){for(var c=b||0,d=this.length;c<d;c++)if(this[c]===a)return c;return-1},iterator:function(b,c,d,f){var m=[],g,h,n,k,q,l=this.context,p,r,A=this.selector;"string"===typeof b&&(f=d,d=c,c=b,b=!1);h=0;for(n=l.length;h<
n;h++){var B=new W(l[h]);if("table"===c)g=d.call(B,l[h],h),g!==a&&m.push(g);else if("columns"===c||"rows"===c)g=d.call(B,l[h],this[h],h),g!==a&&m.push(g);else if("column"===c||"column-rows"===c||"row"===c||"cell"===c)for(r=this[h],"column-rows"===c&&(p=jb(l[h],A.opts)),k=0,q=r.length;k<q;k++)g=r[k],g="cell"===c?d.call(B,l[h],g.row,g.column,h,k):d.call(B,l[h],g,h,k,p),g!==a&&m.push(g)}return m.length||f?(b=new W(l,b?m.concat.apply([],m):m),c=b.selector,c.rows=A.rows,c.cols=A.cols,c.opts=A.opts,b):
this},lastIndexOf:fa.lastIndexOf||function(a,b){return this.indexOf.apply(this.toArray.reverse(),arguments)},length:0,map:function(a){var b=[];if(fa.map)b=fa.map.call(this,a,this);else for(var c=0,d=this.length;c<d;c++)b.push(a.call(this,this[c],c));return new W(this.context,b)},pluck:function(a){return this.map(function(b){return b[a]})},pop:fa.pop,push:fa.push,reduce:fa.reduce||function(a,b){return t(this,a,b,0,this.length,1)},reduceRight:fa.reduceRight||function(a,b){return t(this,a,b,this.length-
1,-1,-1)},reverse:fa.reverse,selector:null,shift:fa.shift,sort:fa.sort,splice:fa.splice,toArray:function(){return fa.slice.call(this)},to$:function(){return b(this)},toJQuery:function(){return b(this)},unique:function(){return new W(this.context,gb(this))},unshift:fa.unshift};W.extend=function(a,c,d){if(c&&(c instanceof W||c.__dt_wrapper)){var f,m,g,h=function(a,b,c){return function(){var d=b.apply(a,arguments);W.extend(d,d,c.methodExt);return d}};f=0;for(m=d.length;f<m;f++)g=d[f],c[g.name]="function"===
typeof g.val?h(a,g.val,g):b.isPlainObject(g.val)?{}:g.val,c[g.name].__dt_wrapper=!0,W.extend(a,c[g.name],g.propExt)}};W.register=Q=function(a,c){if(b.isArray(a))for(var d=0,f=a.length;d<f;d++)W.register(a[d],c);else for(var m=a.split("."),g=Ob,h,n,d=0,f=m.length;d<f;d++){h=(n=-1!==m[d].indexOf("()"))?m[d].replace("()",""):m[d];var k;a:{k=0;for(var q=g.length;k<q;k++)if(g[k].name===h){k=g[k];break a}k=null}k||(k={name:h,val:{},methodExt:[],propExt:[]},g.push(k));d===f-1?k.val=c:g=n?k.methodExt:k.propExt}};
W.registerPlural=ba=function(c,d,f){W.register(c,f);W.register(d,function(){var c=f.apply(this,arguments);return c===this?this:c instanceof W?c.length?b.isArray(c[0])?new W(c.context,c[0]):c[0]:a:c})};var Za=function(a,c){if("number"===typeof a)return[c[a]];var d=b.map(c,function(a,b){return a.nTable});return b(d).filter(a).map(function(a){a=b.inArray(this,d);return c[a]}).toArray()};Q("tables()",function(a){return a?new W(Za(a,this.context)):this});Q("table()",function(a){a=this.tables(a);var b=
a.context;return b.length?new W(b[0]):a});ba("tables().nodes()","table().node()",function(){return this.iterator("table",function(a){return a.nTable},1)});ba("tables().body()","table().body()",function(){return this.iterator("table",function(a){return a.nTBody},1)});ba("tables().header()","table().header()",function(){return this.iterator("table",function(a){return a.nTHead},1)});ba("tables().footer()","table().footer()",function(){return this.iterator("table",function(a){return a.nTFoot},1)});ba("tables().containers()",
"table().container()",function(){return this.iterator("table",function(a){return a.nTableWrapper},1)});Q("draw()",function(a){return this.iterator("table",function(b){ma(b,!1===a)})});Q("page()",function(b){return b===a?this.page.info().page:this.iterator("table",function(a){Ba(a,b)})});Q("page.info()",function(b){if(0===this.context.length)return a;b=this.context[0];var c=b._iDisplayStart,d=b._iDisplayLength,f=b.fnRecordsDisplay(),m=-1===d;return{page:m?0:Math.floor(c/d),pages:m?1:Math.ceil(f/d),
start:c,end:b.fnDisplayEnd(),length:d,recordsTotal:b.fnRecordsTotal(),recordsDisplay:f}});Q("page.len()",function(b){return b===a?0!==this.context.length?this.context[0]._iDisplayLength:a:this.iterator("table",function(a){ia(a,b)})});var zb=function(a,b,c){"ssp"==pa(a)?ma(a,b):(Z(a,!0),wa(a,[],function(c){A(a);c=ra(a,c);for(var d=0,f=c.length;d<f;d++)D(a,c[d]);ma(a,b);Z(a,!1)}));if(c){var d=new W(a);d.one("draw",function(){c(d.ajax.json())})}};Q("ajax.json()",function(){var a=this.context;if(0<a.length)return a[0].json});
Q("ajax.params()",function(){var a=this.context;if(0<a.length)return a[0].oAjaxData});Q("ajax.reload()",function(a,b){return this.iterator("table",function(c){zb(c,!1===b,a)})});Q("ajax.url()",function(c){var d=this.context;if(c===a){if(0===d.length)return a;d=d[0];return d.ajax?b.isPlainObject(d.ajax)?d.ajax.url:d.ajax:d.sAjaxSource}return this.iterator("table",function(a){b.isPlainObject(a.ajax)?a.ajax.url=c:a.ajax=c})});Q("ajax.url().load()",function(a,b){return this.iterator("table",function(c){zb(c,
!1===b,a)})});var $a=function(c,d){var f=[],m,g,h,n,k,q;m=typeof c;c&&"string"!==m&&"function"!==m&&c.length!==a||(c=[c]);h=0;for(n=c.length;h<n;h++)for(g=c[h]&&c[h].split?c[h].split(","):[c[h]],k=0,q=g.length;k<q;k++)(m=d("string"===typeof g[k]?b.trim(g[k]):g[k]))&&m.length&&f.push.apply(f,m);return f},hb=function(a){a||(a={});a.filter&&!a.search&&(a.search=a.filter);return{search:a.search||"none",order:a.order||"current",page:a.page||"all"}},ib=function(a){for(var b=0,c=a.length;b<c;b++)if(0<a[b].length)return a[0]=
a[b],a.length=1,a.context=[a.context[b]],a;a.length=0;return a},jb=function(a,c){var d,f,m,g=[],h=a.aiDisplay;d=a.aiDisplayMaster;var n=c.search;f=c.order;m=c.page;if("ssp"==pa(a))return"removed"===n?[]:Ka(0,d.length);if("current"==m)for(d=a._iDisplayStart,f=a.fnDisplayEnd();d<f;d++)g.push(h[d]);else if("current"==f||"applied"==f)g="none"==n?d.slice():"applied"==n?h.slice():b.map(d,function(a,c){return-1===b.inArray(a,h)?a:null});else if("index"==f||"original"==f)for(d=0,f=a.aoData.length;d<f;d++)"none"==
n?g.push(d):(m=b.inArray(d,h),(-1===m&&"removed"==n||0<=m&&"applied"==n)&&g.push(d));return g},Ub=function(a,c,d){return $a(c,function(c){var f=Mb(c);if(null!==f&&!d)return[f];var m=jb(a,d);if(null!==f&&-1!==b.inArray(f,m))return[f];if(!c)return m;if("function"===typeof c)return b.map(m,function(b){var d=a.aoData[b];return c(b,d._aData,d.nTr)?b:null});f=bb(Oa(a.aoData,m,"nTr"));return c.nodeName&&-1!==b.inArray(c,f)?[c._DT_RowIndex]:b(f).filter(c).map(function(){return this._DT_RowIndex}).toArray()})};
Q("rows()",function(c,d){c===a?c="":b.isPlainObject(c)&&(d=c,c="");d=hb(d);var f=this.iterator("table",function(a){return Ub(a,c,d)},1);f.selector.rows=c;f.selector.opts=d;return f});Q("rows().nodes()",function(){return this.iterator("row",function(b,c){return b.aoData[c].nTr||a},1)});Q("rows().data()",function(){return this.iterator(!0,"rows",function(a,b){return Oa(a.aoData,b,"_aData")},1)});ba("rows().cache()","row().cache()",function(a){return this.iterator("row",function(b,c){var d=b.aoData[c];
return"search"===a?d._aFilterData:d._aSortData},1)});ba("rows().invalidate()","row().invalidate()",function(a){return this.iterator("row",function(b,c){E(b,c,a)})});ba("rows().indexes()","row().index()",function(){return this.iterator("row",function(a,b){return b},1)});ba("rows().remove()","row().remove()",function(){var a=this;return this.iterator("row",function(c,d,f){var m=c.aoData;m.splice(d,1);for(var g=0,h=m.length;g<h;g++)null!==m[g].nTr&&(m[g].nTr._DT_RowIndex=g);b.inArray(d,c.aiDisplay);
B(c.aiDisplayMaster,d);B(c.aiDisplay,d);B(a[f],d,!1);ub(c)})});Q("rows.add()",function(a){var b=this.iterator("table",function(b){var c,d,f,m=[];d=0;for(f=a.length;d<f;d++)c=a[d],c.nodeName&&"TR"===c.nodeName.toUpperCase()?m.push(J(b,c)[0]):m.push(D(b,c));return m},1),c=this.rows(-1);c.pop();c.push.apply(c,b.toArray());return c});Q("row()",function(a,b){return ib(this.rows(a,b))});Q("row().data()",function(b){var c=this.context;if(b===a)return c.length&&this.length?c[0].aoData[this[0]]._aData:a;c[0].aoData[this[0]]._aData=
b;E(c[0],this[0],"data");return this});Q("row().node()",function(){var a=this.context;return a.length&&this.length?a[0].aoData[this[0]].nTr||null:null});Q("row.add()",function(a){a instanceof b&&a.length&&(a=a[0]);var c=this.iterator("table",function(b){return a.nodeName&&"TR"===a.nodeName.toUpperCase()?J(b,a)[0]:D(b,a)});return this.row(c[0])});var N=function(a,c,d,f){var m=[],g=function(c,d){if(c.nodeName&&"tr"===c.nodeName.toLowerCase())m.push(c);else{var f=b("<tr><td/></tr>").addClass(d);b("td",
f).addClass(d).html(c)[0].colSpan=z(a);m.push(f[0])}};if(b.isArray(d)||d instanceof b)for(var h=0,n=d.length;h<n;h++)g(d[h],f);else g(d,f);c._details&&c._details.remove();c._details=b(m);c._detailsShow&&c._details.insertAfter(c.nTr)},Pb=function(b,c){var d=b.context;d.length&&(d=d[0].aoData[c!==a?c:b[0]],d._details&&(d._details.remove(),d._detailsShow=a,d._details=a))},Vb=function(a,b){var c=a.context;if(c.length&&a.length){var d=c[0].aoData[a[0]];d._details&&((d._detailsShow=b)?d._details.insertAfter(d.nTr):
d._details.detach(),Yb(c[0]))}},Yb=function(a){var b=new W(a),c=a.aoData;b.off("draw.dt.DT_details column-visibility.dt.DT_details destroy.dt.DT_details");0<ya(c,"_details").length&&(b.on("draw.dt.DT_details",function(d,f){a===f&&b.rows({page:"current"}).eq(0).each(function(a){a=c[a];a._detailsShow&&a._details.insertAfter(a.nTr)})}),b.on("column-visibility.dt.DT_details",function(b,d,f,m){if(a===d)for(d=z(d),f=0,m=c.length;f<m;f++)b=c[f],b._details&&b._details.children("td[colspan]").attr("colspan",
d)}),b.on("destroy.dt.DT_details",function(d,f){if(a===f)for(var m=0,g=c.length;m<g;m++)c[m]._details&&Pb(b,m)}))};Q("row().child()",function(b,c){var d=this.context;if(b===a)return d.length&&this.length?d[0].aoData[this[0]]._details:a;!0===b?this.child.show():!1===b?Pb(this):d.length&&this.length&&N(d[0],d[0].aoData[this[0]],b,c);return this});Q(["row().child.show()","row().child().show()"],function(a){Vb(this,!0);return this});Q(["row().child.hide()","row().child().hide()"],function(){Vb(this,!1);
return this});Q(["row().child.remove()","row().child().remove()"],function(){Pb(this);return this});Q("row().child.isShown()",function(){var a=this.context;return a.length&&this.length?a[0].aoData[this[0]]._detailsShow||!1:!1});var Zb=/^(.+):(name|visIdx|visible)$/,Wb=function(a,b,c,d,f){c=[];d=0;for(var m=f.length;d<m;d++)c.push(M(a,f[d],b));return c},$b=function(a,c,d){var f=a.aoColumns,m=ya(f,"sName"),g=ya(f,"nTh");return $a(c,function(c){var h=Mb(c);if(""===c)return Ka(f.length);if(null!==h)return[0<=
h?h:f.length+h];if("function"===typeof c){var n=jb(a,d);return b.map(f,function(b,d){return c(d,Wb(a,d,0,0,n),g[d])?d:null})}var k="string"===typeof c?c.match(Zb):"";if(k)switch(k[2]){case "visIdx":case "visible":h=parseInt(k[1],10);if(0>h){var q=b.map(f,function(a,b){return a.bVisible?b:null});return[q[q.length+h]]}return[r(a,h)];case "name":return b.map(m,function(a,b){return a===k[1]?b:null})}else return b(g).filter(c).map(function(){return b.inArray(this,g)}).toArray()})};Q("columns()",function(c,
d){c===a?c="":b.isPlainObject(c)&&(d=c,c="");d=hb(d);var f=this.iterator("table",function(a){return $b(a,c,d)},1);f.selector.cols=c;f.selector.opts=d;return f});ba("columns().header()","column().header()",function(a,b){return this.iterator("column",function(a,b){return a.aoColumns[b].nTh},1)});ba("columns().footer()","column().footer()",function(a,b){return this.iterator("column",function(a,b){return a.aoColumns[b].nTf},1)});ba("columns().data()","column().data()",function(){return this.iterator("column-rows",
Wb,1)});ba("columns().dataSrc()","column().dataSrc()",function(){return this.iterator("column",function(a,b){return a.aoColumns[b].mData},1)});ba("columns().cache()","column().cache()",function(a){return this.iterator("column-rows",function(b,c,d,f,m){return Oa(b.aoData,m,"search"===a?"_aFilterData":"_aSortData",c)},1)});ba("columns().nodes()","column().nodes()",function(){return this.iterator("column-rows",function(a,b,c,d,f){return Oa(a.aoData,f,"anCells",b)},1)});ba("columns().visible()","column().visible()",
function(d,f){return this.iterator("column",function(m,g){if(d===a)return m.aoColumns[g].bVisible;var h=m.aoColumns,n=h[g],k=m.aoData,q,l,p;if(d!==a&&n.bVisible!==d){if(d){var r=b.inArray(!0,ya(h,"bVisible"),g+1);q=0;for(l=k.length;q<l;q++)p=k[q].nTr,h=k[q].anCells,p&&p.insertBefore(h[g],h[r]||null)}else b(ya(m.aoData,"anCells",g)).detach();n.bVisible=d;aa(m,m.aoHeader);aa(m,m.aoFooter);if(f===a||f)c(m),(m.oScroll.sX||m.oScroll.sY)&&Pa(m);da(m,null,"column-visibility",[m,g,d]);qa(m)}})});ba("columns().indexes()",
"column().index()",function(a){return this.iterator("column",function(b,c){return"visible"===a?y(b,c):c},1)});Q("columns.adjust()",function(){return this.iterator("table",function(a){c(a)},1)});Q("column.index()",function(a,b){if(0!==this.context.length){var c=this.context[0];if("fromVisible"===a||"toData"===a)return r(c,b);if("fromData"===a||"toVisible"===a)return y(c,b)}});Q("column()",function(a,b){return ib(this.columns(a,b))});var ac=function(c,d,f){var m=c.aoData,g=jb(c,f);f=bb(Oa(m,g,"anCells"));
var h=b([].concat.apply([],f)),n,k=c.aoColumns.length,q,l,p,r,A,B;return $a(d,function(d){var f="function"===typeof d;if(null===d||d===a||f){q=[];l=0;for(p=g.length;l<p;l++)for(n=g[l],r=0;r<k;r++)A={row:n,column:r},f?(B=c.aoData[n],d(A,M(c,n,r),B.anCells[r])&&q.push(A)):q.push(A);return q}return b.isPlainObject(d)?[d]:h.filter(d).map(function(a,c){n=c.parentNode._DT_RowIndex;return{row:n,column:b.inArray(c,m[n].anCells)}}).toArray()})};Q("cells()",function(c,d,f){b.isPlainObject(c)&&(typeof c.row!==
a?(f=d,d=null):(f=c,c=null));b.isPlainObject(d)&&(f=d,d=null);if(null===d||d===a)return this.iterator("table",function(a){return ac(a,c,hb(f))});var m=this.columns(d,f),g=this.rows(c,f),h,n,k,q,l,p=this.iterator("table",function(a,b){h=[];n=0;for(k=g[b].length;n<k;n++)for(q=0,l=m[b].length;q<l;q++)h.push({row:g[b][n],column:m[b][q]});return h},1);b.extend(p.selector,{cols:d,rows:c,opts:f});return p});ba("cells().nodes()","cell().node()",function(){return this.iterator("cell",function(b,c,d){return(b=
b.aoData[c].anCells)?b[d]:a},1)});Q("cells().data()",function(){return this.iterator("cell",function(a,b,c){return M(a,b,c)},1)});ba("cells().cache()","cell().cache()",function(a){a="search"===a?"_aFilterData":"_aSortData";return this.iterator("cell",function(b,c,d){return b.aoData[c][a][d]},1)});ba("cells().render()","cell().render()",function(a){return this.iterator("cell",function(b,c,d){return M(b,c,d,a)},1)});ba("cells().indexes()","cell().index()",function(){return this.iterator("cell",function(a,
b,c){return{row:b,column:c,columnVisible:y(a,c)}},1)});ba("cells().invalidate()","cell().invalidate()",function(a){return this.iterator("cell",function(b,c,d){E(b,c,a,d)})});Q("cell()",function(a,b,c){return ib(this.cells(a,b,c))});Q("cell().data()",function(b){var c=this.context,d=this[0];if(b===a)return c.length&&d.length?M(c[0],d[0].row,d[0].column):a;C(c[0],d[0].row,d[0].column,b);E(c[0],d[0].row,"data",d[0].column);return this});Q("order()",function(c,d){var f=this.context;if(c===a)return 0!==
f.length?f[0].aaSorting:a;"number"===typeof c?c=[[c,d]]:b.isArray(c[0])||(c=Array.prototype.slice.call(arguments));return this.iterator("table",function(a){a.aaSorting=c.slice()})});Q("order.listener()",function(a,b,c){return this.iterator("table",function(d){eb(d,a,b,c)})});Q(["columns().order()","column().order()"],function(a){var c=this;return this.iterator("table",function(d,f){var m=[];b.each(c[f],function(b,c){m.push([c,a])});d.aaSorting=m})});Q("search()",function(c,d,f,m){var g=this.context;
return c===a?0!==g.length?g[0].oPreviousSearch.sSearch:a:this.iterator("table",function(a){a.oFeatures.bFilter&&U(a,b.extend({},a.oPreviousSearch,{sSearch:c+"",bRegex:null===d?!1:d,bSmart:null===f?!0:f,bCaseInsensitive:null===m?!0:m}),1)})});ba("columns().search()","column().search()",function(c,d,f,m){return this.iterator("column",function(g,h){var n=g.aoPreSearchCols;if(c===a)return n[h].sSearch;g.oFeatures.bFilter&&(b.extend(n[h],{sSearch:c+"",bRegex:null===d?!1:d,bSmart:null===f?!0:f,bCaseInsensitive:null===
m?!0:m}),U(g,g.oPreviousSearch,1))})});Q("state()",function(){return this.context.length?this.context[0].oSavedState:null});Q("state.clear()",function(){return this.iterator("table",function(a){a.fnStateSaveCallback.call(a.oInstance,a,{})})});Q("state.loaded()",function(){return this.context.length?this.context[0].oLoadedState:null});Q("state.save()",function(){return this.iterator("table",function(a){qa(a)})});G.versionCheck=G.fnVersionCheck=function(a){var b=G.version.split(".");a=a.split(".");
for(var c,d,f=0,m=a.length;f<m;f++)if(c=parseInt(b[f],10)||0,d=parseInt(a[f],10)||0,c!==d)return c>d;return!0};G.isDataTable=G.fnIsDataTable=function(a){var c=b(a).get(0),d=!1;b.each(G.settings,function(a,b){if(b.nTable===c||b.nScrollHead===c||b.nScrollFoot===c)d=!0});return d};G.tables=G.fnTables=function(a){return b.map(G.settings,function(c){if(!a||a&&b(c.nTable).is(":visible"))return c.nTable})};G.util={throttle:Ea,escapeRegex:cb};G.camelToHungarian=f;Q("$()",function(a,c){var d=this.rows(c).nodes(),
d=b(d);return b([].concat(d.filter(a).toArray(),d.find(a).toArray()))});b.each(["on","one","off"],function(a,c){Q(c+"()",function(){var a=Array.prototype.slice.call(arguments);a[0].match(/\.dt\b/)||(a[0]+=".dt");var d=b(this.tables().nodes());d[c].apply(d,a);return this})});Q("clear()",function(){return this.iterator("table",function(a){A(a)})});Q("settings()",function(){return new W(this.context,this.context)});Q("data()",function(){return this.iterator("table",function(a){return ya(a.aoData,"_aData")}).flatten()});
Q("destroy()",function(a){a=a||!1;return this.iterator("table",function(c){var d=c.nTableWrapper.parentNode,f=c.oClasses,m=c.nTable,g=c.nTBody,h=c.nTHead,n=c.nTFoot,q=b(m),g=b(g),l=b(c.nTableWrapper),p=b.map(c.aoData,function(a){return a.nTr}),r;c.bDestroying=!0;da(c,"aoDestroyCallback","destroy",[c]);a||(new W(c)).columns().visible(!0);l.unbind(".DT").find(":not(tbody *)").unbind(".DT");b(k).unbind(".DT-"+c.sInstance);m!=h.parentNode&&(q.children("thead").detach(),q.append(h));n&&m!=n.parentNode&&
(q.children("tfoot").detach(),q.append(n));q.detach();l.detach();c.aaSorting=[];c.aaSortingFixed=[];ab(c);b(p).removeClass(c.asStripeClasses.join(" "));b("th, td",h).removeClass(f.sSortable+" "+f.sSortableAsc+" "+f.sSortableDesc+" "+f.sSortableNone);c.bJUI&&(b("th span."+f.sSortIcon+", td span."+f.sSortIcon,h).detach(),b("th, td",h).each(function(){var a=b("div."+f.sSortJUIWrapper,this);b(this).append(a.contents());a.detach()}));!a&&d&&d.insertBefore(m,c.nTableReinsertBefore);g.children().detach();
g.append(p);q.css("width",c.sDestroyWidth).removeClass(f.sTable);(r=c.asDestroyStripes.length)&&g.children().each(function(a){b(this).addClass(c.asDestroyStripes[a%r])});d=b.inArray(c,G.settings);-1!==d&&G.settings.splice(d,1)})});G.version="1.10.4";G.settings=[];G.models={};G.models.oSearch={bCaseInsensitive:!0,sSearch:"",bRegex:!1,bSmart:!0};G.models.oRow={nTr:null,anCells:null,_aData:[],_aSortData:null,_aFilterData:null,_sFilterRow:null,_sRowStripe:"",src:null};G.models.oColumn={idx:null,aDataSort:null,
asSorting:null,bSearchable:null,bSortable:null,bVisible:null,_sManualType:null,_bAttrSrc:!1,fnCreatedCell:null,fnGetData:null,fnSetData:null,mData:null,mRender:null,nTh:null,nTf:null,sClass:null,sContentPadding:null,sDefaultContent:null,sName:null,sSortDataType:"std",sSortingClass:null,sSortingClassJUI:null,sTitle:null,sType:null,sWidth:null,sWidthOrig:null};G.defaults={aaData:null,aaSorting:[[0,"asc"]],aaSortingFixed:[],ajax:null,aLengthMenu:[10,25,50,100],aoColumns:null,aoColumnDefs:null,aoSearchCols:[],
asStripeClasses:null,bAutoWidth:!0,bDeferRender:!1,bDestroy:!1,bFilter:!0,bInfo:!0,bJQueryUI:!1,bLengthChange:!0,bPaginate:!0,bProcessing:!1,bRetrieve:!1,bScrollCollapse:!1,bServerSide:!1,bSort:!0,bSortMulti:!0,bSortCellsTop:!1,bSortClasses:!0,bStateSave:!1,fnCreatedRow:null,fnDrawCallback:null,fnFooterCallback:null,fnFormatNumber:function(a){return a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,this.oLanguage.sThousands)},fnHeaderCallback:null,fnInfoCallback:null,fnInitComplete:null,fnPreDrawCallback:null,
fnRowCallback:null,fnServerData:null,fnServerParams:null,fnStateLoadCallback:function(a){try{return JSON.parse((-1===a.iStateDuration?sessionStorage:localStorage).getItem("DataTables_"+a.sInstance+"_"+location.pathname))}catch(b){}},fnStateLoadParams:null,fnStateLoaded:null,fnStateSaveCallback:function(a,b){try{(-1===a.iStateDuration?sessionStorage:localStorage).setItem("DataTables_"+a.sInstance+"_"+location.pathname,JSON.stringify(b))}catch(c){}},fnStateSaveParams:null,iStateDuration:7200,iDeferLoading:null,
iDisplayLength:10,iDisplayStart:0,iTabIndex:0,oClasses:{},oLanguage:{oAria:{sSortAscending:": activate to sort column ascending",sSortDescending:": activate to sort column descending"},oPaginate:{sFirst:"First",sLast:"Last",sNext:"Next",sPrevious:"Previous"},sEmptyTable:"No data available in table",sInfo:"Showing _START_ to _END_ of _TOTAL_ entries",sInfoEmpty:"Showing 0 to 0 of 0 entries",sInfoFiltered:"(filtered from _MAX_ total entries)",sInfoPostFix:"",sDecimal:"",sThousands:",",sLengthMenu:"Show _MENU_ entries",
sLoadingRecords:"Loading...",sProcessing:"Processing...",sSearch:"Search:",sSearchPlaceholder:"",sUrl:"",sZeroRecords:"No matching records found"},oSearch:b.extend({},G.models.oSearch),sAjaxDataProp:"data",sAjaxSource:null,sDom:"lfrtip",searchDelay:null,sPaginationType:"simple_numbers",sScrollX:"",sScrollXInner:"",sScrollY:"",sServerMethod:"GET",renderer:null};d(G.defaults);G.defaults.column={aDataSort:null,iDataSort:-1,asSorting:["asc","desc"],bSearchable:!0,bSortable:!0,bVisible:!0,fnCreatedCell:null,
mData:null,mRender:null,sCellType:"td",sClass:"",sContentPadding:"",sDefaultContent:null,sName:"",sSortDataType:"std",sTitle:null,sType:null,sWidth:null};d(G.defaults.column);G.models.oSettings={oFeatures:{bAutoWidth:null,bDeferRender:null,bFilter:null,bInfo:null,bLengthChange:null,bPaginate:null,bProcessing:null,bServerSide:null,bSort:null,bSortMulti:null,bSortClasses:null,bStateSave:null},oScroll:{bCollapse:null,iBarWidth:0,sX:null,sXInner:null,sY:null},oLanguage:{fnInfoCallback:null},oBrowser:{bScrollOversize:!1,
bScrollbarLeft:!1},ajax:null,aanFeatures:[],aoData:[],aiDisplay:[],aiDisplayMaster:[],aoColumns:[],aoHeader:[],aoFooter:[],oPreviousSearch:{},aoPreSearchCols:[],aaSorting:null,aaSortingFixed:[],asStripeClasses:null,asDestroyStripes:[],sDestroyWidth:0,aoRowCallback:[],aoHeaderCallback:[],aoFooterCallback:[],aoDrawCallback:[],aoRowCreatedCallback:[],aoPreDrawCallback:[],aoInitComplete:[],aoStateSaveParams:[],aoStateLoadParams:[],aoStateLoaded:[],sTableId:"",nTable:null,nTHead:null,nTFoot:null,nTBody:null,
nTableWrapper:null,bDeferLoading:!1,bInitialised:!1,aoOpenRows:[],sDom:null,searchDelay:null,sPaginationType:"two_button",iStateDuration:0,aoStateSave:[],aoStateLoad:[],oSavedState:null,oLoadedState:null,sAjaxSource:null,sAjaxDataProp:null,bAjaxDataGet:!0,jqXHR:null,json:a,oAjaxData:a,fnServerData:null,aoServerParams:[],sServerMethod:null,fnFormatNumber:null,aLengthMenu:null,iDraw:0,bDrawing:!1,iDrawError:-1,_iDisplayLength:10,_iDisplayStart:0,_iRecordsTotal:0,_iRecordsDisplay:0,bJUI:null,oClasses:{},
bFiltered:!1,bSorted:!1,bSortCellsTop:null,oInit:null,aoDestroyCallback:[],fnRecordsTotal:function(){return"ssp"==pa(this)?1*this._iRecordsTotal:this.aiDisplayMaster.length},fnRecordsDisplay:function(){return"ssp"==pa(this)?1*this._iRecordsDisplay:this.aiDisplay.length},fnDisplayEnd:function(){var a=this._iDisplayLength,b=this._iDisplayStart,c=b+a,d=this.aiDisplay.length,f=this.oFeatures,m=f.bPaginate;return f.bServerSide?!1===m||-1===a?b+d:Math.min(b+a,this._iRecordsDisplay):!m||c>d||-1===a?d:c},
oInstance:null,sInstance:null,iTabIndex:0,nScrollHead:null,nScrollFoot:null,aLastSort:[],oPlugins:{}};G.ext=ka={classes:{},errMode:"alert",feature:[],search:[],internal:{},legacy:{ajax:null},pager:{},renderer:{pageButton:{},header:{}},order:{},type:{detect:[],search:{},order:{}},_unique:0,fnVersionCheck:G.fnVersionCheck,iApiIndex:0,oJUIClasses:{},sVersion:G.version};b.extend(ka,{afnFiltering:ka.search,aTypes:ka.type.detect,ofnSearch:ka.type.search,oSort:ka.type.order,afnSortData:ka.order,aoFeatures:ka.feature,
oApi:ka.internal,oStdClasses:ka.classes,oPagination:ka.pager});b.extend(G.ext.classes,{sTable:"dataTable",sNoFooter:"no-footer",sPageButton:"paginate_button",sPageButtonActive:"current",sPageButtonDisabled:"disabled",sStripeOdd:"odd",sStripeEven:"even",sRowEmpty:"dataTables_empty",sWrapper:"dataTables_wrapper",sFilter:"dataTables_filter",sInfo:"dataTables_info",sPaging:"dataTables_paginate paging_",sLength:"dataTables_length",sProcessing:"dataTables_processing",sSortAsc:"sorting_asc",sSortDesc:"sorting_desc",
sSortable:"sorting",sSortableAsc:"sorting_asc_disabled",sSortableDesc:"sorting_desc_disabled",sSortableNone:"sorting_disabled",sSortColumn:"sorting_",sFilterInput:"",sLengthSelect:"",sScrollWrapper:"dataTables_scroll",sScrollHead:"dataTables_scrollHead",sScrollHeadInner:"dataTables_scrollHeadInner",sScrollBody:"dataTables_scrollBody",sScrollFoot:"dataTables_scrollFoot",sScrollFootInner:"dataTables_scrollFootInner",sHeaderTH:"",sFooterTH:"",sSortJUIAsc:"",sSortJUIDesc:"",sSortJUI:"",sSortJUIAscAllowed:"",
sSortJUIDescAllowed:"",sSortJUIWrapper:"",sSortIcon:"",sJUIHeader:"",sJUIFooter:""});(function(){var a="",a="",c=a+"ui-state-default",d=a+"css_right ui-icon ui-icon-",a=a+"fg-toolbar ui-toolbar ui-widget-header ui-helper-clearfix";b.extend(G.ext.oJUIClasses,G.ext.classes,{sPageButton:"fg-button ui-button "+c,sPageButtonActive:"ui-state-disabled",sPageButtonDisabled:"ui-state-disabled",sPaging:"dataTables_paginate fg-buttonset ui-buttonset fg-buttonset-multi ui-buttonset-multi paging_",sSortAsc:c+
" sorting_asc",sSortDesc:c+" sorting_desc",sSortable:c+" sorting",sSortableAsc:c+" sorting_asc_disabled",sSortableDesc:c+" sorting_desc_disabled",sSortableNone:c+" sorting_disabled",sSortJUIAsc:d+"triangle-1-n",sSortJUIDesc:d+"triangle-1-s",sSortJUI:d+"carat-2-n-s",sSortJUIAscAllowed:d+"carat-1-n",sSortJUIDescAllowed:d+"carat-1-s",sSortJUIWrapper:"DataTables_sort_wrapper",sSortIcon:"DataTables_sort_icon",sScrollHead:"dataTables_scrollHead "+c,sScrollFoot:"dataTables_scrollFoot "+c,sHeaderTH:c,sFooterTH:c,
sJUIHeader:a+" ui-corner-tl ui-corner-tr",sJUIFooter:a+" ui-corner-bl ui-corner-br"})})();var Xb=G.ext.pager;b.extend(Xb,{simple:function(a,b){return["previous","next"]},full:function(a,b){return["first","previous","next","last"]},simple_numbers:function(a,b){return["previous",Fa(a,b),"next"]},full_numbers:function(a,b){return["first","previous",Fa(a,b),"next","last"]},_numbers:Fa,numbers_length:7});b.extend(!0,G.ext.renderer,{pageButton:{_:function(a,c,d,f,m,g){var h=a.oClasses,n=a.oLanguage.oPaginate,
k,q,p=0,r=function(c,f){var l,A,B,u,E=function(b){Ba(a,b.data.action,!0)};l=0;for(A=f.length;l<A;l++)if(u=f[l],b.isArray(u))B=b("<"+(u.DT_el||"div")+"/>").appendTo(c),r(B,u);else{q=k="";switch(u){case "ellipsis":c.append("<span>&hellip;</span>");break;case "first":k=n.sFirst;q=u+(0<m?"":" "+h.sPageButtonDisabled);break;case "previous":k=n.sPrevious;q=u+(0<m?"":" "+h.sPageButtonDisabled);break;case "next":k=n.sNext;q=u+(m<g-1?"":" "+h.sPageButtonDisabled);break;case "last":k=n.sLast;q=u+(m<g-1?"":
" "+h.sPageButtonDisabled);break;default:k=u+1,q=m===u?h.sPageButtonActive:""}k&&(B=b("<a>",{"class":h.sPageButton+" "+q,"aria-controls":a.sTableId,"data-dt-idx":p,tabindex:a.iTabIndex,id:0===d&&"string"===typeof u?a.sTableId+"_"+u:null}).html(k).appendTo(c),tb(B,{action:u},E),p++)}};try{var A=b(l.activeElement).data("dt-idx");r(b(c).empty(),f);null!==A&&b(c).find("[data-dt-idx="+A+"]").focus()}catch(B){}}}});b.extend(G.ext.type.detect,[function(a,b){var c=b.oLanguage.sDecimal;return yb(a,c)?"num"+
c:null},function(a,b){if(!(!a||a instanceof Date||Qb.test(a)&&vb.test(a)))return null;var c=Date.parse(a);return null!==c&&!isNaN(c)||na(a)?"date":null},function(a,b){var c=b.oLanguage.sDecimal;return yb(a,c,!0)?"num-fmt"+c:null},function(a,b){var c=b.oLanguage.sDecimal;return Nb(a,c)?"html-num"+c:null},function(a,b){var c=b.oLanguage.sDecimal;return Nb(a,c,!0)?"html-num-fmt"+c:null},function(a,b){return na(a)||"string"===typeof a&&-1!==a.indexOf("<")?"html":null}]);b.extend(G.ext.type.search,{html:function(a){return na(a)?
a:"string"===typeof a?a.replace(Lb," ").replace(Na,""):""},string:function(a){return na(a)?a:"string"===typeof a?a.replace(Lb," "):a}});var Cb=function(a,b,c,d){if(0!==a&&(!a||"-"===a))return-Infinity;b&&(a=xb(a,b));a.replace&&(c&&(a=a.replace(c,"")),d&&(a=a.replace(d,"")));return 1*a};b.extend(ka.type.order,{"date-pre":function(a){return Date.parse(a)||0},"html-pre":function(a){return na(a)?"":a.replace?a.replace(/<.*?>/g,"").toLowerCase():a+""},"string-pre":function(a){return na(a)?"":"string"===
typeof a?a.toLowerCase():a.toString?a.toString():""},"string-asc":function(a,b){return a<b?-1:a>b?1:0},"string-desc":function(a,b){return a<b?1:a>b?-1:0}});Wa("");b.extend(!0,G.ext.renderer,{header:{_:function(a,c,d,f){b(a.nTable).on("order.dt.DT",function(b,m,g,h){a===m&&(b=d.idx,c.removeClass(d.sSortingClass+" "+f.sSortAsc+" "+f.sSortDesc).addClass("asc"==h[b]?f.sSortAsc:"desc"==h[b]?f.sSortDesc:d.sSortingClass))})},jqueryui:function(a,c,d,f){b("<div/>").addClass(f.sSortJUIWrapper).append(c.contents()).append(b("<span/>").addClass(f.sSortIcon+
" "+d.sSortingClassJUI)).appendTo(c);b(a.nTable).on("order.dt.DT",function(b,m,g,h){a===m&&(b=d.idx,c.removeClass(f.sSortAsc+" "+f.sSortDesc).addClass("asc"==h[b]?f.sSortAsc:"desc"==h[b]?f.sSortDesc:d.sSortingClass),c.find("span."+f.sSortIcon).removeClass(f.sSortJUIAsc+" "+f.sSortJUIDesc+" "+f.sSortJUI+" "+f.sSortJUIAscAllowed+" "+f.sSortJUIDescAllowed).addClass("asc"==h[b]?f.sSortJUIAsc:"desc"==h[b]?f.sSortJUIDesc:d.sSortingClassJUI))})}}});G.render={number:function(a,b,c,d){return{display:function(f){var m=
0>f?"-":"";f=Math.abs(parseFloat(f));var g=parseInt(f,10);f=c?b+(f-g).toFixed(c).substring(2):"";return m+(d||"")+g.toString().replace(/\B(?=(\d{3})+(?!\d))/g,a)+f}}}};b.extend(G.ext.internal,{_fnExternApiFunc:Kb,_fnBuildAjax:wa,_fnAjaxUpdate:za,_fnAjaxParameters:xa,_fnAjaxUpdateDraw:Ma,_fnAjaxDataSrc:ra,_fnAddColumn:n,_fnColumnOptions:u,_fnAdjustColumnSizing:c,_fnVisibleToColumnIndex:r,_fnColumnIndexToVisible:y,_fnVisbleColumns:z,_fnGetColumns:F,_fnColumnTypes:H,_fnApplyColumnDefs:K,_fnHungarianMap:d,
_fnCamelToHungarian:f,_fnLanguageCompat:g,_fnBrowserDetect:v,_fnAddData:D,_fnAddTr:J,_fnNodeToDataIndex:function(b,c){return c._DT_RowIndex!==a?c._DT_RowIndex:null},_fnNodeToColumnIndex:function(a,c,d){return b.inArray(d,a.aoData[c].anCells)},_fnGetCellData:M,_fnSetCellData:C,_fnSplitObjNotation:L,_fnGetObjectDataFn:I,_fnSetObjectDataFn:S,_fnGetDataMaster:m,_fnClearTable:A,_fnDeleteIndex:B,_fnInvalidate:E,_fnGetRowElements:T,_fnCreateTr:V,_fnBuildHead:la,_fnDrawHead:aa,_fnDraw:R,_fnReDraw:ma,_fnAddOptionsHtml:ga,
_fnDetectHeader:ea,_fnGetUniqueThs:va,_fnFeatureHtmlFilter:ca,_fnFilterComplete:U,_fnFilterCustom:p,_fnFilterColumn:Aa,_fnFilter:lb,_fnFilterCreateSearch:mb,_fnEscapeRegex:cb,_fnFilterData:Ha,_fnFeatureHtmlInfo:Ab,_fnUpdateInfo:Ta,_fnInfoMacros:Eb,_fnInitialise:Ua,_fnInitComplete:db,_fnLengthChange:ia,_fnFeatureHtmlLength:kb,_fnFeatureHtmlPaginate:Va,_fnPageChange:Ba,_fnFeatureHtmlProcessing:O,_fnProcessingDisplay:Z,_fnFeatureHtmlTable:Bb,_fnScrollDraw:Pa,_fnApplyToChildren:ua,_fnCalculateColumnWidths:Ca,
_fnThrottle:Ea,_fnConvertToWidth:pb,_fnScrollingWidthAdjust:Fb,_fnGetWidestNode:Gb,_fnGetMaxLenString:qb,_fnStringToCss:X,_fnScrollBarWidth:rb,_fnSortFlatten:Ia,_fnSort:Hb,_fnSortAria:Ib,_fnSortListener:sb,_fnSortAttachListener:eb,_fnSortingClasses:ab,_fnSortData:Jb,_fnSaveState:qa,_fnLoadState:Ra,_fnSettingsFromNode:Qa,_fnLog:Ga,_fnMap:oa,_fnBindAction:tb,_fnCallbackReg:ja,_fnCallbackFire:da,_fnLengthOverflow:ub,_fnRenderer:fb,_fnDataSource:pa,_fnRowAttributes:Y,_fnCalculateEnd:function(){}});b.fn.dataTable=
G;b.fn.dataTableSettings=G.settings;b.fn.dataTableExt=G.ext;b.fn.DataTable=function(a){return b(this).dataTable(a).api()};b.each(G,function(a,c){b.fn.DataTable[a]=c});return b.fn.dataTable})})(window,document);window.TOONTALK||(window.TOONTALK={});window.TOONTALK.creators_from_json={};window.TOONTALK.create_function_table=function(k){return function(){var l={};return{check_message:function(a){var b;if(a.is_box())if(b=a.get_size(),1>b)k.UTILITIES.display_message("Function birds can only respond to boxes with holes.");else if(a=a.get_hole_contents(0)){if(a.is_bird())return{box_size:b,bird:a};k.UTILITIES.display_message("Function birds can only respond to boxes with a bird in the first hole. The first hole contains "+k.UTILITIES.add_a_or_an(a.get_type_name()+"."))}else k.UTILITIES.display_message("Function birds can only respond to boxes with something in the first hole.");
else k.UTILITIES.display_message("Function birds can only respond to boxes. One was given "+k.UTILITIES.add_a_or_an(a.get_type_name()))},process_response:function(a,b,d,f,g){a&&b.widget_dropped_on_me(a,!1,void 0,g,!0,!0);d.remove(void 0,!0)},process_message:function(a,b,d,f){var g=this.check_message(a);if(g)return b=b(g.bird,g.box_size),this.process_response(b,g.bird,a,d,f),b},type_check:function(a,b,d,f){if(!a)return!0;if(!b)return k.UTILITIES.display_message("Birds for the "+d+" function can only respond to boxes with "+
k.UTILITIES.add_a_or_an(a)+" in the "+k.UTILITIES.ordinal(f)+" hole. The "+k.UTILITIES.ordinal(f)+" hole is empty."),!1;if(b.dereference().is_of_type(a))return!0;if(b.is_nest())throw{wait_for_nest_to_receive_something:b};k.UTILITIES.display_message("Birds for the "+d+" function can only respond to boxes with "+k.UTILITIES.add_a_or_an(a)+" in the "+k.UTILITIES.ordinal(f)+" hole. The "+k.UTILITIES.ordinal(f)+" hole contains "+k.UTILITIES.add_a_or_an(b.get_type_name()+"."));return!1},number_check:function(a,
b,d){return this.type_check("number",a,b,d)},n_ary_widget_function:function(a,b,d,f,g,k){var h=function(g,h){var n,k,c,q;if(1===h)return b();k=1;c=a.get_hole_contents(k).dereference();if(q=this.number_check(c,f,k)){for(k++;k<h;){n=a.get_hole_contents(k).dereference();q=this.number_check(n,f,k);if(!q)return;d.call(c,n);k++}return c}}.bind(this);return this.process_message(a,h,g,k)},n_ary_function:function(a,b,d,f,g,q){var h=function(g,h){var n,q,c,l;if(h<d+1)k.UTILITIES.display_message("Birds for the "+
f+" function can only respond to boxes with at least "+(d+1)+" holes. Not "+h+" holes.");else{c=[];for(q=1;q<h;){n=a.get_hole_contents(q).dereference();l=this.number_check(n,f,q);if(!l)return;c.push(n.get_value());q++}return b.apply(null,c)}}.bind(this);return this.process_message(a,h,g,q)},typed_bird_function:function(a,b,d,f,g,q,h){var l=function(h,n){var q,c,l,y;if(0<=f&&n!=f+1)k.UTILITIES.display_message("Birds for the "+g+" function can only respond to boxes with "+(f+1)+" holes. Not "+n+" holes.");
else{l=[];for(c=1;c<n;){q=a.get_hole_contents(c).dereference();c<=d.length&&(y=d[c-1]);if(!this.type_check(y,q,g,c))return;l.push(q);c++}return b.apply(null,l)}}.bind(this);return this.process_message(a,l,q,h)},numeric_javascript_function_to_widget_function:function(a,b,d){return function(){var f=k.number.ZERO(k.number.function_bird_results_default_format);f.set_value_from_decimal(a.apply(null,k.UTILITIES.map_arguments(arguments,d||bigrat.toDecimal)));b&&f.set_approximate(!0);return f}},bigrat_function_to_widget_function:function(a,
b){return function(){var d=k.number.create_from_bigrat(a.apply(null,arguments));b&&d.set_approximate(!0);return d}},add_function_object:function(a,b,d,f,g){l[a]={name:a,short_name:f||a,respond_to_message:b,get_description:g?1===g.length?function(){return"If you give me a box with another bird and "+k.UTILITIES.add_a_or_an(g[0])+" then "+k.UTILITIES.lower_case_first_letter(this.title)+"\nOn my back side you can change me to compute other functions."}:function(){return"If you give me a box with another bird, "+
k.UTILITIES.conjunction(g,!0)+" then "+k.UTILITIES.lower_case_first_letter(this.title)+"\nOn my back side you can change me to compute other functions."}:function(){return"If you give me a box with another bird and some numbers then "+k.UTILITIES.lower_case_first_letter(this.title)+"\nOn my back side you can change me to compute other functions."},toString:function(){return k.UTILITIES.add_a_or_an("'"+this.name+"' function bird")},title:d}},get_function_table:function(){return l}}}}(window.TOONTALK);window.TOONTALK.widget=function(k){var l=function(a){var b=this.get_frontside&&this.get_frontside(!0);if(b)return a&&this.rerender(),b.get_element()};k.creators_from_json.top_level=function(a){a=k.widget.create_top_level_widget(a.settings);$(a.get_backside(!0).get_element()).addClass("toontalk-top-level-backside");return a};return{add_standard_widget_functionality:function(a){var b=function(){return!1},d;this.add_sides_functionality(a);this.runnable(a);this.stackable(a);this.animatable(a);this.has_title(a);
this.has_parent(a);this.has_description(a);this.has_listeners(a);this.droppable(a);this.erasable(a);a.this_and_walk_children=function(b){b(a)&&a.walk_children&&a.walk_children(b)};a.top_level_widget=function(){var a;if(d)return d;if(this.is_top_level())return this;if(d=k.UTILITIES.widget_from_jquery($(this.get_frontside_element()).closest(".toontalk-top-level-backside")))return d;if(a=this.get_parent_of_frontside()||this.get_parent_of_backside())return d=a.get_widget().top_level_widget();a=$(".toontalk-top-level-backside");
if(0<a.length)return 1<a.length&&console.log("Cannot find the top-level widget of "+this+" but found "+a.length+" top-level backsides so picked one."),d=k.UTILITIES.widget_from_jquery(a);console.log("Could not find top_level_widget of "+this+". Created one instead");return d=this.create_top_level_widget()};a.is_of_type||(a.is_of_type=function(a){return this.get_type_name()===a});a.dereference||(a.dereference=function(){return this});a.is_number||(a.is_number=b);a.is_box||(a.is_box=b);a.is_empty_hole||
(a.is_empty_hole=b);a.is_hole||(a.is_hole=b);a.is_scale||(a.is_scale=b);a.is_bird||(a.is_bird=b);a.is_nest||(a.is_nest=b);a.is_robot||(a.is_robot=b);a.is_element||(a.is_element=b);a.is_sensor||(a.is_sensor=b);a.is_function_nest||(a.is_function_nest=b);a.is_plain_text_element||(a.is_plain_text_element=b);a.is_attribute_widget||(a.is_attribute_widget=b);a.maintain_proportional_dimensions||(a.maintain_proportional_dimensions=b);a.ok_to_set_dimensions=function(){return!this.is_plain_text_element()};a.set_name&&
(a.receive_name_from_dropped=function(a){if(a.get_text&&(a=a.get_text(),this.set_name(a,!0)))return this.get_name()});!k.debugging&&!k.logging||a.to_debug_string||(a.to_debug_string=function(){var a=this.get_parent_of_frontside(),b=this._debug_id,d=this.get_description(),d=d?d+" ":"";b||(b=a&&a.id?"id of parent is "+a.id:"");return this.toString({plain_text:!0})+" ("+d+" "+(this.get_name&&this.get_name()+" "||"")+b+")"});a.is_top_level=b;a.is_widget=!0;return a},erasable:function(a){var b;a.get_erased||
(a.get_erased=function(){return b});a.set_erased||(a.set_erased=function(a,f){b=a;f&&this.rerender()});return a},add_sides_functionality:function(a){var b,d;a.get_frontside||(a.get_frontside=function(d){d&&!b&&(b=k.frontside.create(a));return b},a.save_dimensions=function(){return this.save_dimensions_of(this)},a.save_dimensions_of=function(a){var b;if(a.is_element()){if(!this.get_original_width())return;b=a.get_attribute("width");a=a.get_attribute("height")}else a=a.get_frontside_element(),b=$(a).width(),
a=$(a).height();0<b&&(this.saved_width=b);0<a&&(this.saved_height=a);return!0},a.restore_dimensions=function(){var a,b;0<this.saved_width&&(a=this.get_frontside_element(),this.ok_to_set_dimensions()?this.set_size_attributes?this.set_size_attributes(this.saved_width,this.saved_height):k.UTILITIES.set_css(a,{width:this.saved_width,height:this.saved_height}):(b={width:"",height:""},k.UTILITIES.set_css_transform(b,""),k.UTILITIES.set_css(a,b)),this.saved_height=this.saved_width=void 0)});a.get_backside||
(a.get_backside=function(a){a&&!d&&(d=this.create_backside());return d});a.set_backside||(a.set_backside=function(a){d=a});a.forget_backside||(a.forget_backside=function(){d=void 0});a.create_backside||(a.create_backside=function(){return k.backside.create(a)});return a},runnable:function(a){var b=!1,d=!1;a.get_running||(a.get_running=function(){var a=!1,d;b&&(d=this.get_backside_widgets(),0===d.length?b=!1:d.some(function(b){if(b.get_widget().get_running())return a=!0}));return a});a.is_ok_to_run||
(a.is_ok_to_run=function(){return d},a.set_ok_to_run=function(a){d=a});a.set_running||(a.set_running=function(f,g){var k=b===f,h,l;d=f;h=this.get_backside_widgets();b=f;this.get_backside()&&this.get_backside().run_status_changed(b);h.forEach(function(d){l=d.get_widget();d.is_backside()&&0<=this.backside_widgets.indexOf(l)||(l.is_robot()&&!l.being_trained?(b?(l.set_stopped(!1),l.run(a,g),l.set_ok_to_run(!0)):(l.set_stopped(!0),l.set_running(!1)),l.rerender()):l.set_running&&(!g&&d.is_backside()&&"top-level"!==
a.get_type_name()?l.set_running(f,a):l.set_running(f)))}.bind(this));this.walk_children&&this.walk_children(function(a){a.set_running&&a.set_running(b);return!0});this.is_robot()&&(b?a.get_parent_of_backside()&&(this.set_stopped(!1),this.run(a.get_parent_of_backside().get_widget(),g)):this.set_stopped(!0));k||this.rerender()});return a},droppable:function(a){a.drop_on||(a.drop_on=function(a,d,f,g){if(a.widget_dropped_on_me)return a.widget_dropped_on_me(this,d,f,g);console.log("No handler for drop of '"+
this+"' on '"+a+"'")})},stackable:function(a){var b=!1;a.get_infinite_stack||(a.get_infinite_stack=function(){return b});a.set_infinite_stack||(a.set_infinite_stack=function(d){var f=a.get_backside_element(),g=a.get_frontside_element();b=d;f&&$(f).find(".toontalk-infinite-stack-check-box").prop("checked",d);g&&(d?$(g).addClass("toontalk-infinite-stack"):$(g).removeClass("toontalk-infinite-stack"))});return a},animatable:function(a){var b;a.animate_to_widget||(b=function(a){var b=a.get_element();b&&
(a.is_backside()||$(b).is(":visible"))||(b=k.UTILITIES.find_resource_equal_to_widget(a));return b},a.animate_to_widget=function(a,f,g,k,h,l,t){var n=function(){this.animate_to_element(b(a),f,g,k,h,l,t&&Math.max(0,t-100));this.render()}.bind(this);0===t?n():setTimeout(n,100)});a.animate_to_element||(a.animate_to_element=function(a,b,g,k,h,l,t){var n=$(a).offset(),u=$(this.get_frontside_element()),c=$(a).is(".toontalk-backside");if(a&&$(a).is(":visible")){if("number"===typeof a.animation_left_offset)k=
a.animation_left_offset;else if("undefined"===typeof k||c)k=($(a).width()-u.width())*Math.random();if("number"===typeof a.animation_top_offset)h=a.animation_top_offset;else if("undefined"===typeof h||c)h=($(a).height()-u.height())*Math.random();n?(n.left+=k,n.top+=h):n={left:0,top:0};this.animate_to_absolute_position(n,b,g,l,t)}else b&&b()});a.animate_to_absolute_position||(a.animate_to_absolute_position=function(a,b,g,q,h){k.UTILITIES.animate_to_absolute_position(this.get_frontside_element(),a,b,
g,q,h)});return a},has_title:function(a){a.get_title||(a.get_title=function(){var a=this.get_type_name(),d=this.get_backside(),f=this.get_frontside_element(),g=this.get_description(),q="";$(f).is(".toontalk-top-level-resource")?q=this.can_run&&this.can_run()?this.get_running()?"Click elsewhere to stop me from running. Click on it to start me up again.":"Click to start me running. Click elsewhere to stop me.":"Drag me to a work area.":d&&d.get_element()&&$(d.get_element()).is(":visible")||(q=this.can_run&&
this.can_run()?this.get_running()?"Robots on my back are running (or waiting to run).\nTo see them click the stop sign "+k.UTILITIES.encode_HTML_for_title("<span class='toontalk-stop-sign-icon'></span>")+" and then click on me.":"There are robots on my back.\nTo see them in action click me to open my back side and then click the green flag "+k.UTILITIES.encode_HTML_for_title("<span class='toontalk-green-flag-icon'></span>")+".":"Click to see my back side.");g&&(g="I'm "+g,q=q?g+"\n"+q:g);if(this.get_erased())return this.get_title_of_erased_widget();
q=this.get_custom_title_prefix&&!$(f).is(".toontalk-top-level-resource")?this.get_custom_title_prefix()+"\n"+q:"I'm "+k.UTILITIES.add_a_or_an(a)+". "+q;q=q.trim();0>".?!".indexOf(q[q.length-1])&&(q+=".");return q});a.update_title=function(){k.UTILITIES.give_tooltip(this.get_frontside_element(),this.get_title())};return a},get_title_of_erased_widget:function(){var a=this.get_frontside_element(),b=this.get_type_name();return a&&$(a).closest(".toontalk-conditions-contents-container").is("*")?"I'm an erased "+
b+".\nI'll match with any other "+b+".":"I'm an erased "+b+".\nDusty the Vacuum can restore me to normal."},has_parent:function(a){var b=[],d,f;a.get_parent_of_frontside=function(){return d};a.get_parent_of_backside=function(){return f};a.set_parent_of_frontside=function(a,f,h){var k=d;a&&f&&(a=a.get_backside(!0));if(d===a)return;d=a;k&&!h&&!f&&k.is_backside()&&k.get_widget().remove_backside_widget(this,!1,!0);b.forEach(function(a){a(k,d)})};a.add_parent_of_frontside_change_listener=function(a){b.push(a)};
a.remove_parent_of_frontside_change_listener=function(a){a=b.indexOf(a);0<=a&&b.splice(a,1)};a.set_parent_of_backside=function(a,b,d){f&&!d&&f.is_backside()&&f.get_widget().remove_backside_widget(this,!0,!0);f=a&&b?a.get_backside(!0):a};a.closest_visible_ancestor=function(){for(var a=this;a&&!a.visible();)a=a.is_backside()?a.get_parent_of_backside():a.get_parent_of_frontside();return a||this};a.closest_visible_ancestor_or_frontside=function(){for(var a=this,b;a&&!$(a.get_frontside_element()).is(":visible");)b=
a,a.is_backside()?(a=a.get_parent_of_backside())||(a=b.get_widget()):a=a.get_parent_of_frontside();return a||this};a.ancestor_of_type=function(a){for(var b=this;b&&!b.is_of_type(a);)b=b.is_backside()?b.get_widget().get_parent_of_backside():b.get_parent_of_frontside();return b};a.has_ancestor=function(a){for(var b=this;b;){if(a===b)return!0;b=b.is_backside()?b.get_widget().get_parent_of_backside():b.get_parent_of_frontside()}return!1};a.remove_from_parent_of_frontside=function(a){d&&(d.is_backside()?
d.remove_backside_widget(this,!1,!a):d.removed_from_container&&d.removed_from_container(this,!1,a,void 0,!0))};return a},has_description:function(a){var b;a.get_description||(a.get_description=function(){return b});a.set_description||(a.set_description=function(a,f){if(b===a||!b&&""===a)return!1;b=a;f&&this.rerender();return!0});a.receive_description_from_dropped=function(a){if(a.get_text&&(a=a.get_text(),this.set_description(a,!0)))return this.get_description()}},has_name:function(a){var b;a.get_name||
(a.get_name=function(){"string"!==typeof b&&a.generate_name&&(b=a.generate_name());return b});a.set_name||(a.set_name=function(a,f){if(b===a||"string"!==typeof a)return!1;b=a;f&&this.rerender();return!0})},has_listeners:function(a){var b={};a.add_listener||(a.add_listener=function(a,f){var g=b[a];g?0>g.indexOf(f)&&g.push(f):b[a]=[f]});a.remove_listener||(a.remove_listener=function(a,f,g){if(a=b[a])if(f=a.indexOf(f),0<=f){a.splice(f,1);return}!g&&k.debugging&&console.log("Listener of type "+type_name+
" could not be removed.")});a.get_listeners||(a.get_listeners=function(a){return b[a]})},get_full_description:function(a){var b;if(this.get_erased&&this.get_erased())return a&&"conditions"===a.role?"any "+this.get_type_name():"erased "+this.get_type_name();b=this.get_description(a);a=this.toString(a);return b?a+" ("+b+")":a},remove:function(a,b){var d=this.get_backside(),f=this.get_frontside(),g=this.get_parent_of_frontside();this.get_parent_of_backside();d&&d.hide_backside();f&&(f.remove(),g&&this.remove_from_parent_of_frontside(a));
this.set_running(!1);this.set_visible(!1);this.walk_children&&!b&&this.walk_children(function(a){a.remove&&a.remove();return!0})},get_frontside_element:l,get_element:l,get_backside_element:function(a){if(a=this.get_backside&&this.get_backside(a))return a.get_element()},add_to_json:function(a,b){var d,f,g,k,h;if(a){a.view?(f=a,d=a.view,a=a.semantic):(d={},f={semantic:a,view:d});f.version=1;this.get_erased&&this.get_erased()&&(a.erased=!0);this.get_infinite_stack&&this.get_infinite_stack()&&(a.infinite_stack=
!0);this.get_running&&this.get_running()&&(a.running=!0);if(!this.get_parent_of_frontside()||this.get_parent_of_frontside().is_backside())if(k=this.get_frontside_element&&this.get_frontside_element())h=$(k).width(),$(k).is(".toontalk-plain-text-element")||0===h||(d.frontside_width=$(k).width(),d.frontside_height=$(k).height()),0!==h&&(g=$(k).position()),g&&(d.frontside_left=g.left,d.frontside_top=g.top);if(k=this.get_backside()){if(h=k.get_element())d.backside_width=$(h).width(),d.backside_height=
$(h).height(),d.backside_left||(g=$(h).position(),d.backside_left=g.left,d.backside_top=g.top,"&lt;"===$(h).find(".toontalk-settings-backside-button").html()&&(d.advanced_settings_open=!0));k.get_backside_dimensions()&&(d.backside_geometry=k.get_backside_dimensions())}!d.backside_geometry&&this.backside_geometry&&(d.backside_geometry=this.backside_geometry);a.description=this.get_description&&this.get_description();d.saved_width=this.saved_width;d.saved_height=this.saved_height;return f}console.log("get_json not defined");
return{}},add_backside_widgets_to_json:function(a,b){var d=this.get_backside_widgets(),f;0<d.length&&(a.semantic.backside_widgets=k.UTILITIES.get_json_of_array(d,b),(d=this.get_backside_widgets_json_views())&&d.forEach(function(d,k){var h;if(f=a.semantic.backside_widgets[k]){if(0<=f.widget.shared_widget_index){h=b.widgets_encountered.indexOf(b.shared_widgets[f.widget.shared_widget_index]);if(!b.json_of_widgets_encountered[h])return;h=b.json_of_widgets_encountered[h].view}else h=f.widget.view;f.is_backside?
d.backside_left&&(h.backside_left=d.backside_left,h.backside_top=d.backside_top):d.frontside_left&&(h.frontside_left=d.frontside_left,h.frontside_top=d.frontside_top)}}))},get_backside_widgets:function(){return this.backside_widgets||[]},add_backside_widget:function(a,b){var d=this.get_backside(!0),f=b?a.get_backside():a;k.debugging&&a===this?k.UTILITIES.report_internal_error("Adding a widget to a list of its backside widgets!"):(this.backside_widgets?0>this.backside_widgets.indexOf(f)&&this.backside_widgets.push(f):
this.backside_widgets=[f],b?a.set_parent_of_backside(this,!0):a.set_parent_of_frontside(this,!0),d.visible()&&(f.set_visible(!0),a.render()))},remove_all_backside_widgets:function(){if(this.backside_widgets)for(;0<this.backside_widgets.length;)this.backside_widgets[0].remove()},remove_backside_widget:function(a,b,d){this.get_backside();var f=b?a.get_backside(!0):a,g;this.backside_widgets?(g=this.backside_widgets.indexOf(f),0>g?d?k.debugging&&console.log("Warning: Probable redundant call to remove_backside_widget"):
k.UTILITIES.report_internal_error("Couldn't find a widget to remove it from backside widgets. "+f.get_widget()+" ("+f.get_widget()._debug_id+")"):(this.backside_widgets.splice(g,1),this.backside_widgets_json_views&&this.backside_widgets_json_views.splice(g,1),b?(b=a.get_parent_of_backside())&&b.get_widget()===this&&a.set_parent_of_backside(void 0,!0,!0):(b=a.get_parent_of_frontside())&&b.get_widget()===this&&a.set_parent_of_frontside(void 0,void 0,!0),f.set_visible(!1))):d?k.debugging&&console.log("remove_backside_widget called and there are no backside_widgets"):
k.UTILITIES.report_internal_error("Couldn't remove a widget from backside widgets.")},set_backside_widget_sides:function(a,b){var d=this.get_backside(),f=d&&d.visible();this.backside_widgets=a;0<a.length&&(this.get_backside()?this.get_backside().add_backside_widgets(a,b):this.backside_widgets_json_views=b,a.forEach(function(a){a&&(a.is_backside()?a.get_widget().set_parent_of_backside(this,!0):a.get_widget().set_parent_of_frontside(this,!0),a.set_visible(f))}.bind(this)))},get_backside_widgets_json_views:function(a){!this.backside_widgets_json_views&&
a&&(this.backside_widgets_json_views=[]);return this.backside_widgets_json_views},can_run:function(){var a=!1,b;this.get_backside_widgets().some(function(d){if(!d)return!1;b=d.get_widget();if(b.get_body&&!b.get_body().is_empty()||b.can_run())return a=!0});return a},add_to_copy:function(a,b){var d;this.get_erased&&this.get_erased()&&(a.set_erased||k.widget.erasable(a),a.set_erased(this.get_erased()));b&&b.just_value||(d=this.get_backside_widgets(),0<d.length&&a.set_backside_widget_sides(k.UTILITIES.copy_widget_sides(d,
b),this.get_backside_widgets_json_views()));a.set_visible(this.visible());return a},get_type_name:function(){return""},copy:function(){console.assert(!1,"copy not implemented")},add_copy_to_container:function(a,b,d){a||(a=this.copy({}));var f=this.get_frontside_element(),g=a.get_frontside_element(),q=$(f).closest(".toontalk-backside"),h=a.ok_to_set_dimensions(),l,t;0===q.length&&(q=$(".toontalk-backside"));"undefined"===typeof b&&(b=30);"undefined"===typeof d&&(d=30);l=k.UTILITIES.relative_position(f,
q.get(0));t=k.UTILITIES.widget_from_jquery(q);k.UTILITIES.set_css(g,{width:h?$(f).width():"",height:h?$(f).height():"",left:l.left+b,top:l.top+d});q.get(0).appendChild(g);t&&t.add_backside_widget(a);this.robot_in_training()&&this.robot_in_training().copied(this,a,!1);return a},visible:function(){var a=this.get_frontside();return a?a.visible():!1},set_visible:function(a){var b=this.get_frontside(a);b&&b.set_visible(a)},is_backside:function(){return!1},get_parent:function(){return this.get_parent_of_frontside()},
drag_started:function(a,b){this.robot_in_training()&&this.robot_in_training().picked_up(this,a,b)},match:function(a){console.assert(!1,"match not implemented for "+a.toString())},removed:function(a){k.UTILITIES.report_internal_error("removed not implemented")},equals_box:function(){return!1},equals_number:function(){return!1},open_backside:function(a){var b=this.get_backside(),d=a&&function(){setTimeout(a)},f=function(a,b){k.UTILITIES.set_timeout(function(){$(a).addClass("toontalk-side-appearing");
k.UTILITIES.add_one_shot_event_handler(a,"transitionend",2500,function(){$(a).removeClass("toontalk-side-appearing");d&&d()});k.UTILITIES.set_css(a,{left:l,top:t,opacity:b});this.apply_backside_geometry()}.bind(this))}.bind(this),g,q,h,l,t,n,u,c;if(b){g=b.get_element();if($(g).is(":visible"))return k.UTILITIES.highlight_element(g,void 0,1E3),d&&d(),b;if((b=this.get_parent_of_backside())&&b.is_backside())return b.get_widget().open_backside(a)}q=this.get_frontside_element();h=$(q).parent();b=$(q);if(b.is(".toontalk-top-level-resource"))d&&
d();else{for(;0<h.length&&!h.is(".toontalk-backside");)b=h,h=h.parent();b.get(0);b=this.get_backside(!0);g=b.get_element();g.toontalk_widget=this;n=$(q).offset();u=h.offset();c=h.width();u||(u={left:0,top:0});k.UTILITIES.set_css(g,{left:n.left-u.left,top:n.top-u.top,opacity:.01});h.append(g);(h=k.UTILITIES.widget_from_jquery(h))&&h.add_backside_widget(this,!0);h=this.is_element()?this.get_attribute("height"):$(q).height();q=$(g).width();l=n.left-u.left;l+q>c&&(l=Math.max(0,c-q));t=n.top-u.top+h+34;
this.is_box()&&(t+=28);f(g,"inherit");b.render();this.backside_widgets&&this.backside_widgets.forEach(function(a){a.is_backside()&&0<=this.backside_widgets.indexOf(a.get_widget())?a.hide_backside():(a.render(),a.set_visible(!0))}.bind(this));return b}},hide_backside:function(){var a=this.get_backside();a&&a.hide_backside()},apply_backside_geometry:function(){var a=this.get_backside(!0),b=a.get_element();this.backside_geometry&&b&&(k.backside.scale_backside($(b),this.backside_geometry.x_scale,this.backside_geometry.y_scale,
this.backside_geometry.original_width,this.backside_geometry.original_height),a.set_dimensions(this.backside_geometry))},robot_in_training:function(){return this.top_level_widget().robot_in_training()},robot_training_this_robot:function(){return this.top_level_widget().robot_training_this_robot()},robot_started_training:function(a){this.top_level_widget().robot_started_training(a)},robot_finished_training:function(){this.top_level_widget().robot_finished_training()},backup_all:function(a){var b=this.top_level_widget();
b&&b.save(a)},render:function(){k.DISPLAY_UPDATES.pending_update(this)},rerender:function(){this.visible()&&this.render()},hide:function(){$(this.get_frontside_element()).hide()},close_button_ok:function(a){return"top-level"!==this.get_type_name()&&!$(a).is(".toontalk-top-level-resource")&&!$(a).closest(".toontalk-conditions-panel").is("*")},get_widget:function(){return this},add_to_top_level_backside:function(a,b){var d=this.top_level_widget(),f=a.get_frontside_element(!0);d.add_backside_widget(a);
d.get_backside_element().appendChild(f);a.render();b&&this.robot_in_training()&&this.robot_in_training().dropped_on(a,d);return f},create_top_level_widget:function(a){var b=Object.create(k.widget),d=[],f=function(){return!1};a||(a={});b.is_top_level=function(){return!0};b.is_number=f;b.is_box=f;b.is_empty_hole=f;b.is_scale=f;b.is_bird=f;b.is_nest=f;b.is_robot=f;b.is_element=f;b.is_sensor=f;b.is_function_nest=f;b.is_hole=f;b.is_plain_text_element=f;b.is_attribute_widget=f;b.ok_to_set_dimensions=f;
b.get_json=function(b){b=this.get_backside(!0).get_element();b=document.defaultView.getComputedStyle(b,null).getPropertyValue("background-color");return{semantic:{type:"top_level",settings:a},view:{background_color:b}}};b.get_type_name=function(){return"top-level"};b.is_of_type=function(a){return"top-level"===a};b.toString=function(){return"top level widget"};b.get_description=function(){};b.match=function(){return"matched"};b.update_display=function(){this.backside_widgets&&this.backside_widgets.forEach(function(a){a&&
a.visible()&&a.update_display()})};b.copy=function(){return this};b.visible=function(){return!0};b.get_parent_of_frontside=function(){};b.get_parent_of_backside=function(){};b.closest_visible_ancestor=function(){return this};b.get_infinite_stack=function(){return!1};b.top_level_widget=function(){return this};if(k.debugging||k.logging)b.to_debug_string=function(){var a=$(this.get_backside_element()).offset();return"top-level widget at "+Math.round(a.left)+", "+Math.round(a.top)};b=b.add_sides_functionality(b);
b=b.runnable(b);b=b.has_parent(b);b.removed_from_container=function(a,b,d,f,k){this.robot_in_training()||this.remove_backside_widget(a,b,k)};b.widget_dropped_on_me=function(a,b,d,f,k){return this.get_backside().widget_dropped_on_me(a,b,d,f,k)};b.get_element=function(){return this.get_backside().get_element()};b.get_setting=function(b,d){"undefined"!==typeof a[b]||d||(a[b]=k.DEFAULT_SETTINGS&&k.DEFAULT_SETTINGS[b]);return a[b]};b.set_setting=function(b,d){a[b]=d};b.open_settings=function(){k.SETTINGS.open(b)};
b.robot_in_training=function(){if(0<d.length)return d[d.length-1]};b.robot_training_this_robot=function(){if(1<d.length)return d[d.length-2]};b.robot_started_training=function(a){d.push(a)};b.robot_finished_training=function(){d.pop()};b.save=function(a,b,d){var f=this.get_setting("program_name",!0),l;f&&(b||(b={}),"undefined"===typeof b.google_drive&&(b.google_drive=k.google_drive&&this.get_setting("auto_save_to_google_drive")),"undefined"===typeof b.local_storage&&(b.local_storage=this.get_setting("auto_save_to_local_storage")),
a?(b.google_drive&&!this.get_setting("google_drive_unavailable")&&(l=k.UTILITIES.get_json_top_level(this),a=k.google_drive.get_status(),"Ready"===a?(k.google_drive.upload_file(f,"json",JSON.stringify(l,k.UTILITIES.clean_JSON),d),d=void 0):k.google_drive.connection_to_google_drive_possible()&&("Need to authorize"===a?(k.UTILITIES.display_message_if_new("Unable to save to your Google Drive because you need to log in. Click on the settings icon "+k.UTILITIES.encode_HTML_for_title("<span class='toontalk-settings-icon'></span>")+
" to log in."),k.UTILITIES.display_tooltip($(".toontalk-settings-button"))):console.log("Unable to save to Google Drive because: "+a))),b.local_storage&&(l||(l=k.UTILITIES.get_json_top_level(this)),this.save_to_local_storage(l)),d&&d()):setTimeout(function(){this.save(!0,b,d)}.bind(this),100))};b.publish=function(a,b){k.publish.publish_widget(this.get_setting("program_name"),this,b,a)};b.save_to_local_storage=function(a,b){var d=this.get_setting("program_name"),f=k.UTILITIES.local_storage_program_key(d),
l=k.UTILITIES.local_storage_program_meta_data_key(d),n,u,c;b||(b=Date.now());try{u=(u=window.localStorage.getItem(l))?JSON.parse(u):{created:b},u.last_modified=b,c=JSON.stringify(a,k.UTILITIES.clean_json),u.file_size=c.length,window.localStorage.setItem(l,JSON.stringify(u)),window.localStorage.setItem(f,c),window.localStorage.setItem("toontalk-last-key",f),n=k.UTILITIES.get_all_locally_stored_program_names(),0>n.indexOf(d)&&(n.push(d),k.UTILITIES.set_all_locally_stored_program_names(n))}catch(r){d=
c?"Failed to save state to local storage since it requires "+c.length+" bytes. Error message is "+r:"Error while saving to local storage. Error message is "+r,k.UTILITIES.is_internet_explorer()?console.error(d):k.UTILITIES.display_message(d),this.last_local_storage_error=d}};b.load=function(a,d,f){var l=this.get_setting("program_name"),t=l+".json",n=k.UTILITIES.local_storage_program_key(l),u=function(a){var c;if(a)try{c=JSON.parse(a),b.remove_all_backside_widgets(),k.UTILITIES.add_backside_widgets_from_json(b,
c.semantic.backside_widgets,{json_of_shared_widgets:c.shared_widgets,shared_widgets:[],shared_html:c.shared_html}),d&&d()}catch(g){k.UTILITIES.display_message("Error encountered loading "+l+" : "+g)}else f&&f()},c=function(a){a?k.google_drive.download_file(a,u):u(window.localStorage.getItem(n))};a&&k.google_drive&&"Ready"===k.google_drive.get_status()?k.google_drive.get_toontalk_program_file(t,c):u(window.localStorage.getItem(n))};b.walk_children=function(){};b.render=function(){};b.is_widget=!0;
b.get_backside(!0).set_visible(!0);k.debugging&&(b._debug_id=k.UTILITIES.generate_unique_id(),b.debug_string="Top-level widget");return b}}}(window.TOONTALK);window.TOONTALK.backside=function(k){return{create:function(l){var a=Object.create(this),b=document.createElement("div"),d=$(b),f=1,g=1,q=document.createElement("div"),h=document.createElement("div"),v=l.get_help_URL&&l.get_help_URL(),t,n,u,c,r,y,z,F,H,K,D,J=function(a){a?($(q).addClass("toontalk-green-flag-active").removeClass("toontalk-green-flag-inactive"),$(h).addClass("toontalk-stop-sign-inactive").removeClass("toontalk-stop-sign-active")):($(q).addClass("toontalk-green-flag-inactive").removeClass("toontalk-green-flag-active"),
$(h).addClass("toontalk-stop-sign-active").removeClass("toontalk-stop-sign-inactive"))},M=function(){var a=d.width();d.height();var b,c,f;0===a?setTimeout(M,100):(a=$(h).width(),b=(b=$(z).width())?b+14:0,$(h).css({right:b}),$(q).css({right:b+a+6}),c=$(q).width(),H&&$(H).css({right:b+a+c+12}),t&&(f=$(H).width()||0,$(t).css({right:b+a+c+f+12})))};F=this.create_description_label(a,l);var C=function(){var a;a=l.get_running()?"To stop this click on the stop sign "+k.UTILITIES.encode_HTML_for_title("<span class='toontalk-stop-sign-icon'></span>"):
l.can_run()?"Click this to start this running.":"There is nothing to run on this.";k.UTILITIES.give_tooltip(q,a)},L=function(){var a;a=l.get_running()?"Click to stop this from running.":l.can_run()?"This has stopped. Click on the flag "+k.UTILITIES.encode_HTML_for_title("<span class='toontalk-green-flag-icon'></span>")+" to start running it.":"There is nothing to run here.";k.UTILITIES.give_tooltip(h,a)},I,S,m,A,B;k.TRANSLATION_ENABLED&&(v=k.UTILITIES.add_URL_parameter(v,"translate","1"));l.close_button_ok(b)&&
(S=function(b){var c=function(){a.hide_backside(b);l.robot_in_training()&&l.robot_in_training()!==l&&l.robot_in_training().backside_closed(l)},f,m;l.get_running()?(f=l.get_backside_widgets(),f.some(function(a){a=a.get_widget();if(a.is_robot())return a.finish_cycle_immediately(c),m=!0}),m||(console.log("Expected to find a robot on back of "+l),c()),d.css({opacity:1}),d.addClass("toontalk-animating-element"),d.css({opacity:0})):c();b.stopPropagation()},I=(I=l.get_description())?"the "+l.get_type_name()+
" who "+I:"the "+l.get_type_name(),z=k.UTILITIES.create_close_button(S,"Click to hide this back side of "+I+"."),b.appendChild(z));$(q).addClass("toontalk-green-flag toontalk-green-flag-inactive").click(function(a){l.can_run()?(J(!0),l.set_running(!0),L()):l.is_top_level()?k.UTILITIES.display_message("There is nothing to run."):k.UTILITIES.display_message("This "+l.get_type_name()+" has nothing to run. Add some robots on the back.");l.robot_in_training()&&l.robot_in_training().button_clicked(".toontalk-green-flag",
l);a.stopPropagation()}).on("mouseenter",L);$(h).addClass("toontalk-stop-sign toontalk-stop-sign-active").click(function(a){J(!1);l.set_running(!1);C();l.robot_in_training()&&l.robot_in_training().button_clicked(".toontalk-stop-sign",l);a.stopPropagation()}).on("mouseenter",C);b.appendChild(q);b.appendChild(h);k.UTILITIES.use_custom_tooltip(q);k.UTILITIES.use_custom_tooltip(h);v&&(B=0>v.indexOf("://"),H=document.createElement(B?"div":"a"),$(H).addClass("toontalk-help-button notranslate toontalk-widget-help-button").click(function(a){B?
(K=document.createElement("iframe"),$(K).addClass("toontalk-help-frame"),K.src=v,document.body.appendChild(D),document.body.appendChild(K),a.stopPropagation()):(H.href=v,H.target="_blank")}),H.innerHTML="i",H.translate=!1,k.UTILITIES.give_tooltip(H,"Click to learn more about "+l.get_type_name(!0,!0)+"."),D=document.createElement("div"),$(D).addClass("toontalk-close-help-frame-button").button().click(function(a){$(K).remove();$(D).remove();a.stopPropagation()}),D.innerHTML="Return to ToonTalk",b.appendChild(H));
F&&b.appendChild(F);l.is_top_level()&&(t=document.createElement("div"),$(t).addClass("toontalk-settings-button").click(function(a){l.open_settings();a.stopPropagation()}),k.UTILITIES.give_tooltip(t,"Click to change settings or open a different program."),b.appendChild(t));k.UTILITIES.set_timeout(M);d.addClass("toontalk-backside toontalk-side toontalk-backside-of-"+l.get_type_name());d.css({"z-index":k.UTILITIES.next_z_index()});a.get_element=function(){return b};a.get_backside_element=function(){return b};
a.get_widget=function(){return l};a.visible=function(){return n};a.set_visible=function(a){var b=this.get_widget().get_backside_widgets();n=a;b.forEach(function(b){b&&(b.set_visible(a),a&&b.render())})};l.get_backside||(l.get_backside=function(){return a});a.get_parent_of_backside=function(){return l.get_parent_of_backside()};a.get_parent_of_frontside=function(){return l.get_parent_of_frontside()};a.get_frontside=function(){return l.get_frontside()};a.get_frontside_element=function(){return l.get_frontside_element()};
a.get_description_text_area=function(){return m};a.set_description_text_area=function(a){m=a};a.get_name_text_input=function(){return A};a.set_name_text_input=function(a){A=a};l.removed_from_container||(l.removed_from_container=function(a,b,c,d,f){l.robot_in_training()||this.remove_backside_widget(a,b,f)});a.widget_dropped_on_me=function(a,b,c,f,m){var g,h,n;k.sounds&&c&&k.sounds.drop.play();b?(g=a.get_backside(!0),h=g.get_element(),g.rerender()):(g=a.get_frontside(!0),h=g.get_element(),a.rerender());
g=$(h);d.append(g);this.get_widget().is_top_level()&&f&&!f.visible()&&g.addClass("toontalk-widget-added-to-backside-by-unwatched-robot");k.UTILITIES.set_position_is_absolute(h,!0,c);l.robot_in_training()&&!m&&c&&setTimeout(function(){l.robot_in_training().dropped_on(a,this,c)}.bind(this));b&&"top-level"!=this.get_widget().get_type_name()&&(n=a.get_backside(),a.forget_backside(),a.remove(c),a.set_backside(n));this.add_backside_widget(a,b);a.dropped_on_other&&a.dropped_on_other(this.get_widget(),!0,
c,f);c&&a.get_body&&a.get_body().is_empty()&&!a.being_trained&&setTimeout(function(){(n=a.open_backside())&&$(n.get_element()).find(".toontalk-train-backside-button").click()});c&&a.get_widget().backup_all();return!0};a.add_backside_widget=function(a,b){return this.get_widget().add_backside_widget(a,b)};a.add_backside_widgets=function(a,c){0!==a.length&&k.UTILITIES.set_timeout(function(){var f=this.visible(),m,g,h;a.forEach(function(a,n){if(a){var l=a.get_widget().get_backside();m=a.get_element();
m.toontalk_widget=a.get_widget();c&&(g=c[n])&&(a.is_backside()?(h={left:g.backside_left,top:g.backside_top,width:g.backside_width,height:g.backside_height},a.get_widget().apply_backside_geometry(),g.advanced_settings_open&&l.set_advanced_settings_showing(!0,l.get_element())):(0===g.frontside_width&&(g.frontside_width=""),0===g.frontside_height&&(g.frontside_height=""),h={left:g.frontside_left,top:g.frontside_top,width:g.frontside_width,height:g.frontside_height}),k.UTILITIES.constrain_css_to_fit_inside(b,
h),$(m).css(h));d.append(m);a.set_visible(f);a.get_widget().rerender()}})}.bind(this))};a.get_backside_dimensions=function(){if(1!==f||1!==g)return{x_scale:f,y_scale:g,original_width:u,original_height:c}};a.set_dimensions=function(a){f=a.x_scale;g=a.y_scale;u=a.original_width;c=a.original_height};a.scale_to_fit=function(a,b){var d;!u&&this.get_widget().backside_geometry&&(u=this.get_widget().backside_geometry.original_width,c=this.get_widget().backside_geometry.original_height);d=k.UTILITIES.scale_to_fit(a,
b,u,c);f=d.x_scale;g=d.y_scale};a.run_status_changed=function(a){J(a)};if(k.debugging||k.logging)a.to_debug_string=function(){return"backside of "+this.get_widget().to_debug_string()};b.toontalk_widget=l;k.UTILITIES.drag_and_drop(b);d.resizable({start:function(){r=d.width();y=d.height();u||(u=r);c||(c=y)},resize:function(a,b){var m=b.size.width,h=b.size.height;d.is(".toontalk-top-level-backside")||(f*=m/r,g*=h/y,r=m,y=h,k.backside.scale_backside(d,f,g,u,c))},handles:"e,s,se"});b.addEventListener("mouseenter",
function(a){a=l.get_frontside();var b=l.get_parent_of_backside();!a||b&&!b.get_widget().is_top_level()||k.UTILITIES.highlight_element(a.get_element())});b.addEventListener("mouseleave",function(a){l.is_top_level()||k.UTILITIES.remove_highlight()});a.update_display=function(){var b=this.get_description_text_area(),c=this.get_name_text_input(),d;b&&(d=this.get_widget().get_description())&&(b.button.value=d);c&&(c.button.value=this.get_widget().get_name());a.display_updated()};a.display_updated=function(){var a=
$(this.get_element());u||(u=a.width());c||(c=a.height())};l.get_backside_widgets&&(F=l.get_backside_widgets(),a.add_backside_widgets(F,l.get_backside_widgets_json_views()));k.debugging&&(b.id=l.debug_id);return a},toString:function(){return"backside of "+this.get_widget()},remove_element:function(){$(this.get_element()).remove()},create_infinite_stack_check_box:function(l,a){var b=k.UTILITIES.create_check_box(a.get_infinite_stack(),"toontalk-infinite-stack-check-box","Copy when dragged.","Check this if you want the "+
a.get_type_name()+" to be copied instead of moved.");$(b.button).click(function(d){var f=b.button.checked,g;a.set_infinite_stack(f);a.robot_in_training()&&(g=f?"change dragging to make a copy of ":"change dragging back to moving for ",a.robot_in_training().edited(a,{setter_name:"set_infinite_stack",argument_1:f,toString:g,button_selector:".toontalk-infinite-stack-check-box"}));d.stopPropagation()});return b},create_description_label:function(l,a){var b=a.get_description();if(b)return k.UTILITIES.create_text_element("I'm the back side of a "+
a.get_type_name()+" that is "+b)},add_advanced_settings:function(l){var a=this.get_widget(),b=this.create_infinite_stack_check_box(this,a),d=a.get_type_name(),f=k.UTILITIES.create_text_area(a.get_description(),"toontalk-description-input","I'm ","Type here to provide additional information about this "+d+".",function(b){(b=k.UTILITIES.input_area_drop_handler(b,a.receive_description_from_dropped.bind(a),a))&&a.robot_in_training()&&a.robot_in_training().dropped_on_text_area(b,a,{area_selector:".toontalk-description-input",
setter:"receive_description_from_dropped",toString:"for a widget's description"})}),g=$("<button>Make a sensor nest</button>").button(),q=$("<button>Make a function bird</button>").button(),h=function(){var b=f.button.value.trim();a.set_description(b,!0)&&a.robot_in_training()&&a.robot_in_training().edited(a,{setter_name:"set_description",argument_1:b,toString:"change the description to '"+b+"'' of the "+d,button_selector:".toontalk-description-input"})},v=document.createElement("table"),t=this.get_element(),
n=function(b,c){var d=a.get_parent_of_frontside(),f=b.get_frontside_element(!0),g;d&&d.add_backside_widget&&!d.get_widget().is_top_level()?(d.add_backside_widget(b),g=d.get_element(),g.appendChild(f),d=$(g).offset(),d.top+=.6*$(g).height()):(a.add_to_top_level_backside(b,!1),d=c.offset(),d.left-=120,0>d.left&&(d.left=0));k.UTILITIES.set_absolute_position($(f),d)},u,c;a.set_name&&(c=function(b){(b=a.receive_name_from_dropped&&k.UTILITIES.input_area_drop_handler(b,a.receive_name_from_dropped.bind(a),
a))&&a.robot_in_training()&&a.robot_in_training().dropped_on_text_area(b,a,{area_selector:".toontalk-name-input",setter:"receive_name_from_dropped",toString:"for a widget's name"})},u=k.UTILITIES.create_text_input(a.get_name(),"toontalk-name-input",a.get_name_input_label?a.get_name_input_label():"My name is ",a.get_name_input_title?a.get_name_input_title():"Edit the name of this "+d+". There is not much room so keep it short.",void 0,"text",c),c=function(){var b=u.button.value.trim();a.set_name(b,
!0)&&a.robot_in_training()&&a.robot_in_training().edited(a,{setter_name:"set_name",argument_1:b,toString:"change the name to '"+b+"'' of the "+d,button_selector:".toontalk-name-input"})},u.button.addEventListener("change",c),u.button.addEventListener("mouseout",c),this.set_name_text_input(u));$(v).addClass("toontalk-advanced-setting");$(f.button).val(a.get_description());f.button.addEventListener("change",h);f.button.addEventListener("mouseout",h);this.set_description_text_area(f);g.addClass("toontalk-make-sensor_nest_button").click(function(b){var c=
k.sensor.create("click","which",void 0,void 0,!0,a);n(c,g);a.robot_in_training()&&a.robot_in_training().created_widget(c,a,".toontalk-make-sensor_nest_button");b.stopPropagation()});g.attr("title","Click to create a nest which receives messages when events happen to this "+a.get_type_name()+".");q.addClass("toontalk-make-function_bird_button").click(function(b){var c=a.get_function_type&&a.get_function_type(),c=k.bird.create_function(c||d);n(c,q);a.robot_in_training()&&a.robot_in_training().created_widget(c,
a,".toontalk-make-function_bird_button");b.stopPropagation()});a.is_number()||a.is_box()?q.attr("title","Click to get a bird that flies to functions of "+a.get_type_name(!0)+"."):(q.attr("title","There are no functions that operate on "+a.get_type_name(!0)+" (yet)."),q.button("option","disabled",!0));v.appendChild(k.UTILITIES.create_row(f.container));if(1<arguments.length)for(h=1;h<arguments.length;h++)v.appendChild(arguments[h]);u&&v.appendChild(k.UTILITIES.create_row(u.container));v.appendChild(k.UTILITIES.create_row(g.get(0),
q.get(0),b.container));t.appendChild(v);l?$(t).find(".toontalk-settings-backside-button").remove():$(t).find(".toontalk-advanced-setting").hide()},get_type_name:function(){return"the backside of "+k.UTILITIES.add_a_or_an(this.get_widget().get_type_name())},hide_backside:function(l){var a=this.get_widget(),b=a.get_frontside_element(),d=$(a.get_backside_element()),f=d.position(),g=d.parent().closest(".toontalk-backside"),q=function(){var b=a.get_backside_widgets(),d=a.get_backside_widgets_json_views(!0);
this.get_backside_dimensions();var f;b.forEach(function(a,b){a.get_widget();var g;if(f=a.get_element())d[b]||(d[b]={}),a.start_position?(g=a.start_position,a.start_position=void 0):g=$(f).position(),a.is_backside()?(d[b].backside_left=k.UTILITIES.left_as_percent(g.left,f),d[b].backside_top=k.UTILITIES.top_as_percent(g.top,f)):(d[b].frontside_left=k.UTILITIES.left_as_percent(g.left,f),d[b].frontside_top=k.UTILITIES.top_as_percent(g.top,f))})}.bind(this),h=a.get_parent_of_backside();k.UTILITIES.remove_highlight();
q();a.backside_geometry=this.get_backside_dimensions();h&&(h.is_backside()?a.set_parent_of_backside(void 0,!0):h.removed_from_container(a,!0,l,void 0,!0),a.forget_backside&&a.forget_backside());(function(a){var d=$(b).offset(),f=g.position(),h=function(){a.remove()};a.is(":visible")&&("0"===a.css("opacity")?(a.removeClass("toontalk-animating-element"),a.remove()):(a.addClass("toontalk-side-appearing"),k.UTILITIES.add_one_shot_event_handler(a.get(0),"transitionend",2500,h),f||(f={left:0,top:0}),k.UTILITIES.set_css(a,
{left:d.left-f.left,top:d.top-f.top,opacity:.1})))})(d);this.set_visible(!1);!$(b).is(":visible")&&(f&&k.UTILITIES.set_css(b,{left:f.left,top:f.top}),l=k.UTILITIES.widget_from_jquery(g))&&(l.add_backside_widget(a),g.append(b),a.render());a.backside_widgets&&a.backside_widgets.forEach(function(a){a.set_visible(!1)});if(a.on_backside_hidden)a.on_backside_hidden()},create_advanced_settings_button:function(l,a){var b=document.createElement("div"),d=$(b),f=!1;b.innerHTML="&gt;";d.addClass("toontalk-settings-backside-button");
d.css({"z-index":k.UTILITIES.next_z_index()});d.click(function(b){f=!f;this.set_advanced_settings_showing(f,l.get_element(),d);b.stopPropagation();a.robot_in_training()&&a.robot_in_training().button_clicked(".toontalk-settings-backside-button",l)}.bind(this));k.UTILITIES.give_tooltip(d.get(0),"Click to see the advanced settings of this "+a.get_type_name()+".");return d.get(0)},set_advanced_settings_showing:function(l,a,b){a||(a=this.get_element());b||(b=$(a).find(".toontalk-settings-backside-button"));
l?($(a).find(".toontalk-advanced-setting").show(),b.html("<"),k.UTILITIES.give_tooltip(b.get(0),"Click to hide the advanced settings.")):($(a).find(".toontalk-advanced-setting").hide(),b.html(">"),k.UTILITIES.give_tooltip(b.get(0),"Click to show the advanced settings."))},get_widgets:function(){var k=[];$(this.get_element()).children().each(function(a,b){var d=b.toontalk_widget;d&&0>k.indexOf(d)&&k.push(d)});return k},scale_backside:function(l,a,b,d,f){var g=Math.min(1,a,b);1===a&&1===b?k.UTILITIES.set_css(l,
{width:"",height:""}):k.UTILITIES.set_css(l,{transform:"scale("+g+", "+g+")","transform-origin":"left top",width:d*a/g,height:f*b/g})},render:function(){k.DISPLAY_UPDATES.pending_update(this)},rerender:function(){this.visible()&&k.DISPLAY_UPDATES.pending_update(this)},remove_backside_widget:function(k,a,b){return this.get_widget().remove_backside_widget(k,a,b)},remove:function(){this.get_widget().remove()},is_backside:function(){return!0},get_parent:function(){return this.get_parent_of_backside()},
is_of_type:function(k){return this.get_widget().is_of_type(k)},save_dimensions:function(){return!1}}}(window.TOONTALK);window.TOONTALK.frontside=function(k){return{create:function(l){var a=Object.create(this),b=document.createElement("div"),d=$(b),f=function(a){if(!$(a.target).is(".ui-resizable-handle")&&("click"!==a.type||1===a.which)){if(d.is(".toontalk-top-level-resource"))l.set_running(!l.get_running());else if(!l.get_running()||l.robot_in_training())l.open_backside(),l.robot_in_training()&&l.robot_in_training().backside_opened(l);a.stopPropagation()}},g;$(b).addClass("toontalk-frontside toontalk-side");b.toontalk_widget=
l;k.UTILITIES.drag_and_drop(b);a.get_element=function(){return b};a.get_widget=function(){return l};a.visible=function(){return g};a.set_visible=function(a){var b;g!==a&&(g=a,b=this.get_widget(),b.walk_children&&b.walk_children(function(b){b.set_visible(a);return!0}))};b.addEventListener("click",f);b.addEventListener("touchstart",f);b.addEventListener("mouseenter",function(a){var b=l.get_backside(),d=(l.is_empty_hole()?wiget.get_parent_of_frontside():l).get_frontside_element();b&&k.UTILITIES.highlight_element(b.get_element());
$(".toontalk-wiggle").removeClass("toontalk-wiggle");$(d).is(".toontalk-top-level-resource")||$(d).addClass("toontalk-wiggle");a.stopPropagation()});b.addEventListener("mouseleave",function(a){a=l.get_backside();var b=l.is_empty_hole()?wiget.get_parent_of_frontside():l;a&&k.UTILITIES.remove_highlight();$(b.get_frontside_element()).removeClass("toontalk-wiggle")});k.debugging&&(b.id=l.debug_id);return a},update_display:function(){return this.get_widget().update_display()},remove:function(){$(this.get_element()).remove()}}}(window.TOONTALK);(function(k){var l=180/Math.PI,a=Math.log(10),b=bigrat.fromInteger(10),d=bigrat.fromValues(1,2),f=bigrat.fromValues(-1,2),g=bigrat.fromInteger(360),q=bigrat.fromDecimal(2*Math.PI),h=Math.log10?Math.log10:function(b){return Math.log(b)/a},v=function(a){var b=bigrat.fromValues(bigrat.toBigInteger(a),1);a=bigrat.subtract(bigrat.create(),a,b);return{integer_part:b,fractional_part:a}},t=function(a){var b=v(a),c=k.number.ZERO(k.number.function_bird_results_default_format),d=k.number.ZERO(k.number.function_bird_results_default_format);
c.set_value(b.integer_part);d.set_value(b.fractional_part);return k.box.create(2,!0,[c,d],"The integer and fraction parts of "+a.toString().replace(",","/"))},n=function(a,b){var c=bigrat.divide(bigrat.create(),a,b),d=v(c);return bigrat.multiply(c,d.fractional_part,b)},u=function(a){a=v(a);return bigrat.isLessThan(a.fractional_part,f)?bigrat.subtract(a.integer_part,a.integer_part,bigrat.ONE):bigrat.isLessThan(a.fractional_part,bigrat.ZERO)||bigrat.isLessThan(a.fractional_part,d)?a.integer_part:bigrat.add(a.integer_part,
a.integer_part,bigrat.ONE)},c=function(a){a=v(a);return bigrat.isLessThan(a.fractional_part,bigrat.ZERO)?bigrat.subtract(a.integer_part,a.integer_part,bigrat.ONE):a.integer_part},r=function(a){a=v(a);return bigrat.isLessThan(a.fractional_part,bigrat.ZERO)||bigrat.equals(a.fractional_part,bigrat.ZERO)?a.integer_part:bigrat.add(a.integer_part,a.integer_part,bigrat.ONE)};window.TOONTALK.number=function(){var a=Object.create(k.widget),c=function(a,b,c,d){var f="",g=100;c=50/c;b/=1+b;if(d)for(d=0;g>=c&&
d<a.length;)f=f+"<span class='toontalk-digit' style='font-size:"+g+"%'>"+a[d]+"</span>",d+=1,"-"!==a[d]&&(g*=b);else for(d=a.length-1;g>=c&&0<d;)f="<span class='toontalk-digit' style='font-size:"+g+"%'>"+a[d]+"</span>"+f,--d,"-"!==a[d]&&(g*=b);return f},d=function(a,b){var c=a/(1+a);return Math.ceil(Math.log(.5/b)/Math.log(c))},f=function(a,b,d){if(a.length<=Math.round(b))return'<span class="toontalk-digit" style="font-size:100%">'+a+"</span>";if(1>b)return"";if(5>b)return"<span style='font-size: 80%'>"+
f(a,1.25*b,.8*d)+"</span>";b=b/2-1;return c(a,b,d,!0)+c(a,b,d,!1)},g=function(a,c){bigrat.isNegative(a)&&bigrat.abs(a,a);var d;a:{d=bigrat.fromValues(a[0],1);var f=bigrat.fromValues(a[1],1),g="",h=bigrat.create(),k=bigrat.create(),l=bigrat.create();for(bigrat.multiply(d,d,b);c>g.length;){if(bigrat.isLessThan(d,f))g+="0";else if(bigrat.divide(h,d,f),k=bigrat.toBigInteger(h),g+=k.toString(),bigrat.subtract(l,h,bigrat.fromValues(k,1)),bigrat.multiply(d,l,f),bigrat.equals(d,bigrat.ZERO)){d=g=n(g);break a}bigrat.multiply(d,
d,b)}d=g}return d},n=function(a){return 0<a.length&&"0"===a.charAt(a.length-1)?n(a.substring(0,a.length-1)):a},l=function(a,b){var c=Math.min(b,a/2);return a-(c+1)},q=function(a,b){b||(b=1);if(!("number"!==typeof a&&"string"!==typeof a||"number"!==typeof b&&"string"!==typeof b))return bigrat.fromValues(a,b);var c=bigrat.create();1===b?bigrat.set(c,bigrat.toBigInteger(a.get_value()),BigInteger.ONE):a.get_value&&b.get_value?bigrat.set(c,bigrat.toBigInteger(a.get_value()),bigrat.toBigInteger(b.get_value())):
bigrat.set(c,a,b);return c},r=function(a){switch(a){case "+":return"";case "-":return"&minus;";case "*":return"&times;";case "/":return"&divide;";case "=":return"&equals;";case "^":return"^";default:return k.UTILITIES.report_internal_error("Number has an unsupported operator: "+a),""}};a.default_format="mixed_number";a.function_bird_results_default_format="decimal";a.create=function(b,c,d,f,g,h){var n=Object.create(a),l=q(b,c);d||(d="+");n.is_number=function(){return!0};n.set_value=function(a,b){if(b||
!bigrat.equals(l,a))return this.fire_value_change_listeners(l,a),l=a,this.rerender(),k.debugging&&(this._debug_string=this.to_debug_string(),"0,0"===a.toString()&&k.UTILITIES.report_internal_error("Impossible numeric value -- can be caused by decimal string not being parsable as a number.")),this};n.set_value_from_sub_classes=n.set_value;n.fire_value_change_listeners=function(a,b){var c=this.get_listeners("value_changed"),d;c&&(d={type:"value_changed",old_value:a,new_value:b},c.forEach(function(a){a(d)}))};
n.get_value=function(){return l};n.set_value_from_decimal=function(a){this.set_value(bigrat.fromDecimal(a));k.debugging&&"0,0"===this.get_value().toString()&&k.UTILITIES.report_internal_error("Number being set to 0/0 from "+a)};n.copy=function(b){return this.add_to_copy(a.create(l[0],l[1],d,f,g,h),b)};n.get_format=function(){return f||a.default_format};n.set_format=function(a,b){f=a;b&&this.rerender();return this};n.get_operator=function(){return d};n.set_operator=function(a,b){d=a;b&&this.rerender();
return this};n.get_approximate=function(){return h};n.set_approximate=function(a,b){h=a;b&&this.rerender();return this};n=a.add_standard_widget_functionality(n);n.set_description(g);k.debugging&&(n._debug_string=n.toString(),n._debug_id=k.UTILITIES.generate_unique_id(),l._debug_id_new=n._debug_id);return n};a.create_from_bigrat=function(a){var b=k.number.ZERO();b.set_value(a);return b};a.create_backside=function(){return k.number_backside.create(this)};a.set_from_values=function(a,b){return this.set_value(q(a,
b))};a.set_numerator=function(a){return this.set_value(q(a,this.get_value()[1].toString()))};a.set_denominator=function(a){return this.set_value(q(this.get_value()[0].toString(),a))};a.ONE=function(){return k.number.create(1)};a.ZERO=function(a){return k.number.create(0,void 0,void 0,a)};a.equals=function(a){return a.equals_number&&a.equals_number(this)};a.equals_number=function(a){return bigrat.equals(this.get_value(),a.get_value())};a.compare_with=function(a){if(a.compare_with_number)return-1*a.compare_with_number(this)};
a.compare_with_number=function(a){return bigrat.equals(this.get_value(),a.get_value())?0:bigrat.isGreaterThan(this.get_value(),a.get_value())?1:-1};a.update_display=function(){var a=this.get_frontside(!0),b=28,c,d,f,g;k.logging&&0<=k.logging.indexOf("display")&&console.log("Updating display of "+this.to_debug_string());a=a.get_element();$(a).is(".toontalk-conditions-contents")?c=$(a):$(a).parent().is(".toontalk-backside, .toontalk-json")?(c=$(a),g=!0):c=$(a).parent().is(".toontalk-scale-half")?$(a):
$(a).parent();0===c.length&&(d=this.get_parent_of_frontside())&&(d.get_widget().is_hole()&&(d=d.get_parent_of_frontside()),c=$(d.get_frontside_element()));if($(a).is(".toontalk-carried-by-bird"))f=d=100;else if($(a).is(".toontalk-element-attribute"))d=200,f=32;else{if(!c.is(":visible")){k.logging&&0<=k.logging.indexOf("display")&&console.log("Container not visible so no display of "+this.to_debug_string());return}d=c.width();f=c.height();if(0===d||0===f){k.logging&&0<=k.logging.indexOf("display")&&
console.log("Container has zero dimensions so no display of "+this.to_debug_string());return}c.is(".toontalk-nest")&&(d*=k.nest.CONTENTS_WIDTH_FACTOR,f*=k.nest.CONTENTS_HEIGHT_FACTOR)}$(a).removeClass("toontalk-number-eighth-size-border toontalk-number-quarter-size-border toontalk-number-half-size-border toontalk-number-full-size-border");b=this.get_border_size(d,f);4===b?$(a).addClass("toontalk-number-eighth-size-border toontalk-number"):8===b?$(a).addClass("toontalk-number-quarter-size-border toontalk-number"):
16===b?$(a).addClass("toontalk-number-half-size-border toontalk-number"):$(a).addClass("toontalk-number-full-size-border toontalk-number");b=f-2*b;g=this.to_HTML(d/(.64*b),b,this.get_format(),!0,this.get_operator(),g);k.UTILITIES.on_a_nest_in_a_box(a)&&(d="width:"+d+"px;",b=g.indexOf('style="'),g=0<=b?g.substring(0,b+7)+d+g.substring(b+7):g);d=$(a).children(".toontalk-widget");d.is("*")?d=d.get(0):(d=document.createElement("div"),a.appendChild(d));d.innerHTML=g;d.translate=!1;$(d).addClass("toontalk-widget notranslate");
c.is(".toontalk-box-hole")&&$(a).css({width:"",height:""});k.UTILITIES.give_tooltip(a,this.get_title())};a.get_border_size=function(a,b){return 64>=a||64>=b?4:128>=a||128>=b?8:256>=a||256>=b?16:32};a.to_HTML=function(a,n,q,m,A,B){var u,t,y,v,D,M,R=!1!==m?" toontalk-top-level-number":"";this.is_attribute_widget&&this.is_attribute_widget()?R+=" toontalk-attribute-number":this.get_approximate()&&(R+=" toontalk-approximate-number");B&&(R+=" toontalk-number-size-unconstrained-by-container");t=A?r(A):"";
a||(a=4);n||(n=16);if(this.get_erased&&this.get_erased())return'<div class="toontalk-number toontalk-integer'+R+'" style="font-size: '+n+'px;"></div>';0<t.length&&(--a,2>a&&(n*=Math.max(1,a)/2,a=2));if(this.is_integer()&&"scientific_notation"!==q){try{u=bigrat.toBigInteger(this.get_value()).toString()}catch(ma){k.UTILITIES.report_internal_error("Error converting number to a string: "+ma),u="0"}m=u.length;0<t.length&&m++;4>a&&m>a&&(m=Math.min(4,m),n*=a/m,a=m);return'<div class="toontalk-number toontalk-integer'+
R+'" style="font-size: '+n+'px;">'+t+f(u,a,n)+"</div>"}u=' style="font-size:'+.4*n+'px;"';if("improper_fraction"===q||!q)return n='<table class="toontalk-number toontalk-improper-fraction'+R+'"'+u+'><tr class="toontalk-numerator"><td align="center" class="toontalk-number">'+f(this.numerator_string(),2*a,n)+'</td></tr><tr class="toontalk-fraction-line-as-row"><td  class="toontalk-fraction-line-as-table-entry"><div class="toontalk-fraction-line"></div></tr><tr class="toontalk-denominator"><td align="center" class="toontalk-number">'+
f(this.denominator_string(),2*a,n)+"</td></tr></table>",""===t?n:"<table class='toontalk-operator-and-fraction'"+u+"><tr><td>"+t+"</td><td>"+n+"</td></tr></table>";if("mixed_number"===q||"proper_fraction"===q){t=this.integer_part();if(t.is_zero())return this.to_HTML(a,n,"improper_fraction",m,A);m=this.copy({just_value:!0}).subtract(t).absolute_value();return'<table class="toontalk-number toontalk-mixed-number'+R+'"'+u+'><tr><td class="toontalk-number toontalk-integer-part-of-mixed-number">'+t.to_HTML(a/
2,n,"",!1,this.get_operator())+'</td><td class="toontalk-number toontalk-fraction-part-of-mixed-number">'+m.to_HTML(a/2,n,"improper_fraction",!1)+"</td></tr></table>"}if("decimal"===q)return 4>a&&(n*=Math.max(1,a)/4,a=4),'<div class="toontalk-number toontalk-decimal toontalk-top-level-decimal'+R+'" style="font-size: '+n+'px;">'+t+this.decimal_string(a,n)+"</div>";if("scientific_notation"===q){M=bigrat.isNegative(this.get_value());y=this.get_value();v=bigrat.abs(bigrat.create(),y);y=bigrat.isLessThan(v,
bigrat.ONE);v=(y?bigrat.toBigInteger(bigrat.divide(bigrat.create(),bigrat.ONE,v)):bigrat.toBigInteger(v)).toString();y=y?-v.length:v.length-1;v=bigrat.power(bigrat.create(),b,y+1);D=bigrat.divide(bigrat.create(),this.get_value(),v);v=6+(0===y?1:Math.ceil(h(Math.abs(y)))/2);M&&v++;if(a<v+1)return this.to_HTML(v+1,n*a/(v+1),q,m,A,B);m=d(l(a,v),n);m=g(D,m);A=M?"-"+m.substring(0,1):m.substring(0,1);m=m.substring(1);a=c(m,a*(1-v/a),n,!0);0<a.length&&(a="<span class='toontalk-decimal-point'>.</span>"+a);
return'<table class="toontalk-number toontalk-scientific_notation'+R+'"'+u+'><tr><td class="toontalk-number toontalk-significand-of-scientific-notation"><div class="toontalk-number toontalk-decimal'+R+'" style="font-size: '+.9*n+'px;">'+t+A+a+'</td><td class="toontalk-number toontalk-exponent-of-scientific-notation"><div style="font-size: '+n+'px;"> &times;10<sup style="font-size: '+n/2+'px;">'+y+"</sup></div></td></tr></table>"}};a.drop_on=function(a,b,c,d){if(a.number_dropped_on_me)return a.number_dropped_on_me(this,
b,c,d),!0;if(a.widget_dropped_on_me)return a.widget_dropped_on_me(this,b,c,d);console.log("No handler for drop of '"+this+"' on '"+a+"'")};a.number_dropped_on_me=function(a,b,c,d){var f,g,h,n;if(a.visible()&&(c||d)){if(d){if(!d.animate_consequences_of_actions())return a.remove(),this.number_dropped_on_me_semantics(a,c,d);a.robot_waiting_before_next_step=d}f=document.createElement("div");$(f).addClass("toontalk-bammer-down");g=$(this.get_frontside_element()).closest(".toontalk-top-level-backside");
f.style.left="-10px";f.style.top=g.height()+"px";g.append(f);b=this.get_frontside_element();h=$(b).offset();h.left-=.75*$(f).width();h.left+=.5*$(b).width()+.1*$(f).width();h.top-=.5*$(b).height()+.4*$(f).height();b=function(){k.sounds&&k.sounds.bammer_hammer.play();this.number_dropped_on_me_semantics(a,c,d)&&d&&d.run_next_step();c&&this.backup_all();$(f).removeClass("toontalk-bammer-down");k.UTILITIES.set_timeout(function(){var a=g.offset();a||(a={left:0,top:0});$(f).addClass("toontalk-bammer-away");
h.left=a.left+g.width()-100;h.top=a.top+g.height()+100;n=function(){$(f).remove()};k.UTILITIES.animate_to_absolute_position(f,h,n,d&&d.transform_animation_speed(k.UTILITIES.default_animation_speed));$(f).css({opacity:.01})})}.bind(this);k.UTILITIES.animate_to_absolute_position(f,h,b,d&&d.transform_animation_speed(k.UTILITIES.default_animation_speed));$(f).css({opacity:1,"z-index":k.UTILITIES.next_z_index()+100});return this}return this.number_dropped_on_me_semantics(a,c,d)};a.number_dropped_on_me_semantics=
function(a,b,c){b&&this.robot_in_training()&&this.robot_in_training().dropped_on(a,this);a.get_approximate()&&this.set_approximate(!0);a.remove();switch(a.get_operator()){case "+":return this.add(a);case "-":return this.subtract(a);case "*":return this.multiply(a);case "/":return this.divide(a);case "=":return this.set_value(a.get_value());case "^":return this.power(a);default:k.UTILITIES.report_internal_error("Number received a number with unsupported operator: "+a.get_operator())}};a.widget_dropped_on_me=
function(a,b,c,d){return a.number_dropped_on_me?this.number_dropped_on_me(a,b,c,d):!1};a.add=function(a){this.set_value(bigrat.add(this.get_value(),this.get_value(),a.get_value()),!0);return this};a.subtract=function(a){this.set_value(bigrat.subtract(this.get_value(),this.get_value(),a.get_value()),!0);return this};a.multiply=function(a){this.set_value(bigrat.multiply(this.get_value(),this.get_value(),a.get_value()),!0);return this};a.divide=function(a){this.set_value(bigrat.divide(this.get_value(),
this.get_value(),a.get_value()),!0);return this};a.minimum=function(a){this.set_value(bigrat.min(this.get_value(),this.get_value(),a.get_value()),!0);return this};a.maximum=function(a){this.set_value(bigrat.max(this.get_value(),this.get_value(),a.get_value()),!0);return this};a.power=function(a){this.set_value(bigrat.power(this.get_value(),this.get_value(),bigrat.toInteger(a.get_value())),!0);return this};a.absolute_value=function(){this.set_value(bigrat.abs(this.get_value(),this.get_value()),!0);
return this};a.is_zero=function(){return bigrat.equals(this.get_value(),bigrat.ZERO)};a.is_negative=function(){return bigrat.isNegative(this.get_value())};a.toString=function(){return this.get_erased()?"erased number":("+"===this.get_operator()?"":this.get_operator())+bigrat.str(this.get_value())};a.operator_word=function(a){switch(this.get_operator()){case "+":return"add "+a+" to";case "-":return"subtract "+a+" from";case "*":return"multiply "+a+" with";case "/":return"divide "+a+" into"}};a.get_text=
function(){return this.is_integer()||"improper_fraction"===this.get_format()?this.toString():bigrat.toDecimal(this.get_value()).toString()};a.to_float=function(){return bigrat.toDecimal(this.get_value())};a.get_type_name=function(a){return a?"numbers":"number"};a.get_help_URL=function(){return"docs/manual/numbers.html"};a.get_json=function(){return{type:"number",operator:this.get_operator(),numerator:this.numerator_string(),denominator:this.denominator_string(),format:this.get_format(),approximate:this.get_approximate()}};
k.creators_from_json.number=function(b){return a.create(b.numerator,b.denominator,b.operator,b.format,b.description,b.approximate)};a.is_integer=function(){return 0===this.get_value()[1].compare(BigInteger.ONE)||0===this.get_value()[0].compare(BigInteger.ZERO)};a.numerator=function(){var a=bigrat.create();return bigrat.set(a,this.get_value()[0],BigInteger.ONE)};a.denominator=function(){var a=bigrat.create();return bigrat.set(a,this.get_value()[1],BigInteger.ONE)};a.numerator_string=function(){return this.get_value()[0].toString()};
a.denominator_string=function(){return this.get_value()[1].toString()};a.integer_part=function(){return this.create(this)};a.decimal_string=function(b,h){if(this.is_integer())return this.numerator_string();var n=this.get_value(),m=a.create(n[0],n[1]),k=m.integer_part(),n=k.toString();"0"===n&&this.is_negative()&&(n="-"+n);m=m.get_value();bigrat.subtract(m,m,k.get_value());var q=l(b,n.length),r=d(q,h),k=Math.min(n.length,b/2),m=g(m,r),m=m.length<q?m:c(m,q,h,!0);return f(n,k,h)+"<span class='toontalk-decimal-point'>.</span>"+
m};a.match=function(a){return this.get_erased&&this.get_erased()?a.match_with_any_number?a.match_with_any_number():this:a.match_with_this_number?a.match_with_this_number(this):this};a.match_with_any_number=function(){return"matched"};a.match_with_this_number=function(a){return a.equals(this)?"matched":a};a.get_custom_title_prefix=function(){var a;a="="===this.get_operator()?"Drop me on another number I'll give him my value.":"Drop me on another number and I'll "+this.operator_word("myself")+" him.";
this.get_approximate()&&(a+="\nI look a bit yellow because I'm the result of an "+k.UTILITIES.encode_HTML_for_title("<i>approximate</i>")+" calculation.");return a};return a}();window.TOONTALK.number_backside=function(){return{create:function(a){var b=k.backside.create(a),c=b.get_element(),d=document.createElement("div"),f=a.numerator_string(),g=a.denominator_string(),h=k.UTILITIES.create_text_area(f,"toontalk-numerator-input","","Type here to edit the numerator",void 0,"number"),n=k.UTILITIES.create_text_area(g,
"toontalk-denominator-input","","Type here to edit the denominator",void 0,"number"),l=k.UTILITIES.create_radio_button("number_format","decimal","toontalk-decimal-radio-button","Decimal number","Display number as a decimal."),q=k.UTILITIES.create_radio_button("number_format","proper_fraction","toontalk-proper-fraction-radio-button","Mixed number","Display number as an integer part and a proper fraction."),r=k.UTILITIES.create_radio_button("number_format","improper_fraction","toontalk-improper-fraction-radio-button",
"Improper fraction","Display number as a simple fraction."),u=k.UTILITIES.create_radio_button("number_format","scientific_notation","toontalk-scientific-notation-radio-button","Scientific notation","Display number as a decimal between 1 and 10 multiplied by ten to some power."),m=k.UTILITIES.create_radio_button("operator","+","toontalk-plus-radio-button","+","Add me to what I'm dropped on."),A=k.UTILITIES.create_radio_button("operator","-","toontalk-minus-radio-button","&minus;","Subtract me from what I'm dropped on."),
B=k.UTILITIES.create_radio_button("operator","*","toontalk-times-radio-button","&times;","Multiply me with what I'm dropped on."),t=k.UTILITIES.create_radio_button("operator","/","toontalk-divide-radio-button","&divide;","Divide me into what I'm dropped on."),v=k.UTILITIES.create_radio_button("operator","=","toontalk-set-equal-radio-button","&equals;","Set what I'm dropped on to my value."),V=function(b){var c=h.button.value.trim(),d=n.button.value.trim(),m=function(a,b,c){if(1>a.length)return{message:"Empty "+
b+" treated as 1.",replacement:"1"};if("-"===a.charAt(0)){if(c)return{message:"'-' only allowed as the first character of the "+b+". Ignoring extra '-'s.",replacement:m(a,b).replacement};a=m(a.substring(1,a.length),b,!0);a.message||(a.replacement="-"+a.replacement);return a}return/^\d+$/.test(a)?{replacement:a}:{message:"The "+b+" can only contain digits. '"+a+"' doesn't make sense.",replacement:a.replace(/[^\d]*/g,"")}},l;if(c!==f||d!==g)l=m(c,"numerator"),l.message&&(k.UTILITIES.display_message(l.message),
c=l.replacement),"0"===d?(k.UTILITIES.display_message("It doesn't make sense for a fraction to have a denominator of 0. Resetting it to 1."),d="1"):(l=m(d,"denominator"),l.message&&(k.UTILITIES.display_message(l.message),d=l.replacement)),a.set_from_values(c,d)&&(f=c,g=d,a.robot_in_training()&&(b=b.srcElement.className.split(" ",1)[0],"toontalk-denominator-input"===b?a.robot_in_training().edited(a,{setter_name:"set_denominator",argument_1:d,toString:"by changing the value of the denominator to "+
d,button_selector:"."+b}):a.robot_in_training().edited(a,{setter_name:"set_numerator",argument_1:c,toString:"by changing the value of the numerator to "+c,button_selector:"."+b})),a.rerender())},Y=function(){var b=k.UTILITIES.selected_radio_button(l.button,q.button,r.button,u.button),c=b.value;a.set_format(c,!0);a.robot_in_training()&&a.robot_in_training().edited(a,{setter_name:"set_format",argument_1:c,toString:"by changing the format to "+c+" of the number",button_selector:"."+b.className.split(" ",
1)[0]});a.rerender()},la=function(){var b=k.UTILITIES.selected_radio_button(m.button,A.button,B.button,t.button,v.button),c=b.value;a.set_operator(c,!0);a.robot_in_training()&&a.robot_in_training().edited(a,{setter_name:"set_operator",argument_1:c,toString:"by changing the operator to "+c+" of the number",button_selector:"."+b.className.split(" ",1)[0]})},aa=k.UTILITIES.create_horizontal_table(h.container,d,n.container),R=$(k.UTILITIES.create_horizontal_table(l.container,q.container,r.container,u.container)).buttonset().get(0),
ma=$(k.UTILITIES.create_horizontal_table(m.container,A.container,B.container,t.container,v.container)).buttonset().get(0),ga=k.backside.create_advanced_settings_button(b,a),ea=b.update_display.bind(b);d.innerHTML="/";$(d).addClass("ui-widget");c.appendChild(aa);c.appendChild(ga);h.button.addEventListener("change",V);h.button.addEventListener("mouseout",V);h.button.addEventListener("mouseenter",function(){f=h.button.value.trim()});n.button.addEventListener("change",V);n.button.addEventListener("mouseout",
V);n.button.addEventListener("mouseenter",function(){g=n.button.value.trim()});l.button.addEventListener("change",Y);q.button.addEventListener("change",Y);r.button.addEventListener("change",Y);u.button.addEventListener("change",Y);switch(a.get_format()){case "decimal":k.UTILITIES.check_radio_button(l);break;case "improper_fraction":k.UTILITIES.check_radio_button(r);break;case "mixed_number":case "proper_fraction":k.UTILITIES.check_radio_button(q);break;case "scientific_format":k.UTILITIES.check_radio_button(u)}switch(a.get_operator()){case "+":k.UTILITIES.check_radio_button(m);
break;case "-":k.UTILITIES.check_radio_button(A);break;case "*":k.UTILITIES.check_radio_button(B);break;case "/":k.UTILITIES.check_radio_button(t);break;case "=":k.UTILITIES.check_radio_button(v)}m.button.addEventListener("change",la);A.button.addEventListener("change",la);B.button.addEventListener("change",la);t.button.addEventListener("change",la);v.button.addEventListener("change",la);b.update_display=function(){$(h.button).val(a.numerator_string());$(n.button).val(a.denominator_string());ea()};
$(R).addClass("toontalk-advanced-setting");$(ma).addClass("toontalk-advanced-setting");c.appendChild(R);c.appendChild(ma);b.add_advanced_settings();return b}}}();window.TOONTALK.number.function=function(){var a=k.create_function_table(),b=function(a){return bigrat.toDecimal(n(a,g))},d=function(a){return bigrat.toDecimal(n(a,q))};a.add_function_object("sum",function(b,c,d){return a.n_ary_widget_function(b,k.number.ZERO,k.number.add,"sum",c,d)},"The bird will return with the sum of the numbers in the box.",
"+");a.add_function_object("difference",function(b,c,d){return a.n_ary_widget_function(b,k.number.ZERO,k.number.subtract,"difference",c,d)},"The bird will return with the result of subtracting the numbers in the box from the first number.","-");a.add_function_object("product",function(b,c,d){return a.n_ary_widget_function(b,k.number.ONE,k.number.multiply,"product",c,d)},"The bird will return with the product of the numbers in the box.","\u00d7");a.add_function_object("division",function(b,c,d){return a.n_ary_widget_function(b,
k.number.ONE,k.number.divide,"division",c,d)},"The bird will return with the result of dividing the numbers into the first number in the box.","\u00f7");a.add_function_object("modulo",function(b,c,d){return a.n_ary_function(b,a.bigrat_function_to_widget_function(n),2,"modulo",c,d)},"The bird will return with the first number modulo the second number. For positive numbers this is like the remainder after division.","mod");a.add_function_object("minimum",function(b,c,d){return a.n_ary_widget_function(b,
k.number.ONE,k.number.minimum,"minimum",c,d)},"The bird will return with the smallest of the numbers in the box.","min");a.add_function_object("maximum",function(b,c,d){return a.n_ary_widget_function(b,k.number.ONE,k.number.maximum,"maximum",c,d)},"The bird will return with the largest of the numbers in the box.","max");a.add_function_object("absolute value",function(b,c,d){return a.n_ary_function(b,function(a){var c=k.number.ZERO(b.get_hole_contents(1).get_format());bigrat.abs(c.get_value(),a);return c},
1,"absolute value",c,d)},"The bird will return with the positive version of the number.","abs");a.add_function_object("power",function(b,c,d){return a.n_ary_function(b,a.bigrat_function_to_widget_function(function(a,b){var c=bigrat.power(bigrat.create(),a,b[0].valueOf()),d=b[1].valueOf();return 1===d?c:bigrat.nthRoot(c,c,d)},!0),2,"power",c,d)},"The bird will return with the first number to the power of the second number.");a.add_function_object("logarithm",function(b,c,d){return a.n_ary_function(b,
a.numeric_javascript_function_to_widget_function(function(){return 1===arguments.length?Math.log(arguments[0]):Math.log(arguments[0])/Math.log(arguments[1])},!0),1,"logarithm",c,d)},"The bird will return an approximation of the logarithm number of the first number.\nIf a second number is provided then it is used as the base of the logarithm.\nIf there is no second number the logarithm is natural (the base is e).","log");a.add_function_object("random",function(b,c,d){return a.n_ary_function(b,a.numeric_javascript_function_to_widget_function(function(){return 0===
arguments.length?Math.random():1===arguments.length?Math.random()*arguments[0]:arguments[0]<arguments[1]?Math.random()*(arguments[1]-arguments[0])+arguments[0]:Math.random()*(arguments[0]-arguments[1])+arguments[1]}),0,"random",c,d)},"The bird will return a random number between the first and second numbers.\nIf the second number isn't provided a number less than the first number is returned.\nIf no numbers are given then the bird returns with a number between 0 and 1.","rand");a.add_function_object("round",
function(b,c,d){return a.n_ary_function(b,a.bigrat_function_to_widget_function(u),1,"round",c,d)},"The bird will return the number rounded to the nearest integer.");a.add_function_object("floor",function(b,d,f){return a.n_ary_function(b,a.bigrat_function_to_widget_function(c),1,"floor",d,f)},"The bird will return the largest integer less than or equal to the number.");a.add_function_object("ceiling",function(b,c,d){return a.n_ary_function(b,a.bigrat_function_to_widget_function(r),1,"ceiling",c,d)},
"The bird will return the smallest integer greater than or equal to the number.","ceil");a.add_function_object("delay",function(b,c,d){var f=Date.now(),g=a.check_message(b),h;if(g)if(2>g.size)k.UTILITIES.display_message("Delay function birds need a number in the second hole.");else return h=b.get_hole_contents(1).to_float(),setTimeout(function(){var h=k.number.ZERO(k.number.function_bird_results_default_format);h.set_value_from_decimal((Date.now()-f)/1E3);h.set_approximate(!0);a.process_response(h,
g.bird,b,c,d)},1E3*h),!0},"The bird will return after waiting the number of seconds in the second hole. She will return with the exact amount of time since she received the box.");a.add_function_object("integer and fraction parts",function(b,c,d){return a.n_ary_function(b,t,1,"integer and fraction parts",c,d)},"The bird will return with a box containing the integer part and the fraction.","parts");a.add_function_object("sine",function(c,d,f){return a.n_ary_function(c,a.numeric_javascript_function_to_widget_function(function(a){return Math.sin(a/
l)},!0,b),1,"sine",d,f)},"The bird will return with an approximation of the sine of the number (in degrees).","sin");a.add_function_object("cosine",function(c,d,f){return a.n_ary_function(c,a.numeric_javascript_function_to_widget_function(function(a){return Math.cos(a/l)},!0,b),1,"cosine",d,f)},"The bird will return with an approximation of the cosine of the number (in degrees).","cos");a.add_function_object("arc tangent",function(b,c,d){return a.n_ary_function(b,a.numeric_javascript_function_to_widget_function(function(a){return l*
Math.atan(a)},!0),1,"arc tangent",c,d)},"The bird will return with an approximation of the arc tangent (in degrees) of the number.","atan");a.add_function_object("arc tangent of y and x",function(b,c,d){return a.n_ary_function(b,a.numeric_javascript_function_to_widget_function(function(a,b){return l*Math.atan2(a,b)},!0),2,"arc tangent of y and x",c,d)},"The bird will return with an approximation of the arc tangent (in degrees) of the point where the first number is the y coordinate and the second one is the x.",
"atan2");a.add_function_object("sine (in radians)",function(b,c,f){return a.n_ary_function(b,a.numeric_javascript_function_to_widget_function(Math.sin,!0,d),1,"sine (in radians)",c,f)},"The bird will return with an approximation of the sine of the number (in radians).","sin rad");a.add_function_object("cosine (in radians)",function(b,c,f){return a.n_ary_function(b,a.numeric_javascript_function_to_widget_function(Math.cos,!0,d),1,"cosine (in radians)",c,f)},"The bird will return with an approximation of the cosine of the number (in radians).",
"cos rad");a.add_function_object("arc tangent (in radians)",function(b,c,d){return a.n_ary_function(b,a.numeric_javascript_function_to_widget_function(Math.atan,!0),1,"arc tangent (in radians)",c,d)},"The bird will return with an approximation of the arc tangent (in radians) of the number.","atan rad");a.add_function_object("arc tangent of y and x (in radians)",function(b,c,d){return a.n_ary_function(b,a.numeric_javascript_function_to_widget_function(Math.atan2,!0),2,"arc tangent of y and x (in radians)",
c,d)},"The bird will return with an approximation of the arc tangent (in radians) of the point where the first number is the y coordinate and the second one is the x.","atan2 rad");return a.get_function_table()}()})(window.TOONTALK);(function(k){var l=function(a,b,d,f){var g;a&&0<=d&&a.maintain_proportional_dimensions()&&a.get_default_width?(g=a.get_default_width(),a=a.get_default_height(),d/g>=f/a?(g=g*f/a,d={left:(d-g)/2,top:0,width:g,height:f}):(g=a*d/g,d={left:0,top:(f-g)/2,width:d,height:g})):d={left:0,top:0};k.UTILITIES.set_css(b,d)};window.TOONTALK.box=function(a){var b=Object.create(a.widget);b.create=function(d,f,g,k,h){var v=Object.create(b),t=[];"undefined"===typeof f&&(f=!0);v.is_box=function(){return!0};v.get_horizontal=
function(){return f};v.set_horizontal=function(a,b){f=a;b&&($(this.get_frontside_element()).children(".toontalk-side").remove(),this.rerender());return this};v.get_hole=function(a){return t[a]};v.get_hole_contents=function(a){return t[a].get_contents()};v.set_hole=function(b,d,c){var f;t[b].set_contents(d);if(c){d&&d.save_dimensions();c=this.get_frontside_element();b=$(c).children(".toontalk-hole-number-"+b);b.empty();if(!d)return;f=this.get_hole_dimensions();c=d.get_frontside_element(!0);b.append(c);
l(d,c,f.width,f.height);d.rerender()}this.rerender();a.debugging&&(this._debug_string=this.to_debug_string())};v.get_holes=function(){return t};v.temporarily_remove_contents=function(a,b){var c=this.get_index_of(a);this.temporarily_removed_contents||(this.temporarily_removed_contents=[]);this.temporarily_removed_contents[c]=a;this.set_hole(c,void 0,b);return function(){this.set_hole(c,a,b);this.temporarily_removed_contents[c]=void 0}.bind(this)};v.get_contents_temporarily_removed=function(a){if(this.temporarily_removed_contents)return this.temporarily_removed_contents[a]};
v.set_contents=function(a){a.forEach(function(a,b){t[b].set_contents(a)})};v.get_size=function(){return d};v.set_size=function(b,f){var c,g;if(d===b||0>b||isNaN(b))return!1;g=this.visible();t.length=b;if(b>d)for(c=d;c<b;c++)t[c]=a.box_hole.create(c),t[c].set_parent_of_frontside(v),t[c].set_visible(g);d=b;f&&this.rerender();a.debugging&&(this._debug_string=this.to_debug_string());return!0};v.get_hole_dimensions=function(){var b=this.get_frontside_element(),g=$(b).width()||a.box.get_default_width(),
b=$(b).height()||a.box.get_default_height();return f?{width:g/d,height:b}:{width:g,height:b/d}};v.receive_size_from_dropped=function(b,d){var c;if(b.is_number())return c=a.number.create(this.get_size()),c.number_dropped_on_me_semantics(b),c=Math.max(0,Math.round(c.to_float())),this.set_size(c),c.toString()};v.copy=function(a){var g;a||(a={});g=t.map(function(b){if(b=b.get_contents())return b.copy(a)});g=b.create(d,f,g,this.get_description(),this.get_name());return this.add_to_copy(g,a)};v.generate_name=
function(){for(var a="",b=this.get_size();0<b;)a+=";",b--;return a};v.add_standard_widget_functionality(v);v.has_name(v);v.set_name(h);for(h=0;h<d;h++)t[h]=a.box_hole.create(h),t[h].set_parent_of_frontside(v);v.set_description(k);g&&v.set_contents(g);a.debugging&&(v._debug_id=a.UTILITIES.generate_unique_id(),v._debug_string=v.to_debug_string());return v};b.create_backside=function(){return a.box_backside.create(this)};b.equals=function(a){return a.equals_box&&this.get_type_name()===a.get_type_name()&&
a.equals_box(this)};b.equals_box=function(a){var b=this.get_size(),g,k,h;if(b!==a.get_size())return!1;for(g=0;g<b;g++)if(k=this.get_hole_contents(g),h=a.get_hole_contents(g),!k&&h||k&&!h||k&&h&&(!k.equals||!k.equals(h)))return!1;return!0};b.compare_with=function(a){if(a.compare_with_box)return-1*a.compare_with_box(this)};b.compare_with_box=function(a){var b=this.get_size(),g=a.get_size(),k,h;if(b>g)return 1;if(b<g)return-1;for(g=0;g<b;g++){k=this.get_hole_contents(g);h=a.get_hole_contents(g);if(k&&
!h)return 1;if(!k&&h)return-1;if(k&&h)if(k.compare_with){if(k=k.compare_with(h),1===k||-1===k)return k}else return}return 0};b.match=function(a){return this.get_erased&&this.get_erased()?a.match_with_any_box?a.match_with_any_box():this:a.match_with_this_box?a.match_with_this_box(this):this};b.match_with_any_box=function(){return"matched"};b.match_with_this_box=function(b){var f=this.get_size(),g=[],k,h,l;if(f!==b.get_size())return b;for(k=0;k<f;k++)if(l=b.get_hole_contents(k))if(h=this.get_hole_contents(k)){h=
a.UTILITIES.match(l,h);if(h.is_widget)return h;"matched"!==h&&(g=0===g.length?h:g.concat(h))}else if(h=this.get_contents_temporarily_removed(k))g.push(h);else return b;return 0<g.length?g:"matched"};b.toString=function(a){var b="",g=this.get_size(),k,h,l=this.get_type_name()+" that looks like ";for(k=0;k<g;k++)h=this.get_hole(k),b+=h.get_full_description(a),k<g-1&&(b+=" | ");return l+"["+b.replace(l,"")+"]"};b.get_type_name=function(a){return a?"boxes":"box"};b.get_help_URL=function(){return"docs/manual/boxes.html"};
b.get_json=function(b){var f=[],g=this.get_size(),k;for(k=0;k<g;k++)this.get_hole_contents(k)?f[k]=a.UTILITIES.get_json(this.get_hole_contents(k),b):f[k]=null;return{type:"box",size:g,contents:f,horizontal:this.get_horizontal(),name:this.get_name()}};b.walk_children=function(a){var b=this.get_size(),g;for(g=0;g<b&&a(this.get_hole(g));g++);};a.creators_from_json.box=function(d,f){return b.create(d.size,d.horizontal,a.UTILITIES.create_array_from_json(d.contents,f),d.description,d.name)};b.update_display=
function(){var b=this.get_frontside(!0).get_element(),f=this.get_size(),g=function(b,c,d){var g=c.get_contents(),h=(g||c).get_frontside_element(!0),n=$(b).parents(".toontalk-box-hole"),t=function(){$(b).parents(".toontalk-box-hole").children(".toontalk-nest").is("*")&&(S/=a.nest.CONTENTS_WIDTH_FACTOR,m/=a.nest.CONTENTS_HEIGHT_FACTOR)},L,I,S,m;k?(I=0,0<n.length?(S=u-2*z/f,m=r-2*z):(S=u,m=r),t(),L=S*d,1<d&&(L+=z*(d-1))):(L=0,0<n.length?(S=u-2*z,m=r-2*z/f):(S=u,m=r),t(),I=m*d,1<d&&(I+=z*(d-1)));a.UTILITIES.set_css(b,
{left:L,top:I,width:S,height:m});v[d]&&b.setAttribute("toontalk_name",v[d]);!a.UTILITIES.has_animating_image(h)&&0<d&&($(b).removeClass("toontalk-box-eighth-size-border-left toontalk-box-quarter-size-border-left toontalk-box-half-size-border-left toontalk-box-full-size-border-left"),$(b).removeClass("toontalk-box-eighth-size-border-top toontalk-box-quarter-size-border-top toontalk-box-half-size-border-top toontalk-box-full-size-border-top"),k?$(b).addClass(y+"-left"):$(b).addClass(y+"-top"));b!==
h&&(l(g,h,S,m),b.appendChild(h),c.get_contents().update_display());c.is_element()&&(c=c.get_contents(),c.set_size_attributes(S,m,!0))},k=this.get_horizontal();$(b).is(".toontalk-box");var h=function(){var h=$(b).children(".toontalk-box-hole");h.length===f?h.each(function(a,b){var c=this.get_hole(a);c&&g(b,c,a)}.bind(this)):(h.remove(),this.get_holes().forEach(function(a,c){t=a.get_element();$(t).addClass("toontalk-hole-number-"+c);g(t,a,c);b.appendChild(t)}));$(b).parent(".toontalk-conditions-contents-container").is("*")||
($(b).parent(".toontalk-box-hole").is("*")?a.UTILITIES.set_css(b,{width:"",height:""}):a.UTILITIES.set_css(b,{width:n,height:c}))}.bind(this),v=this.get_name().split(";"),t,n,u,c,r,y,z;a.logging&&0<=a.logging.indexOf("display")&&console.log("Updating display of "+this.to_debug_string());$(b).addClass("toontalk-box");$(b).removeClass("toontalk-box-eighth-size-border toontalk-box-quarter-size-border toontalk-box-half-size-border toontalk-box-full-size-border");a.UTILITIES.give_tooltip(b,this.get_title());
a.debugging&&(this._debug_string=this.to_debug_string());this.get_erased()?($(b).addClass("toontalk-box-erased"),$(b).children(".toontalk-side").remove()):($(b).removeClass("toontalk-box-erased"),n=0===f?0:$(b).width()||a.box.get_default_width(),c=$(b).height()||a.box.get_default_height(),k?(u=0===f?0:n/f,r=c):(u=n,r=c/f),z=this.get_border_size(u,r),y=4===z?"toontalk-box-eighth-size-border":8===z?"toontalk-box-quarter-size-border":16===z?"toontalk-box-half-size-border":"toontalk-box-full-size-border",
k?u-=(f-1)*z/f:r-=(f-1)*z/f,$(b).addClass(y),a.UTILITIES.set_timeout(h))};b.get_default_width=function(){return 164};b.get_default_height=function(){return 68};b.get_border_size=function(a,b){var g;if(0===a)return g=$(this.get_frontside_element()).width(),16>=g?4:32>=g?8:64>=g?16:32;a||(a=$(this.get_frontside_element()).width());b||(b=$(this.get_frontside_element()).height());return 32>=a||32>=b?4:64>=a||64>=b?8:128>=a||128>=b?16:32};b.get_name_input_label=function(){return"The labels of my holes are"};
b.get_name_input_title=function(){return"Each hole label is followed by a ';'. Yoou may enter as many hole labels as there are holes."};b.drop_on=function(a,b,g,k){if(a.box_dropped_on_me)return b=a.box_dropped_on_me(this,g,k),g&&a.rerender(),b&&this.remove(),b;if(a.widget_dropped_on_me)return a.widget_dropped_on_me(this,b,g,k);console.log("No handler for drop of "+this+" on "+a)};b.box_dropped_on_me=function(a,b){console.log("box on box not yet implemented");return!1};b.widget_dropped_on_me=function(b,
f,g,k){var h=this.which_hole(g),l;if(0<=h)return l=this.get_hole(h),(h=l.get_contents())?b.drop_on(h,f,g,k):l.widget_dropped_on_me(b,f,g,k);a.UTILITIES.report_internal_error(b+" dropped on "+this+" but no event was provided.")};b.get_index_of=function(a){return a.get_parent_of_frontside()&&a.get_parent_of_frontside().get_index&&a.get_parent_of_frontside().get_index()};b.removed_from_container=function(b,f,g,k,h){f=!!g;"undefined"===typeof k&&(k=this.get_index_of(b));0<=k?(this.set_hole(k,void 0,f),
f&&(this.rerender(),b.restore_dimensions())):h&&a.UTILITIES.report_internal_error("Attempted to remove "+b+" from "+this+" but not found.")};b.get_path_to=function(b,f){var g=this.get_size(),k,h;if("empty hole"===b.get_type_name()){g=b.get_parent_of_frontside();h=a.box.path.create(b.get_index());if(g===this)return h;g=this.get_path_to(g);if(!g)return;g.next=h;return g}for(k=0;k<g;k++)if(h=this.get_hole_contents(k)||this.get_contents_temporarily_removed(k)){if(b===h||h.top_contents_is&&h.top_contents_is(b))return a.box.path.create(k);
if(h.get_path_to&&(h=h.get_path_to(b,f)))return g=a.box.path.create(k),g.next=h,g}};b.element_to_highlight=function(a){a=this.which_hole(a,!0);var b;if(0>a||0===this.get_size())return this.get_frontside_element();a=this.get_hole(a);return(b=a.get_contents())?b.get_frontside_element():a.get_frontside_element()};b.which_hole=function(a){var b=this.get_horizontal(),g=this.get_frontside_element(),k=this.get_size(),h,l;if(0!==k&&(h=$(g).offset(),g=b?$(g).width()/k:$(g).height()/k,l=b?h.left:h.top,a))for(h=
0;h<k;h++)if(l+=g,(b?a.pageX<=l:a.pageY<=l)||h+1===k)return h};b.dereference_path=function(b,f,g){var k,h;if(b){k=b.get_index&&b.get_index();if(!a.debugging||"number"===typeof k){if(h=this.get_hole_contents(k)){if(h.dereference_contents&&!b.not_to_be_dereferenced)return h.dereference_contents(b,f,g);if(b.next){if(h.dereference_path)return h.dereference_path(b.next,f,g);a.UTILITIES.report_internal_error("Expected to refer to a part of "+h+" but it lacks a method to obtain "+a.path.toString(b.next))}b.removing_widget&&
("empty hole"===h.get_type_name()?a.UTILITIES.report_internal_error("Robot is trying to remove something from an empty hole. "):h.get_infinite_stack()||g.remove_from_container(h,this));return h}return this.get_hole(k)}a.UTILITIES.report_internal_error(this+" unable to dereference the path: "+a.path.toString(b))}else return this};b.path={create:function(b){return{get_index:function(){return b},toString:function(){return"scale"===this.true_type?0===b?"the left pan ":"the right pan ":"the "+a.UTILITIES.ordinal(b)+
" hole "},get_json:function(a){return{type:"box_path",index:b,true_type:this.true_type,next:this.next&&this.next.get_json(a)}}}}};b.get_custom_title_prefix=function(){return"Drop things in my holes to store them."};a.creators_from_json.box_path=function(d,f){var g=b.path.create(d.index);d.next&&(g.next=a.UTILITIES.create_from_json(d.next,f));d.true_type&&(g.true_type=d.true_type);return g};return b}(window.TOONTALK);window.TOONTALK.box_backside=function(a){return{create:function(b){var d=a.backside.create(b),
f=a.UTILITIES.create_text_input(b.get_size().toString(),"toontalk-box-size-input","Number of holes","Type here to edit the number of holes.",void 0,"number",function(c){(c=a.UTILITIES.input_area_drop_handler(c,b.receive_size_from_dropped.bind(b),b))&&b.robot_in_training()&&b.robot_in_training().dropped_on_text_area(c,b,{area_selector:".toontalk-box-size-input",setter:"receive_size_from_dropped",toString:"for the box's size"})}),g=a.UTILITIES.create_radio_button("box_orientation","horizontal","toontalk-horizontal-radio-button",
"Left to right","Show box horizontally."),k=a.UTILITIES.create_radio_button("box_orientation","vertical","toontalk-vertical-radio-button","Top to bottom","Show box vertically."),h=function(){var a=parseInt(f.button.value.trim(),10);b.set_size(a,!0)&&b.robot_in_training()&&b.robot_in_training().edited(b,{setter_name:"set_size",argument_1:a,toString:"by changing the number of holes to "+a+" of the box",button_selector:".toontalk-box-size-input"})},l=function(){var c=a.UTILITIES.selected_radio_button(g.button,
k.button),d=c.value,f="horizontal"===d;b.set_horizontal(f,!0);b.robot_in_training()&&b.robot_in_training().edited(b,{setter_name:"set_horizontal",argument_1:f,toString:"by changing the orientation to "+d+" of the box",button_selector:"."+c.className.split(" ",1)[0]})},t=d.get_element(),n=a.backside.create_advanced_settings_button(d,b),u=d.update_display.bind(d);f.button.addEventListener("change",h);f.button.addEventListener("mouseout",h);g.button.addEventListener("change",l);k.button.addEventListener("change",
l);d.update_display=function(){f.button.value=b.get_size().toString();b.get_horizontal()?a.UTILITIES.check_radio_button(g):a.UTILITIES.check_radio_button(k);u()};t.appendChild(f.container);t.appendChild($(a.UTILITIES.create_horizontal_table(g.container,k.container)).buttonset().get(0));t.appendChild(n);d.add_advanced_settings();d.rerender();return d}}}(window.TOONTALK);window.TOONTALK.box_hole=function(a){return{create:function(b){var d=Object.create(this),f,g,k;d.is_hole=function(){return!0};d.is_empty_hole=
function(){return!f};d.get_element=function(){k||(k=document.createElement("div"),k.className="toontalk-box-hole toontalk-frontside toontalk-side",k.toontalk_widget=d);return k};d.get_frontside=function(a){return f?f.get_frontside(a):this.get_element()};d.get_side_element=function(){return this.get_element()};d.get_frontside_element=function(a){return this.get_element()};d.get_frontside=function(){return this};d.widget_dropped_on_me=function(b,d,f,g){var k=this.get_parent_of_frontside(),c,l,q;b.dropped_on_other&&
b.dropped_on_other(this,!1,f,g);f?(a.sounds&&a.sounds.fall_inside.play(),d=this.get_element(),g=b.is_plain_text_element(),q=b.get_element(),$(q).css({"z-index":a.UTILITIES.next_z_index()}),l=$(q.parentElement).offset(),c=$(d).offset(),g||(q.style.left=f.pageX-l.left+"px",q.style.top=f.pageY-l.top+"px",$(q).addClass("toontalk-animating-element")),q.style.width=d.style.width,q.style.height=d.style.height,q.style.left=c.left-l.left+"px",q.style.top=c.top-l.top+"px",f=function(){$(q).removeClass("toontalk-animating-element");
k.render();this.set_contents(b)}.bind(this),setTimeout(f,g||a.UTILITIES.has_animating_image(q)?0:1200),k.robot_in_training()&&k.robot_in_training().dropped_on(b,this),b.save_dimensions&&b.set_size_attributes&&b.set_size_attributes($(d).width(),$(d).height())):(k.render(),this.set_contents(b));return!0};d.get_json=function(){return null};d.add_to_json=function(a){return a};d.copy=function(d){return a.box_hole.create(b)};d.match=function(){return"matched"};d.get_type_name=function(a){return f?f.get_type_name(a):
a?"empty holes":"empty hole"};d.is_of_type=function(a){return f?f.is_of_type(a):"empty hole"===a};d.get_box=function(){return this.get_parent_of_frontside()};d.update_display=function(){var a;f&&(a=this.get_frontside_element(),l(f,f.get_frontside_element(),$(a).width(),$(a).height()))};d.dereference=function(){return f?f.dereference():this};d.get_index=function(){return b};d.get_contents=function(){return f};d.set_contents=function(b){var d=this.get_listeners("value_changed");d&&(f!==b&&d.forEach(function(a){a({type:"value_changed",
old_value:f,new_value:b})}),f&&d.forEach(function(a){f.remove_listener("value_changed",a,!0)}),b&&d.forEach(function(a){b.add_listener("value_changed",a)}));f&&f.set_parent_of_frontside(void 0);(f=b)?(f.set_parent_of_frontside(this),a.debugging&&(this._debug_string="A hole containing "+f.to_debug_string()),f.set_visible(g)):a.debugging&&(this._debug_string=this.to_debug_string())};d.visible=function(){return this.get_parent_of_frontside().visible()};d.set_visible=function(a){g=a;f&&f.set_visible(a)};
d.remove=function(){f&&f.remove()};d.render=function(){f&&a.DISPLAY_UPDATES.pending_update(this)};d.rerender=function(){if(f.visible())return this.render()};d.set_running=function(a){f&&f.set_running(a)};d.maintain_proportional_dimensions=function(){if(f)return f.maintain_proportional_dimensions()};d.removed_from_container=function(b,d,g,n,k){f?(g&&f.restore_dimensions(),this.set_contents(void 0),g&&this.get_parent_of_frontside().render()):k&&a.UTILITIES.report_internal_error("Holes can't be removed from containers.")};
d.temporarily_remove_contents=function(a,b){if(f)return this.get_parent_of_frontside().temporarily_remove_contents(a,b)};d.toString=function(){return f?f.toString():"_"};d.get_description=function(){return f?f.get_description():"_"};d.get_full_description=function(a){return f?f.get_full_description(a):"_"};d.is_backside=function(){return!1};d.get_widget=function(){return this.get_parent_of_frontside()};d.is_number=function(){return f?f.is_number():!1};d.is_box=function(){return f?f.is_box():!1};d.is_scale=
function(){return f?f.is_scale():!1};d.is_bird=function(){return f?f.is_bird():!1};d.is_nest=function(){return f?f.is_nest():!1};d.is_robot=function(){return f?f.is_robot():!1};d.is_element=function(){return f?f.is_element():!1};d.is_sensor=function(){return f?f.is_sensor():!1};d.is_top_level=function(){return!1};a.widget.has_parent(d);a.widget.has_listeners(d);if(a.debugging||a.logging)d.to_debug_string=function(){var d="the "+a.UTILITIES.ordinal(b)+" hole of the "+(this.get_parent_of_frontside()?
this.get_parent_of_frontside().to_debug_string():"not-yet-defined box");return f?d+" which contains "+f.to_debug_string():d+" which is empty"},d._debug_string=d.to_debug_string();return d}}}(window.TOONTALK);window.TOONTALK.box.function=function(){var a=k.create_function_table();a.add_function_object("box hole",function(b,d,f){return a.typed_bird_function(b,function(a,b){var d=Math.round(a.to_float());if(1>d)k.UTILITIES.display_message("The box hole function bird cannot accept "+a+". She only accepts positive numbers.");
else if(d>b.get_size())k.UTILITIES.display_message("The box hole function bird cannot accept "+a+". The box only has "+b.get_size()+" holes.");else return b.get_hole_contents(d-1)},["number","box"],2,"box hole",d,f)},"The bird will return with what is in a hole of the box. The number determines which hole's contents are returned. 1 for the first hole.","hole",["number","box"]);a.add_function_object("count holes",function(b,d,f){return a.typed_bird_function(b,function(a){return k.number.create(a.get_size())},
["box"],1,"count holes",d,f)},"The bird will return with the number of holes the box has.","count holes",["box"]);a.add_function_object("fill hole",function(b,d,f){return a.typed_bird_function(b,function(a,b,d){var f=Math.round(a.to_float());if(1>f)k.UTILITIES.display_message("The fill hole function bird cannot accept "+a+". She only accepts positive numbers.");else return f>b.get_size()&&b.set_size(f),b.set_hole(f-1,d),b},["number","box",void 0],3,"fill hole",d,f)},"The bird will return with the box where one of its holes has been filled by whatever is in the fourth hole. The number determines which hole's contents are changed. 1 for the first hole.",
"fill hole",["number","box",void 0]);a.add_function_object("split box",function(b,d,f){return a.typed_bird_function(b,function(a,b){var d=Math.round(a.to_float()),f=b.get_size();if(0>d)k.UTILITIES.display_message("The box split function bird cannot accept "+a+". She only accepts zero or positive numbers.");else if(d>f)k.UTILITIES.display_message("The box split function bird cannot accept "+a+". The box only has "+f+" holes.");else{b.get_holes();var f=f-d,l=k.box.create(f),n;for(n=0;n<f;n++)l.set_hole(n,
b.get_hole_contents(n+d));b.set_size(d);return k.box.create(2,!1,[b,l])}},["number","box"],2,"split box",d,f)},"The bird will return with a box with the original box split in two. The number determines where the split is. 1 for after the first hole.","split",["number","box"]);a.add_function_object("merge boxes",function(b,d,f){return a.typed_bird_function(b,function(){var a=0,b,d,f,l;if(0===arguments.length)return k.box.create(0);d=arguments[0];for(b=0;b<arguments.length;b++)a+=arguments[b].get_size();
f=d.get_size();d.set_size(a);for(b=1;b<arguments.length;b++)for(l=arguments[b].get_size(),a=0;a<l;a++)d.set_hole(f,arguments[b].get_hole_contents(a)),f++;return d},["box"],void 0,"merge boxes",d,f)},"The bird will return with a box that joins together all the boxes.","merge",["any number of boxes"]);return a.get_function_table()}()})(window.TOONTALK);(function(){var k,l,a,b,d;window.TOONTALK.bird=function(a){var b=Object.create(a.widget),q=function(b,d,g){var n=b.get_function_type();b=b.get_function_object();var k=Object.keys(TOONTALK[n]["function"]),c=k.map(function(a){return TOONTALK[n]["function"][a].title}),k=a.UTILITIES.create_select_menu("functions",k,"toontalk-select-function","Which function should I fly to? ","Click to select the function that this bird will use when given a box.",c);d=d.get_element();b&&(k.menu.value=b.name);k.menu.addEventListener("change",
function(a){g.set_function_name(a.target.value)});d.insertBefore(k.container,d.firstChild)};b.create=function(h,v){var t=Object.create(b),n=[],u=[];k=function(a){h=a};t.is_bird=function(){return!0};t.widget_dropped_on_me=function(b,d,g,n,k,l){var q=d?b.get_backside():b,u,t;if(h){if(h.has_ancestor(b))return a.UTILITIES.display_message("Bird can't take its nest to its nest!"),!1;!(h.visible()||this.visible()||h.any_nest_copies_visible())||n&&n.visible()&&!n.animate_consequences_of_actions()?(h.add_to_contents(q,
g,n),n&&n===q.robot_waiting_before_next_step&&(q.robot_waiting_before_next_step=void 0,n.run_next_step())):(l||b.save_dimensions(),u=this.get_frontside_element(),setTimeout(function(){$(u).removeClass("toontalk-bird-gimme")}),b.set_visible(!0),n&&!k&&(b.robot_waiting_before_next_step=n,b.remove_from_parent_of_frontside(),n.run_next_step&&(t=function(){q.robot_waiting_before_next_step=void 0;n.run_next_step()})),h.animate_bird_delivery(q,this,t,g,n))}else console.log("TODO: handle drop on a nestless bird -- just removes other?");
g&&this.robot_in_training()&&this.robot_in_training().dropped_on(b,this);return!0};t.animate_delivery_to=function(b,d,g,k,l,q,t,v){var J=!!g,M=this.get_parent_of_frontside(),C=this.get_frontside_element();$(C).width();var L=this.closest_visible_ancestor_or_frontside(),I=$(L.get_frontside_element()).offset(),S=function(){var b=$(V).offset(),c;a.sounds&&a.sounds.bird_fly.pause();J?this.remove():this.visible()&&(c=function(){$(C).removeClass("toontalk-bird-morph-to-static");$(C).addClass(this.get_class_name_with_color("toontalk-bird-static"));
M&&M.get_widget().rerender()}.bind(this),C.style.position=Y,b&&(I.left-=b.left,I.top-=b.top),a.UTILITIES.set_css(C,I),V&&V.appendChild(C),M&&(M.get_widget().is_top_level()?this.rerender():M.get_widget().rerender()),R&&(va.remove_backside_widget(this,!1,!0),R(),n&&(b=n,n=[],u=[],b.forEach(function(a){a()}))),a.UTILITIES.add_animation_class(C,"toontalk-bird-morph-to-static"),a.UTILITIES.add_one_shot_event_handler(C,"animationend",1E3,c));q&&q()}.bind(this),m=function(){try{g.add_to_contents(b,t,v,this,
!0)}catch(d){if(d.wait_for_nest_to_receive_something){d.wait_for_nest_to_receive_something.run_when_non_empty(m,this);q&&(q(),q=void 0);return}console.error(d.stack);throw d;}B($(C).offset());a.UTILITIES.set_timeout(function(){this.fly_to(I,S,v)}.bind(this))}.bind(this),A=function(b,c){b.width_before_carry=$(b).width();b.height_before_carry=$(b).height();this.element_to_display_when_flying=b;c&&(this.update_display(),setTimeout(function(){c.update_display()}));$(this.element_to_display_when_flying).addClass("toontalk-carried-by-bird");
a.UTILITIES.set_timeout(function(){a.UTILITIES.set_css(this.element_to_display_when_flying,{left:"",top:"",width:"",height:"",position:""});this.update_display()}.bind(this))}.bind(this),B=function(d){this.element_to_display_when_flying&&($(this.element_to_display_when_flying).removeClass("toontalk-carried-by-bird"),d?(a.UTILITIES.set_css(this.element_to_display_when_flying,{width:this.element_to_display_when_flying.width_before_carry||"",height:this.element_to_display_when_flying.height_before_carry||
"","z-index":a.UTILITIES.next_z_index()}),$(C).closest(".toontalk-top-level-backside").append(this.element_to_display_when_flying),a.UTILITIES.set_absolute_position($(this.element_to_display_when_flying),d),(d=b.get_parent_of_frontside())&&!d.is_backside()?d.rerender():b.rerender()):$(this.element_to_display_when_flying).remove(),this.element_to_display_when_flying=void 0,this.update_display())}.bind(this),E,T,V,Y,la,aa,R,ma,ga,ea,va;a.sounds&&a.sounds.bird_fly.play();g||(g=h);ea=b.get_element();
A(ea,b);d.is_function_nest()||(T=d.get_widget().closest_visible_ancestor_or_frontside().get_widget().get_frontside_element());if(!d.visible()&&!this.visible()||!d.is_function_nest()&&!$(T).is(":visible"))g.add_to_contents(b,t,v,this,!0);else if(d.is_function_nest()||(T=d.get_widget().closest_visible_ancestor_or_frontside().get_widget().get_frontside_element(),E=$(T).offset(),aa=$(g.get_frontside_element()).closest(".toontalk-top-level-backside")),aa&&aa.is("*")||(aa=$(this.get_frontside_element()).closest(".toontalk-top-level-backside")),
(d=aa.offset())||(d={left:0,top:0}),k?I={left:k+d.left,top:l+d.top}:0===I.left&&0===I.top&&(I={left:-ea.clientWidth,top:d.top+aa.height()/2}),E||(E={left:-2*ea.clientWidth,top:d.top+aa.height()/2}),V=C.parentElement,L=$(C).width(),la=$(C).height(),Y=C.style.position,C.style.position="absolute",va=this.top_level_widget(),M&&M.temporarily_remove_contents&&(R=M.temporarily_remove_contents(this,!0))&&va.add_to_top_level_backside(this),aa.append(C),a.UTILITIES.set_css(C,{left:k||I.left-d.left,top:l||I.top-
d.top,width:L,height:la}),a.logging&&0<=a.logging.indexOf("bird")&&console.log(this.to_debug_string()+" from "+(k||I.left-d.left)+", "+(l||I.top-d.top)+" to "+E.left+", "+E.top),(ma=g.get_contents_frontside_element&&g.get_contents_frontside_element())&&g.visible()&&(!v||v.animate_consequences_of_actions())){k=$(T).width();l=$(T).height();ga=$(T).offset();d.max_left=d.left+aa.width();d.max_top=d.top+aa.height();E.left+=k;E.top+=l;var wa={left:Math.min(ga.left+k,d.max_left-k),top:Math.min(ga.top+l,
d.max_top-l)},za={left:Math.max(ga.left-k,d.left),top:Math.max(ga.top-l,d.top)};E=function(){var a=function(){g.visible()?(g.set_locked(!0),this.fly_to(ga,xa,v,300)):(g.add_to_contents(b,t,v,this,!0),q&&(q(),q=void 0))}.bind(this);B(wa);g.get_locked()?g.run_when_unlocked(a):a()}.bind(this);var xa=function(){A(ma);this.fly_to(za,Ma,v,300)}.bind(this),Ma=function(){B(za);this.fly_to(wa,ra,v,300)}.bind(this),ra=function(){A(ea,b);this.fly_to(ga,ca,v,300)}.bind(this),ca=function(){var d=g.get_contents_dimensions();
B(ga);a.UTILITIES.set_css(b.get_frontside_element(),d);this.fly_to(za,U,v,300)}.bind(this),U=function(){A(ma);this.fly_to(ga,p,v,300)}.bind(this),p=function(){g.set_locked(!1);B();g.update_display();m()}.bind(this);this.fly_to(wa,E,v,300)}else this.fly_to(E,m,v,300)};t.get_json=function(b){return{type:"bird",nest:h&&a.UTILITIES.get_json(h,b)}};t.copy=function(a){var b,f,g;if(a)if(a.just_value)b=this.create(void 0,this.get_description());else{if((g=h.get_guid())&&a.nests_copied&&a.nests_copied[g]){b=
a.nests_copied[g][0];d.call(b);for(f=1;f<a.nests_copied[g].length;f++)l.call(a.nests_copied[g][f],b);b=this.create(b,this.get_description())}else b=this.create(h,this.get_description());a.birds_copied||(a.birds_copied={});g&&(a.birds_copied[g]||(a.birds_copied[g]=[]),a.birds_copied[g].push(b))}else b=h&&h.is_function_nest()?this.create(h.copy(),this.get_description()):this.create(h,this.get_description());return this.add_to_copy(b,a)};t.run_when_non_empty=function(a,b){0>u.indexOf(b)&&(n.push(a),
u.push(b))};t.create_backside=function(){var b=a.bird_backside.create(this);h&&h.is_function_nest()&&q(h,b,this);return b};t.get_help_URL=function(){return h&&h.is_function_nest()?"docs/manual/function-birds.html":"docs/manual/birds-nests.html"};t.is_function_bird=function(){return h&&h.is_function_nest()};t.get_custom_title_prefix=function(){var a;return h?h.is_function_nest()&&(a=h.get_function_object())?a.get_description():"Drop something on me and I'll take it to my nest.":"This bird no longer knows where her nest is. She'll get rid of anything you give her."};
t.toString=function(a){return h?h.is_function_nest()?h.get_function_object().toString():"a bird":a&&"conditions"===a.role?"any bird":"a bird without a nest"};t.update_display=function(){var b=this.get_frontside(!0);this.get_backside();var d;d=b.get_element();h&&d.setAttribute("toontalk_name",h.get_name());a.UTILITIES.give_tooltip(d,this.get_title());$(d).is(".toontalk-bird, .toontalk-side-animating")||($(d).addClass(this.get_class_name_with_color("toontalk-bird toontalk-bird-static")),d.addEventListener("dragenter",
function(b){0<=d.className.indexOf("toontalk-bird-static")&&($(d).removeClass(this.get_class_name_with_color("toontalk-bird-static")),a.UTILITIES.add_animation_class(d,"toontalk-bird-gimme"))}.bind(this)),d.addEventListener("dragleave",function(a){$(d).is(".toontalk-bird-gimme")&&($(d).addClass(this.get_class_name_with_color("toontalk-bird-static")).removeClass("toontalk-bird-gimme"),this.get_parent_of_frontside().render())}.bind(this)));this.element_to_display_when_flying?d.appendChild(this.element_to_display_when_flying):
$(d).children(".toontalk-side").remove()};t.set_function_name=function(a){h&&h.is_function_nest()&&h.set_function_name(a)&&(this.rerender(),this.robot_in_training()&&this.robot_in_training().edited(this,{setter_name:"set_function_name",argument_1:a,toString:"change the function bird to '"+a+"'",button_selector:".toontalk-select-function"}))};t.get_class_name_with_color=function(a){return h&&h.get_class_name_with_color?h.get_class_name_with_color(a):a};t.get_name=function(){return h&&h.get_name()};
h&&h.set_name&&(t.set_name=function(a,b){return h.set_name(a,b)});t=t.add_standard_widget_functionality(t);t.set_description(v);a.debugging&&(t._debug_id=a.UTILITIES.generate_unique_id(),t._debug_string=t.to_debug_string());return t};b.create_function=function(d,k,l){return b.create(a.nest.create_function(k,d,l||a.UTILITIES.get_first_property(a[d].function)))};b.match=function(a){return a.match_with_any_bird?a.match_with_any_bird(this):this};b.match_with_any_bird=function(){return"matched"};b.fly_to=
function(b,d,g,n){var k=this.get_frontside_element(),c=$(k).offset(),c=Math.atan2(b.top-c.top,b.left-c.left),l="toontalk-fly-west toontalk-fly-northwest toontalk-fly-north toontalk-fly-northeast toontalk-fly-east toontalk-fly-southeast toontalk-fly-south toontalk-fly-southwest".split(" ")[Math.round(4*(c/Math.PI+1))%8];$(k).position();c=function(){$(k).removeClass(l);n?setTimeout(d,g?g.transform_step_duration(n):n):d()}.bind(this);a.UTILITIES.add_animation_class(k,l);$(k).removeClass($(k).removeClass(this.get_class_name_with_color("toontalk-bird-static")));
this.animate_to_absolute_position(b,c,g&&g.transform_animation_speed(a.UTILITIES.default_animation_speed))};b.get_type_name=function(a,b){return a?b&&this.is_function_bird()?"function birds":"birds":"bird"};b.maintain_proportional_dimensions=function(){return!0};b.matching_resource=function(a){return a.get_type_name&&a.get_type_name()===this.get_type_name()};b.drop_on=function(a,b,d,f){if(a.widget_dropped_on_me)return a.widget_dropped_on_me(this,!1,d,f)};a.creators_from_json.bird=function(b,d){return a.bird.create(a.UTILITIES.create_from_json(b.nest,
d),b.description)};return b}(window.TOONTALK);window.TOONTALK.bird_backside=function(a){return{create:function(b){b=a.backside.create(b);b.add_advanced_settings(!0);return b}}}(window.TOONTALK);window.TOONTALK.nest=function(f){var g=Object.create(f.widget),q,h=0,v=0;g.default_maximum_capacity=10;g.maximum_capacity=g.default_maximum_capacity;g.create=function(t,n,u,c,r,y){var z=Object.create(g),F=[],H=[],K=[],D,J,M;n||(n=[]);r||(h++,r=h);l=function(d){c&&b.call(c,this);c=d;u=d.get_guid();a.call(d,
this)};d=function(){c&&b.call(c,this);c=void 0;u=f.UTILITIES.generate_unique_id()};a=function(a){q||(q=f.UTILITIES.generate_unique_id());this[q](a)};b=function(a){q||(q=f.UTILITIES.generate_unique_id());this[q](a,!0)};z.is_nest=function(){return!0};z.get_guid=function(){return u};z.matched_by=function(a){return 0<n.length?f.UTILITIES.match(a,n[0].get_widget()):[[this,a]]};z.run_when_non_empty=function(a,b){0<n.length?a(n[0]):0>K.indexOf(b)&&(F.push(a),K.push(b))};z.dereference=function(){return 0<
n.length?n[0]:this};z.match=function(a){return 0<n.length?n[0].match(a):a.match_nest_with_nest?a.match_nest_with_nest(this):a};z.add_to_contents=function(a,b,c,d,m){var h;h=n.push(a);h>g.maximum_capacity&&c&&!c.visible()&&!this.visible()&&(f.logging&&0<=f.logging.indexOf("nest")&&console.log(this.to_debug_string()+" postponing addition of "+a.to_debug_string()+" by "+c.to_debug_string()+". Stack is "+n.length+" long. "+H.length+" previously postponed."),c.add_body_finished_listener(function(a,b,d){c.set_stopped(!0);
H.push(function(){c.set_stopped(!1);c.run_actions(a,b,d)})}));f.logging&&0<=f.logging.indexOf("nest")&&console.log(this.to_debug_string()+" added "+a.to_debug_string()+" nest now contains "+n.length+" widgets.");1===h?(0<F.length&&(h=F,F=[],K=[],h.forEach(function(b){b(a)})),a.set_visible(this.visible())):(a.get_widget().hide(),a.set_visible(!1));a.is_backside()?a.get_widget().set_parent_of_backside(this):a.get_widget().set_parent_of_frontside(this);D&&!m&&(d?D.forEach(function(m){m.has_ancestor(a.get_widget())||
m.animate_bird_delivery(f.UTILITIES.copy_side(a),d,void 0,b,c)}):D.forEach(function(d){d.has_ancestor(a.get_widget())||d.add_to_contents(f.UTILITIES.copy_side(a,!1,!0),b,c)}));this.rerender()};z.animate_bird_delivery=function(a,b,c,d,m){var g,h,n;b.animate_delivery_to(a,this,void 0,void 0,void 0,c,d,m);D&&(g=$(b.closest_visible_ancestor().get_widget().get_frontside_element()).closest(":visible").position(),h=b.get_parent_of_frontside().get_element(),n=this.visible(),D.forEach(function(c){var k=f.UTILITIES.copy_side(a,
!1,n),l,q;c.has_ancestor(a.get_widget())||(g&&(c.visible()||n)?(l=b.copy({just_value:!0}),q=l.get_frontside_element(!0),$(h).append(q),l.animate_delivery_to(k,c,c,g.left,g.top,void 0,d,m)):c.add_to_contents(k,void 0,m))}))};z.get_contents_frontside_element=function(){if(0<n.length)return n[0].get_widget().get_frontside_element()};z.get_locked=function(){return this.locked_for_animating_deliveries};z.set_locked=function(a){this.locked_for_animating_deliveries=a;!a&&this.to_run_when_unlocked&&0<this.to_run_when_unlocked.length&&
this.to_run_when_unlocked.shift()()};z.run_when_unlocked=function(a){this.to_run_when_unlocked?this.to_run_when_unlocked.push(a):this.to_run_when_unlocked=[a]};z.removed_from_container=function(a,b,c,d,m){a=n.shift();f.logging&&0<=f.logging.indexOf("nest")&&console.log(this.to_debug_string()+" removed "+a.to_debug_string()+" remaining widgets is "+n.length);if(a)return a.is_backside()?a.get_widget().set_parent_of_backside(void 0):a.get_widget().set_parent_of_frontside(void 0),this.visible()&&(a.get_widget().restore_dimensions(),
0<n.length&&(n[0].set_visible(!0),$(n[0].get_element()).show()),this.render()),n.length<g.maximum_capacity&&0<H.length&&(f.logging&&0<=f.logging.indexOf("nest")&&console.log(this.to_debug_string()+" running "+H.length+" postponed additions. Stack is "+n.length+" long."),g.maximum_capacity=Number.MAX_VALUE,H.forEach(function(a){a()}),g.maximum_capacity=g.default_maximum_capacity,H=[]),a;m&&f.UTILITIES.report_internal_error("Nothing removed from nest!")};z.dereference_path=function(a,b,c){if(0===n.length)return this.get_guid()?
{wait_until_this_nest_receives_something:this}:this;if(n)return n[0].dereference_path(a,b,c);f.UTILITIES.display_message("Robot expected to find a nest something that it could get "+f.path.toString(a)+". But the nest is empty.");return this};z.dereference_contents=function(a,b,c){var d,m,g,h;return 0===n.length?{wait_until_this_nest_receives_something:this}:a.removing_widget?(a=n[0],c.remove_from_container(a,this),this.visible()&&(g=this.get_frontside_element(),c=$(g).offset(),b=$(g).closest(".toontalk-backside-of-top-level"),
(d=b.offset())||(d={left:0,top:0}),m=a.get_frontside_element(),h=$(g).width(),g=$(g).height(),f.UTILITIES.set_css(m,{left:.1*h+c.left-d.left,top:.1*g+c.top-d.top,width:h*f.nest.CONTENTS_WIDTH_FACTOR,height:g*f.nest.CONTENTS_HEIGHT_FACTOR}),b.append(m)),a):a.next?n[0].get_widget().dereference_path(a.next,b,c):n[0].get_widget()};z.get_json=function(a){return{type:"nest",contents:f.UTILITIES.get_json_of_array(n,a),guid:u,original_nest:c&&f.UTILITIES.get_json(c,a),serial_number:r,name:this.get_name()}};
z.copy=function(a){var b,d,g,m;if(a&&a.just_value){if(0<n.length&&(b=n[0].get_widget().copy(a),!a.copy_covered_nests))return b;d=f.nest.create(this.get_description(),[],"in a robot's condition",void 0,r,this.get_name());b&&d.add_to_contents(b);return d}b=f.UTILITIES.copy_widget_sides(n,a);a?a.fresh_copy?d=f.nest.create(this.get_description(),b,u&&f.UTILITIES.generate_unique_id()):(g=c||this,a.birds_copied&&a.birds_copied[u]?(m=g.get_guid(),a.nests_copied&&a.nests_copied[m]?(d=a.nests_copied[m][0].copy(),
a.nests_copied[m].forEach(function(a){l.call(a,d)})):d=f.nest.create(this.get_description(),b,f.UTILITIES.generate_unique_id()),a.birds_copied[u].forEach(function(a){k.call(a,d)})):d=f.nest.create(this.get_description(),b,u,g,r,this.get_name()),a.nests_copied||(a.nests_copied={}),a.nests_copied[g]?a.nests_copied[m].push(d):a.nests_copied[m]=[d]):d=f.nest.create(this.get_description(),b,u,c||this,r,this.get_name());return this.add_to_copy(d,a)};z.has_contents=function(){return 0<n.length};z.dropped_on_other=
function(a,b,c,d){var m,g,h,n,k,l,q;if(!u){u=f.UTILITIES.generate_unique_id();f.debugging&&(this._debug_string=this.to_debug_string());m=f.bird.create(this);if(d){d.add_newly_created_widget(m);if(!this.visible())return;this.robot_waiting_before_next_step=d}c&&this.robot_in_training()&&this.robot_in_training().add_newly_created_widget(m);f.sounds&&setTimeout(function(){f.sounds.hatching.play()},1E3);this.rerender();g=this.get_frontside_element(!0);f.UTILITIES.add_animation_class(g,"toontalk-hatch-egg");
k=function(){var k,r,u;if(b)k=a.get_backside();else if((u=f.UTILITIES.widget_from_jquery($(g).closest(".toontalk-top-level-backside")))||(u=f.UTILITIES.widget_from_jquery($(a.get_widget().get_frontside_element(!0)).closest(".toontalk-top-level-backside"))),u)k=u.get_backside();else{f.UTILITIES.report_internal_error("Unable to find the top-level backside for bird to go to.");return}r=k.get_element();u=$(r).offset();h=m.get_frontside_element(!0);$(h).removeClass(this.get_class_name_with_color("toontalk-bird-static"));
f.UTILITIES.add_animation_class(h,"toontalk-fly-southwest");n=f.UTILITIES.relative_position(g,r);f.UTILITIES.set_css(h,{left:n.left,top:n.top});c&&this.robot_in_training()?k.widget_dropped_on_me(m,!1,c,void 0,!0):k.widget_dropped_on_me(m,!1,c);$(g).removeClass("toontalk-hatch-egg").addClass(this.get_class_name_with_color("toontalk-empty-nest")).css({width:"",height:""});this.get_parent_of_frontside().get_widget().is_top_level()&&f.UTILITIES.set_css(g,{left:n.left-5,top:n.top+45});this.get_parent_of_frontside().render();
q=function(){$(h).removeClass("toontalk-fly-southwest");f.UTILITIES.set_timeout(function(){f.UTILITIES.add_animation_class(h,"toontalk-fly-down");$(h).removeClass(this.get_class_name_with_color("toontalk-bird-static"));l=function(){var a=function(){$(h).removeClass("toontalk-bird-morph-to-static toontalk-side-animating").addClass(this.get_class_name_with_color("toontalk-bird-static"))}.bind(this);$(h).removeClass("toontalk-fly-down");f.UTILITIES.add_animation_class(h,"toontalk-bird-morph-to-static");
f.UTILITIES.add_one_shot_event_handler(h,"animationend",1E3,a);d&&(this.robot_waiting_before_next_step=void 0,d.run_next_step());m.update_display()}.bind(this);f.UTILITIES.add_one_shot_event_handler(g,"animationend",1E3,l)}.bind(this))}.bind(this);$(h).removeClass(this.get_class_name_with_color("toontalk-bird-static"));k=Math.max(10,n.left-70);r=Math.max(10,n.top+70);m.animate_to_absolute_position({left:k+u.left,top:r+u.top},q,d&&d.transform_animation_speed(f.UTILITIES.default_animation_speed));this.rerender()}.bind(this);
f.UTILITIES.add_one_shot_event_handler(g,"animationend",2E3,k)}return!0};z.widget_dropped_on_me=function(a,b,c,d){c&&a.save_dimensions&&a.save_dimensions();0===n.length?(this.add_to_contents(b?a.get_backside():a,c,d),a.dropped_on_other?a.dropped_on_other(this,b,c,d):c&&this.robot_in_training()&&this.robot_in_training().dropped_on(a,this)):a.drop_on(n[0].get_widget(),b,c,d);return!0};z.drop_on=function(a,b,c,d){return a.widget_dropped_on_me?(a.widget_dropped_on_me(this,!1,c,d),!0):!1};z.element_to_highlight=
function(){return 0===n.length?this.get_frontside_element():n[0].get_frontside_element()};z.update_display=function(){var a=this.get_frontside(!0),b=this.get_backside(),c,d,m,g,h,a=a.get_element();a.setAttribute("toontalk_name",this.get_name());0<n.length?(c=n[0].get_widget(),n[0].is_backside()?(g=c.get_backside(!0),h=g.get_element(),g.update_display(),g.scale_to_fit(h,a)):(c.render(),h=n[0].get_element(),$(h).show()),d=$(a).width(),m=$(a).height(),0<d&&0<m&&f.UTILITIES.set_timeout(function(){var a=
this.get_contents_dimensions();a&&(f.UTILITIES.set_css(h,{width:a.width,height:a.height,left:.1*d,top:.1*m}),c.set_size_attributes&&c.set_size_attributes(a.width,a.height))}.bind(this),2),a.appendChild(h),$(a).addClass(this.get_class_name_with_color("toontalk-empty-nest")),n[0].is_backside()?c.set_parent_of_backside(this):c.set_parent_of_frontside(this)):(f.UTILITIES.give_tooltip(a,this.get_title()),u?($(a).removeClass(this.get_class_name_with_color("toontalk-nest-with-egg")),$(a).addClass(this.get_class_name_with_color("toontalk-empty-nest"))):
f.UTILITIES.add_animation_class(a,this.get_class_name_with_color("toontalk-nest-with-egg")));$(a).addClass("toontalk-nest");b&&b.rerender()};q||(q=f.UTILITIES.generate_unique_id());z[q]=function(a,b){if(!D){if(b)return;D=[]}b?D.splice(D.indexOf(a),1):D.push(a)};z.get_contents_dimensions=function(){var a=this.get_frontside_element(),b=$(a).width(),a=$(a).height(),b=f.nest.CONTENTS_WIDTH_FACTOR*b,a=f.nest.CONTENTS_HEIGHT_FACTOR*a,c=n[0];if(c){var d=c.is_box()?1:2,c=c.get_border_size?d*c.get_border_size(b,
a):0;return{width:b-c,height:a-c}}};z.get_path_to=function(a,b){var c,d;if(0<n.length){c=n[0].get_widget();if(c===a)return f.path.to_widget_on_nest();if(c.get_path_to)return d=f.path.to_widget_on_nest(),d.next=c.get_path_to(a,b),d}};z.walk_children=function(a){if(0<n.length)return a(n[0])};z.top_contents_is=function(a){return 0<n.length&&n[0].get_widget()===a};z.any_nest_copies_visible=function(){var a=!1;if(!D)return!1;D.some(function(b){b.visible()&&(a=!0)});return a};z.compare_with=function(a){if(0<
n.length)return n[0].compare_with(a);if(a.compare_with_nest)return-1*a.compare_with_nest(this)};z.compare_with_nest=function(a){return 0===n.length?0:1};z.compare_with_number=function(a){return 0<n.length?n[0].compare_with(a):-1};z.get_class_name_with_color=function(a){return r?a+["","-magenta","-yellow"][r%3]:a};z.generate_name=function(){v++;return"#"+v.toString()};z.has_name(z);J=z.set_name;z.set_name=function(a,b){var c=this.get_name();if(!J.call(this,a,b))return!1;b&&$(".toontalk-bird").each(function(){this.getAttribute("toontalk_name")===
c&&f.UTILITIES.widget_of_element(this).rerender()})};z.set_name(y);z.compare_with_box=z.compare_with_number;z.compare_with_scale=z.compare_with_number;z.add_standard_widget_functionality(z);M=z.set_visible;z.set_visible=function(a){M.call(this,a);a||this.set_locked(!1)};z.set_description(t);f.debugging&&(z._debug_id=f.UTILITIES.generate_unique_id(),z._debug_string=z.to_debug_string());c&&u&&(q||(q=f.UTILITIES.generate_unique_id()),c[q](z));return z};g.create_function=function(a,b,d){var c=function(){return!1},
g=f[b]&&f[b].function&&f[b].function[d],c={get_function_type:function(){return b},get_function_object:function(){return g},set_function_name:function(a){if(d===a)return!1;d=a;g=f[b]&&f[b].function&&f[b].function[d];this.add_to_contents=g.respond_to_message;return!0},is_function_nest:function(){return!0},copy:function(){return f.nest.create_function(a,b,d)},animate_bird_delivery:function(a,b,c,d,f){b.animate_delivery_to(a,this,void 0,void 0,void 0,c,d,f)},get_json:function(a){return{type:"function_nest",
function_type:b,function_name:g?g.name:f.UTILITIES.get_first_property(f[b].function)}},add_to_json:f.widget.add_to_json,get_widget:function(){return this},get_guid:function(){},get_name:function(){return g.short_name},has_ancestor:c,visible:c,any_nest_copies_visible:c,is_backside:c};f.widget.has_parent(c);f.widget.has_description(c);f.widget.add_sides_functionality(c);c.set_description(a);g?(c.add_to_contents=g.respond_to_message,f.debugging&&(c._debug_id=f.UTILITIES.generate_unique_id(),c._debug_string=
"a function nest that "+g.toString())):f.UTILITIES.report_internal_error("Cannot create a function nest because TOONTALK."+b+"."+d+" is not defined.");return c};f.creators_from_json.function_nest=function(a,b){return f.nest.create_function(a.description,a.function_type,a.function_name)};g.create_backside=function(){return f.nest_backside.create(this)};g.match_nest_with_nest=function(a){return"matched"};g.toString=function(){return"a nest"};g.get_help_URL=function(){return"docs/manual/birds-nests.html"};
g.get_type_name=function(a){return a?"nests":"nest"};g.maintain_proportional_dimensions=function(){return!0};g.matching_resource=function(a){return a.get_type_name&&a.get_type_name()===this.get_type_name()};g.get_custom_title_prefix=function(){return"Drop something on my bird and she'll take it here."};f.creators_from_json.nest=function(a,b){var d=!a.original_nest&&a.guid&&b&&b.guid_to_nest_table&&b.guid_to_nest_table[a.guid];d||(d=f.nest.create(a.description,f.UTILITIES.create_array_from_json(a.contents,
b),a.guid,a.original_nest&&f.UTILITIES.create_from_json(a.original_nest,b),a.serial_number,a.name),b.guid_to_nest_table[a.guid]=d);return d};g.CONTENTS_WIDTH_FACTOR=.8;g.CONTENTS_HEIGHT_FACTOR=.8;return g}(window.TOONTALK);window.TOONTALK.nest_backside=function(a){return{create:function(b){b=a.backside.create(b);b.add_advanced_settings(!0);return b}}}(window.TOONTALK)})();window.TOONTALK.scale=function(k){var l=Object.create(k.widget);l.create=function(a,b,d,f){var g=function(){d.rerender()},l,h,v;d||(d=k.box.create(2,void 0,a,b));l=d.get_json;h=d.copy;v=d.get_path_to;d.is_scale=function(){return!0};d.copy=function(a){var b;a||(a={});b=h.call(this,a);b=k.scale.create(void 0,void 0,b,a.just_value&&this.get_state());return d.add_to_copy(b,a)};d.get_json=function(a){a=l.call(this,a);a.type="scale";a.inactive_state=this.get_inactive_state();return a};d.get_path_to=function(a,
b){var d=v.call(this,a,b);d&&(d.true_type="scale");return d};d.drop_on=function(a,b,d,c){if(a.widget_dropped_on_me)return a.widget_dropped_on_me(this,b,d,c)};d.widget_dropped_on_me=function(a,b,d,c){var f=this.get_hole_contents(0),g=this.get_hole_contents(1),h;a.dropped_on_other&&a.dropped_on_other(this,!1,d,c);if(f&&!g)return this.get_hole(1).widget_dropped_on_me(a,b,d,c),!0;if(!f&&(g||!d))return this.get_hole(0).widget_dropped_on_me(a,b,d,c),!0;h=this.which_hole(d,!1);if(0===h){if(f){if(f.drop_on)return a.drop_on(f,
b,d,c);return}}else if(g){if(g.drop_on)return a.drop_on(g,b,d,c);return}this.get_hole(h).widget_dropped_on_me(a,b,d,c);return!0};d.which_hole=function(a,b){var f=$(d.get_frontside_element()),c=f.offset(),f=f.width(),c=a.clientX-(c.left+f/2),f=b?f/10:0;return-c>f?0:c>f?1:-1};d.get_inactive_state=function(){return f};d.update_display=function(){var a=this.get_frontside_element(),b=$(a),d=$(a).children(".toontalk-scale-half"),c=$(a).parent(),c=c.is(".toontalk-backside")?a:c.get(0),f=$(c).width(),g=$(c).height(),
h=function(a,b,c){var d=(b.get_contents()||b).get_frontside_element(!0),h=c*f*.5,k=.5*f,n=g;b=b.get_contents();$(a).css({left:h,top:0,width:k,height:n});a!==d&&(h=0===c?-.05*f:.15*f,c="toontalk-scale-balanced"===q?.1*g:0===c&&"toontalk-scale-left_heavier"===q||1===c&&"toontalk-scale-right_heavier"===q?.25*g:1===c&&"toontalk-scale-left_heavier"===q||0===c&&"toontalk-scale-right_heavier"===q?-.1*g:.2*g,k=.4*f,n=.4*g,$(d).css({left:h,top:c,width:k,height:n}),b&&(b.set_location_attributes&&b.set_location_attributes(h,
c),b.set_size_attributes&&b.set_size_attributes(k,n)),a.appendChild(d))},l,q;b.is(".toontalk-top-level-resource")?q="toontalk-scale-balanced":(l=this.get_state(),q="undefined"===typeof l?"toontalk-scale-unbalanced":["toontalk-scale-right_heavier","toontalk-scale-balanced","toontalk-scale-left_heavier"][l+1]);b.removeClass("toontalk-scale-balanced toontalk-scale-left_heavier toontalk-scale-right_heavier toontalk-scale-unbalanced");b.addClass(q);b.addClass("toontalk-scale");b=k.UTILITIES.scale_to_fit(a,
c,123,91);0===f&&(f=1);0===g&&(g=1);f/=b.x_scale;g/=b.y_scale;2===d.length?d.each(function(a,b){k.UTILITIES.set_timeout(function(){h(b,this.get_hole(a),a)}.bind(this))}.bind(this)):this.get_holes().forEach(function(b,c){var d=b.get_element();0===c?$(d).addClass("toontalk-left_scale  toontalk-scale-half"):$(d).addClass("toontalk-right_scale toontalk-scale-half");h(d,b,c);a.appendChild(d)});k.UTILITIES.give_tooltip(a,this.get_title());k.debugging&&(this._debug_string=this.to_debug_string())};d.render=
function(){k.DISPLAY_UPDATES.pending_update(this)};d.get_type_name=function(a){return a?"scales":"scale"};d.get_help_URL=function(){return"docs/manual/scales.html"};d.toString=function(){var a=this.get_hole_contents(0),b=this.get_hole_contents(1),d,c,f;switch(this.get_state()){case -1:d="scale leaning to the right";break;case 1:d="scale leaning to the left";break;case 0:d="balanced scale";break;default:if(d="unbalanced scale",!c&&!f)return d}c=a?"contains "+k.UTILITIES.add_a_or_an(a.get_full_description()):
"is empty";f=b?"contains "+k.UTILITIES.add_a_or_an(b.get_full_description()):"is empty";return d+" and the left pan "+c+" and the right pan "+f};d.create_backside=function(){return k.scale_backside.create(this)};d.get_state=function(){var a=this.get_inactive_state(),b;if(a)return a;a=this.get_hole_contents(0);b=this.get_hole_contents(1);if(a||b)if(a){if(!b)return 1;if(a.compare_with)return a.compare_with(b)}else return-1};d.match=function(a){return a.match_with_scale?a.match_with_scale(this):this};
d.match_with_scale=function(a){return this.get_state()===a.get_state()?"matched":a};d.compare_with=function(a){if(a.compare_with_scale)return-1*a.compare_with_scale(this)};d.compare_with_scale=function(a){var b=this.get_state();a=a.get_state();return b&&!a?1:!b&&a?-1:b>a?1:b<a?-1:0};d.get_hole(0).add_listener("value_changed",g);d.get_hole(1).add_listener("value_changed",g);d.get_hole_contents(0)&&d.get_hole_contents(0).add_listener("value_changed",g);d.get_hole_contents(1)&&d.get_hole_contents(1).add_listener("value_changed",
g);d.get_custom_title_prefix=function(){var a=this.get_state(),b=this.get_hole_contents(0),d=this.get_hole_contents(1);if("undefined"===typeof a)return b&&d?"I can't compare "+b+" and "+d+".":"Use me to compare two things. Drop them in my pans.";b||(b="empty pan");d||(d="empty pan");return["The "+d+" is greater than the "+b+".","The "+d+" is equal to the "+b+".","The "+d+" is less than the "+b+"."][a+1]};k.debugging&&(d._debug_id=k.UTILITIES.generate_unique_id(),d._debug_string=d.to_debug_string());
return d};k.creators_from_json.scale=function(a,b){return l.create(k.UTILITIES.create_array_from_json(a.contents,b),a.description,void 0,a.inactive_state)};return l}(window.TOONTALK);window.TOONTALK.scale_backside=function(k){return{create:function(l){l=k.backside.create(l);l.add_advanced_settings(!0);return l}}}(window.TOONTALK);(function(){window.TOONTALK.robot=function(k){var l=function(a,b,g,l,h){var v;g.current_action_name=b;(a=k.path.get_path_to(a,g))?(l||(l={}),v=Date.now(),l.time=v-g.time_of_last_step,g.time_of_last_step=v,g.add_step(k.robot_action.create(a,b,l),h)):console.log("No path found for "+b);g.current_action_name=void 0},a=Object.create(k.widget),b=0;a.create=function(b,f,g,l,h,v,t,n,u){var c=Object.create(a),r,y,z,F=[],H=[],K,D,J;g||(g=k.actions.create());r||(r=c);c.is_robot=function(){return!0};c.get_frontside_conditions=
function(){return b};c.set_frontside_conditions=function(a){b=a;b.set_parent_of_frontside(this)};b&&b.set_parent_of_frontside(c);c.get_backside_conditions=function(){return f};c.set_backside_conditions=function(a){(f=a)&&k.UTILITIES.available_types.forEach(function(a){f[a]&&(k.widget.erasable(f[a]),f[a].set_parent_of_frontside(this))}.bind(this))};f&&c.set_backside_conditions(f);c.initialize_backside_conditions=function(){var a=this.get_context();J=k.UTILITIES.copy_widget_sides(a.get_backside_widgets(),
{just_value:!0,copy_covered_nests:!0});a.get_backside_widgets().forEach(function(a){a.is_backside()||(a.is_nest()&&a.dereference()!==a?this.add_to_backside_conditions(a):a.walk_children&&a.walk_children(function(b){return b.is_nest()&&!b.is_hole()&&b.dereference()!==b?(this.add_to_backside_conditions(a),!1):!0}.bind(this)))}.bind(this))};c.add_to_backside_conditions=function(a){var b,c;if(!(0<=this.get_newly_created_widgets().indexOf(a))){c=a.get_type_name();if(f){if(f[c])return}else f={};J.some(function(a){if(a.is_of_type(c))return b=
a,!0});b&&(f[c]=b,k.widget.erasable(b))}};c.get_body=function(){return g};c.get_running=function(){return K||this.is_ok_to_run()};c.running_or_in_run_queue=function(){return K};c.set_running_or_in_run_queue=function(a){K=a};c.stopped=function(){return D};c.set_stopped=function(a){if(D=a)this.visible()&&($(this.get_frontside_element()).removeClass("toontalk-robot-waiting"),this.drop_thing_in_hand(),this.rerender()),K=!1;this.get_next_robot()&&this.get_next_robot().set_stopped(a)};c.drop_thing_in_hand=
function(){h&&(h.drop_on(this.top_level_widget(),!1,void 0,this),this.set_thing_in_hand(void 0))};c.finish_cycle_immediately=function(a){var b=z,c=function(){z=b;this.set_visible(!1);a&&a()}.bind(this);z=0;this.add_body_finished_listener(c)};c.get_maximum_step_duration=function(){return z};c.animate_consequences_of_actions=function(){return this.visible()&&0!==z};c.transform_step_duration=function(a){return void 0===a&&0===z?0:u&&a?a/u:"number"===typeof z?Math.min(a,z):a};c.transform_original_step_duration=
function(a){if(!u)return a};c.transform_animation_speed=function(a){return u?a*u:a};c.set_animating=function(a,b){var c=this.get_frontside_element();a?(b||(b=$(c).offset()),$(c).addClass("toontalk-robot-animating toontalk-side-animating"),$(c).css({width:"",height:"","z-index":k.UTILITIES.next_z_index()}),k.UTILITIES.set_position_relative_to_top_level_backside($(c),b),$(c).closest(".toontalk-top-level-backside").append(c)):$(c).removeClass("toontalk-robot-animating toontalk-side-animating")};c.add_body_finished_listener=
function(a){F.push(a)};c.run_body_finished_listeners=function(a,b,c){F.forEach(function(d){d(a,b,c)});F=[]};c.add_watched_step_end_listeners=function(a){H.push(a)};c.run_watched_step_end_listeners=function(){H.forEach(function(a){a()});H=[]};c.get_thing_in_hand=function(){return h};c.set_thing_in_hand=function(a){if(k.debugging){if(a&&"empty hole"===a.get_type_name()){k.UTILITIES.report_internal_error("Robot trying to pick up an empty hole.");return}k.logging&&0<=k.logging.indexOf("thing_in_hand")&&
console.log(this.to_debug_string()+" now has in his hand "+(a?a.to_debug_string():"nothing"))}h=a};c.get_next_robot=function(){return t};c.set_next_robot=function(a){var b=this.get_backside_element();a&&a.set_first_in_team(this.get_first_in_team());!a&&t&&(t.set_first_in_team(t),t.set_previous_robot(void 0));(t=a)&&t.set_previous_robot(this);b&&(a=a?"When the robot can't run then this one will try: ":window.TOONTALK.robot.empty_drop_area_instructions,$(b).find(".toontalk-drop-area-instructions").get(0).innerHTML=
a)};c.get_previous_robot=function(){return y};c.set_previous_robot=function(a){y=a};c.get_first_in_team=function(){return r};c.set_first_in_team=function(a){r=a;t&&t.set_first_in_team(a)};c.walk_children=function(a){var b;t&&!a(t)||!(b=this.get_frontside_conditions())||b.is_top_level()||a(b)};c.get_run_once=function(){return v};c.set_run_once=function(a){v=a;this.update_title();return!0};c.get_watched_speed=function(){return u};c.set_watched_speed=function(a){u=a;return!0};c.can_run=function(){return this.get_frontside_conditions()&&
this.get_frontside_conditions().is_top_level()||k.widget.can_run.call(this)};c.training_started=function(a){var b=this.get_context();b?this.being_trained||(this.time_of_last_step=Date.now(),this.being_trained=!0,this.set_frontside_conditions(b.copy({just_value:!0})),this.initialize_backside_conditions(),a||($("*").css({cursor:"url("+k.UTILITIES.absolute_file_path("images/RB19.32x32.PNG")+"), default"}),$(this.get_frontside_element()).addClass("toontalk-ghost_robot")),this.update_title(),a=this.get_backside_element(),
$(a).find(".toontalk-conditions-panel").remove(),this.robot_training_this_robot()&&this.robot_training_this_robot().started_training_another(this)):k.UTILITIES.report_internal_error("Robot started training but can't find its 'context'.")};c.training_finished=function(){if(this.being_trained){var a,b,c;a=this.get_body().get_newly_created_widgets();for(b=0;b<a.length;b++)c=a[b],"drop it on top-level"!==c.last_action&&"copy"!==c.last_action||this.add_step(k.robot_action.create(k.newly_created_widgets_path.create(b),
"add to the top-level backside"));$(this.get_frontside_element()).removeClass("toontalk-ghost_robot");this.rerender();this.being_trained=!1;this.update_title();this.backup_all();this.robot_finished_training();this.robot_in_training()?this.robot_in_training().finished_training_another(this):$("*").css({cursor:""})}};if(k.debugging||k.logging)c.to_debug_string=function(){var a=this.get_frontside_conditions();return"Robot ("+(this.get_description()||"")+" "+this.get_name()+") runs if working on "+(a?
k.UTILITIES.add_a_or_an(a.toString()):"anything")};t&&c.set_next_robot(t);c=c.add_standard_widget_functionality(c);c.has_name(c);c.set_name(n);c.set_description(l);k.debugging&&(c._debug_id=k.UTILITIES.generate_unique_id(),c._debug_string=c.to_debug_string());return c};a.create_backside=function(){return k.robot_backside.create(this)};a.copy=function(a){var b=this.get_frontside_conditions(),g=this.get_backside_conditions(),b=b?b.copy({just_value:!0}):void 0,l=this.get_next_robot(),l=l?l.copy(a):void 0,
h;g&&(h={},k.UTILITIES.available_types.forEach(function(a){h[a]&&(h[a]=h[a].copy({just_value:!0}))}));g=this.create(b,h,this.get_body().copy(),this.get_description(),this.get_thing_in_hand(),this.get_run_once(),l,(!a||!a.fresh_copy)&&this.get_name(),this.get_watched_speed());return this.add_to_copy(g,a)};a.match=function(a){var b;return a.is_robot()&&(b=this.get_body().is_empty(),a=a.get_body().is_empty(),b===a)?"matched":this};a.generate_name=function(){b++;return"#"+b.toString()};a.run=function(a,
b,g){var l=this.get_frontside_conditions(),h,v,t,n;if(this.being_trained||this.running_or_in_run_queue())return this;n=function(a){a&&a.visible()&&$(a.get_frontside_element()).removeClass("toontalk-conditions-not-matched toontalk-conditions-waiting").find(".toontalk-conditions-not-matched, .toontalk-conditions-waiting").removeClass("toontalk-conditions-not-matched toontalk-conditions-waiting")};n(l);this.rerender();this.match_status=k.UTILITIES.match(l,a);"matched"===this.match_status&&(h=this.get_backside_conditions())&&
((v=a.get_backside_widgets())&&v.some(function(a){var b=!a.is_backside()&&h[a.get_widget().get_type_name()];if(b&&(n(b),a=k.UTILITIES.match(b,a.get_widget()),"matched"!==a))return this.match_status=a,!0}.bind(this)),"matched"===this.match_status&&Object.keys(h).some(function(a){var b;if(h[a]&&(v.some(function(d){if(d.get_widget().is_of_type(a))return b=!0}),!b))return this.match_status=h[a],!0}.bind(this)));if("matched"===this.match_status)return g||(g=k.DEFAULT_QUEUE),this.get_body().reset_newly_created_widgets(),
g.enqueue({robot:this,context:a,top_level_context:b,queue:g}),this.match_status;if(this.match_status.is_widget)return $(this.match_status.get_frontside_element()).addClass("toontalk-conditions-not-matched"),this.rerender(),this.get_next_robot()?this.get_next_robot().run(a,b,g):this.match_status;this.match_status.forEach(function(a){a[1]&&$(a[1].get_frontside_element()).addClass("toontalk-conditions-waiting")});if(this.get_next_robot()){l=this.get_next_robot().run(a,b,g);if("matched"===l)return l;
l.is_widget||l.forEach(function(a){0>this.match_status.indexOf(a)&&this.match_status.push(a)}.bind(this))}this.get_first_in_team()===this&&(t=function(){this.set_waiting(!1);this.run(a,b,g)}.bind(this),this.match_status.forEach(function(a){a[0]?a[0].run_when_non_empty(t,this):a.run_when_non_empty(t,this)}.bind(this)),this.set_waiting(!0));return this.match_status};a.set_waiting=function(a){var b=this.get_frontside_element();a?(k.UTILITIES.add_animation_class(b,"toontalk-robot-waiting"),k.UTILITIES.give_tooltip(b,
"This robot is waiting for a bird to deliver something.")):($(b).removeClass("toontalk-robot-waiting"),k.UTILITIES.give_tooltip(b,this.get_title()))};a.run_actions=function(a,b,g){return this.stopped()?(this.get_first_in_team().set_running(!1),!1):this.visible()?this.get_body().run_watched(a,b,g,this):this.get_body().run_unwatched(a,b,g,this)};a.drop_from_data_transfer=function(a,b){var g;a.is_top_level&&a.is_top_level()?(g=a.get_backside_widgets().slice(),setTimeout(function(){g.forEach(function(a){this.picked_up(a,
void 0,!0);this.time_of_last_step-=1E3;this.dropped_on(a,b.get_backside());this.time_of_last_step-=1E3}.bind(this))}.bind(this))):this.data_transfer=a};a.picked_up=function(a,b,g){var l,h;if(this!==a&&!(a.is_top_level()||b&&b.view.backside))return a.get_infinite_stack&&a.get_infinite_stack()?this.current_action_name="pick up a copy of":this.current_action_name="pick up",g?(h=a,b=a.copy({fresh_copy:!0}),b=k.path.get_path_to_resource(b)):b=k.path.get_path_to(a,this),b&&(g=Date.now(),l={time:g-this.time_of_last_step},
this.time_of_last_step=g,l=k.robot_action.create(b,this.current_action_name,l),this.add_step(l,h)),a.last_action=this.current_action_name,this.current_action_name=void 0,this.set_thing_in_hand(a),l};a.dropped_on=function(a,b){var g,l,h,v,t;if(this!==a&&(!this.get_parent_of_frontside()||this.get_parent_of_frontside().get_widget()!==a)){this.data_transfer&&(this.picked_up(this.data_transfer,void 0,!0),this.data_transfer=void 0,this.time_of_last_step-=1E3);this.current_action_name="drop it on";if(g=
k.path.get_path_to(b,this))b.is_backside()?(h=$(b.get_element()),l=h.offset(),v=h.width(),t=h.height(),h=$(a.get_frontside_element()).offset(),v=(h.left-l.left)/v,l=(h.top-l.top)/t,v=Math.max(0,Math.min(1,v)),l=Math.max(0,Math.min(1,l)),l={left_offset_fraction:v,top_offset_fraction:l}):l={},h=Date.now(),l.time=h-this.time_of_last_step,this.time_of_last_step=h,g=k.robot_action.create(g,this.current_action_name,l),this.add_step(g);a.last_action=this.current_action_name+" "+b.get_type_name();this.current_action_name=
void 0;this.set_thing_in_hand(void 0)}};a.dropped_on_text_area=function(a,b,g){l(a,"drop it on the text area of",this,g);a.last_action="drop it on the text area of "+b.get_type_name();this.set_thing_in_hand(void 0)};a.copied=function(a,b,g){g=g?"pick up a copy of":"copy";l(a,g,this,void 0,b);b.last_action=g};a.removed=function(a){var b;this.get_parent_of_frontside()&&(b=this.get_parent_of_frontside().get_widget());l(a,"remove",this);a.last_action="remove";b===a||a===this?(this.add_to_top_level_backside(this.copy()),
this.training_finished()):this.add_newly_created_widget_if_new(a)};a.edited=function(a,b){l(a,"edit",this,b)};a.erased_widget=function(a){l(a,"change whether erased",this)};a.resized_widget=function(a,b,g,k,h){b===k&&g===h||l(a,"change size of",this,{x_factor:k/b,y_factor:h/g})};a.started_training_another=function(a){l(a,"start training",this)};a.finished_training_another=function(a){l(a,"stop training",this)};a.trained=function(a,b){l(a,"train",this,{step:b})};a.backside_opened=function(a){l(a,"open the backside",
this)};a.backside_closed=function(a){l(a,"close the backside",this)};a.button_clicked=function(a,b){l(b.get_widget(),"click the button of",this,{button_selector:a})};a.created_widget=function(a,b,g){this.add_newly_created_widget(a);this.add_to_top_level_backside(a,!1);this.add_step(k.robot_action.create(k.path.get_path_to_resource(a.copy()),"add a new widget to the work space",{button_selector:g,path_to_source:k.path.get_path_to(b,this)}))};a.get_newly_created_widgets=function(){return this.get_body().get_newly_created_widgets()};
a.remove_from_container=function(a,b){var g=b.get_index_of&&a.get_parent_of_frontside()&&b.get_index_of(a),k=function(){b.removed_from_container(a,!1,!0,g,!1)};this.animate_consequences_of_actions()?this.add_watched_step_end_listeners(k):k();this.add_newly_created_widget_if_new(a)};a.add_step=function(a,b){this.get_body().add_step(a,b);this.update_title();"train"!==a.get_action_name()&&"start training"!==a.get_action_name()&&this.robot_training_this_robot()&&this.robot_training_this_robot().trained(this,
a)};a.get_context=function(){var a=this.get_frontside_element(),b=$(a).parent(),a=k.UTILITIES.widget_from_jquery(b);return!a&&(b=k.UTILITIES.widget_from_jquery(b.closest(".toontalk-backside-of-robot")))?b.get_context():a};a.update_display=function(){var a=this.get_frontside(!0);this.get_backside();var b=this.get_thing_in_hand(),g,l;k.debugging&&(this._debug_string=this.to_debug_string());g=a.get_element();b&&(l=b.get_frontside_element());!l&&this.carrying_tool&&(l=document.createElement("div"),$(l).addClass(this.carrying_tool));
k.UTILITIES.give_tooltip(g,this.get_title());$(g).addClass("toontalk-robot");$(g).children(".toontalk-side, .toontalk-held-by-robot").remove();l&&g.appendChild(l);this.match_status&&(this.match_status.is_widget?$(g).addClass("toontalk-side-animating toontalk-robot-not-matched"):$(g).removeClass("toontalk-robot-not-matched"));g.setAttribute("toontalk_name",this.get_name());k.UTILITIES.set_timeout(function(){var a,d,k,n,u;l&&(u={position:"absolute"},$(l).addClass("toontalk-held-by-robot"),a=$(l).width(),
$(l).height(),k=$(g).width(),n=$(g).height(),b&&0===a&&(a=b.get_default_width?b.get_default_width():2*k,d=b.get_default_height?b.get_default_height():n/2,u.width=a,u.height=d),u.left=(k-a)/2,u.top=n/4,$(l).css(u),b&&b.render())})};a.add_newly_created_widget=function(a){return this.get_body().add_newly_created_widget(a)};a.add_newly_created_widget_if_new=function(a){if(a!==this.get_context()&&this!==a)return this.get_body().add_newly_created_widget_if_new(a)};a.is_newly_created=function(a){return this.get_body().is_newly_created(a)};
a.get_recently_created_widget=function(){var a=this.get_body().get_newly_created_widgets();return a[a.length-1]};a.get_title=function(){var a=this.get_description();if(a)return a="I'm "+a,0>a.lastIndexOf(".")&&(a+="."),a+"\n"+this.toString();a=this.get_frontside_element();return $(a).is(".toontalk-top-level-resource")?"Drag this robot to a work area.":this.toString()};a.toString=function(a){var b,g,l,h,v,t,n,u,c;if(a&&"conditions"===a.role)return"any robot";b=this.get_frontside_conditions();if(!b)return"an untrained robot";
a||(a={});c=a.person;if(a&&a.resource){if(this.get_description())return'"'+this.get_description()+'"';a.person="third"}g=this.get_backside_conditions();h=this.get_body();t=v="";n=this.get_next_robot();b.is_top_level()?u="When the workspace's green flag "+k.UTILITIES.encode_HTML_for_title("<span class='toontalk-green-flag-icon'></span>")+" is pressed":(b=k.UTILITIES.add_a_or_an(b.get_full_description({role:"conditions"})),u="When working on something that matches "+b);g&&(Object.keys(g).forEach(function(a){var b=
g[a];b&&(u+=" and\nif on the back is "+k.UTILITIES.add_a_or_an(a)+" that matches "+k.UTILITIES.add_a_or_an(b.get_full_description({role:"conditions"})));l=!0}),l&&(u+="\n"));if(this.being_trained){if(h.is_empty())return"I'm ready to be trained. Show me what to do and then click on my 'Stop training' button.";v="is being trained.\n";t="\n..."}h=v+u+(a&&"third"===a.person?" he will ":" I will ")+(this.get_run_once()?"":"repeatedly ")+"\n"+(h.toString({robot:this})||"do nothing")+t;if(a&&a.resource)return a.person=
c,h.replace(/\n/g," ");this.match_status&&(this.match_status.is_widget?h="I'm not running because the "+this.match_status+" in my conditions (highlighted in red) doesn't match the corresponding widget. Perhaps editing my conditions will help.\n"+h:"matched"!==this.match_status&&(h="I'm waiting for something to be delivered to the nest that matches the "+this.match_status[0][1]+" in my conditions (highlighted in yellow).\n"+h));n&&(h+="\nIf it doesn't match then the next robot will try to run.\n"+
n.toString());return h};a.get_type_name=function(a){return a?"robots":"robot"};a.maintain_proportional_dimensions=function(){return!0};a.matching_resource=function(a){return a.is_robot()&&!this.get_frontside_conditions()&&!a.get_frontside_conditions()&&this.get_body().is_empty()&&a.get_body().is_empty()};a.get_top_level_context_description=function(a){var b=this.get_frontside_conditions().get_type_name();return"top-level"===b?a&&"third"===a.person?"his workspace":"my workspace":a&&"third"===a.person?
"the "+b+" he's working on":"the "+b+" I'm working on"};a.get_help_URL=function(){return"docs/manual/robots.html"};a.get_json=function(a){var b=this.get_frontside_conditions(),g=this.get_backside_conditions(),l,h,v;b&&(l=b.is_top_level()?{type:"top_level"}:k.UTILITIES.get_json(b,a));g&&k.UTILITIES.available_types.forEach(function(b){g[b]&&(h||(h={}),h[b]=k.UTILITIES.get_json(g[b],a))});this.get_next_robot()&&(v=k.UTILITIES.get_json(this.get_next_robot(),a));return{type:"robot",frontside_conditions:l,
backside_conditions:h,body:this.get_body().get_json(a),run_once:this.get_run_once(),next_robot:v,name:this.get_name(),speed:this.get_watched_speed()}};k.creators_from_json.robot=function(a,b){var g,l,h;a.thing_in_hand&&(l=k.UTILITIES.create_from_json(a.thing_in_hand,b));a.next_robot&&(g=k.UTILITIES.create_from_json(a.next_robot,b));a.backside_conditions&&(h={},k.UTILITIES.available_types.forEach(function(g){var l=k.UTILITIES.create_from_json(a.backside_conditions[g],b);l&&(h[g]=l)}));return k.robot.create(k.UTILITIES.create_from_json(a.frontside_conditions||
a.bubble,b),h,k.UTILITIES.create_from_json(a.body,b),a.description,l,a.run_once,g,a.name,a.speed)};a.find_conditions_path=function(a,b,g){var l=b.get_frontside_conditions(),h=l===a?"entire_condition":l.get_path_to&&l.get_path_to(a,g),l=k.path.get_path_to(b,g),v,t;h||(v=b.get_backside_conditions(),k.UTILITIES.available_types.some(function(b){v[b]&&(h=v[b].get_path_to(a,g))&&(t=b)}));if(h)return k.robot.create_conditions_path(h,l,t);k.UTILITIES.report_internal_error("Robot has widget in its conditions but unable to construct the path.")};
a.create_conditions_path=function(a,b,g){return{dereference_path:function(l,h,v){l=k.path.dereference_path(b,l,h,v);l=g?l.get_backside_conditions()[g]:l.get_frontside_conditions();return"entire_condition"===a?l:k.path.dereference_path(a,l,h,v)},toString:function(){var l="entire_condition"===a?"the ":k.path.toString(a)+" of the ";return g?l+g+" backside condition of "+k.path.toString(b):l+" front side condition of "+k.path.toString(b)},get_json:function(){return{type:"path_to_robot_conditions",backside_conditions_type:g,
path_to_robot:b.get_json(),path_within_conditions:"entire_condition"===a?"entire_condition":a.get_json()}}}};k.creators_from_json.path_to_robot_conditions=function(a){var b=k.UTILITIES.create_from_json(a.path_to_robot),g="entire_condition"===a.path_within_conditions?a.path_within_conditions:k.UTILITIES.create_from_json(a.path_within_conditions);return k.robot.create_conditions_path(g,b,a.backside_conditions_type)};return a}(window.TOONTALK);window.TOONTALK.robot_backside=function(k){var l=function(a,
d,f,g){a=k.UTILITIES.create_text_element(a);var l=d.get_frontside_element(!0),h=document.createElement("div");$(l).addClass("toontalk-conditions-contents "+g);k.UTILITIES.set_timeout(function(){$(l).parent().addClass("toontalk-conditions-contents-container");$(l).css({left:"inherit",width:"inherit",height:"inherit"});d.render()});f.match_status&&(f.match_status.is_widget?$(f.match_status.get_frontside_element()).addClass("toontalk-conditions-not-matched"):"matched"!==f.match_status&&f.match_status.forEach(function(a){$(a[1].get_frontside_element()).addClass("toontalk-conditions-waiting")}));
h.appendChild(l);f=k.UTILITIES.create_horizontal_table(a,h);$(f).addClass("toontalk-conditions-panel");return f},a=function(a,d){var f=d.get_frontside_conditions(),g=d.get_backside_conditions(),q=d.visible(),h,v;f&&(f.is_top_level()?0>a.firstChild.textContent.indexOf("This robot always runs when the green flag")&&a.insertBefore(k.UTILITIES.create_text_element("This robot always runs when the green flag <span class='toontalk-green-flag-icon'></span> is clicked."),a.firstChild):0===$(a).find(".toontalk-frontside-conditions-area").length&&
a.insertBefore(l("Runs only if the widget matches: ",f,d,"toontalk-frontside-conditions-area"),a.firstChild),f.set_visible(q),f.rerender());g&&Object.keys(g).forEach(function(f){if(h=g[f])v="toontalk-backside-"+f+"-conditions-area",0===$(a).find("."+v).length&&(f="bird"===f?k.UTILITIES.create_text_element("And there is a bird on the back."):l("Runs only if the "+f+" on the backside matches: ",h,d,v),a.insertBefore(f,a.firstChild.nextSibling),h.set_visible(q),h.rerender())})};return{create:function(b){var d=
k.backside.create(b),f=d.get_element(),g=function(a){return a?"Check this if you want the robot to start over again after finishing what he was trained to do.":"Uncheck this if you want the robot to stop after finishing what he was trained to do."},l=k.UTILITIES.create_check_box(!b.get_run_once(),"toontalk-run-once-check-box","When finished start again",g(b.get_run_once())),h="normal;original;double;half;very fast;very slow".split(";"),v=[1,void 0,2,.5,10,.25],t=function(a){a=h.indexOf(a);return v[a]},
n=k.UTILITIES.create_select_menu("robot_speed",h,"toontalk-select-function","  What speed should I run at? ","Click to select the speed I'll run when watched.","The normal speed for each step;The original delay between steps when I was trained;Double the normal speed;Half the normal speed;Ten times normal speed;One-fourth of normal speed".split(";")),u=k.UTILITIES.create_drop_area(window.TOONTALK.robot.empty_drop_area_instructions),c=b.get_next_robot(),r=k.backside.create_advanced_settings_button(d,
b),y=d.update_display.bind(d),z=function(a,c){setTimeout(function(){var d=a.get_frontside_element(b.visible()),f,g;a.get_default_width&&(f=a.get_default_width(),g=a.get_default_height(),$(d).css({left:"",top:"",width:f,height:g}));c.appendChild(d)})};u.data("drop_area_owner",b);$(l.button).click(function(a){var c=l.button.checked;b.set_run_once(!c);k.UTILITIES.give_tooltip(l.container,g(!c));b.robot_in_training()&&b.robot_in_training().edited(b,{setter_name:"set_run_once",argument_1:!c,toString:"change to "+
(c?"run again":"run once")+" of the robot",button_selector:".toontalk-run-once-check-box"});a.stopPropagation()});n.menu.value=function(a){a=a?v.indexOf(a):1;return h[a]}(b.get_watched_speed());n.menu.addEventListener("change",function(a){b.set_watched_speed(t(a.target.value))});c&&z(c,u.get(0));u.get(0).addEventListener("drop",function(a){a=k.UTILITIES.get_dragee();(a=k.UTILITIES.widget_from_jquery(a))&&a.is_robot()&&(a.get_body().is_empty()?(a=a.open_backside(),$(a.get_element()).find(".toontalk-train-backside-button").click()):
(z(a,u.get(0)),b.set_next_robot(a)))});d.update_display=function(){var a=b.get_frontside_element();a&&k.UTILITIES.give_tooltip(a,b.get_title());y()};f.appendChild(this.create_train_button(d,b));f.appendChild(r);$(l.container).addClass("toontalk-advanced-setting");$(n.container).addClass("toontalk-advanced-setting");u.addClass("toontalk-advanced-setting");f.appendChild(l.container);f.appendChild(n.container);f.appendChild(u.get(0));a(f,b);d.add_advanced_settings();return d},create_train_button:function(b,
d){var f=b.get_element();$(f);var g=$("<button>Train</button>").button();g.addClass("toontalk-train-backside-button");var l=!1;b.change_label_and_title_of_train_button=function(b){b?(g.button("option","label","Stop training "+d.get_name()),k.UTILITIES.give_tooltip(g.get(0),"Click to stop training this robot.")):d.get_body().is_empty()?(g.button("option","label","Train"),k.UTILITIES.give_tooltip(g.get(0),"Click to start training this robot.")):(g.button("option","label","Re-train "+d.get_name()),k.UTILITIES.give_tooltip(g.get(0),
"Click to start training this robot all over again."));$(f).is(":visible")&&a(f,d)};b.change_label_and_title_of_train_button(l);g.click(function(a){l=!l;b.change_label_and_title_of_train_button(l);l?(d.get_body().reset_steps(),d.robot_started_training(d),d.training_started()):d.training_finished();a.stopPropagation()});return g.get(0)}}}(window.TOONTALK);window.TOONTALK.robot.empty_drop_area_instructions="Drop a robot here who will try to run when I can't."})();(function(){var k=function(a){return"rotate"===a||"skewX"===a||"skewY"===a||"transform-origin-x"===a||"transform-origin-y"===a},l=function(a){return"transform-origin-x"===a||"transform-origin-y"===a?"https://developer.mozilla.org/en-US/docs/Web/CSS/transform-origin#"+a:k(a)?"https://developer.mozilla.org/en-US/docs/Web/CSS/transform#"+a:"http://www.w3.org/community/webed/wiki/CSS/Properties/"+a};window.TOONTALK.element=function(a){var b=["left","top","width","height"],d=Object.create(a.widget),f=
function(a,b){var d,f;if(!a)return 0;"number"===typeof a&&(f=a);0===a.length&&(f=0);if("undefined"===typeof f&&(d=a.substring(a.length-1),0<="0123456789x".indexOf(d)&&(f=parseFloat(a),isNaN(f))))return;d=f;0<=["rotate","skewX","skewY"].indexOf(b)&&(d%=360,0>d&&(d+=360));return d};d.create=function(b,f,h,l,t,n,u){var c=Object.create(d),r=a.UTILITIES.generate_unique_id(),y=c.drag_started,z={},F={},H,K,D,J,M,C,L,I,S,m,A,B,E,T,V;f||(f=[]);l&&(H="string"===typeof l?new Audio(l):l);t&&("string"===typeof t?
b="<video src='"+t+"' alt='"+t+"'/>":K=t);c.is_element=function(){return!0};c.get_HTML=function(){return J};c.get_guid=function(){return r};c.get_text=function(){var a=this.get_frontside_element().textContent;""===a&&(this.update_display(),a=this.get_frontside_element().textContent);return""===a?this.get_HTML():a};c.set_HTML=function(a){var b=this.get_frontside_element(),c=function(a){for(var b=0,c,d;;){b=a.indexOf("<a ",b);if(0>b)break;c=a.indexOf(">",b);if(0>c)break;b+=3;d=a.indexOf("target='_blank'",
b);if(0>d||d>c)a=a.substring(0,b)+"target='_blank'"+a.substring(b)}0===a.indexOf("data:image")?a="<image src='"+a+"'>":0===a.indexOf("data:audio")?a="<audio src='"+a+"'>":0===a.indexOf("data:video")&&(a="<video src='"+a+"'>");return a}.bind(this);if(!b||J===a)return!1;J=c(a);$(b).children(":not(.ui-resizable-handle)").remove();this.is_plain_text_element()?b.innerHTML=J.replace(/ /g,"&nbsp;"):b.innerHTML=J;M&&(this.compute_original_dimensions(!0),f.forEach(function(a){this.add_to_css(a,this.get_attribute(a))}.bind(this)),
this.rerender());return!0};c.set_HTML_from_sub_classes=c.set_HTML;c.set_text=function(a){var b=this.get_frontside_element(),c=function(b){$(b).contents().each(function(){this.nodeType==Node.TEXT_NODE?(this.textContent=a,a=""):c(this,a)})};if(!b||a===b.textContent)return!1;if($(b).is(".toontalk-plain-text-element"))return this.set_HTML(a);c(b);return this.set_HTML(b.innerHTML)};c.get_style_attributes=function(){return f};c.set_style_attributes=function(a){f=a};c.get_attribute_widgets_in_backside_table=
function(){return z};c.get_original_copies=function(){return F};c.get_pending_css=function(){return m};c.get_transform_css=function(){return A};c.add_to_css=function(a,b){k(a)?(A||(A={}),A[a]=b):(m||(m={}),m[a]=b)};c.apply_css=function(){var b="",c,d,f;if((m||A)&&(c=this.get_frontside_element())&&!$(c).is(".toontalk-not-observable"))if($(c).is(":visible")){m?(m.width&&(I=m.width),m.height&&(S=m.height)):m={};A&&("number"===typeof A.rotate&&(b+="rotate("+A.rotate+"deg)"),"number"===typeof A.skewX&&
(b+="skewX("+A.skewX+"deg)"),"number"===typeof A.skewY&&(b+="skewY("+A.skewY+"deg)"),"number"===typeof A["transform-origin-x"]||"number"===typeof A["transform-origin-y"])&&(m["transform-origin"]=(A["transform-origin-x"]||0)+" "+(A["transform-origin-y"]||0));if(m.left||m.top)m.left&&(d=$(this.get_parent_of_frontside().get_element()),f=d.width(),m.left=(m.left%f+f)%f),m.top&&(d||(d=$(this.get_parent_of_frontside().get_element())),d=d.height(),m.top=(m.top%d+d)%d);I||S?(E&&E.css({width:C,height:L}),
$(c).css({width:"",height:""}),a.UTILITIES.run_when_dimensions_known(c,function(d){a.UTILITIES.scale_element(c,I,S,C,L,b,m,d);m=void 0})):(a.UTILITIES.add_transform_to_css(b,"",m,0>c.parentElement.className.indexOf("toontalk-box-hole")),$(c).css(m),m=void 0)}else a.UTILITIES.set_timeout(function(){this.apply_css()}.bind(this),100)};c.on_update_display=function(a){B?B.push(a):B=[a]};c.fire_on_update_display_handlers=function(){B&&a.UTILITIES.set_timeout(function(){B.forEach(function(a,b){a()||B.splice(b,
1)})})};c.get_image_element=function(){return E};c.set_image_element=function(a,b){E=$(a).find("img");0===E.length?E=void 0:($(b).width(E.width()),$(b).height(E.height()))};c.get_additional_classes=function(){return u};c.set_additional_classes=function(a){u=a};c.set_sound_effect=function(a){H=a};c.get_sound_effect=function(){return H};c.get_video_object=function(){K||(K=this.get_frontside_element().getElementsByTagName("video")[0]);return K};c.set_video_object=function(a){K=a};c.get_ignore_pointer_events=
function(){return n};c.set_ignore_pointer_events=function(a){n=a;$(this.get_frontside_element()).find(":not(ui-resizable-handle)").css({"pointer-events":a?"none":"auto"})};c.get_source_URL=function(){return D};c.set_source_URL=function(a){if(D!==a)return D=a,this.refresh(),!0};c=c.add_standard_widget_functionality(c);T=c.set_running.bind(c);c.set_running=function(a,b){T(a,b);Object.keys(z).forEach(function(c){z[c].set_running(a,b)})};V=c.can_run.bind(c);c.can_run=function(){var a;if(V())return!0;
Object.keys(z).some(function(b){if(z[b].can_run())return a=!0});return a};c.drag_started=function(a,b){this.drag_x_offset=a.view.drag_x_offset;this.drag_y_offset=a.view.drag_y_offset;y.call(this,a,b)};c.update_display=function(){var b=this.get_frontside_element();this.get_backside();var c=function(a){return this.get_image_element()?"image":$(a).is(".toontalk-plain-text-element")?"text":"element"}.bind(this);if(!this.being_dragged)if(this.get_erased()){var d;d=$(b).parent(".toontalk-backside").is("*")?
c="":c="100%";this.save_dimensions();$(b).removeClass().empty().addClass("toontalk-erased-element toontalk-side").css({width:c,height:d,transform:""});$(b).parent(".toontalk-conditions-contents-container").is("*")?a.UTILITIES.give_tooltip(b,"This is an element that has been erased. It will match any element."):a.UTILITIES.give_tooltip(b,"This is an erased element. It will replace its HTML with the HTML of the element you drop on it.")}else $(b).is(".toontalk-erased-element")&&($(b).removeClass("toontalk-erased-element"),
this.restore_dimensions()),this.initialize_element(),a.UTILITIES.on_a_nest_in_a_box(b)&&(this.set_attribute("width",$(b).closest(".toontalk-box-hole").width(),!1),this.set_attribute("height",$(b).closest(".toontalk-box-hole").height(),!1)),"undefined"===typeof C&&b.parentElement&&this.compute_original_dimensions(),this.apply_css(),this.fire_on_update_display_handlers(),a.UTILITIES.give_tooltip(b,"Click to see the backside where you can place robots or change the style of this "+c(b)+"."),this.set_ignore_pointer_events(this.get_ignore_pointer_events())};
c.initialize_element=function(){var a=this.get_frontside_element();$(a).children(".ui-resizable-handle");var b;M||(J=this.get_HTML(),b=this.is_plain_text_element(),a.innerHTML=b?J.replace(/ /g,"&nbsp;"):J,$(a).addClass("toontalk-element-frontside"),b&&((b=this.get_additional_classes())&&$(a).addClass(b),$(a).addClass("ui-widget toontalk-plain-text-element")),M=!0)};c.is_plain_text_element=function(){var a=this.get_HTML();if(a)return!a.match(/<\w/)};c.compute_original_dimensions=function(b){a.UTILITIES.original_dimensions(this,
function(a,b){var c=this.get_parent_of_frontside();C=a;L=b;c&&c.get_box?c.get_box().rerender():this.rerender()}.bind(this),b)};c.get_attribute_from_current_css=function(a){var b,c;if("width"===a&&(I||C))return I||C;if("height"===a&&(S||L))return S||L;b=this.get_frontside_element();c=b.style[a];""===c&&(c=$(b).css(a));return c?"number"===typeof c?c:"%"!==c.charAt(c.length-1)||"left"!==a&&"top"!==a?c.replace("px",""):$(b).offset()[a]:0};c.get_original_width=function(){return C};c.get_original_height=
function(){return L};c.increment_width=function(a){this.set_attribute("width",(I||C)+a)};c.increment_height=function(a){this.set_attribute("height",(S||L)+a)};c.set_HTML(b.toString());c.set_description(h);a.debugging&&(c._debug_id=a.UTILITIES.generate_unique_id(),c._debug_string=c.to_debug_string());return c};d.copy=function(a){var b=this.get_style_attributes(),f=d.create(this.get_HTML(),b.slice(),this.get_description(),this.get_sound_effect(),this.get_video_object(),this.get_ignore_pointer_events());
f.set_source_URL(this.get_source_URL());a&&(a.elements_copied||(a.elements_copied={}),a.elements_copied[this.get_guid()]=f);b.forEach(function(a){f.set_attribute(a,this.get_attribute(a))}.bind(this));return this.add_to_copy(f,a)};d.match=function(a){return this.get_erased&&this.get_erased()?a.match_with_any_element?a.match_with_any_element():this:a.match_with_another_element_widget?a.match_with_another_element_widget(this):this};d.match_with_any_element=function(){return"matched"};d.match_with_another_element_widget=
function(a){var b;if(this.get_HTML()===a.get_HTML())return"matched";b=a.get_text();return""!==b&&b===this.get_text()?"matched":a};d.compare_with=function(a){if(a.compare_with_other_element)return a.compare_with_other_element(this)};d.compare_with_other_element=function(a){a=a.get_HTML().localeCompare(this.get_HTML());return 0>a?-1:0<a?1:a};d.widget_dropped_on_me=function(a,b,d,f){if(this.get_erased()&&a.get_HTML)return this.set_HTML(a.get_HTML()),this.set_erased(!1),a.remove(),!0;console.log("Dropping widgets on un-erased elements does nothing (but may someday)")};
d.create_backside=function(){return a.element_backside.create(this)};d.get_attribute_from_pending_css=function(a){var b=this.get_pending_css();if(b&&b[a]||(b=this.get_transform_css())&&b[a])return b[a]};d.get_attribute=function(a){var b=this.get_attribute_from_pending_css(a);return"undefined"!==typeof b?b:this.get_attribute_from_current_css(a)};d.set_attribute=function(a,b,d,k){var l,n;if(!this.get_frontside(!0).get_element())return!1;l=this.get_attribute_from_pending_css(a);if(l===b||"undefined"===
typeof l&&(l=this.get_attribute_from_current_css(a),l===b))return!1;n=f(b,a);if("number"===typeof n){if(l==n)return!1;b=n}d&&this.robot_in_training()&&this.robot_in_training().edited(this,{setter_name:"set_attribute",argument_1:a,argument_2:b,toString:"change the '"+a+"' style to "+b+" of",button_selector:".toontalk-element-"+a+"-attribute-input"});this.add_to_css(a,b);k&&(b=this.get_style_attributes(),0>b.indexOf(a)&&b.push(a));this.rerender();return!0};d.dropped_on_style_attribute=function(a,b,
d,f){var k,n,l;if(a){k=a.toString();if(a.is_number()){n=this.get_attribute(b);if("number"===typeof n)l=n;else if("auto"===n)switch(b){case "left":l=$(this.get_frontside_element()).offset().left;break;case "top":l=$(this.get_frontside_element()).offset().top;break;default:l=0}else l=parseFloat(n);n=a.to_float();switch(k.substring(0,1)){case "-":k=l-n;break;case "*":k=l*n;break;case "/":k=l/n;break;case "^":k=Math.pow(l,n);break;default:k=l+n}this.set_attribute(b,k,!1);(d||f&&f.visible())&&this.get_backside().render()}a.get_infinite_stack()||
a.remove();d&&this.robot_in_training()&&this.robot_in_training().dropped_on(a,this.create_attribute_widget(b))}};d.get_attribute_widget_in_backside_table=function(a,b,d){var f=this.get_attribute_widgets_in_backside_table()[a];f||b||(f=this.create_attribute_widget(a,d),this.get_attribute_widgets_in_backside_table()[a]=f);return f};d.create_attribute_widget=function(d,f){var h=".toontalk-element-"+d+"-attribute-input",k=this.get_backside_element(),t=this.get_attribute(d),n=this,u=function(b,c){var d=
c.toString,f=c.equals;H=c.update_display;c.element_widget=this;c.attribute=b;c.get_type_name=function(a){return a?"element attributes":"element attribute"};c.toString=function(){return d.call(this)+" ("+this.attribute+" of "+this.get_attribute_owner()+")"};c.get_custom_title_prefix=function(){return"I'm the '"+this.attribute+"' attribute of "+this.get_attribute_owner()+".\nDrop a number on me or edit my back side to change my value. My back side has an info button to learn more."};c.equals=function(a){return b===
a.attribute?this.equals(a.element_widget):f.call(this,a)};c.update_display=function(){var a;this.get_erased()||(a=this.get_attribute_owner().get_attribute(this.attribute),F(a));H.call(this)};z=c.copy.bind(c);c.copy=function(a){var c;if(a){if(a.just_value)return z(a);a.elements_copied&&(c=a.elements_copied[n.get_guid()])}return this.add_to_copy((c||n).create_attribute_widget(b),a)};c.get_json=function(c){return{type:"attribute_widget",attribute_name:b,element:a.UTILITIES.get_json(n,c)}};c.get_original_attribute_widget=
function(){var a=n.get_original_copies()[b];return a&&a[0]};c.get_attribute_owner=function(){var a=function(b){if(b=b.get_parent_of_frontside()){if(b.is_backside())return b;if(!b.is_nest())return a(b.get_widget())}},b,c;b=a(this);if(!b)return(b=this.get_original_attribute_widget())&&b!==this?b.get_attribute_owner():n;if(!b.get_widget().is_element())return n;b=b.get_widget();for(c=b.get_parent_of_backside();c&&c.get_widget().is_element();)b=c.get_widget(),c=b.get_parent_of_backside();return b};c.get_help_URL=
function(){return l(b)}}.bind(this),c=function(b,c){var d=a.number.create(0,1);u(b,d);d.set_value_from_decimal(c);d.set_format("decimal");d.set_value=function(a){var c=n.get_original_copies()[b];a=bigrat.toDecimal(a);var d=bigrat.fromDecimal(a);this.get_attribute_owner().set_attribute(this.attribute,a)&&c.forEach(function(a,b){a.set_value_from_sub_classes(d,!0)});return this.set_value_from_sub_classes(d,!1)};d.is_attribute_widget=function(){return!0};d.get_function_type=function(){return"number"};
return d}.bind(this),r=function(b,c){var d=a.element.create(c);u(b,d);d.set_HTML=function(a){var c=n.get_original_copies()[b],d;this.get_attribute_owner().set_attribute(this.attribute,a)&&c.forEach(function(b,c){d=b.set_HTML_from_sub_classes(a)});return d};d.get_function_type=function(){return"element"};d.set_additional_classes("toontalk-string-attribute-widget");return d}.bind(this),y;y=0<=["background-color","color"].indexOf(d)?"string":"number";var z,F,H,K,D;k&&(h=$(k).find(h),0<h.length&&(h.get(0).toontalk_widget=
this));if("number"===y){if(K=c(d,t),F=K.set_value_from_decimal.bind(K),0<=b.indexOf(d)&&(this.on_update_display(function(){K.rerender();return!0}),"left"===d||"top"===d)){var J;f&&f.to_be_on_backside_of&&(J=f.to_be_on_backside_of[0]);J||(J=K.get_attribute_owner());D=function(a){var b,c;a.currentTarget.toontalk_widget===K.get_attribute_owner()&&(b=$(J.get_frontside_element()).closest(".toontalk-top-level-backside").offset(),b||(console.log("Unable to find top-level backside of an element for its position. Perhaps is 'visible' but not attached."),
b={left:0,top:0}),c=a.pageX-b.left-(J.drag_x_offset||0),b=a.pageY-b.top-(J.drag_y_offset||0),"left"===d?(a=c,J.set_attribute("top",b)):(a=b,J.set_attribute("left",c)),K.set_value_from_decimal(a),H.call(K))};K.add_parent_of_frontside_change_listener(function(a,b){a&&a.get_widget().is_element()&&a.get_frontside_element().removeEventListener("drag",D);b&&b.get_widget().is_element()&&b.get_frontside_element().addEventListener("drag",D)})}}else if("string"===y)K=r(d,t),F=K.set_HTML.bind(K);else{a.UTILITIES.report_internal_error("Unrecognized attribute type: "+
y+" for "+d);return}(t=this.get_original_copies()[d])?t.push(K):this.get_original_copies()[d]=[K];return K};a.creators_from_json.attribute_widget=function(b,d){return a.UTILITIES.create_from_json(b.element,d).create_attribute_widget(b.attribute_name,d)};a.creators_from_json.attribute_number=a.creators_from_json.attribute_widget;d.on_backside_hidden=function(){this.get_style_attributes().forEach(function(a){(a=this.get_attribute_widget_in_backside_table(a,!0))&&a.set_visible(!1)}.bind(this))};d.toString=
function(a){var b;if(a)if("conditions"===a.role||a.plain_text)b='"'+this.get_text()+'"';else{if(a.for_json_div)return""}else a=this.get_HTML(),1<a.length&&"<"===a.charAt(0)?(b=a.indexOf(" "),b=a.substring(0,b+1)+"style='width: 50px; height: 30px;'"+a.substring(b)):b='"'+a+'"';return"the element "+b};d.get_type_name=function(a){return a?"elements":"element"};d.get_help_URL=function(){return"docs/manual/elements.html"};d.get_json=function(b){var d=this.get_style_attributes(),f=[],k=a.UTILITIES.remove_z_index(this.get_HTML()),
l=encodeURIComponent(k);0===k.indexOf("<img src='data:image/")&&(b.shared_html||(b.shared_html=[]),k=b.shared_html.indexOf(l),0>k&&(k=b.shared_html.push(l)-1),l={shared_html_index:k});d.forEach(function(a){f.push(a)});return{type:"element",html:l,attributes:f,attribute_values:f.map(this.get_attribute.bind(this)),attributes_backsides:f.map(function(d){if(d=this.get_attribute_widget_in_backside_table(d,!0))return a.UTILITIES.get_json_of_array(d.get_backside_widgets(),b)}.bind(this)),additional_classes:this.get_additional_classes(),
sound_effect:this.get_sound_effect()&&this.get_sound_effect().src,video:this.get_video_object()&&this.get_video_object().src,ignore_pointer_events:this.get_ignore_pointer_events()?!0:void 0,source_URL:this.get_source_URL()}};a.creators_from_json.element=function(b,k){var h=decodeURIComponent("string"===typeof b.html?b.html:k.shared_html[b.html.shared_html_index]),l=d.create(h,b.attributes,b.description,b.sound_effect,b.video,b.ignore_pointer_events),t;t=k&&k.event?["left","top"]:[];b.attribute_values.forEach(function(d,
h){var c=b.attributes[h],r=b.attributes_backsides&&b.attributes_backsides[h];0>t.indexOf(c)&&l.add_to_css(c,f(d)||d);r&&(c=l.get_attribute_widget_in_backside_table(c,!1,k),a.UTILITIES.add_backside_widgets_from_json(c,r,k))}.bind(this));b.additional_classes&&l.set_additional_classes(b.additional_classes);b.source_URL&&(l.set_source_URL(b.source_URL),l.refresh());return l};d.create_attribute_path=function(b,d){var f=a.path.get_path_to(b.element_widget,d);return this.extend_attribute_path(f,b.attribute)};
d.refresh=function(){this.get_source_URL()&&a.UTILITIES.create_widget_from_URL(this.get_source_URL(),function(a){a&&this.set_HTML(a.get_HTML())}.bind(this))};d.extend_attribute_path=function(a,b){return{dereference_path:function(d,f,k){return a.dereference_path(f||d,void 0,k).get_attribute_widget_in_backside_table(b)},toString:function(){return"the '"+b+"' property of "+a},get_json:function(){return{type:"path_to_style_attribute",attribute:b,element_widget_path:a.get_json()}}}};a.creators_from_json.path_to_style_attribute=
function(b){var f=a.UTILITIES.create_from_json(b.element_widget_path);return d.extend_attribute_path(f,b.attribute)};d.set_size_attributes=function(b,d,f){f?(this.add_to_css("width",b),this.add_to_css("height",d)):(this.set_attribute("width",b),this.set_attribute("height",d));a.UTILITIES.set_timeout(function(){this.rerender()}.bind(this))};d.set_location_attributes=function(a,b){this.set_attribute("left",a);this.set_attribute("top",b)};d.receive_HTML_from_dropped=function(a){a=a.get_text&&a.get_text();
if(this.set_HTML(a))return this.get_text()};d.receive_URL_from_dropped=function(a){a=a.get_text();if(this.set_source_URL(a))return this.get_source_URL()};d.add_style_attribute=function(a){var b=this.get_style_attributes();0>b.indexOf(a)&&(b.push(a),"left"===a?(a=this.get_frontside_element(),$(a).on("drag",function(a){var b=this.get_backside_element(!0),d=this.get_frontside_element();b&&d&&$(b).find(".toontalk-element-left-attribute-input").val(a.originalEvent.clientX)}.bind(this))):"top"===a&&(a=
this.get_frontside_element(),$(a).on("drag",function(a){var b=this.get_backside_element(!0),d=this.get_frontside_element();b&&d&&$(b).find(".toontalk-element-top-attribute-input").val(a.originalEvent.clientY)}.bind(this))));return!0};d.remove_style_attribute=function(a){var b=this.get_style_attributes();a=b.indexOf(a);0<=a&&(b.splice(a,1),this.get_backside().update_style_attribute_chooser());return!0};return d}(window.TOONTALK);window.TOONTALK.element_backside=function(a){var b=function(b,d,k){if(k.visible()){var h=
d.get_style_attributes();d.get_frontside_element();$(b).empty();h.forEach(function(h){d.get_attribute(h);var l=document.createElement("tr"),n=document.createElement("td"),u=d.get_attribute_widget_in_backside_table(h),c=u.get_frontside_element();u.set_parent_of_frontside(k,!1,!0);u.set_infinite_stack(!0);b.appendChild(l);l.appendChild(n);n.appendChild(a.UTILITIES.create_text_element(h));n=document.createElement("td");l.appendChild(n);u.set_visible(!0);$(c).addClass("toontalk-element-attribute");n.appendChild(c);
u.render()})}},d=function(b,d){var k=$("<button>Add or remove my style attributes</button>").button();k.addClass("toontalk-show-attributes-chooser-button");k.click(function(h){$(b).is(":visible")?($(b).hide(),k.button("option","label","Add or remove my style attributes"),a.UTILITIES.give_tooltip(k.get(0),"Click to add widgets for my style attributes.")):($(b).show(),k.button("option","label","Hide my style attributes list"),a.UTILITIES.give_tooltip(k.get(0),"Click to hide my list of attributes that can be added or removed."));
d.robot_in_training()&&d.robot_in_training().button_clicked(".toontalk-show-attributes-chooser-button",d)});a.UTILITIES.give_tooltip(k.get(0),"Click to add widgets for my style attributes.");return k.get(0)};return{create:function(f){var g=a.backside.create(f),k=g.get_element();f.get_HTML();var h=document.createElement("table"),v=document.createElement("div"),t=d(v,f),n=a.backside.create_advanced_settings_button(g,f),u=a.UTILITIES.create_check_box(!0,"toontalk-react-to-pointer-check-box","Normal response to mouse",
"Uncheck this if you don't want the usual browser action to occur when clicked."),c=a.UTILITIES.get_current_url_boolean_parameter("elementHTML",!0),r=c?"get_HTML":"get_text",y=g.update_display.bind(g),z,F,H,K,D,J,M,C,L,I;f.initialize_element();z=f[r]().trim();0<z.length&&!f.get_image_element()&&(H=function(b){(b=a.UTILITIES.input_area_drop_handler(b,f.receive_HTML_from_dropped.bind(f),f))&&f.robot_in_training()&&f.robot_in_training().dropped_on_text_area(b,f,{area_selector:".toontalk-html-input",
setter:"receive_HTML_from_dropped",toString:"for the element's text"})},F=a.UTILITIES.create_text_area(z,"toontalk-html-input","My HTML is","Type here to edit the text.",H),z=function(a){a=F.button.value.trim().replace(/\xA0/g," ");f.get_frontside_element();var b=c?"set_HTML":"set_text";f[b](a)&&f.robot_in_training()&&f.robot_in_training().edited(f,{setter_name:b,argument_1:a,toString:'change the text to "'+a+'"',button_selector:".toontalk-html-input"})},$(F.container).css({width:"100%"}),$(F.button).css({width:"100%"}),
F.button.addEventListener("change",z),F.button.addEventListener("mouseout",z),f.is_plain_text_element()&&k.appendChild(F.container),f.get_source_URL()&&(H=function(b){var c=a.UTILITIES.input_area_drop_handler(b,f.receive_URL_from_dropped.bind(f),f);c&&f.robot_in_training()&&f.robot_in_training().dropped_on_text_area(c,f,{area_selector:".toontalk-URL-input",setter:"receive_URL_from_dropped",toString:"for the URL source of the text"});b.stopPropagation()},z=function(a){a=K.button.value.trim().replace(/\xA0/g,
" ");f.get_frontside_element();f.set_source_URL(a)&&f.robot_in_training()&&f.robot_in_training().edited(f,{setter_name:"set_source_URL",argument_1:a,toString:'change the source URL to "'+a+'"',button_selector:".toontalk-URL-input"})},K=a.UTILITIES.create_text_input(f.get_source_URL(),"toontalk-URL-input","","Edit the URL where this text comes from.",void 0,void 0,H),K.button.addEventListener("change",z),K.button.addEventListener("mouseout",z),k.appendChild(K.container)));g.update_style_attribute_chooser=
function(){var c=function(c,d,f){var m=0<=f.get_style_attributes().indexOf(c),g=a.UTILITIES.create_check_box(m,"toontalk-style-attribute-check-box",c+"&nbsp;","Click to add or remove the '"+c+"' style attribute from my backside."),k="toontalk-style-attribute-check-box-for-"+c,m=a.UTILITIES.create_anchor_element("i",l(c)),n=document.createElement("li");$(m).addClass("toontalk-help-button notranslate toontalk-attribute-help-button");$(m).css({color:"white"});m.translate=!1;m.lang="en";g.container.appendChild(m);
$(g.button).addClass(k);g.button.addEventListener("click",function(a){g.button.checked?f.add_style_attribute(c):f.remove_style_attribute(c);b(h,f,f.get_backside());f.robot_in_training()&&f.robot_in_training().edited(f,{setter_name:g.button.checked?"add_style_attribute":"remove_style_attribute",argument_1:c,toString:(g.button.checked?"add":"remove")+" a widget for the "+c+" attribute of",button_selector:"."+k})});n.appendChild(g.container);d.appendChild(n)},d=function(a,b,f){var g,h;"string"===typeof a?
c(a,b,f):a.label?(g=document.createElement("h3"),g.textContent=a.label,h=document.createElement("ul"),b.appendChild(g),b.appendChild(h),d(a.sub_menus,h,f)):a.forEach(function(a){d(a,b,f)})};$(v).is(".ui-accordion")&&$(v).accordion("destroy");$(v).empty();d([{label:"Geometry attributes",sub_menus:"left top width height z-index background-position".split(" ")},{label:"Color attributes",sub_menus:["background-color","color","opacity"]},{label:"Font attributes",sub_menus:["font-size","font-weight"]},
{label:"Visibility",sub_menus:["display","visibility"]},{label:"Transformations",sub_menus:["rotate","skewX","skewY","transform-origin-x","transform-origin-y"]}],v,f);$(v).accordion({active:0,heightStyle:"content"});return v};g.get_attributes_chooser=function(){return v};f.get_sound_effect()?(M=f.get_sound_effect(),C=function(){g.visible()&&(M.paused?(a.UTILITIES.give_tooltip(D.get(0),"Click to begin playing this sound."),D.button("option","label","Play sound")):(a.UTILITIES.give_tooltip(D.get(0),
"Click to pause this sound."),D.button("option","label","Pause sound")))},D=$("<button>Play sound</button>").button(),D.addClass("toontalk-play-sound-effect-button"),D.click(function(a){M.paused?(M.play(),M.addEventListener("ended",C)):M.pause();C();f.robot_in_training()&&f.robot_in_training().button_clicked(".toontalk-play-sound-effect-button",f)}),C(),k.appendChild(D.get(0))):$(f.get_frontside_element()).find("video").is("*")&&(L=f.get_video_object(),I=function(){g.visible()&&(L.paused?(a.UTILITIES.give_tooltip(J.get(0),
"Click to begin playing this video."),J.button("option","label","Play video")):(a.UTILITIES.give_tooltip(J.get(0),"Click to pause this video."),J.button("option","label","Pause video")))},J=$("<button>Play video</button>").button(),J.addClass("toontalk-play-video-button"),J.click(function(a){L.paused?(L.play(),L.addEventListener("ended",I)):L.pause();I();f.robot_in_training()&&f.robot_in_training().button_clicked(".toontalk-play-video-button",f)}),I(),k.appendChild(J.get(0)));g.update_style_attribute_chooser();
b(h,f,g);k.appendChild(v);k.appendChild(t);k.appendChild(h);k.appendChild(n);$(v).hide();$(v).addClass("toontalk-attributes-chooser");g.update_display=function(){F&&$(F.button).val(f[r]());b(h,f,g);$(v).is(":visible")&&g.update_style_attribute_chooser();f.get_backside_widgets().forEach(function(a){a&&a.get_widget().is_attribute_widget()&&a.rerender()});y()};$(k).find(".toontalk-hide-backside-button").click(function(a){$(v).hide()});u.button.checked=!f.get_ignore_pointer_events();u.button.addEventListener("click",
function(a){f.set_ignore_pointer_events(!u.button.checked)});f.is_plain_text_element()?g.add_advanced_settings(!1,u.container):g.add_advanced_settings(!1,F.container,u.container);return g}}}(window.TOONTALK)})();window.TOONTALK.sensor=function(k){var l=Object.create(k.widget),a=function(a,d){"element"===a.get_type_name()&&(a.set_attributes("font-size",.5*$(d.get_frontside_element(!0)).height(),!1,!0),a.set_additional_classes("toontalk-string-value-from-sensor"),d.visible()&&a.rerender())};l.create=function(b,d,f,g,q,h,v){var t=k.nest.create(f,g,"sensor",void 0,void 0,v||"sensor"),n=t.get_json,u=t.update_display,c=t.copy,r=d.split(" "),y=function(a){return r.map(function(b){var c;if("keyCode"===b){if(16===
c)return"";c=String.fromCharCode(c);a.shiftKey||(c=c.toLowerCase())}else c=a[b],"undefined"===typeof c&&(c="No "+b+" in event "+a+" of sensor "+l,k.UTILITIES.display_message(c));return c})},z=function(b){var c;switch(typeof b){case "number":c=k.number.create(Math.round(b),1);break;case "string":c=k.element.create(b,void 0,void 0,void 0,void 0,void 0,"toontalk-string-value-from-sensor");a(c,t);break;case "boolean":c=k.element.create(b.toString(),void 0,void 0,void 0,void 0,void 0,"toontalk-string-value-from-sensor"),
a(c,t)}return c},F=function(a){if(t.get_active()){var c=y(a),d=t.visible();a=$(t.get_frontside_element()).closest(".toontalk-top-level-backside");c=1===c.length?z(c[0]):k.box.create(c.length,!0,c.map(z),"the values of the "+k.UTILITIES.conjunction(r)+" attributes of "+k.UTILITIES.add_a_or_an(b)+" event.",r.join(";"));d?(d=k.bird.create(t),t.add_to_top_level_backside(d),c.render(),d.animate_delivery_to(c,t,t,a.width()/2,a.height())):t.add_to_contents(c)}}.bind(this);t.is_sensor=function(){return!0};
t.copy=function(a){var d;if(a&&a.just_value&&this.has_contents())return c.call(this,a);d=a?k.sensor.create(b,this.get_attributes_string(),f,void 0,a.copying_resource||q,h,this.get_name()):k.sensor.create(b,this.get_attributes_string(),f,void 0,q,h,this.get_name());return t.add_to_copy(d,a)};t.get_json=function(a){var c=n.call(this,a);c.type="sensor";c.event_name=b;c.attribute=this.get_attributes_string();c.active=q;c.sensor_of=h&&k.UTILITIES.get_json(h,a);return c};t.update_display=function(){var a=
$(this.get_frontside_element());u.call(this);q||a.is(".toontalk-top-level-resource")?(a.addClass("toontalk-sensor-nest"),a.removeClass("toontalk-sensor-inactive-nest")):(a.addClass("toontalk-sensor-inactive-nest"),a.removeClass("toontalk-sensor-nest"));a.removeClass("toontalk-empty-nest")};t.get_type_name=function(a){return a?"sensors":"sensor"};t.get_help_URL=function(){return"docs/manual/sensors.html"};t.toString=function(){return"a sensor that receives the '"+this.get_attributes_string()+"' attribute of "+
b+" events"};t.get_class_name_with_color=function(a){return a};t.get_active=function(){return!0===q};t.restore_active=function(){"temporarily false"===q&&this.set_active(!0)};t.set_active=function(a,c){if(q!==a||c)!0===a?h?h.get_frontside_element().addEventListener(b,F):window.addEventListener(b,F):h?h.get_frontside_element().removeEventListener(b,F):window.removeEventListener(b,F),q=a};t.set_running=function(a){this.set_active(a)};t.set_active(q,!0);t.create_backside=function(){return k.sensor_backside.create(this)};
t.get_event_name=function(){return b};t.set_event_name=function(a){var c=q;b&&q&&this.set_active(!1);b=a;c&&this.set_active(!0)};t.get_attributes=function(){return r};t.set_attributes=function(a){r=a.split(" ")};t.get_attributes_string=function(){return r.join(" ")};t.match=function(a){return this};t.set_sensor_of=function(a){h=a};t.get_custom_title_prefix=function(){var a="When a '"+b+"' event occurs my bird will bring me the '"+this.get_attributes_string()+"' attribute of the event.";q?this.get_backside()||
(a+=" On my back you can change which kind of events and attributes I receive."):a+=" But I'm deactivated and can't receive anything until the 'Listening to events' check box on my back is ticked.";return a};return t};k.creators_from_json.sensor=function(b,d){var f=k.UTILITIES.create_array_from_json(b.contents,d),g=k.sensor.create(b.event_name,b.attribute,b.description,f,!1,void 0,b.name);b.sensor_of?k.UTILITIES.set_timeout(function(){g.set_sensor_of(k.UTILITIES.create_from_json(b.sensor_of,d));g.set_active(b.active)}):
g.set_active(b.active);0<f.length&&setTimeout(function(){f.forEach(function(b){a(b.get_widget(),g)})},500);return g};return l}(window.TOONTALK);
window.TOONTALK.sensor_backside=function(k){return{create:function(l){var a=k.UTILITIES.create_text_input(l.get_event_name(),"toontalk-sensor-event-name-input","Event name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;","Type here the event name.","https://developer.mozilla.org/en-US/docs/Web/Events/"+l.get_event_name()),b=k.UTILITIES.create_text_input(l.get_attributes_string(),"toontalk-sensor-event-attribute-input","Event attribute","Type here the event attribute name or names separated by spaces.","https://developer.mozilla.org/en/docs/Web/API/Event"),
d=k.UTILITIES.create_check_box(l.get_active(),"toontalk-sensor-active-check-box","Listening to events","Check the box if you want to make this sensor active."),f=k.nest_backside.create(l),g=f.get_element(),q=$(g).find(".toontalk-settings-backside-button").get(0);a.button.addEventListener("change",function(){l.set_event_name(a.button.value.trim())});b.button.addEventListener("change",function(){l.set_attributes(b.button.value.trim())});$(d.button).click(function(a){var b=d.button.checked;l.set_active(b);
l.robot_in_training()&&l.robot_in_training().edited(robot,{setter_name:"set_active",argument_1:b,toString:"change to "+(b?"active":"inactive")+" of the "+l,button_selector:".toontalk-sensor-active-check-box"});l.render();a.stopPropagation()});g.insertBefore(a.container,q);g.insertBefore(b.container,q);g.insertBefore(d.container,q);return f}}}(window.TOONTALK);window.TOONTALK.tool=function(k){document.addEventListener("mousemove",function(l){k.tool.pageX=l.pageX;k.tool.pageY=l.pageY});return{add_listeners:function(l,a){var b,d,f,g,q,h=function(c){var h=l.getBoundingClientRect();a.set_held&&a.set_held(!0);g=h.height;c&&c.preventDefault();setTimeout(function(){a.held&&!a.held()||$(l).addClass("toontalk-tool-held")},200);b=$(l).offset();document.addEventListener("mousemove",t);document.addEventListener("touchmove",t);document.addEventListener("mouseup",n);
document.addEventListener("touchend",n);k.logging&&0===k.logging.indexOf("touch")&&(k.debugging+="\nmouse_down at "+Date.now());f=d=0;$(".ui-tooltip").each(function(){$(this).hide()})},v=function(b){var g=l.getBoundingClientRect();a.held&&a.held()||h(b);d=k.UTILITIES.get_mouse_or_first_touch_event_attribute("clientX",b)-g.left;f=k.UTILITIES.get_mouse_or_first_touch_event_attribute("clientY",b)-g.top},t=function(a){var b=k.UTILITIES.find_widget_on_page(a,l,d,f-g/2),h,n,t;a.preventDefault();$(".ui-tooltip").each(function(){$(this).hide()});
n=u(a);t=k.UTILITIES.get_mouse_or_first_touch_event_attribute("pageX",a)-n.deltaX-d;a=k.UTILITIES.get_mouse_or_first_touch_event_attribute("pageY",a)-n.deltaY-f;l.style.left=t+"px";l.style.top=a+"px";k.logging&&0===k.logging.indexOf("touch")&&(k.debugging+="\nmouse_move at "+Date.now()+" now at "+l.style.left+", "+l.style.top);if(b&&b.is_top_level())q&&(k.UTILITIES.remove_highlight(),q=void 0);else{if(b&&(h=b.get_frontside_element(),h===q))return;q=h;k.UTILITIES.highlight_element(q)}},n=function(c){var h=
k.UTILITIES.find_widget_on_page(c,l,d,f-g/2),u;c.preventDefault();a.set_held&&a.set_held(!1);q&&k.UTILITIES.remove_highlight();h&&h.top_level_widget&&(u=h.top_level_widget(),a.apply_tool(h,c),u.backup_all());!h&&a.nothing_under_tool&&a.nothing_under_tool();$(l).removeClass("toontalk-tool-held");$(l).addClass("toontalk-tool-returning");k.UTILITIES.add_one_shot_event_handler(l,"transitionend",1E3,function(){$(l).removeClass("toontalk-tool-returning")});k.UTILITIES.set_timeout(function(){l.style.left=
b.left+"px";l.style.top=b.top+"px"});document.removeEventListener("mousemove",t);document.removeEventListener("touchmove",t);document.removeEventListener("mouseup",n);document.removeEventListener("touchend",n);k.logging&&0===k.logging.indexOf("touch")&&(k.debugging+="\nmouse_up at "+Date.now(),alert(k.debugging),k.debugging="touch")},u=function(a){var b=0,d=0;20>a.clientX?b=-20:a.clientX+20>window.innerWidth&&(b=20);20>a.clientY?d=-20:a.clientY+20>window.innerHeight&&(d=20);window.scrollBy(b,d);return{deltaX:b,
deltaY:d}};l.addEventListener("mousedown",v);l.addEventListener("touchstart",v);return h}}}(window.TOONTALK);window.TOONTALK.vacuum=function(k){var l=Object.create(null),a={suck:"I'm a vacuum. Drag me over the thing you want to remove.\nType 'e' to switch to erasing, type 'r' to swich to restoring, or 'a' for removing all.\nOr click to switch modes.",erase:"I'm a vacuum. Drag me over the thing you want to erase (or un-erase).\nType 's' to switch to sucking, type 'r' to switch to restoring, or 'a' for removing all.\nOr click to switch modes.",restore:"Drag me over the work area. Each time you release me I'll restore a widget.\nType 's' to switch to sucking, type 'e' to swich to erasing, or 'a' for removing all.\nOr click to switch modes.",
suck_all:"Drag me over the work area and click. Everything will be removed.\nType 'r' to switch to restoring, type 'e' to switch to erasing, or type 's' to switch to sucking.\nOr click to switch modes."},b={suck:"toontalk-vacuum-s",erase:"toontalk-vacuum-e",restore:"toontalk-vacuum-r",suck_all:"toontalk-vacuum-a"},d={suck:"erase",erase:"restore",restore:"suck_all",suck_all:"suck"},f=!1,g;l.create=function(){var q,h,v,t=[],n=function(a){v!==a&&(v=a,k.sounds&&k.sounds.click.play(),$(q).removeClass(h),
h=b[v],$(q).addClass(h),u())},u=function(){"restore"===v&&0===t.length?k.UTILITIES.give_tooltip(q,"I'm empty.\nType 's' to switch to sucking, or type 'e' to switch to erasing, or 'a' to remove all."):k.UTILITIES.give_tooltip(q,a[v])};document.addEventListener("keyup",function(a){var b=String.fromCharCode(a.keyCode);a.altKey&&(q||(l.the_vacuum.get_element(),$(q).css({left:k.tool.pageX,top:k.tool.pageY}),document.body.appendChild(q)),g());l.the_vacuum.held()&&("s"===b||"S"===b?n("suck"):"e"===b||"E"===
b?n("erase"):"r"===b||"R"===b?n("restore"):"a"===b||"A"===b?n("suck_all"):k.sounds&&k.sounds.event_ignored.play(),a.preventDefault(),a.stopPropagation())});document.addEventListener("keydown",function(a){l.the_vacuum.held()&&(a.preventDefault(),a.stopPropagation())});k.vacuum.the_vacuum={apply_tool:function(a,b){var d=a.get_widget(),f=function(a){var c;a.is_backside()?a.hide_backside():(b&&d.robot_in_training()&&d.robot_in_training().removed(a),a===d.robot_in_training()?(a.training_finished(),a.set_run_once(!0)):
(d.is_bird()&&k.sounds&&k.sounds.bird_fly.pause(),c=a.copy(),c.save_dimensions_of(a),c.this_and_walk_children(function(a){a.is_sensor()&&a.get_active()&&a.set_active("temporarily false");return!0}),t.push(c),a.set_running&&a.set_running(!1),a.this_and_walk_children(function(a){a.is_sensor()&&a.get_active()&&a.set_active(!1);return!0}),a.remove(b)))},g,h,n;"suck"===v?a.remove&&"top-level"!==a.get_type_name()&&(f(a),k.sounds&&k.sounds.vacuum_suck.play()):"erase"===v||"restore"===v&&a.get_erased&&a.get_erased()?
"top-level"!==a.get_type_name()&&(g=!a.get_erased(),k.sounds&&(g?k.sounds.vacuum_suck.play():k.sounds.vacuum_spit.play()),a.set_erased(g,!0),b&&d.robot_in_training()&&d.robot_in_training().erased_widget(a,g)):"restore"===v?0<t.length&&(g=t.pop(),g.restore_dimensions(),n=a.add_to_top_level_backside(g,!0),h=$(q).offset(),h.left-=$(n).width(),k.UTILITIES.set_absolute_position($(n),h),g.this_and_walk_children(function(a){a.is_sensor()&&a.restore_active();return!0}),k.sounds&&k.sounds.vacuum_spit.play()):
"suck_all"===v&&(g=a.top_level_widget(),g=g.get_backside_widgets().slice(),0<g.length&&k.sounds&&(k.sounds.vacuum_suck.play(),k.sounds.bird_fly.pause()),g.forEach(function(a){a&&d!==d.robot_in_training()&&f(a)}))},nothing_under_tool:function(){n(d[v])},get_element:function(){q||(q=document.createElement("div"),$(q).addClass("toontalk-vacuum"),g=k.tool.add_listeners(q,this),n("suck"),u());return q},held:function(){return f},set_held:function(a){f=a}};return k.vacuum.the_vacuum};k.creators_from_json.vacuum=
function(a,b){var d=k.vacuum.create();a.mode&&k.UTILITIES.set_timeout(function(){d.set_mode(a.mode)});return d};return l}(window.TOONTALK);window.TOONTALK.wand=function(k){var l=Object.create(null);l.create=function(){var a;return{apply_tool:function(a){"top-level"!==a.get_type_name()&&(k.sounds&&k.sounds.magic.play(),a.add_copy_to_container())},get_element:function(){a||(a=document.createElement("div"),$(a).addClass("toontalk-wand"),k.UTILITIES.give_tooltip(a,"I'm a magic wand. Drag me over the thing you want me to copy."),k.tool.add_listeners(a,this));return a}}};k.creators_from_json.wand=function(){return k.wand.create()};return l}(window.TOONTALK);window.TOONTALK.SETTINGS=function(k){var l=[],a=function(a,g,q){var h=[],v=k.UTILITIES.create_local_files_table(),t=function(d,g){var c=function(a){a||g.newPanel.appendChild(k.UTILITIES.create_text_element("Error connecting to cloud"))},h=g.newPanel.is(".dataTable");$(".dataTables_info").hide();$(".dataTables_wrapper").hide();g.newPanel.is(".toontalk-programs-in-cloud-table")?h?($("#tab-1_info").show(),$("#tab-1_wrapper").show()):b(g.newPanel,"program",a,q,c):g.newPanel.is(".toontalk-pages-in-cloud-table")?
h?($("#tab-2_info").show(),$("#tab-2_wrapper").show()):b(g.newPanel,"page",a,q,c):($("#tab-0_info").show(),$("#tab-0_wrapper").show())};h[0]="Programs stored in browser";l[0]=v;g?(h[1]="Programs in cloud",l[1]=k.UTILITIES.create_file_data_table("toontalk-programs-in-cloud-table"),h[2]="Published pages",l[2]=k.UTILITIES.create_file_data_table("toontalk-pages-in-cloud-table"),g=k.UTILITIES.create_tabs(h,l),q.appendChild(g),$(g).on("tabsactivate",t)):q.appendChild(k.UTILITIES.create_tabs(h,l));d(a,v,
!0,q);$(v).on("draw.dt",function(){d(a,v,!1,q)})},b=function(a,b,l,h,v){k.google_drive.get_toontalk_files(!1,b,function(t){var n;"string"===typeof t?n=t:t.error&&(n=t.error.message);n?"Need to authorize"===n||"Login Required"===n?k.google_drive.authorize(v):(console.log(n),console.log("Google drive status: "+k.google_drive.get_status()),v(null)):(n="program"===b&&"toontalk-file-load-button toontalk-file-load-button-without-click-handler",k.UTILITIES.become_file_data_table(a,t.items,!0,n),a.on("draw.dt",
function(){d(l,a.get(0),!0,h)}),v(a.get(0)))})},d=function(a,b,d,h){$(b).find(".toontalk-file-load-button-without-click-handler").click(function(b){var g=function(){$(h).remove()},k=function(){a.set_setting("program_name",b.target.textContent);a.load(d,g)}.bind(this);a.save(!0,void 0,k)}).removeClass("toontalk-file-load-button-without-click-handler")};return{open:function(b){var d=document.createElement("div"),l=b.get_backside_element(),h=b.get_setting("program_name"),v=k.UTILITIES.create_text_input(h,
"toontalk-program-name-input","Current program name:","Edit this to change the name of your program","docs/manual/settings.html"),t=k.UTILITIES.create_close_button(function(){$(d).remove()},"Click to close the settings panel."),n=k.UTILITIES.create_text_element("How should your program be saved?"),u=k.UTILITIES.create_check_box(b.get_setting("auto_save_to_google_drive"),"toontalk-save-setting","Save automatically to my Google Drive",'Check this if you want your programs automatically saved to a "ToonTalk Programs" folder in your Google Drive.'),
c=k.UTILITIES.create_check_box(b.get_setting("auto_save_to_local_storage"),"toontalk-save-setting","Save automatically to this browser's local storage","Check this if you want your programs automatically saved in this browser's local storage."),r=k.UTILITIES.create_button("Save to Google Drive now","toontalk-save-button","Click to save your program now to your Google Drive account.",function(){b.save(!0,{google_drive:!0})}),y=k.UTILITIES.create_button("Save to browser's storage now","toontalk-save-button",
"Click to save your program now to this browser's local storage.",function(){b.save(!0,{local_storage:!0})}),z=k.UTILITIES.create_button("Login to Google","toontalk-google-login-button","Click to log in to Google to authorize use of your Google Drive.",function(){k.google_drive.authorize(function(){$(z).remove()})}),F=k.UTILITIES.create_button("Publish","toontalk-publish-button","Click to publish your program by generating a Google Drive URL.",function(){k.UTILITIES.display_message("Creating your web page...");
b.publish(K,H.button.checked)}),H=k.UTILITIES.create_check_box(b.get_setting("publish_as_workspace"),"toontalk-publish-setting","As a workspace","Check this if you want to publish the workspace and its widgets. Uncheck it you wish to publish just the widgets."),K=function(a,c){var d=document.createElement("span"),m=k.google_drive.google_drive_url(a.id);k.TRANSLATION_ENABLED&&(m=k.UTILITIES.add_URL_parameter(m,"translate","1"));d.innerHTML="Published: <a href='"+m+"' target='_blank'>"+b.get_setting("program_name")+
"</a>";k.UTILITIES.display_message("Your web page is ready for you to edit. Just click on the link.");$(v.container).children("tr").append(k.UTILITIES.create_table_entry(d))},D=document.createElement("div"),J=k.google_drive&&"undefined"!==typeof gapi?k.google_drive.get_status():"Google Drive API not loaded",M=!0,C=k.UTILITIES.create_vertical_table(F,H.container);$(d).addClass("toontalk-settings-panel").css({width:$(l).width()+29,height:$(l).height()+50,left:-2,top:-25,"z-index":k.UTILITIES.next_z_index()});
d.appendChild(t);v.button.addEventListener("change",function(){var a=v.button.value.trim();h!==a&&b.save(!0,void 0,function(){h=a;b.set_setting("program_name",a);b.load(!0,function(){setTimeout(function(){$(d).css({"z-index":k.UTILITIES.next_z_index()})},500)},function(){b.save(!0,void 0,function(){$(".toontalk-settings-panel").remove();k.UTILITIES.display_message("Your program was copied and the new copy's name is '"+b.get_setting("program_name")+"'.")})})})});u.button.addEventListener("click",function(a){b.save(!0,
{auto_save_to_google_drive:c.button.checked,gooogle_drive:!0});b.set_setting("auto_save_to_google_drive",u.button.checked);u.button.checked?$(r).hide():$(r).show()});c.button.addEventListener("click",function(a){b.save(!0,{auto_save_to_local_storage:c.button.checked,local_storage:!0});b.set_setting("auto_save_to_local_storage",c.button.checked);c.button.checked?$(y).hide():$(y).show()});H.button.addEventListener("click",function(a){b.set_setting("publish_as_workspace",H.button.checked)});d.appendChild(D);
$(n).css({"font-weight":"bold","font-size":24,color:"navy"});D.appendChild(n);D.appendChild(v.container);D.appendChild(u.container);D.appendChild(c.container);u.container.appendChild(k.UTILITIES.create_space());u.container.appendChild(r);b.get_setting("auto_save_to_google_drive")&&$(r).hide();c.container.appendChild(k.UTILITIES.create_space());c.container.appendChild(y);b.get_setting("auto_save_to_local_storage")&&$(y).hide();"Need to authorize"===J?(u.container.appendChild(k.UTILITIES.create_space()),
u.container.appendChild(z)):"Authorized"!==J&&"Ready"!==J&&"Authorized but not yet ready"!==J&&(M=!1,b.set_setting("google_drive_unavailable",!0),setTimeout(function(){u.button.disabled=!0;$(F).button("option","disabled",!0);$(r).button("option","disabled",!0);k.UTILITIES.give_tooltip(u.container,"Inactivated because attempt to connect to Google Drive returned: "+J);F.title=u.container.title;r.title=u.container.title},1));$(v.container).children("tr").append(k.UTILITIES.create_table_entry(C));a(b,
M,d);l.appendChild(d)}}}(window.TOONTALK);window.TOONTALK.DEFAULT_SETTINGS={program_name:"My first program",auto_save_to_google_drive:!0,auto_save_to_local_storage:!0};window.TOONTALK.DISPLAY_UPDATES=function(k){var l=[];return{pending_update:function(a){0<=l.indexOf(a)||l.push(a)},update_display:function(){var a,b;0!==l.length&&(a=l,b=function(a,f){$(a).children().each(function(a,d){$(d).css({"z-index":f+1});b(d,f+1)})},l=[],a.forEach(function(a){var f=a.get_frontside_element&&a.get_frontside_element(),g,l,h;a.update_display();a.get_backside&&(l=a.get_backside())&&l.update_display();setTimeout(function(){k.UTILITIES.use_custom_tooltip(f)});g=$(f).parent().closest(".toontalk-side");
g.is("*")&&0===g.find(".toontalk-side-animating, .toontalk-side-appearing").length&&(l=k.UTILITIES.get_style_numeric_property(f,"z-index"),h=k.UTILITIES.get_style_numeric_property(g.get(0),"z-index"),h||(h=k.UTILITIES.next_z_index(),g.css({"z-index":h})),!l||g.is(".toontalk-top-level-backside")?(l=k.UTILITIES.next_z_index(),$(f).css({"z-index":l})):l>=h&&(l=h+1,$(f).css({"z-index":l})),b(f,l));f&&!$(f).is(".toontalk-top-level-resource, .toontalk-bird, .toontalk-nest, .toontalk-box-hole, .toontalk-plain-text-element, .toontalk-conditions-contents, .toontalk-robot, .toontalk-widget, .toontalk-held-by-robot")&&
k.UTILITIES.set_timeout(function(){g.is(".toontalk-box-hole")?$(f).is(".ui-resizable")&&$(f).resizable("destroy"):$(f).is(".ui-resizable")||k.UTILITIES.make_resizable($(f),a)})}))},run_cycle_is_over:function(){this.update_display()}}}(window.TOONTALK);window.TOONTALK.actions=function(k){k.creators_from_json.body=function(l,a){var b=k.actions.create();a.body=b;b.initialise_steps(k.UTILITIES.create_array_from_json(l.steps,a));return b};return{create:function(l){var a=Object.create(this),b=[];l||(l=[]);a.copy=function(){return k.actions.create(k.UTILITIES.copy_array(l))};a.get_steps=function(){return l};a.initialise_steps=function(a){l=a};a.is_empty=function(){return 0===l.length};a.reset_steps=function(){l=[];this.reset_newly_created_widgets()};
a.reset_newly_created_widgets=function(){b=[]};a.add_step=function(a,b){l.push(a);b&&this.add_newly_created_widget_if_new(b)};a.add_newly_created_widget_if_new=function(a){0<=b.indexOf(a)||this.add_newly_created_widget(a)};a.add_newly_created_widget=function(a){k.debugging&&0<=b.indexOf(a)?console.log("add_newly_created_widget called with not new widget."):(b.push(a),k.logging&&0<=k.logging.indexOf("newly-created")&&console.log("Added "+a.to_debug_string()+" to list of newly_created_widgets. Length is "+
b.length))};a.is_newly_created=function(a){return 0<=b.indexOf(a)};a.get_newly_created_widgets=function(){return b};a.get_path_to=function(a,f){var g,l;b.some(function(b,v){if(b===a)return g=k.newly_created_widgets_path.create(v),!0;if(b.get_path_to&&(l=b.get_path_to(a,f)))return g=k.newly_created_widgets_path.create(v),g.next=l,!0});return g};a.dereference_path=function(a){k.debugging&&!b[a]&&k.UTILITIES.report_internal_error("Expected to find the "+k.UTILITIES.ordinal(a)+" newly created widget.");
return b[a]};return a},run_unwatched:function(l,a,b,d,f){var g=this.get_steps();k.logging&&0<=k.logging.indexOf("run")&&console.log(d.to_debug_string()+" running unwatched");f||(f=0);d.run_next_step=function(){if(f<g.length){var q=g[f];f++;k.logging&&0<=k.logging.indexOf("event")&&console.log(q.get_action_name()+" (unwatched)");q.run_unwatched(l,a,d)}else d.set_running_or_in_run_queue(!1),d.run_body_finished_listeners(l,a,b),d.get_run_once()?d.get_first_in_team().set_running(!1):d.get_first_in_team().run(l,
a,b)};d.run_next_step()},run_watched:function(l,a,b,d){var f=this.get_steps(),g=d.get_frontside_element(),q,h,v=g.parentElement,t=function(){var c=d.visible()&&0!==d.get_maximum_step_duration()&&d.get_first_in_team()===d,f=function(){c&&(v.appendChild(g),d.set_animating(!1));d.get_run_once()?d.get_first_in_team().set_running(!1):d.stopped()||d.get_first_in_team().run(l,a,b);d.get_first_in_team()===d&&k.UTILITIES.set_absolute_position($(g),u);d.rerender()};c?k.UTILITIES.animate_to_absolute_position(g,
u,f,d&&d.transform_animation_speed(k.UTILITIES.default_animation_speed)):(d.set_animating(!1),f(),l.add_backside_widget(d),$(d.get_frontside_element()).remove())},n=0,u=$(g).offset(),c=$(g).position(),r=$(g).width(),y=$(g).height(),z=$(g).closest(".toontalk-backside"),F=$(g).closest(".toontalk-top-level-backside").offset(),H=l.get_backside();k.logging&&0<=k.logging.indexOf("run")&&console.log(d.to_debug_string()+" running watched");d.get_parent_of_frontside()||(h=d.get_previous_robot(),h.open_backside(),
h.get_backside().set_advanced_settings_showing(!0),(q=g.parentElement)||(q=$(h.get_backside_element()).find(".toontalk-drop-area").get(0)),l.get_backside_element().appendChild(g),l.add_backside_widget(d),d.update_display(),d.add_body_finished_listener(function(){q&&q.appendChild(g);l.remove_backside_widget(d);d.set_visible(!0);$(g).css({left:"",top:""})}));0===r&&($(g).css({width:"",height:""}),r=$(g).width(),y=$(g).height());F||(console.log("Unable to find top-level backside. Perhaps is 'visible' but not attached."),
F={left:0,top:0});0<z.length&&(h=z.get(0).getBoundingClientRect(),u.left<h.left-F.left||u.top<h.top-F.top||u.left+r>h.right+F.left||u.top+y>h.bottom+F.top)&&(u=z.offset(),u.left+=z.width()/2,u.top+=z.height()-y);d.start_position=c;d.run_next_step=function(){H&&(H.visible()||$(H.get_element()).is(":visible"))?setTimeout(function(){d.run_watched_step_end_listeners();if(n<f.length&&!d.stopped()){var b=f[n];n++;k.logging&&0<=k.logging.indexOf("event")&&console.log(b.get_action_name()+" (watched)");b.run_watched(l,
a,d);d.get_thing_in_hand()&&(d.get_thing_in_hand().save_dimensions(),d.render())}else d.set_running_or_in_run_queue(!1),t(),d.run_body_finished_listeners()},d.transform_step_duration(50)):(d.set_running_or_in_run_queue(!1),d.set_animating(!1),$(g).css({width:"",height:""}),g.style.left=c.left+"px",g.style.top=c.top+"px",v.appendChild(g),this.run_unwatched(l,a,b,d,n))}.bind(this);d.set_animating(!0,u);d.run_next_step();return!0},toString:function(k){for(var a="",b=this.get_steps().map(function(a){return a&&
a.toString(k)});""===b[b.length-1];)b.pop();b.forEach(function(d,f){d&&(a+=d,a=f===b.length-2?a+" and \n":f<b.length-2?a+", \n":a+".")});return a},get_json:function(l){return{type:"body",steps:k.UTILITIES.get_json_of_array(this.get_steps(),l)}}}}(window.TOONTALK);
window.TOONTALK.newly_created_widgets_path=function(k){k.creators_from_json.newly_created_widgets_path=function(l){return k.newly_created_widgets_path.create(l.index)};return{create:function(l){return{dereference_path:function(a,b,d){a=d.get_body().dereference_path(l);if(this.next)return k.path.dereference_path(this.next,a,b,d);this.removing_widget&&(b=a.get_parent_of_frontside())&&b.removed_from_container&&d.remove_from_container(a,b);return a},toString:function(){return"the "+k.UTILITIES.ordinal(l)+
" new widget"},get_json:function(){return{type:"newly_created_widgets_path",index:l}}}}}}(window.TOONTALK);window.TOONTALK.robot_action=function(k){var l={copy:function(a,b,c,d){d.add_newly_created_widget(a.copy());return!0},"pick up":function(a,b,c,d){d.set_thing_in_hand(a);return!0},"pick up a copy of":function(a,b,c,d){a=a.copy();d.add_newly_created_widget(a);d.set_thing_in_hand(a);return!0},"drop it on":function(a,b,c,d,f){if(a)if(b=d.get_thing_in_hand()){if(b.drop_on)return k.debugging&&b===a&&k.UTILITIES.report_internal_error("Dropping something on itself! "+a),b.drop_on(a,!1,void 0,d),d.set_thing_in_hand(void 0),
a.rerender(),b.robot_waiting_before_next_step===d?(f&&f.running_watched||(b.robot_waiting_before_next_step=void 0),!1):!0;k.UTILITIES.report_internal_error("Thing in robot's hand ("+b+") doesn't handle 'drop_on'. Robot that "+d)}else k.UTILITIES.report_internal_error("The robot that '"+d.toString()+"' is executing drop_on but has nothing in its hand.");else k.UTILITIES.report_internal_error("The robot that '"+d.toString()+"' is executing drop_on but doesn't know where to drop what its holding")},
"drop it on the text area of":function(a,b,c,d,f){if(a){if(b=d.get_thing_in_hand())return d.set_thing_in_hand(void 0),a[f.setter](b),!0;k.UTILITIES.report_internal_error("The robot that '"+d.toString()+"' is executing dropped_on_text_area but has nothing in its hand.")}else k.UTILITIES.report_internal_error("The robot that '"+d.toString()+"' is executing dropped_on_text_area but doesn't know where to drop what its holding")},remove:function(a,b,c,d){a.remove();a===d&&d.set_stopped(!0);return!0},"change whether erased":function(a,
b,c,d,f){if(a.set_erased)return a.set_erased(!a.get_erased()),!0;k.UTILITIES.display_message("Robot is unable to erase "+a)},edit:function(a,b,c,d,f){if(a[f.setter_name])return f.argument_2?a[f.setter_name].call(a,f.argument_1,f.argument_2,a.visible()):a[f.setter_name].call(a,f.argument_1,a.visible()),!0;k.UTILITIES.report_internal_error(a+" cannot be edited.")},"change size of":function(a,b,c,d,f){return!0},"add to the top-level backside":function(a,b,c,d,f){d.visible()||(f=a.get_frontside_element(!0),
c=$(b.get_frontside_element()).position(),b=$(b.get_frontside_element()).closest(".toontalk-top-level-backside").get(0)||$(f).closest(".toontalk-top-level-backside").get(0),$(f).css({left:c.left,top:c.top}),b.appendChild(f),b.toontalk_widget.add_backside_widget(a),a.animate_to_element(b,void 0,d.transform_animation_speed(k.UTILITIES.default_animation_speed)));return!0},"add a new widget to the work space":function(a,b,c,d,f){b.is_top_level()?(b=d.add_to_top_level_backside(a),d=$(d.get_frontside_element()).offset(),
a.update_display(),k.UTILITIES.set_position_relative_to_top_level_backside($(b),d,!0)):a.drop_on(b.get_backside(),!1,void 0,d,!0);return!0},"start training":function(a,b,c,d,f){a.training_started(d);return!0},"stop training":function(a,b,c,d,f){a.training_finished();return!0},train:function(a,b,c,d,f){a.add_step(f.step)},"open the backside":function(){return!0},"close the backside":function(){return!0},"click the button of":function(){return!0}},a=function(a,b,c,d){var f=b.get_thing_in_hand(),g=b.get_frontside_element(),
h=a.get_element(),k=$(h).width(),l=$(h).height(),q,t,v,C,L,I;d&&d.left_offset_fraction?(b.original_animation_left_offset||(b.original_animation_left_offset=[]),b.original_animation_top_offset||(b.original_animation_top_offset=[]),v=d.left_offset_fraction*k,C=d.top_offset_fraction*l,f&&(L=f.get_element(),$(L).is(":visible")&&(I=$(L).offset(),g=$(g).offset(),v-=I.left-g.left,C-=I.top-g.top)),f&&0<=b.original_animation_left_offset.indexOf(v)&&0<=b.original_animation_top_offset.indexOf(C)?(v=b.animation_left_offset+
b.last_thing_in_hand_width,C=b.animation_top_offset,v>=k&&(v=0,C+=b.max_thing_in_hand_height,C>=l&&(C=0)),b.last_thing_in_hand_width=$(L).width(),"undefined"===typeof b.max_thing_in_hand_height&&(b.max_thing_in_hand_height=0),b.max_thing_in_hand_height=Math.max(b.max_thing_in_hand_height,$(L).height())):(b.original_animation_left_offset.push(v),b.original_animation_top_offset.push(C),b.last_thing_in_hand_width=$(L).width(),b.max_thing_in_hand_height=$(L).height()),h.animation_left_offset=v,h.animation_top_offset=
C,b.animation_left_offset=v,b.animation_top_offset=C):(q=k/2,t=l/2);b.animate_to_widget(a,c,b.transform_animation_speed(.25),q,t,!0,b.transform_original_step_duration(d&&d.time))},b=function(b,d,c,f){a(b,d,function(){b.open_backside(c);v(b,d)},f)},d=function(a,b){var c=a.get_backside_element(!0);return $(c).find(b).get(0)},f=function(a,b,c,f,g,h,l,q){var t=d(a,h);f.get_frontside_element();var D=t&&$(t).is(":visible"),J=function(){g(t);$(t).addClass("ui-state-active");if(".toontalk-select-function"===
h||".toontalk-box-size-input"===h)t.value=l.argument_1;setTimeout(function(){$(t).removeClass("ui-state-active");!D&&a.get_backside()&&f.add_body_finished_listener(function(){a.get_backside()&&a.get_backside().hide_backside()});f.run_next_step()},q)};b=function(){!$(t).is(":visible")&&M&&M.set_advanced_settings_showing(!0,M.get_element());f.animate_to_element(t,J,f.transform_animation_speed(k.UTILITIES.default_animation_speed/2),0,0,!0)};var M;!D&&a.open_backside&&f.animate_consequences_of_actions()?
(a.open_backside(b),v(a,f)):b()},g=function(a,b,c,d,f,g,h){h=$("."+h).get(0);var l=function(){q(a,b,c,d,f,g)};h&&d.animate_consequences_of_actions()?d.animate_to_element(h,l,d.transform_animation_speed(k.UTILITIES.default_animation_speed),0,0,!0):l()},q=function(a,b,c,d,f,g){d.get_frontside_element();b=function(){d.carrying_tool=void 0;d.update_display();f();d.run_next_step()};d.animate_consequences_of_actions()?(d.carrying_tool=g,d.update_display(),d.animate_to_element(a.get_frontside_element(),
b,d.transform_animation_speed(k.UTILITIES.default_animation_speed/2),0,0,!0)):(f(),d.run_next_step())},h=function(a,b,c,d,f){var h=a.get_parent_of_frontside();g(a,b,c,d,function(){f();h&&"top-level"!==h.get_widget().get_type_name()&&h.update_display&&h.update_display();a.render()},"toontalk-vacuum-ready-small","toontalk-vacuum")},v=function(a,b){b.add_body_finished_listener(function(){a.get_backside()&&a.get_backside().hide_backside()})},t={copy:function(a,b,c,d,f){g(a,b,c,d,function(){f();a.add_copy_to_container(d.get_recently_created_widget())},
"toontalk-wand-small","toontalk-wand")},"pick up":function(b,d,c,f,g,h){b.get_frontside_element();d=function(){g();f.animate_consequences_of_actions()&&f.update_display();f.run_next_step()};"empty hole"===b.get_type_name()?k.UTILITIES.report_internal_error("Robot trying to pick up an empty hole."):b.save_dimensions()&&f.animate_consequences_of_actions()?a(b,f,d,h):d()},"pick up a copy of":function(b,d,c,f,g,h){a(b,f,function(){var a;g();f.animate_consequences_of_actions()&&(a=f.get_recently_created_widget())&&
(a.set_visible(!0),k.UTILITIES.copy_frontside_dimensions(b,a),f.update_display());f.run_next_step()},h)},"drop it on":function(d,f,c,g,h,l){var q=g.get_thing_in_hand(),t;q?(k.debugging&&q===d&&k.UTILITIES.report_internal_error("Dropping something on itself!"),t=$(q.get_frontside_element()),f=function(){var a=t.offset(),b;t.removeClass("toontalk-held-by-robot");h();q.drop_on&&(g.animate_consequences_of_actions()&&(t.is(":visible")||(b=$(g.get_frontside_element()).closest(".toontalk-top-level-backside"),
b.append(t.get(0))),k.UTILITIES.set_absolute_position(t,a),q.restore_dimensions()),q.robot_waiting_before_next_step!==g&&(g.set_thing_in_hand(void 0),g.run_next_step()),g.rerender())},d.is_backside()&&!$(d.get_element()).is(":visible")?b(d.get_widget(),g,f,l):a(d,g,f,l)):(k.UTILITIES.report_internal_error("Expected the robot to be holding something."),console.log("The robot is "+g),a(d,g,h,l))},"drop it on the text area of":function(d,f,c,g,h,l){var q=g.get_thing_in_hand(),t,v,D,J;q?(t=$(q.get_frontside_element()),
v=function(){t.offset();var a;t.removeClass("toontalk-held-by-robot");h();q.remove();a=d.get_parent_of_frontside().get_widget();a.is_hole()&&(a=a.get_parent_of_frontside());a.is_top_level()?d.render():a.render();g.set_thing_in_hand(void 0);g.run_next_step()},D=function(){return $(d.get_backside_element()).find(l.area_selector).get(0)},g.rerender(),$(d.get_backside_element()).is(":visible")?(J=D(),g.animate_to_element(J,v,g.transform_animation_speed(k.UTILITIES.default_animation_speed/2),0,0,!0)):
b(d,g,function(){J=D();g.animate_to_element(J,v,g.transform_animation_speed(k.UTILITIES.default_animation_speed/2),0,0,!0)},l)):(k.UTILITIES.report_internal_error("Expected the robot to be holding something."),console.log("The robot is "+g),a(d,g,h,l))},remove:h,"change whether erased":h,edit:function(a,b,c,d,g,h){f(a,b,c,d,function(){a.get_backside()&&a.get_backside().update_display();g()},h.button_selector,h,1E3)},"change size of":function(a,b,c,d,f,g){var h=a.get_frontside_element();d.animate_to_element(h,
function(){var b=$(h).width(),c=$(h).height(),b=b*g.x_factor,c=c*g.y_factor,k=d.transform_step_duration(1E3);$(h).addClass("toontalk-animating-element");h.style.transitionDuration=k+"ms";h.style.width=b+"px";h.style.height=c+"px";setTimeout(function(){f();a.render();d.run_next_step()},k)},d.transform_animation_speed(k.UTILITIES.default_animation_speed),0,0,!0)},"add to the top-level backside":function(a,b,c,d,f){f();d.run_next_step()},"add a new widget to the work space":function(a,b,c,d,g,h){h&&
h.button_selector?(a=k.path.dereference_path(h.path_to_source,b,c,d),f(a,b,c,d,g,h.button_selector,h,3E3)):(g(),d.run_next_step())},"start training":function(a,b,c,d,f){b=a.open_backside();a=a.get_frontside_element();f();b&&$(b.get_element()).find(".toontalk-train-backside-button").click();$(a).addClass("toontalk-robot-animating toontalk-robot-being-trained-by-robot");a.toontalk_followed_by={element:d.get_frontside_element(),left_offset:30,top_offset:-20};a.toontalk_return_to=$(a).offset();d.run_next_step()},
"stop training":function(a,b,c,d,g,h){var l=a.get_frontside_element();f(a,b,c,d,function(){var b=function(){l.toontalk_return_to=void 0;a.get_backside().change_label_and_title_of_train_button(!1);$(l).removeClass("toontalk-robot-animating toontalk-robot-being-trained-by-robot");l.toontalk_followed_by=void 0;setTimeout(g,1500)};l.toontalk_return_to?k.UTILITIES.animate_to_absolute_position(l,l.toontalk_return_to,b,d.transform_animation_speed(k.UTILITIES.default_animation_speed)):b()},".toontalk-train-backside-button",
h,1E3)},train:function(a,b,c,d,f,g){b=function(){f();d.run_next_step()};(g=g.step.run_watched)?(a.run_next_step=b,g(a.get_parent_of_frontside().get_widget(),c,a)):b()},"open the backside":function(a,b,c,d,f){a.open_backside(function(){f();d.run_next_step()});v(a,d)},"close the backside":function(a,b,c,d,f,g){b=d.transform_original_step_duration(g&&g.time);setTimeout(function(){$(a.get_backside_element()).children(".toontalk-close-button").click();f();d.run_next_step()},b)},"click the button of":function(a,
b,c,d,g,h){f(a,b,c,d,function(a){$(a).click();g()},h.button_selector)}};k.creators_from_json.robot_action=function(a,b){return a.additional_info?k.robot_action.create(k.path.create_from_json(a.path,b),a.action_name,k.UTILITIES.create_keys_from_json(a.additional_info,b)):k.robot_action.create(k.path.create_from_json(a.path,b),a.action_name)};return{create:function(a,b,c){var d=Object.create(this),f=l[b],g=t[b];if(g)return a||k.UTILITIES.report_internal_error("path undefined in "+b+" action"),f||k.UTILITIES.report_internal_error("no run_function for "+
b),d.get_action_name=function(){return b},d.get_additional_info=function(){return c},d.run_unwatched=function(b,d,g){var h=k.path.dereference_path(a,b,d,g);if(!h)return k.UTILITIES.report_internal_error("Unable to dereference path: "+k.path.toString(a)+" in context: "+b.toString()),!1;k.logging&&0<=k.logging.indexOf("event")&&(h.wait_until_this_nest_receives_something?console.log("   wait_until_this_nest_receives_something "+h.wait_until_this_nest_receives_something.to_debug_string()+"("+k.path.toString(a)+
") by unwatched "+g.to_debug_string()):console.log("   "+h.to_debug_string()+" ("+k.path.toString(a)+" "+h.to_debug_string()+" by unwatched "+g.to_debug_string()));h.wait_until_this_nest_receives_something?h.wait_until_this_nest_receives_something.run_when_non_empty(function(){this.run_unwatched(b,d,g)}.bind(this),g):f(h,b,d,g,c)&&g.run_next_step()},d.run_watched=function(b,d,h){var l=k.path.dereference_path(a,b,d,h),q=function(){h.stopped()||(c||(c={}),c.running_watched=!0,f(l,b,d,h,c))};l?(k.logging&&
0<=k.logging.indexOf("event")&&console.log("   "+l+" ("+k.path.toString(a)+" "+l.to_debug_string()+" by watched "+h.to_debug_string()+(h.animate_consequences_of_actions()?"":" finishing instantly")),l.wait_until_this_nest_receives_something?(l.wait_until_this_nest_receives_something.run_when_non_empty(function(){h.set_waiting(!1);this.run_watched(b,d,h)}.bind(this),h),h.set_waiting(!0)):(l.set_visible(!0),g(l,b,d,h,q,c))):k.UTILITIES.report_internal_error("Unable to dereference the path: "+k.path.toString(a)+
" in context: "+b.toString())},d.toString=function(d){var f="",g="",h=b,l;if("open the backside"===b||"close the backside"===b)return"";if("click the button of"===b)switch(c.button_selector){case ".toontalk-green-flag":h="click the green flag "+k.UTILITIES.encode_HTML_for_title("<span class='toontalk-green-flag-icon'></span>")+" of";break;case ".toontalk-stop-sign":h="click the stop sign "+k.UTILITIES.encode_HTML_for_title("<span class='toontalk-stop-sign-icon'></span>")+" of";break;case ".toontalk-play-sound-effect-button":h=
"click the 'Play Sound' button of";break;case ".toontalk-settings-backside-button":h="open the advanced settings of";break;case ".toontalk-show-attributes-chooser-button":h="click the button to add or remove attributes of ";break;default:h="click a button of"}if("add a new widget to the work space"===b)return b.replace("a new widget",k.path.toString(a));if("add to the top-level backside"===b)return"";d||(d={});l=k.path.toString(a,d);if("edit"===b||"drop it on the text area of"===b)f=" ("+c.toString+
")";else if("train"===b){f=c.step.toString({person:"third"});if(""===f)return f;f=" to "+f;g="- ";d&&d.robot_being_trained_description&&(l=d.robot_being_trained_description)}else"start training"===b?d&&(d.robot_being_trained_description="it"):"stop training"===b&&(l=d.robot_being_trained_description,d.robot_being_trained_description=void 0);if(0<="pick up;edit;remove;copy;change whether erased;pick up a copy of;drop it on the text area of".split(";").indexOf(b)){if(0<=l.indexOf("hole of"))return g+
h+" what is in "+l+f;if(0===l.indexOf("a When"))return l=l.substring(3),l=k.UTILITIES.remove_encoded_HTML(l),l=k.UTILITIES.elide(l,80,1),"."===l[l.length-1]&&(l=l.substring(0,l.length-1)),g+h+" a robot who w"+l+f+"\n"}return g+h+" "+l+f},d.get_json=function(d){return{type:"robot_action",action_name:b,path:k.path.get_json(a,d),additional_info:c&&k.UTILITIES.get_json_of_keys(c,["running_watched"])}},d;k.UTILITIES.report_internal_error("No watched function for "+b)}}}(window.TOONTALK);window.TOONTALK.queue=function(k){return{create:function(){var l=Object.create(this);l.to_run=k.UTILITIES.create_queue();return l},enqueue:function(k){if(!k.robot.running_or_in_run_queue())return k.robot.set_running_or_in_run_queue(!0),this.to_run.enqueue(k)},maximum_run:50,paused:!1,run:function(){for(var l,a=Date.now()+this.maximum_run;!(this.to_run.isEmpty()||this.paused||Date.now()>=a);)l=this.to_run.dequeue(),l.robot.run_actions(l.context,l.top_level_context,l.queue);k.DISPLAY_UPDATES.run_cycle_is_over();
k.UTILITIES.set_timeout(function(){this.run()}.bind(this),this.to_run.isEmpty()?this.maximum_run:0)}}}(window.TOONTALK);window.TOONTALK.path=function(k){var l;k.creators_from_json["path.to_entire_context"]=function(){return k.path.to_entire_context()};k.creators_from_json["path.to_widget_on_nest"]=function(){return k.path.to_widget_on_nest()};k.creators_from_json["path.top_level_backside"]=function(){return k.path.top_level_backside};k.creators_from_json["path.to_backside_widget_of_context"]=function(a){return k.path.get_path_to_backside_widget_of_context(a.type_name)};k.creators_from_json["path.to_resource"]=function(a,
b){return k.path.get_path_to_resource(k.UTILITIES.create_from_json(a.resource,b))};return{get_path_to:function(a,b){var d=function(a,b){var d=b.get_context(),h=b.get_body(),l,t,n;a.is_backside()&&(n=!0,a=a.get_widget());if(d===a)return l=k.path.to_entire_context(),l.is_backside=n,l;t=a.get_type_name();if("top-level"===t)return k.path.top_level_backside;if(l=h.get_path_to(a,b))return l.is_backside=n,l;if("element attribute"===t&&a.get_original_attribute_widget()===a)return l=k.element.create_attribute_path(a,
b),l.is_backside=n,l;if(k.debugging&&!d)k.UTILITIES.report_internal_error("No context to compute the path");else{if(d.get_path_to&&(h=d.get_path_to(a,b)))return h.is_backside=n,l=k.path.to_entire_context(),l.next=h,l;d.backside_widgets.some(function(d){d=d.get_widget();var c;if(d===a||d.top_contents_is&&d.top_contents_is(a))return l=k.path.get_path_to_backside_widget_of_context(d.get_type_name()),l.is_backside=n,b.add_to_backside_conditions(d),!0;if(d.get_path_to&&(c=d.get_path_to(a,b)))return c.is_backside=
n,l=k.path.get_path_to_backside_widget_of_context(d.get_type_name()),l.next=c,b.add_to_backside_conditions(d),!0});if(l)return l.is_backside=n,l;if(d=a.ancestor_of_type("robot"))return k.robot.find_conditions_path(a,d,b);l=k.path.get_path_to_resource(a.copy());l.is_backside=n;return l}}(a,b);d&&a.dereference_contents&&(k.path.path_end(d).not_to_be_dereferenced=!0);!d||"pick up"!==b.current_action_name&&"remove"!==b.current_action_name||(k.path.path_end(d).removing_widget=!0);return d},path_end:function(a){for(;a.next;)a=
a.next;return a},dereference_path:function(a,b,d,f){var g;a?a.dereference_path?g=a.dereference_path(b,d,f):b.dereference_path&&(g=b.dereference_path(a,d,f)):g=b;return g&&a&&a.is_backside?g.get_backside(!0):g},continue_dereferencing_path:function(a,b,d,f){return a.next?b.dereference_contents&&!a.next.not_to_be_dereferenced?(b=b.dereference_contents(a.next,d,f))&&a.is_backside?b.get_backside(!0):b:(b=b.dereference_path(a.next,d,f))&&a.next.is_backside?b.get_backside(!0):b:b.dereference_contents&&!a.not_to_be_dereferenced?
(b=b.dereference_contents(a,d,f))&&a.is_backside?b.get_backside(!0):b:b},toString:function(a,b){var d="",f;a.is_backside&&(d="the backside of ");b||(b={});f=b.resource;b.resource=!0;a.next?(k.path.toString(a.next,b),d=d+k.path.toString(a.next,b).trim()+" of "+a.toString(b)):d+=a.toString(b);b.resource=f;return d},get_json:function(a,b){var d;if(!a.get_json)return a;d=a.get_json(b);a.is_widget&&a.add_to_json(d,b);a.next&&(d.next_path=k.path.get_json(a.next,b));a.removing_widget&&(d.removing_widget=
!0);a.not_to_be_dereferenced&&(d.not_to_be_dereferenced=!0);a.is_backside&&(d.is_backside=!0);return d},to_entire_context:function(a){return{dereference_path:function(a,d,f){return k.path.continue_dereferencing_path(this,a,d,f)},toString:function(a){return a&&a.robot?a.robot.get_top_level_context_description(a):a&&"third"===a.person?"what he's working on":"what I'm working on"},get_json:function(){return{type:"path.to_entire_context"}}}},to_widget_on_nest:function(){return{dereference_path:function(a,
b,d){return k.path.continue_dereferencing_path(this,a,b,d)},toString:function(){return"what is on the nest"},get_json:function(){return{type:"path.to_widget_on_nest"}}}},get_path_to_resource:function(a){a=a.get_widget();return{dereference_path:function(b,d,f){b=a.copy({copying_resource:!0});var g,l,h;f.add_newly_created_widget(b);f.visible()&&(g=k.UTILITIES.find_resource_equal_to_widget(a))&&(b.save_dimensions_of(k.UTILITIES.widget_of_element(g)),h=b.get_frontside_element(),l=$(g).position(),k.UTILITIES.set_timeout(function(){$(h).css({left:l.left,
top:l.top,width:$(g).width(),height:$(g).height()})}));return b},toString:function(b){return k.UTILITIES.add_a_or_an(a.toString(b))},get_json:function(){return{type:"path.to_resource",resource:k.path.get_json(a,k.UTILITIES.fresh_json_history())}}}},get_path_to_backside_widget_of_context:function(a){return{dereference_path:function(b,d,f){var g;b.backside_widgets.some(function(b){if(b.get_widget().is_of_type(a)&&!f.is_newly_created(b.get_widget()))return g=b.get_widget(),!0});if(g)return k.path.continue_dereferencing_path(this,
g,d,f)},toString:function(){var b="the "+a+" on the back of what I'm working on";return this.removing_widget?"what is on "+b:b},get_json:function(){return{type:"path.to_backside_widget_of_context",type_name:a}}}},create_from_json:function(a,b){var d=k.UTILITIES.create_from_json(a,b);a.next_path&&(d.next=this.create_from_json(a.next_path,b));a.removing_widget&&(d.removing_widget=!0);a.not_to_be_dereferenced&&(d.not_to_be_dereferenced=!0);a.is_backside&&(d.is_backside=!0);return d},top_level_backside:{dereference_path:function(a,
b,d){if(a=a.ancestor_of_type("top-level"))return a;l||(l=k.widget.create_top_level_widget());return l},toString:function(){return"the top-level backside"},get_json:function(){return{type:"path.top_level_backside"}}}}}(window.TOONTALK);window.TOONTALK.publish=function(k){var l=function(a,b,d){var f='<!DOCTYPE html>\n<html>\n<head>\n<link rel="stylesheet" media="all" href="https://toontalk.github.io/ToonTalk/toontalk.css">\n<link href="https://dl.dropboxusercontent.com/u/51973316/ToonTalk/libraries/froala-wysiwyg-editor/css/font-awesome.min.css" rel="stylesheet" type="text/css" />\n<link href="https://dl.dropboxusercontent.com/u/51973316/ToonTalk/libraries/froala-wysiwyg-editor/css/froala_editor.min.css" rel="stylesheet" type="text/css" />\n<script src="https://toontalk.github.io/ToonTalk/compile/toontalk.js">\x3c/script>\n<script src="https://toontalk.github.io/ToonTalk/libraries/jquery-ui-1.11.2.custom/jquery-ui.min.js">\x3c/script>\n<script src="https://dl.dropboxusercontent.com/u/51973316/ToonTalk/libraries/froala-wysiwyg-editor/js/froala_editor.min.js">\x3c/script>\n<script src="https://dl.dropboxusercontent.com/u/51973316/ToonTalk/libraries/froala-wysiwyg-editor/js/plugins/block_styles.min.js">\x3c/script>\n<script src="https://dl.dropboxusercontent.com/u/51973316/ToonTalk/libraries/froala-wysiwyg-editor/js/plugins/colors.min.js">\x3c/script>\n<script src="https://dl.dropboxusercontent.com/u/51973316/ToonTalk/libraries/froala-wysiwyg-editor/js/plugins/font_family.min.js">\x3c/script>\n<script src="https://dl.dropboxusercontent.com/u/51973316/ToonTalk/libraries/froala-wysiwyg-editor/js/plugins/font_size.min.js">\x3c/script>\n<script src="https://dl.dropboxusercontent.com/u/51973316/ToonTalk/libraries/froala-wysiwyg-editor/js/plugins/lists.min.js">\x3c/script>\n<script src="https://dl.dropboxusercontent.com/u/51973316/ToonTalk/libraries/froala-wysiwyg-editor/js/plugins/tables.min.js">\x3c/script>\n<script src="https://dl.dropboxusercontent.com/u/51973316/ToonTalk/libraries/froala-wysiwyg-editor/js/plugins/video.min.js">\x3c/script>\n<title>\n'+
a+'</title>\n<link rel="shortcut icon" href="favicon.ico" />\n</head>\n<body>\n';b.forEach(function(a,b){f+='<div class="toontalk-edit" name="content">\n'+a+"\n</div>\n";d[b]&&(f+=d[b])});return f+='<script src="https://toontalk.github.io/ToonTalk/support/published_support.js">\x3c/script>\n</body>\n</html>\n'};return{publish_widget:function(a,b,d,f){var g=k.google_drive.get_status(),q=["Edit this. Select text for formatting.","And edit this."],h=function(b){(b=b&&b.items&&0<b.items.length&&b.items[0])?
f(b,n):(b=l(a,q,n),k.google_drive.upload_file(v,"html",b,f))},v,t,n;"Ready"===g?(v=b.get_setting("program_name"),d?(t=k.UTILITIES.get_json_top_level(b),b.set_setting("program_name",v+" (published version)"),n=[k.UTILITIES.toontalk_json_div(t,b)],b.set_setting("program_name",v)):(b=b.get_backside_widgets(),n=[],b.forEach(function(a,b){a.visible()&&(t=k.UTILITIES.get_json_top_level(a),n.push(k.UTILITIES.toontalk_json_div(t,a.get_widget())),1<b&&(q[b]=q[1]))}),q.push(q[1])),k.google_drive.get_toontalk_files(k.google_drive.full_file_name(v,
"page"),"page",h)):(console.log("Unable to publish to Google Drive because: "+g),f(null))},republish:function(a){k.google_drive.insert_or_update_file(void 0,a.file_id,"page",l(a.title,a.editable_contents,a.widgets_json),function(){console.log("Published page '"+a.title+"' updated.")})}}}(window.TOONTALK);function handle_client_load(){window.TOONTALK.google_drive.handle_client_load()}
window.TOONTALK.google_drive=function(k){var l=k.GOOGLE_DRIVE_CLIENT_ID||"148386604750-704q35l4gcffpj2nn3p4ivcopl81nm27.apps.googleusercontent.com",a=k.ORIGIN_FOR_GOOGLE_DRIVE||"toontalk.github.io",b="Need to authorize",d,f;return{handle_client_load:function(d){0>window.location.href.indexOf(a)?(b="Connections to Google Drive are configured for the following domain only: "+a+".\nIf you are hosting ToonTalk elsewhere you need to set TOONTALK.GOOGLE_DRIVE_CLIENT_ID and TOONTALK.ORIGIN_FOR_GOOGLE_DRIVE",d&&
d(b)):setTimeout(function(){k.google_drive.check_authorization(d)})},check_authorization:function(a){b="Awaiting authorization";gapi.auth.authorize({client_id:l,scope:"https://www.googleapis.com/auth/drive",immediate:!0},function(b){k.google_drive.handle_authorization_result(b,a)})},handle_authorization_result:function(a,d){a&&!a.error?(b="Authorized but not yet ready",gapi.client.load("drive","v2",function(){k.google_drive.get_folder_ids(function(){b="Ready"})}),d&&d()):(b="Need to authorize",d&&
d(b))},authorize:function(a){gapi.auth.authorize({client_id:l,scope:"https://www.googleapis.com/auth/drive",immediate:!1},function(b){k.google_drive.handle_authorization_result(b,a)})},get_folder_ids:function(a){k.google_drive.get_folder_id(!0,function(b){d=b;k.google_drive.get_folder_id(!1,function(b){f=b;a()})})},get_folder_id:function(a,b){var h=a?"ToonTalk Programs":"ToonTalk Pages",l=function(d){var f=function(a){a&&a.id?b(a.id):console.error("Failure to create folder '"+h+"'. Response was "+
a)};(d=d&&d.items&&0<d.items.length&&d.items[0].id)?b(d):a?k.google_drive.create_folder("ToonTalk Programs",!1,f):k.google_drive.create_folder("ToonTalk Pages",!0,f)};a&&d?b(d):!a&&f?b(f):k.google_drive.fetch_folder_id(h,l)},get_status:function(){return b},connection_to_google_drive_possible:function(){return 0!==b.indexOf("Connections to Google Drive are configured for the following domain only: ")},list_files:function(a,b){gapi.client.request({path:"/drive/v2/files",method:"GET",params:a}).execute(b)},
fetch_folder_id:function(a,b){k.google_drive.list_files({q:"mimeType = 'application/vnd.google-apps.folder' and title ='"+a+"' and trashed = false"},b)},get_toontalk_files:function(a,b,d){"undefined"===typeof gapi?d("Google Drive API not available."):(b="properties has {key='ToonTalkType' and value='"+b+"' and visibility='PUBLIC'} and trashed = false",a&&(b+=" and title='"+a+"'"),k.google_drive.list_files({q:b},d))},get_toontalk_program_file:function(a,b){k.google_drive.list_files({q:"'"+d+"' in parents and trashed = false and title='"+
a+"'"},function(a){a&&a.items&&0<a.items.length?b(a.items[0]):b(null)})},upload_file:function(a,b,d,f){var l="json"===b?"program":"page",n=a+"."+b;k.google_drive.get_toontalk_files(n,l,function(a){gapi.client.load("drive","v2",function(){var b=a&&a.items&&0<a.items.length&&a.items[0].id;f||(f=function(a){a.error&&(console.log("Google drive status: "+k.google_drive.get_status()),"Login Required"!==a.error.message&&console.log(a.error.message));console.log("File "+a.title+" ("+a.id+") "+(b?"updated":
"created"))});b?k.google_drive.insert_or_update_file(void 0,b,l,d,f):k.google_drive.insert_or_update_file(n,void 0,l,d,f)})})},full_file_name:function(a,b){return a+"."+("program"===b?"json":"html")},insert_or_update_file:function(a,b,h,l,t){var n={title:a,mimeType:"text/html"};n.parents=[{kind:"drive#fileLink",id:"program"===h?d:f}];l="\r\n---------314159265358979323846\r\nContent-Type: application/json\r\n\r\n"+JSON.stringify(n)+"\r\n---------314159265358979323846\r\nContent-Type: text/html\r\n\r\n"+
l+"\r\n---------314159265358979323846--";a?(a="/upload/drive/v2/files",n="POST"):(a="/upload/drive/v2/files/"+b,n="PUT");gapi.client.request({path:a,method:n,params:{uploadType:"multipart"},headers:{"Content-Type":'multipart/mixed; boundary="-------314159265358979323846"'},body:l}).execute(function(a){b||k.google_drive.insert_property(a.id,"ToonTalkType",h,"PUBLIC");t&&t(a)})},create_folder:function(a,b,d){gapi.client.drive.files.insert({resource:{title:a,mimeType:"application/vnd.google-apps.folder"}}).execute(b?
function(a){gapi.client.drive.permissions.insert({fileId:a.id,resource:{value:"",type:"anyone",role:"reader"}}).execute(function(b){d(a)})}:d)},download_file:function(a,b){if(a.downloadUrl){var d=gapi.auth.getToken().access_token,f=new XMLHttpRequest;f.open("GET",a.downloadUrl);f.setRequestHeader("Authorization","Bearer "+d);f.onload=function(){b(f.responseText)};f.onerror=function(){b(null)};f.send()}else b(null)},google_drive_url:function(a){return"https://googledrive.com/host/"+a+"/"},insert_property:function(a,
b,d,f){gapi.client.drive.properties.insert({fileId:a,resource:{key:b,value:d,visibility:f}}).execute(function(a){})}}}(window.TOONTALK);function googleTranslateElementInit(){new google.translate.TranslateElement({pageLanguage:"en",layout:google.translate.TranslateElement.InlineLayout.SIMPLE},"google_translate_element")}
window.TOONTALK.UTILITIES=function(k){var l={},a,b=100,d=(new Date).getTime(),f,g=function(a){var b=a.indexOf("<div style='display:none;'>{"),b=0>b?a.indexOf("{"):b+27,c=a.lastIndexOf("}");if(!(0>b||0>c))return a.substring(b,c+1)},q=function(b,c){var d=$(c).closest(".toontalk-side"),f=l.get_mouse_or_first_touch_event_attribute("clientX",b),g=l.get_mouse_or_first_touch_event_attribute("clientY",b),h,k,n;$(".ui-tooltip").remove();$(".ui-tooltip").removeClass("toontalk-side-animating");b.dataTransfer&&
b.dataTransfer.getData("text")&&0<b.dataTransfer.getData("text").length||(a=d||$(c),k=l.widget_from_jquery(a),k||(k=l.widget_of_element(c),l.report_internal_error("Possible bug that "+a+" doesn't have a known owner."),a=$(c)),k.set_stopped&&k.set_stopped(!0),!k.save_dimensions||k.get_parent_of_frontside()&&!k.get_parent_of_frontside().get_widget().is_top_level()||k.save_dimensions(),k.being_dragged=!0,h=a.get(0).getBoundingClientRect(),n=a.is(".toontalk-top-level-resource"),k.get_json&&(d=l.get_json_top_level(k),
d.view.drag_x_offset=f-h.left,d.view.drag_y_offset=g-h.top,!d.view.frontside_width&&a.parent().is(".toontalk-backside")&&(d.view.frontside_width=a.width(),d.view.frontside_height=a.height()),a.is(".toontalk-backside")&&(d.view.backside=!0),a.data("json",d),b.dataTransfer&&(f=l.toontalk_json_div(d,k),b.dataTransfer.effectAllowed=n?"copy":"move",b.dataTransfer.setData("text",f),l.is_internet_explorer()||b.dataTransfer.setData("text/html",f)),k.drag_started(d,n)),a.addClass("toontalk-being-dragged"),
b.stopPropagation())},h=function(b){a||(a=$(b.target).closest(".toontalk-side"));l.widget_from_jquery(a).being_dragged=void 0;if(a.is(".toontalk-frontside"))if(a.parent().is(".toontalk-backside")){var c=a.data("json");c&&l.set_css(a,{width:c.view.frontside_width,height:c.view.frontside_height})}else a.parent().is(".toontalk-top-level-resource, .toontalk-drop-area, .toontalk-json")||a.is(".toontalk-carried-by-bird, .toontalk-element-attribute, .toontalk-function-bird-documentation-bird")||l.has_animating_image(a.get(0))||
l.set_css(a,{width:"100%",height:"100%"});K();b.stopPropagation()},v=function(b){if(a)return l.widget_from_jquery(a);b=l.data_transfer_json_object(b);return l.create_from_json(b)},t=function(b,d){var f=l.data_transfer_json_object(b),g,h,n,q,t,u,v,z,C,D;!f&&a&&(f=a.data("json"));a&&a.data("json","");g=a;K();if(g||f||b.dataTransfer.files||M(b)){if($(b.target).is(".toontalk-drop-area-instructions"))n=$(b.target).parent();else if($(b.target).is(".toontalk-element-attribute-input")){if(n=$(b.target).closest(".toontalk-side"),
q=l.widget_from_jquery(n)){h=g?l.widget_from_jquery(g):l.create_from_json(f);l.restore_resource(g,h);q.dropped_on_style_attribute(h,b.target.name,b);b.stopPropagation();return}}else if($(b.target).is(".toontalk-drop-area"))n=$(b.target);else{if(f&&$(b.currentTarget).is(".froala-element")){v=f;n=l.create_from_json(v);q=document.createElement("div");v=v.view.backside?n.get_backside_element(!0):n.get_frontside_element(!0);f=$(d).closest(".toontalk-edit");g=k.published_support.create_editable_text();
h=b.target;$(q).addClass("toontalk-json toontalk-top-level-resource toontalk-top-level-resource-container");$(v).addClass("toontalk-top-level-resource").css({position:"relative"});v.toontalk_widget=n;q.toontalk_widget=n;q.appendChild(v);for($(q).insertAfter(f);h.nextSibling;)$(g).children(".froala-element").get(0).appendChild(h.nextSibling);$(g).insertAfter(q);n.update_display();return}n=$(b.target).closest(".toontalk-side")}if(0!==n.length&&!n.is(".toontalk-top-level-resource")){v=n.offset();l.remove_highlight();
q=l.widget_from_jquery(n);if(g&&0<g.length&&!(q&&q.get_infinite_stack&&q.get_infinite_stack())&&(g.get(0)===n.get(0)||jQuery.contains(g.get(0),n.get(0)))){if(g.is(".toontalk-top-level-backside"))return;n.hide();h=l.get_mouse_or_first_touch_event_attribute("pageX",b);t=l.get_mouse_or_first_touch_event_attribute("pageY",b);h=document.elementFromPoint(h-window.pageXOffset,t-window.pageYOffset);n.show();h&&(n=$(h).closest(".toontalk-side"),v=n.offset(),q=l.widget_from_jquery(n))}f&&f.view&&f.view.drag_x_offset?
(t=f.view.drag_x_offset,u=f.view.drag_y_offset):u=t=0;if(g&&0<g.length){if(!(q&&q.get_infinite_stack&&q.get_infinite_stack()||g.get(0)!==n.get(0)&&!jQuery.contains(g.get(0),n.get(0)))){l.set_css(g,{left:g.get(0).offsetLeft+(b.layerX-t),top:g.get(0).offsetTop+(b.layerY-u)});b.stopPropagation();return}z=g.is(".toontalk-backside");h=l.widget_from_jquery(g);g.parent().is(".toontalk-drop-area")?(g.removeClass("toontalk-widget-in-drop_area"),g.parent().data("drop_area_owner").set_next_robot(void 0)):(C=
g.parents(".toontalk-side:first"),(D=l.widget_from_jquery(C))?!z&&h.get_infinite_stack&&h.get_infinite_stack()?(C=h.saved_width,D=h.saved_height,h=h.copy(),h.saved_width=C,h.saved_height=D,C=g.width(),D=g.height(),g=$(h.get_frontside_element(!0)),n.is(".toontalk-backside")&&l.set_css(g,{width:f.view.frontside_width||C,height:f.view.frontside_height||D})):D.removed_from_container&&(C.is(".toontalk-backside")?D.remove_backside_widget(h,z,!0):(D.removed_from_container(h,z,b,void 0,!0),h.restore_dimensions&&
!D.is_empty_hole()&&h.restore_dimensions())):l.restore_resource(g,h),h.robot_in_training()&&h.robot_in_training().add_newly_created_widget_if_new(h))}else{if(0<b.dataTransfer.files.length){for(f=0;f<b.dataTransfer.files.length;f++)r(b.dataTransfer.files[f],n,q,v,b);b.stopPropagation();return}if(M(b)){y(b.dataTransfer.getData("URL"),n,q,v,b);b.stopPropagation();return}h=l.create_from_json(f,{event:b});if(!h){f?l.report_internal_error("Unable to construct a ToonTalk widget from the JSON."):k.debugging&&
console.log("No data transfer in drop.");b.stopPropagation();return}h.robot_in_training()&&h.robot_in_training().drop_from_data_transfer(h);(z=f.view.backside)?(g=$(h.get_backside_element()),l.set_css(g,{width:f.view.backside_width,height:f.view.backside_height,"background-color":f.view.background_color,"border-width":f.view.border_width}),h.apply_backside_geometry()):g=$(h.get_frontside_element())}h!==q&&c(n,g,h,q,v,b,f,t,u,z)}}else b.dataTransfer?l.report_internal_error("Drop failed since unable to parse as JSON."):
l.report_internal_error("Drop failed since there is no event.dataTransfer"),b.stopPropagation()},n=function(a,b){a.addEventListener("drop",function(a){var c=v(a);l.restore_resource(l.get_dragee(),c);b(a)})},u=function(a,b){var c;c=$(b).closest(".toontalk-side");var d=l.get_dragee();c=!c.is("*")||c.is(".toontalk-top-level-backside")||c.closest(".toontalk-top-level-resource").is("*")||c.is(".toontalk-being-dragged")||d&&D(c.get(0),d.get(0))?void 0:c;if(c)return l.highlight_element(c.get(0),a),c.get(0)},
c=function(a,b,c,d,f,g,h,n,q,r){var t=l.get_mouse_or_first_touch_event_attribute("pageX",g),u=l.get_mouse_or_first_touch_event_attribute("pageY",g),v,y,z,C,D,F;c.set_visible(!0);if(a.is(".toontalk-backside")){if(c.is_top_level()){v=h.semantic.backside_widgets;y=h.shared_widgets;z=a.get(0);(g=d.robot_in_training())&&g.drop_from_data_transfer(c,d);g=c.get_backside_widgets().slice();g.forEach(function(a,b){var f=a.get_widget(),m,g,h,k,n,q,A;c.remove_backside_widget(f,a.is_backside());m=0<=v[b].widget.shared_widget_index?
y[v[b].widget.shared_widget_index].view:v[b].widget.view;a.is_backside()?(g=f.get_backside_element(!0),h=m.backside_left,k=m.backside_top,n=m.backside_width,q=m.backside_height):(g=f.get_frontside_element(!0),h=m.frontside_left,k=m.frontside_top,n=m.frontside_width,q=m.frontside_height);d.add_backside_widget(f,a.is_backside());z.appendChild(g);A=$(g).position();F={left:A.left+h,top:A.top+k,width:n,height:q};l.constrain_css_to_fit_inside(z,F);l.set_css(g,F);a.is_backside()&&(f.backside_geometry=m.backside_geometry,
f.apply_backside_geometry())}.bind(this));return}c?d.get_backside().widget_dropped_on_me(c,r,g):l.report_internal_error("No source_widget");"undefined"===typeof n&&c.is_element()&&(q=n=0,setTimeout(function(){var a=c.get_HTML(),d=b.width(),f=b.height();0<=a.indexOf("data:image")?(a=Math.min(80,d)/2,d=90,90>f&&(d-=(90-f)/2)):(a=Math.min(60,d/2),d=Math.min(30,f/2));l.set_css(b,{left:C-a,top:D-d})},50));C=t-(f.left+(n||0));D=u-(f.top+(q||0));l.set_css(b,{left:k.UTILITIES.left_as_percent(C,b.get(0)),
top:k.UTILITIES.top_as_percent(D,b.get(0))});h&&h.semantic.running&&!l.get_dragee()&&c.set_running(!0)}else if(a.is(".toontalk-drop-area"))b.addClass("toontalk-widget-in-drop_area"),a.append(b.get(0)),b.is(".toontalk-robot")&&a.data("drop_area_owner").set_next_robot(l.widget_from_jquery(b));else{if(b.is(".toontalk-backside-of-top-level"))return;if(d||g.changedTouches){z=a.closest(".toontalk-top-level-backside").get(0);!z&&g.changedTouches&&(f=document.elementFromPoint(t-window.pageXOffset,u-window.pageYOffset),
(z=$(f).is(".toontalk-top-level-backside")?f:$(f).closest(".toontalk-top-level-backside").get(0))||(z=$(".toontalk-top-level-backside").get(0)),d=l.widget_of_element(z).get_backside());if(!z)return;z.appendChild(b.get(0));f=$(z).offset();l.set_css(b,{left:t-(f.left+n),top:u-(f.top+q)});c.drop_on&&c.drop_on(d,r,g)||d.widget_dropped_on_me&&d.widget_dropped_on_me(c,r,g)||(a=a.closest(".toontalk-top-level-backside"),0<a.length&&(d=l.widget_from_jquery(a))&&d.get_backside().widget_dropped_on_me(c,r,g))}else{l.report_internal_error("target widget missing");
return}}l.remove_highlight()},r=function(a,b,d,f,h){var n=new FileReader,q=0===a.type.indexOf("image"),r=0===a.type.indexOf("audio"),t=0===a.type.indexOf("video"),u,v,y;n.onloadend=function(){if(q)u=k.element.create("<img src='"+n.result+"' alt='"+a.name+"'/>");else if(r)u=k.element.create(a.name+" sound"),u.set_sound_effect(new Audio(n.result));else if(t)u=k.element.create("<video src='"+n.result+"' alt='"+a.name+"'/>");else{if(v=g(n.result))try{y=JSON.parse(v),u=l.create_from_json(y)}catch(z){}u||
(u=k.element.create(n.result))}u&&u.robot_in_training()&&u.robot_in_training().drop_from_data_transfer(u,d);c(b,$(u.get_frontside_element(!0)),u,d,f,h,y)};q||r||t?n.readAsDataURL(a):n.readAsText(a)},y=function(a,b,d,f,g){var h=function(a,b,d,f,m){var g=function(a){a&&(a&&a.robot_in_training()&&a.robot_in_training().drop_from_data_transfer(a,d),c(b,$(a.get_frontside_element(!0)),a,d,f,m))};l.create_widget_from_URL(a,g,function(a){(a=m.dataTransfer.getData("text/html")||m.dataTransfer.getData("text"))?
g(k.element.create(a)):(l.display_message("Error: "+e+". When trying to fetch "+url),console.log(e))})};a.split(/\r?\n/).forEach(function(a){"#"!==a[0]&&h(a,b,d,f,g)})},z=function(a,b){var c=$("<div class='"+a+"'>");l.run_when_dimensions_known(c.get(0),function(){var a=c.width(),d=c.height();b.get_default_width=function(){return a};b.get_default_height=function(){return d}})},F=function(a){var b=l.get_path_to_toontalk_folder()+"sounds/",c=function(c){c=new Audio(b+c);c.volume=a;return c};k.sounds=
{hatching:c("SPARROW.WAV"),bird_fly:c("PIGEON.WAV"),bammer_hammer:c("POP.WAV"),vacuum_spit:c("SPIT.WAV"),vacuum_suck:c("DUSTBUST.WAV"),drop:c("BOOK_DROP.WAV"),magic:c("MAGIC.WAV"),fall_inside:c("FALL_INSIDE.WAV"),click:c("TYPE.WAV"),event_ignored:c("PLOP.WAV")};k.sounds.bird_fly.loop=!0},H=function(a){var b=document.createElement("script");b.src=a;document.body.appendChild(b)},K=function(){a&&(a.removeClass("toontalk-being-dragged"),l.set_timeout(function(){a=void 0}))},D=function(a,b){if(a===b)return!0;
if(a.parentNode)return D(a.parentNode,b)},J=function(a,b){var c=0,d=encodeURIComponent("<span class='notranslate'>decodeURIComponent"),f=encodeURIComponent("decodeURIComponent</span>"),g=a.indexOf(d),h="",k,n;if(0>g)return a;for(;0<=g;){k=g+d.length;n=a.indexOf(f,k);if(0>n)return l.report_internal_error("Expected title to have matching pairs of "+d+" and "+f),a;h+=a.substring(c,g)+b(a.substring(k,n));c=n+f.length;g=a.indexOf(d,c)}return h+=a.substring(c)},M=function(a){return(a=a.dataTransfer&&a.dataTransfer.getData("URL"))&&
0<a.length&&0>a.indexOf("data:")},C=[],L=[],I,S;window.addEventListener("message",function(a){"zero-timeout-message"===a.data&&a.source===window?(a.stopPropagation(),0<C.length&&C.shift()()):a.data.editable_contents&&k.publish.republish(a.data)},!1);$(document).ready(function(){var a;k.debugging=l.get_current_url_parameter("debugging");k.logging=l.get_current_url_parameter("log");a=l.get_current_url_numeric_parameter("volume",10);0<a&&F(a/100);l.process_json_elements();$(document).click(function(a){$(".toontalk-top-level-resource-container").each(function(a,
b){var c=b.toontalk_widget;c&&c.set_running&&c.set_running(!1)})});k.DEFAULT_QUEUE=window.TOONTALK.queue.create();k.DEFAULT_QUEUE.run();window.addEventListener("beforeunload",function(a){try{l.backup_all_top_level_widgets(!0)}catch(b){console.log(b)}});k.TRANSLATION_ENABLED=l.get_current_url_boolean_parameter("translate",!1);k.TRANSLATION_ENABLED?($("a").each(function(a,b){b.href=l.add_URL_parameter(b.href,"translate","1")}),$("#google_translate_element").is("*")||(a=document.createElement("div"),
a.id="google_translate_element",document.body.insertBefore(a,document.body.firstChild)),document.head.appendChild($('<meta name="google-translate-customization" content="7e20c0dc38d147d6-a2c819007bfac9d1-gc84ee27cc12fd5d1-1b"></meta>')[0]),H("https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit")):$("#google_translate_element").remove();k.vacuum.the_vacuum||k.vacuum.create();l.add_test_all_button();z("toontalk-robot",k.robot);z("toontalk-empty-nest",k.nest);z("toontalk-bird-static",
k.bird)});l.available_types="number box element robot nest sensor top-level".split(" ");l.create_from_json=function(a,b,c){var d=function(a,b,c){(b.shared_widgets[c]=a)&&a.finish_create_from_json_continuation&&(a.finish_create_from_json_continuation(),a.finish_create_from_json_continuation=void 0);return a},f,g,h,n;if(a){b||(b={});b.guid_to_nest_table||(b.guid_to_nest_table={});a.shared_widgets&&(b.json_of_shared_widgets=a.shared_widgets,b.shared_widgets=[]);a.shared_html&&(b.shared_html=a.shared_html);
if(a.widget)return(f=l.create_from_json(a.widget,b))&&a.is_backside?f.get_backside(!0):f;if(b&&b.shared_widgets&&0<=a.shared_widget_index){if(c=b.shared_widgets[a.shared_widget_index])return c;c=b.json_of_shared_widgets[a.shared_widget_index];f=l.create_from_json(c,b,!0);return d(f,b,a.shared_widget_index)}(h=a.semantic)||(h=a);a=a.view;if(0<=h.shared_widget_index){if(!b.json_of_shared_widgets){l.report_internal_error("JSON refers to shared widgets but they can't be found. Sorry.");return}f=l.create_from_json(b.json_of_shared_widgets[h.shared_widget_index],
b,!0);return d(f,b,h.shared_widget_index)}if(k.creators_from_json[h.type]){b||(b={});a?b.json_view=a:a=b.json_view;try{f=k.creators_from_json[h.type](h,b)}catch(q){console.error(q.stack),l.report_internal_error("Unable to recreate a "+h.type+". Error is "+q)}if(f&&f.get_backside){h.erased&&(k.widget.erasable(f),f.set_erased(h.erased));h.infinite_stack&&f.set_infinite_stack(h.infinite_stack);if(a&&a.frontside_width&&(g=a.backside?f.get_backside(!0).get_element():f.get_frontside_element(),f.ok_to_set_dimensions()))if(n=
{width:a.frontside_width,height:a.frontside_height},"element"===h.type)f.on_update_display(function(){l.set_css(g,n)});else l.set_css(g,n);a&&a.saved_width&&(f.saved_width=a.saved_width,f.saved_height=a.saved_height);a&&a.backside_geometry&&(f.backside_geometry=a.backside_geometry);h.backside_widgets&&(c?f.finish_create_from_json_continuation=function(){this.add_backside_widgets_from_json(f,h.backside_widgets,b)}.bind(this):this.add_backside_widgets_from_json(f,h.backside_widgets,b))}return f}l.report_internal_error("JSON type '"+
h.type+"' not supported. Perhaps a JavaScript file implementing it is missing.")}};l.add_backside_widgets_from_json=function(a,b,c){var d;b&&(a.is_top_level()||(c.to_be_on_backside_of?c.to_be_on_backside_of.push(a):c.to_be_on_backside_of=[a]),d=this.create_array_from_json(b,c),a.set_backside_widget_sides(d,b.map(function(a){return a?0<=a.widget.shared_widget_index?c.json_of_shared_widgets[a.widget.shared_widget_index].view:a.widget.view:a})),a.is_top_level()||c.to_be_on_backside_of.pop())};l.create_array_from_json=
function(a,b){var c=[];a.forEach(function(a,d){c[d]=a?l.create_from_json(a,b):a});return c};l.get_json_of_array=function(a,b){var c=[];a.forEach(function(a,d){if(a)try{a.is_backside&&a.is_backside()?c[d]={widget:l.get_json(a.get_widget(),b),is_backside:!0}:c[d]=a.get_type_name?{widget:l.get_json(a,b)}:a.get_json(b)}catch(f){l.report_internal_error("Error trying to save "+a)}});return c};l.fresh_json_history=function(){return{widgets_encountered:[],shared_widgets:[],json_of_widgets_encountered:[]}};
l.get_json_top_level=function(a){var b=this.fresh_json_history(),c=l.get_json(a,b);0<b.shared_widgets.length&&(c.shared_widgets=b.shared_widgets.map(function(d,f){var g=function(a){a=b.widgets_encountered.indexOf(a);return b.json_of_widgets_encountered[a]},h=function(a){return g(b.shared_widgets[a])},k=g(d);a===d?(k={semantic:k.semantic,view:k.view,version:k.version},c.semantic={shared_widget_index:f}):l.tree_replace_once(c.semantic,k,{shared_widget_index:f},h,l.generate_unique_id());return k}));
c.shared_html=b.shared_html;return c};l.get_json=function(a,b){var c,d,f;k.debugging&&!b&&l.report_internal_error("no json_history");c=b.shared_widgets.indexOf(a);if(0<=c)return{shared_widget_index:c};c=b.widgets_encountered.indexOf(a);if(0<=c)return c=l.insert_ancestors_last(a,b.shared_widgets),{shared_widget_index:c};c=b.widgets_encountered.push(a)-1;f=a.is_backside();a=a.get_widget();d=a.get_json(b);d=a.add_to_json(d,b);d.view.backside=f;b.json_of_widgets_encountered[c]=d;a.add_backside_widgets_to_json&&
a.add_backside_widgets_to_json(d,b);return d};l.get_json_of_keys=function(a,b){var c;b||(b=[]);Object.keys(a).forEach(function(d){0>b.indexOf(d)&&(c||(c={}),c[d]=a[d].get_json?{json:a[d].get_json()}:a[d])});return c};l.create_keys_from_json=function(a,b){var c={};Object.keys(a).forEach(function(d){c[d]=a[d].json?l.create_from_json(a[d].json,b):a[d]});return c};l.tree_replace_once=function(a,b,c,d,f){if(a.id_of_tree_replace_once_task!==f){a.id_of_tree_replace_once_task=f;var g;Object.keys(a).forEach(function(h){if(g=
a[h]){if(g===b)return a[h]=c,!0;if("shared_widget_index"===h){if(this.tree_replace_once(d(g),b,c,d,f))return!0}else if(!(0<=["string","number","function","undefined","boolean"].indexOf(typeof g))&&this.tree_replace_once(g,b,c,d,f))return!0}}.bind(this));return!1}};l.insert_ancestors_last=function(a,b){var c=-1;b.some(function(b,d){if(a.has_ancestor(b))return c=d,!0});0>c&&(c=b.length);b.splice(c,0,a);return c};l.toontalk_json_div=function(a,b){var c=a.view.backside,d=b.get_backside_widgets(),f=b.get_type_name(),
g=b.toString({for_json_div:!0});"top-level"===f?c?(a.semantic.settings=void 0,f="a work area containing ",0===d.length?f="an empty work area":(f=1===d.length?f+"one thing: ":f+(d.length+" things: "),I=d.length,d.forEach(function(a){I--;f+=l.add_a_or_an(a.get_type_name());1===I?f+=", and ":1<I&&(f+=", ")}))):f="a top-level widget":(f=l.add_a_or_an(f),c&&(f="the back of "+f));g&&(c=g.indexOf("data:image/"),0<c&&(d=g.indexOf("alt=",c),0>d&&(d=g.indexOf(">",c)),g=g.substring(0,c+20)+" ... "+g.substring(d)));
return"<div class='toontalk-json'>\nThis will be replaced by "+f+".\n"+(g?g+"\n":"")+"<div style='display:none;'>"+JSON.stringify(a,l.clean_json,"  ")+"</div></div>"};l.elide=function(a,b,c){c=Math.round(b*c);if(a.length<=b)return a;c=Math.max(c,a.indexOf(" ",c));b=a.length-(b-c);b=Math.max(b,a.indexOf(" ",b)+1);return a.substring(0,c)+" ... "+a.substring(b,a.length)};l.clean_json=function(a,b){return"id_of_tree_replace_once_task"===a?void 0:b};l.create_widget_from_URL=function(a,b,c){var d=function(g){try{var h=
this.getResponseHeader("content-type"),l;if(!h)return;0===h.indexOf("audio")?(l=k.element.create(a),l.set_sound_effect(new Audio(a))):0===h.indexOf("image")?l=k.element.create("<img src='"+a+"'>"):0===h.indexOf("video")?l=k.element.create("<video src='"+a+" ' width='320' height='240'>"):0===h.indexOf("text")&&0>h.indexOf("text/html")?this.responseText&&(l=k.element.create(this.responseText),l.set_source_URL(a)):l=k.element.create("<div class='toontalk-iframe-container'><iframe src='"+a+"' width='480' height='320'></iframe></div>");
l&&b(l)}catch(n){c&&c(n),b()}f.removeEventListener("readystatechange",d)},f=new XMLHttpRequest;f.addEventListener("readystatechange",d);f.open("GET",a,!0);try{f.send()}catch(g){c?c(g):(l.display_message("Error trying to GET "+a+" "+g),console.error(g.stack))}};l.copy_widgets=function(a,b){var c=[],d;for(d=0;d<a.length;d++)c[d]=a[d]&&a[d].copy(b);return c};l.copy_widget_sides=function(a,b){var c=[];a.forEach(function(a){var d;a&&(d=a.get_widget().copy(b),a.is_backside()?c.push(d.get_backside(!0)):
c.push(d))});return c};l.copy_array=function(a){return a.slice()};l.generate_unique_id=function(){d+=1;return"toontalk_id_"+d};l.get_style_property=function(a,b){if(a.currentStyle)return a.currentStyle[b];if(window.getComputedStyle)return document.defaultView.getComputedStyle(a,null).getPropertyValue(b)};l.get_style_numeric_property=function(a,b){var c=this.get_style_property(a,b),d;return"string"===typeof c?(d=c.indexOf("px"),0<=d&&(c=c.substring(0,d)),parseInt(c,10)):c};l.data_transfer_json_object=
function(a){var b;if(a.dataTransfer&&!(0<a.dataTransfer.files.length||M(a))){try{b=a.dataTransfer.getData("text/html")}catch(c){b=a.dataTransfer.getData("text")}if(!b||b.match(/[\u3400-\u9FBF]/))b=a.dataTransfer.getData("text");if(b){a=g(b);if(!a)return l.get_json_top_level(k.element.create(b));try{return JSON.parse(a)}catch(d){l.report_internal_error("Exception parsing "+a+"\n"+d.toString())}}}};l.drag_and_drop=function(a){var b;l.draggable(a);l.can_receive_drops(a);$(a).is(".toontalk-backside-of-top-level")||
(b=$(a).is(".toontalk-top-level-resource")?0:500,l.enable_touch_events(a,b))};l.draggable=function(a){$(a).attr("draggable",!0);a.addEventListener("dragstart",function(b){q(b,a)});a.addEventListener("dragend",function(b){h(b,a)})};l.can_receive_drops=function(a){var b;a.addEventListener("dragover",function(a){a.preventDefault();return!1});a.addEventListener("drop",function(b){b.preventDefault();t(b,a);b.stopPropagation()});a.addEventListener("dragenter",function(c){var d=u(c,a);d&&b!==d&&l.remove_highlight(b);
b=d;c.stopPropagation()});a.addEventListener("dragleave",function(a){b&&!l.inside_rectangle(a.clientX,a.clientY,b.getBoundingClientRect())&&(l.remove_highlight(b),b=void 0);a.stopPropagation()})};l.create_drop_area=function(a){var b=document.createElement("div"),c=$(b),d=document.createElement("div");d.innerHTML=a;$(d).addClass("toontalk-drop-area-instructions ui-widget");c.addClass("toontalk-drop-area");c.append(d);l.can_receive_drops(b);return c};l.process_json_elements=function(){$(".toontalk-json").each(function(a,
b){var c=b.textContent,d,f,g,h;if(c)if(c=c.substring(c.indexOf("{"),c.lastIndexOf("}")+1),d=JSON.parse(c),f=l.create_from_json(d)){b.textContent="";if(f.get_type_name)if(f.is_top_level()){if(!k.no_local_storage&&!l.get_current_url_boolean_parameter("reset",!1)){if(d.load_most_recent_program)try{(h=window.localStorage.getItem("toontalk-last-key"))&&(g=window.localStorage.getItem(h))}catch(n){c="Error reading previous state. Error message is "+n,l.is_internet_explorer()?console.error(c):l.display_message(c)}g&&
(d=JSON.parse(g),f=l.create_from_json(d))}g=f.get_backside(!0);g=g.get_element();$(b).replaceWith(g);l.set_css(g,{width:d.view.backside_width,height:d.view.backside_height,"background-color":d.view.background_color,"border-width":d.view.border_width})}else $(b).addClass("toontalk-top-level-resource toontalk-top-level-resource-container"),g=f.get_frontside_element(),$(g).addClass("toontalk-top-level-resource").css({position:"relative"}),b.toontalk_widget=f,b.appendChild(g);else b.appendChild(f.get_element());
f.set_active&&f.set_active(!1);f.set_visible&&f.set_visible(!0);setTimeout(function(){f.update_display&&f.update_display();d.semantic.running&&f.set_running(!0)},1)}else l.report_internal_error("Could not recreate a widget from this JSON: "+c)})};l.set_absolute_position=function(a,b){for(var c=a.parent(),d=b.left,f=b.top,g;c.is("*")&&!c.is("html");)g=c.position(),d-=g.left,f-=g.top,c=c.parent();l.set_css(a,{left:d,top:f,position:"absolute"});a.is(".toontalk-side-animating")&&(a.get(0).style.left=
d+"px",a.get(0).style.top=f+"px")};l.set_position_relative_to_top_level_backside=function(a,b,c){var d=a.closest(".toontalk-top-level-backside"),f=d.offset(),g,h;f||(console.log("Unable to find top-level backside. Perhaps is 'visible' but not attached."),f={left:0,top:0});g=b.left-f.left;b=b.top-f.top;c&&(c=a.width(),f=a.height(),h=d.width(),d=d.height(),g>h-c&&(g=h-c),0>g&&(g=0),b>d-f&&(b=d-f),0>b&&(b=0));l.set_css(a,{left:g,top:b,position:"absolute"});a.is(".toontalk-side-animating")&&(a.get(0).style.left=
g+"px",a.get(0).style.top=b+"px",l.add_one_shot_event_handler(a.get(0),"transitionend",2E3,function(){a.removeClass("toontalk-side-animating");a.get(0).style.transitionDuration=""}))};l.restore_resource=function(a,b){var c,d;a&&a.is(".toontalk-top-level-resource")&&(c=b.copy({fresh_copy:!0}),d=c.get_frontside_element(),l.set_css(d,{width:a.width(),height:a.height()}),a.parent().removeClass("toontalk-top-level-resource toontalk-top-level-resource-container"),a.removeClass("toontalk-top-level-resource toontalk-top-level-resource-container"),
$(d).addClass("toontalk-top-level-resource toontalk-top-level-resource-container").css({position:"relative"}),a.css({position:"absolute"}),a.get(0).parentElement.appendChild(d),k.DISPLAY_UPDATES.pending_update(c),b.set_active&&(b.set_active(!0),c.set_active(!1)))};l.find_resource_equal_to_widget=function(a){var b;$(".toontalk-top-level-resource.toontalk-side").each(function(c,d){var f=l.widget_from_jquery($(d));if(f&&(a.equals&&a.equals(f)||a.matching_resource&&a.matching_resource(f)||"matched"===
a.match(f))&&(a.is_hole()||f.get_backside_widgets().length===a.get_backside_widgets().length))return b=d,!1});return b};l.set_position_is_absolute=function(a,b){var c,d;b?(a.parentElement.getBoundingClientRect(),c=l.get_style_numeric_property(a,"left"),d=l.get_style_numeric_property(a,"top"),l.set_css(a,{left:l.left_as_percent(c,a),top:l.top_as_percent(d,a),position:"absolute"})):a.style.position="static"};l.left_as_percent=function(a,b){var c;if(!b.parentElement)return a;c=b.parentElement.getBoundingClientRect();
return 100*($(b.parentElement).offset().left-window.scrollX+a-c.left)/c.width+"%"};l.top_as_percent=function(a,b){var c;if(!b.parentElement)return a;c=b.parentElement.getBoundingClientRect();return 100*($(b.parentElement).offset().top+-window.scrollY+a-c.top)/c.height+"%"};l.ordinal=function(a){a++;switch(a){case 1:return"first";case 2:return"second";case 3:return"third";case 4:return"fourth";case 5:return"fifth";case 6:return"sixth";case 7:return"seventh";case 8:return"eighth";case 9:return"ninth";
case 10:return"tenth";default:return 1===a%10?a+"st":2===a%10?a+"nd":3===a%10?a+"rd":a+"th"}};l.on_a_nest_in_a_box=function(a){return $(a).closest(".toontalk-nest").is("*")&&$(a).closest(".toontalk-box").is("*")};l.give_tooltip=function(a,b){a.title=b;l.use_custom_tooltip(a)};l.use_custom_tooltip=function(a){var b=$(a),c;b.tooltip({position:{my:"center bottom-20",at:"center top",using:function(a,d){var f;0>a.top&&(a.top=0,f=b.offset(),f.left<$(window).width()/2?a.left=f.left+b.width()+10:(a.left=
0,c=f.left-40));"bottom"===d.vertical?(b.is(".toontalk-robot")?a.top-=30:b.is(".toontalk-number")?a.top-=30:b.is(".toontalk-box")?a.top-=30:a.top-=20,10>a.left&&(a.left=10),10>a.top&&(a.top=10)):a.top+=20;a.left=Math.max(a.left,window.scrollX);a.top=Math.max(a.top,window.scrollY);l.set_css(this,a)}},open:function(a,b){var d=b.tooltip.get(0).textContent.length,f=b.tooltip.get(0),g;f.innerHTML=J(b.tooltip.get(0).textContent.replace(/(\r\n|\n|\r)/g,"<br>"),decodeURIComponent);100<d&&(g=Math.min(800,
c||$(window).width()-100),$(f).position(),b.tooltip.css({maxWidth:g}));S&&S.hide();S=b.tooltip;setTimeout(function(){b.tooltip.hide();S=void 0},d*(k.MAXIMUM_TOOLTIP_DURATION_PER_CHARACTER||100))},close:function(){S=void 0}})};l.encode_HTML_for_title=function(a){return encodeURIComponent("<span class='notranslate'>decodeURIComponent"+a+"decodeURIComponent</span>")};l.remove_encoded_HTML=function(a){return J(a,function(){return""})};l.add_one_shot_event_handler=function(a,b,c,d){var f=!1,g=function(c){f=
!0;d&&d();a.removeEventListener(b,g)};a.addEventListener(b,g);setTimeout(function(){f||g()},c)};l.default_animation_speed=.5;l.animate_to_absolute_position=function(a,b,c,d,f,g){var h=$(a).offset(),k=$(a).position(),n=l.distance(b,h);0===g?(l.set_absolute_position($(a),b),c&&c()):($(a).css({"z-index":l.next_z_index()}),g||(g=Math.round(n/(d||l.default_animation_speed))),$(a).addClass("toontalk-side-animating"),a.style.transitionDuration=g+"ms",n=k.left+(b.left-h.left),h=k.top+(b.top-h.top),a.style.left=
n+"px",a.style.top=h+"px",a.toontalk_followed_by&&(b.left+=a.toontalk_followed_by.left_offset,b.top+=a.toontalk_followed_by.top_offset,l.animate_to_absolute_position(a.toontalk_followed_by.element,b,void 0,d,f)),f?setTimeout(c,g):setTimeout(function(){$(a).removeClass("toontalk-side-animating");a.style.transitionDuration="";c&&c()},g))};l.distance=function(a,b){var c=a.left-b.left,d=a.top-b.top;return Math.sqrt(c*c+d*d)};l.highlight_element=function(a,b,c){var d;if(a){l.remove_highlight();if(!$(a).is(".toontalk-backside")&&
(d=l.widget_of_element(a),!d||d.element_to_highlight&&b&&(a=d.element_to_highlight(b),!a)))return;$(a).is(".toontalk-highlight")||($(a).addClass("toontalk-highlight").css({"z-index":l.next_z_index()}),c&&setTimeout(function(){l.remove_highlight()},c))}};l.remove_highlight=function(a){a?$(a).removeClass("toontalk-highlight"):$(".toontalk-highlight").removeClass("toontalk-highlight")};l.cursor_of_image=function(a){var b=a.lastIndexOf(".");return 0<=b?a.substring(0,b)+".32x32"+a.substring(b):a};l.inside_rectangle=
function(a,b,c){return a>=c.left&&a<=c.right&&b>=c.top&&b<=c.bottom};l.constrain_css_to_fit_inside=function(a,b){var c=$(a).width();if(0!==c){var d=$(a).height();b.left=Math.min(Math.max(b.left,0),c);b.top=Math.min(Math.max(b.top,0),d)}};l.next_z_index=function(){b++;return b};l.create_button=function(a,b,c,d){a=$("<button>"+a+"</button>").button();a.addClass(b).click(d);l.give_tooltip(a.get(0),c);return a.get(0)};l.create_close_button=function(a,b){var c=document.createElement("div"),d=document.createElement("div");
$(c).addClass("toontalk-close-button");$(c).click(a);l.give_tooltip(c,b);d.innerHTML="&times;";c.appendChild(d);return c};l.check_radio_button=function(a){$(a.button).prop("checked",!0);$(a.label).addClass("ui-state-active")};l.create_button_set=function(){var a=document.createElement("div"),b,c;for(b=0;b<arguments.length;b++)if(0<=arguments[b].length)for(c=0;c<arguments[b].length;c++)a.appendChild(arguments[b][c]);else a.appendChild(arguments[b]);$(a).buttonset();return a};l.create_alert_element=
function(a){a=l.create_text_element(a);$(a).addClass("toontalk-alert-element");return a};l.create_text_element=function(a){var b=document.createElement("div");b.innerHTML=a;$(b).addClass("ui-widget");return b};l.create_space=function(){var a=document.createElement("span");a.innerHTML="&nbsp;";$(a).addClass("ui-widget");return a};l.create_anchor_element=function(a,b){var c=document.createElement("a");c.innerHTML=a;k.TRANSLATION_ENABLED&&(b=l.add_URL_parameter(b,"translate","1"));c.href=b;c.target=
"_blank";return c};l.create_text_input=function(a,b,c,d,f,g,h){var k=document.createElement("input"),q;k.type="text";k.className=b;k.value=a;l.give_tooltip(k,d);g&&(k.type=g);c?(a=document.createElement("label"),a.innerHTML=c,k.id=l.generate_unique_id(),a.htmlFor=k.id,f&&(q=l.create_anchor_element("i",f),$(q).addClass("toontalk-help-button notranslate"),q.translate=!1),c=l.create_horizontal_table(a,k,q),$(a).addClass("ui-widget")):c=k;$(k).button().addClass("toontalk-text-input").css({"background-color":"white"});
k.addEventListener("touchstart",function(){$(k).select()});h&&n(k,h);l.use_custom_tooltip(k);return{container:c,button:k}};l.create_text_area=function(a,b,c,d,f,g){var h=document.createElement("textarea");h.className=b;h.value=a;l.give_tooltip(h,d);a=document.createElement("label");a.innerHTML=c;h.id=l.generate_unique_id();a.htmlFor=h.id;c=l.create_horizontal_table(a,h);$(h).button().addClass("toontalk-text-area").css({background:"white"});h.addEventListener("touchstart",function(){$(h).select()});
f&&n(h,f);$(a).addClass("ui-widget");l.use_custom_tooltip(h);return{container:c,button:h}};l.input_area_drop_handler=function(a,b,c){var d,f;a.preventDefault();(d=v(a))&&d!==c&&(f=b(d,a))&&($(a.currentTarget).trigger("change"),a.currentTarget.value=f,d.remove(),a.stopPropagation());return"string"===typeof f&&d};l.create_radio_button=function(a,b,c,d,f){var g=document.createElement("div"),h=document.createElement("input"),k=document.createElement("label");h.type="radio";h.className=c;h.name=a;h.value=
b;k.innerHTML=d;h.id=l.generate_unique_id();k.htmlFor=h.id;g.appendChild(h);g.appendChild(k);l.give_tooltip(g,f);$(h).button();l.use_custom_tooltip(h);return{container:g,button:h,label:k}};l.create_select_menu=function(a,b,c,d,f,g){var h=document.createElement("div"),k=document.createElement("select"),n=document.createElement("label");k.className=c;k.name=a;k.id=l.generate_unique_id();n.innerHTML=d;n.htmlFor=k.id;h.appendChild(n);h.appendChild(k);l.give_tooltip(h,f);b.forEach(function(a,b){var c=
document.createElement("option");c.value=a;c.innerHTML=a;g&&g[b]&&(l.give_tooltip(c,g[b]),l.use_custom_tooltip(c));k.appendChild(c)});$(k).addClass("ui-widget");$(n).addClass("ui-widget");l.use_custom_tooltip(k);return{container:h,menu:k,label:n}};l.create_check_box=function(a,b,c,d){var f=document.createElement("div"),g=document.createElement("input"),h=document.createElement("label");g.type="checkbox";g.className=b;g.checked=a;h.innerHTML=c;g.id=l.generate_unique_id();h.htmlFor=g.id;$(h).addClass("ui-widget");
f.appendChild(g);f.appendChild(h);l.give_tooltip(f,d);l.use_custom_tooltip(g);return{container:f,button:g,label:h}};l.create_horizontal_table=function(){var a=document.createElement("table"),b,c,d;c=document.createElement("tr");a.appendChild(c);for(b=0;b<arguments.length;b++)arguments[b]&&(d=document.createElement("td"),c.appendChild(d),d.appendChild(arguments[b]));return a};l.create_vertical_table=function(){var a=document.createElement("table"),b,c;for(b=0;b<arguments.length;b++)arguments[b]&&(c=
l.create_row(arguments[b]),a.appendChild(c));return a};l.create_row=function(){var a=document.createElement("tr"),b=document.createElement("td"),c;for(c=0;c<arguments.length;c++)a.appendChild(arguments[c]);b.appendChild(a);return a};l.create_table_entry=function(a){var b=document.createElement("td");b.appendChild(a);return b};l.selected_radio_button=function(){var a;for(a=0;a<arguments.length;a++)if(arguments[a].checked)return arguments[a]};l.create_image=function(a,b){var c=document.createElement("img"),
d;c.src=a;b&&$(c).addClass(b);0===a.indexOf("images/")&&(d=function(b){c.removeEventListener("error",d);c.src="http://toontalk.github.io/ToonTalk/"+a},c.addEventListener("error",d));return c};l.create_tabs=function(a,b){var c=document.createElement("div"),d=document.createElement("ul"),f;if(a.length!==b.length)return console.error("UTILITIES.create_tabs called with different length lists."),c;a.forEach(function(a,c){var g=document.createElement("li"),h=document.createElement("a"),k;"string"===typeof a?
(k=document.createElement("span"),k.innerHTML=a):k=a;f="tab-"+c;h.href="#"+f;h.appendChild(k);g.appendChild(h);d.appendChild(g);b[c].id=f});c.appendChild(d);b.forEach(function(a){c.appendChild(a)});$(c).tabs();return c};l.create_file_data_table=function(a){var b=$('<table cellpadding="0" cellspacing="0" border="0"></table>');a&&b.addClass(a);return b.get(0)};l.become_file_data_table=function(a,b,c,d){$(a).DataTable({data:b,autoWidth:!1,order:[[1,"desc"]],columns:[{data:"title",title:"Name",render:function(a,
b,f,g){a=c?a.substring(0,a.length-5):a;b=c?k.google_drive.google_drive_url(f.id):"Click to load this program.";if(d)return"<div class='"+d+"' title='"+b+"'id='"+f.id+"'>"+a+"</div>";k.TRANSLATION_ENABLED&&(b=l.add_URL_parameter(b,"translate","1"));return"<a href='"+b+"'target='_blank' title='Click to open published page.'>"+a+"</a>"}},{data:"modifiedDate",title:"Modified",render:function(a,b,c,d){return(new Date(a)).toUTCString()}},{data:"createdDate",title:"Created",render:function(a,b,c,d){return(new Date(a)).toUTCString()}},
{data:"fileSize",title:"Size"}]});$(a).addClass("toontalk-file-table")};l.get_local_files_data=function(){return l.get_all_locally_stored_program_names().map(function(a){var b=l.get_local_storage_meta_data(a);if(b)return{title:a,modifiedDate:b.last_modified,createdDate:b.created,fileSize:b.file_size}})};l.create_local_files_table=function(){var a=l.get_local_files_data(),b=l.create_file_data_table();setTimeout(function(){l.become_file_data_table(b,a,!1,"toontalk-file-load-button toontalk-file-load-button-without-click-handler")});
return b};l.get_dragee=function(){return a};l.add_URL_parameter=function(a,b,c){a=l.remove_URL_parameter(a,b);var d;d=0<=a.indexOf("?")?"&":"?";return a+d+b+"="+c};l.remove_URL_parameter=function(a,b){var c=a.indexOf("&"+b+"="),d;0>c&&(c=a.indexOf("?"+b+"="));if(0>c)return a;d=a.indexOf("&",c+1);0>d&&(d=a.length);a=a.substring(0,c)+a.substring(d);"?"===a[a.length-1]&&(a=substring(0,a.length-1));return a};l.add_a_or_an=function(a,b){var c=a.charAt(0);if("'"===c||'"'===c)c=a.charAt(1);return 0===a.indexOf("the ")||
0===a.indexOf("a ")||0===a.indexOf("an ")||0===a.indexOf("any ")||0===a.indexOf('"the ')||0===a.indexOf('"a ')||0===a.indexOf('"an ')||0===a.indexOf('"any ')?a:0>"aeiou".indexOf(c)?b?"A "+a:"a "+a:b?"An "+a:"an "+a};l.lower_case_first_letter=function(a){return a.charAt(0).toLowerCase()+a.slice(1)};l.maximum_string_length=function(a,b){var c;if(a.length<=b)return a;c=a.substring(0,Math.round(.75*b));return c+" ... "+a.substring(a.length-(b-c.length))};l.backup_all_top_level_widgets=function(a){$(".toontalk-top-level-backside").each(function(b,
c){l.widget_of_element(c).save(a)})};l.make_resizable=function(a,b){var c,d;a.resizable({start:function(a,b){c=b.originalSize.width;d=b.originalSize.height},resize:function(f,g){a.is(".toontalk-element-frontside")&&(g.size.width!=c&&(b.increment_width(g.size.width-c),c=g.size.width),g.size.height!=d&&(b.increment_height(g.size.height-d),d=g.size.height));b.rerender()},stop:function(a,f){b.robot_in_training&&b.robot_in_training()&&b.robot_in_training().resized_widget(b,c,d,f.size.width,f.size.height)},
handles:"n,e,s,w"})};l.match=function(a,b){var c=a.match(b);return c.is_widget&&b.matched_by?b.matched_by(a):c};l.current_URL=function(){return window.location.pathname};l.absolute_file_path=function(a){var b=window.location.pathname,c=b.lastIndexOf("ToonTalk/");return 0>c?a:b.substring(0,c+9)+a};l.copy_side=function(a,b,c){b=a.get_widget().copy(b);c&&l.copy_frontside_dimensions(a.get_widget(),b);return a.is_backside()?b.get_backside():b};l.copy_frontside_dimensions=function(a,b){var c=a.get_widget().get_frontside_element(),
d;c&&(d=b.get_frontside_element(!0))&&l.set_css(d,{width:$(c).width(),height:$(c).height()})};l.scale_to_fit=function(a,b,c,d){return $(b).is(".toontalk-backside")?l.scale_element(a,c,d,c,d):l.scale_element(a,$(b).width(),$(b).height(),c,d)};l.scale_element=function(a,b,c,d,f,g,h,k){var n,q;d||(d=$(a).width());f||(f=$(a).height());n=b?b/d:1;q=c?c/f:1;0===n&&(n=1);0===q&&(q=1);var r=!0;k=(k=k&&k!==document.body?k:a.parentElement)&&0>k.className.indexOf("toontalk-box-hole")&&0>a.className.indexOf("toontalk-scale");
var t="";h||(h={});"number"===typeof h.left&&(h.left-=(d-b)/2,r=!1);"number"===typeof h.left&&(h.top-=(f-c)/2,r=!1);r&&k&&(b&&(t+="translateX("+(b-d)/2+"px) "),c&&(t+="translateY("+(c-f)/2+"px) "));l.add_transform_to_css((g||"")+" scale("+n+", "+q+")",t,h,k);h.width=d;h.height=f;l.set_css(a,h);return{x_scale:n,y_scale:q}};l.add_transform_to_css=function(a,b,c,d){a&&(c||(c={}),c["transform-origin"]||(c["transform-origin"]=d?"center center":"left top"),l.set_css_transform(c,b+a))};l.set_css_transform=
function(a,b){a["-webkit-transform"]=b;a["-moz-transform"]=b;a["-ms-transform"]=b;a["o-transform"]=b;a.transform=b};l.run_when_dimensions_known=function(a,b,c){var d=a.parentElement,f=function(a){return a&&0>a.className.indexOf("toontalk-box-hole")},g;!c&&$(a).width()&&f(d)?setTimeout(function(){b(d)}):(g=function(c){setTimeout(function(){var h=$(a).width(),k=$(a).height();h&&k?f(a.parentElement)?(b(d),d?d.appendChild(a):a.parentElement===document.body&&$(a).remove(),$(a).removeClass("toontalk-not-observable")):
l.run_when_dimensions_known(a,b,!0):setTimeout(function(){l.widget_of_element(a);1E4>c&&g(2*c)},c)})},$(a).addClass("toontalk-not-observable"),document.body.appendChild(a),c&&l.set_css(a,{width:"",height:"",transform:""}),g(1))};l.original_dimensions=function(a,b,c){var d=a.get_frontside_element();d.parentElement!==document.body&&l.run_when_dimensions_known(d,function(){b($(d).width(),$(d).height())},c)};l.relative_position=function(a,b){var c=$(a).offset(),d;b&&(d=$(b).offset(),c.left-=d.left,c.top-=
d.top);return c};l.add_animation_class=function(a,b){l.set_css(a,{width:"",height:""});$(a).addClass(b)};l.widget_from_jquery=function(a){if(0<a.length)return a.get(0).toontalk_widget};l.widget_of_element=function(a){return a.toontalk_widget};l.has_animating_image=function(a){a=$(a);return(a=a.css("animation")||a.css("webkit-animation")||a.css("moz-animation")||a.css("ms-animation")||a.css("o-animation"))&&0!==a.indexOf("none")};l.display_message_if_new=function(a){0>L.indexOf(a)&&(l.display_message(a),
L.push(a))};l.display_message=function(a){var b=l.create_alert_element(a);$(".toontalk-alert-element").remove();console.log(a);console.trace();document.body.insertBefore(b,document.body.firstChild);setTimeout(function(){$(b).remove()},Math.max(2E3,a.length*(k.MAXIMUM_TOOLTIP_DURATION_PER_CHARACTER||100)))};l.display_tooltip=function(a){l.use_custom_tooltip(a.get(0));a.tooltip("open")};l.report_internal_error=function(a){console.log(a);console.trace();k.debugging&&l.display_message("Error: "+a)};l.get_current_url_boolean_parameter=
function(a,b){return 0>window.location.href.indexOf(a+"=")?b:0<=window.location.href.indexOf(a+"=1")?!0:!1};l.get_current_url_numeric_parameter=function(a,b){var c=l.get_current_url_parameter(a);if("undefined"===typeof c)return b;try{return parseInt(c,10)}catch(d){return 0}};l.get_current_url_parameter=function(a,b){var c=window.location.href.indexOf(a+"="),d;if(0>c)return b;c=c+a.length+1;d=window.location.href.indexOf("&",c);0>d&&(d=window.location.href.length);return window.location.href.substring(c,
d)};l.get_path_to_toontalk_folder=function(){var a;if("string"===typeof f)return f;f="";a=window.location.href.indexOf("/ToonTalk/");if(0>a)return f;for(a+=9;;){a=window.location.href.indexOf("/",a+1);if(0>a)return f;f+="../"}};l.is_browser_of_type=function(a){return 0<=window.navigator.userAgent.indexOf(a)};l.is_internet_explorer=function(){return l.is_browser_of_type("MSIE")||l.is_browser_of_type("Trident")};l.add_position=function(a,b){return{left:a.left+b.left,top:a.top+b.top}};l.subtract_position=
function(a,b){return{left:a.left-b.left,top:a.top-b.top}};l.remove_z_index=function(a){if(0===a.length||"<"!==a.charAt(0)||0>a.indexOf("z-index"))return a;a=$(a);a.attr("z-index","");return a.html()};l.add_test_all_button=function(){var a=$("#toontalk-test-all-button"),b;if(0!==a.length){a.button();b=a.get(0);b.innerHTML="Run all tests";var c=!1;a.click(function(a){c?($(".toontalk-stop-sign").each(function(){$(this).parent().is(".toontalk-top-level-backside")&&$(this).click()}),b.innerHTML="Run all tests"):
($(".toontalk-green-flag").each(function(){$(this).parent().is(".toontalk-top-level-backside")&&$(this).click()}),b.innerHTML="Stop all tests");c=!c})}};l.set_timeout=function(a,b){b?setTimeout(a,b):(C.push(a),window.postMessage("zero-timeout-message","*"))};l.get_first_property=function(a){return Object.keys(a)[0]};l.get_all_locally_stored_program_names=function(){var a=window.localStorage.getItem("toontalk-all-program-names");return a?JSON.parse(a):[]};l.set_all_locally_stored_program_names=function(a){window.localStorage.setItem("toontalk-all-program-names",
JSON.stringify(a))};l.get_local_storage_meta_data=function(a){a=l.local_storage_program_meta_data_key(a);var b;try{if(b=window.localStorage.getItem(a))return JSON.parse(b)}catch(c){}};l.local_storage_program_key=function(a){return"toontalk-json: "+a};l.local_storage_program_meta_data_key=function(a){return"toontalk-meta-data: "+a};l.enable_editor=function(a,b,c,d){(function(a,b){var c=function(a){a.data.editor_enabled_for&&a.data.editor_enabled_for===b&&(f=!0,window.removeEventListener("message",
c))},d=function(a,b){f||setTimeout(function(){a();d(a,b)},500)},f=!1;window.addEventListener("message",c);d(a,b)})(function(){a.postMessage({save_edits_to:window.location.href,file_id:c,widgets_json:d},"*")},c)};l.touch_available=function(){return"ontouchstart"in window||navigator.msMaxTouchPoints};l.enable_touch_events=function(a,b){var c=a,d=function(b){var d;b.stopPropagation();b.preventDefault();f?(f=!1,h(b,a),d=l.widget_of_element(a),k.logging&&0===k.logging.indexOf("touch")&&(k.debugging+="\ndrag ended"),
d&&(t(b,a),k.logging&&0===k.logging.indexOf("touch")&&(k.debugging+="\ndrop happened")),k.logging&&0===k.logging.indexOf("touch")&&(alert(k.debugging),k.debugging="touch")):g=!0;a=c},f=!1,g=!1,n=0,r=0,v;a.addEventListener("touchstart",function(c){k.logging&&0===k.logging.indexOf("touch")&&(k.debugging+="\ntouch start");c.preventDefault();"TEXTAREA"===c.srcElement.tagName||"INPUT"===c.srcElement.tagName||$(c.srcElement).is(".ui-resizable-handle")?k.logging&&0===k.logging.indexOf("touch")&&(k.debugging+=
"\ntouch start ignored due to tag name or class"):(c.stopPropagation(),l.set_timeout(function(){var b=c.changedTouches[0],d,h,t;g?(g=!1,d=document.createEvent("MouseEvent"),d.initMouseEvent("click",!0,!0,window,1,b.screenX,b.screenY,b.clientX,b.clientY,!1,!1,!1,!1,0,null),b.target.dispatchEvent(d),k.logging&&0===k.logging.indexOf("touch")&&(k.debugging+="\ntouch end treated as click",alert(k.debugging),k.debugging="touch")):(f=!0,(d=l.widget_of_element(a))&&d.get_infinite_stack()?(h=d.copy(),d.add_copy_to_container(h,
0,0),d.set_infinite_stack(!1),h.set_infinite_stack(!0)):$(a).is(".toontalk-top-level-resource")&&(h=d.copy(),d.add_copy_to_container(h,0,0),t=$(a).offset(),a=h.get_frontside_element(!0)),t||(t=$(a).offset()),q(c,a),n=b.clientX-t.left,r=b.clientY-t.top,k.logging&&0===k.logging.indexOf("touch")&&(k.debugging+="\ndrag started"))},b))},!0);a.addEventListener("touchmove",function(b){var c;b.preventDefault();if(f){c=b.changedTouches[0];l.set_absolute_position($(a),{left:c.pageX-n,top:c.pageY-r});b=l.find_widget_on_page(c,
a,0,0);if(v&&v!==b){var d=v.get_frontside_element();l.remove_highlight(d);v=void 0}b&&(u(c,b.get_frontside_element()),v=b);k.logging&&0===k.logging.indexOf("touch")&&(k.debugging+="\ndragged to "+(c.pageX-n)+", "+(c.pageY-r))}else k.logging&&0===k.logging.indexOf("touch")&&(k.debugging+="\ntouch move ignored since drag_started not yet set. "+Date.now())},!0);a.addEventListener("touchend",d,!0);a.addEventListener("touchcancel",d,!0)};l.get_mouse_or_first_touch_event_attribute=function(a,b){return b.changedTouches?
b.changedTouches[0][a]:b[a]};l.find_widget_on_page=function(a,b,c,d){var f=l.get_mouse_or_first_touch_event_attribute("pageX",a);a=l.get_mouse_or_first_touch_event_attribute("pageY",a);var g;$(b).hide();c=document.elementFromPoint(f-(window.pageXOffset+c),a-(window.pageYOffset+d));for($(b).show();c&&!c.toontalk_widget&&(!$(c).is(".toontalk-backside")||$(c).is(".toontalk-top-level-backside"));)c=c.parentNode;c&&(g=c.toontalk_widget);if(g)return g&&g.get_contents&&g.get_contents()&&(g=g.get_contents()),
b=g.get_type_name(),g&&"empty hole"===b?g.get_parent_of_frontside():g};l.closest_top_level_backside=function(a,b){var c,d;$(".toontalk-top-level-backside").each(function(){var b=$(this).offset(),b=b.left+$(this).width()/2-a^2+(b.top+$(this).height()/2-a)^2;c?b<d&&(c=this,d=b):(c=this,d=b)});return l.widget_of_element(c)};l.set_css=function(a,b){b&&$(a).css(b)};l.map_arguments=function(a,b){for(var c=a.length,d=0,f=[];d<c;)f.push(b(a[d])),d++;return f};l.conjunction=function(a,b){return a.map(function(c,
d){var f;if("undefined"===typeof c)return"anything";f=b?l.add_a_or_an(c):c;return d===a.length-2?f+" and ":d===a.length-1?f:f+", "}).join("")};l.insert_function_bird_documentation=function(a){var b=TOONTALK[a]["function"],c=Object.keys(b),d="<table class='toontalk-function-bird-documentation-table'>";c.forEach(function(a,c){d+="<tr><td><div id='bird_id_"+c+"'></div></td><td class='toontalk-function-bird-name'>"+a+"</td><td class='toontalk-function-bird-title-documentation'>"+b[a].title+"</td></tr>"});
d+="</table>";document.write(d);c.forEach(function(b,c){var d=window.TOONTALK.bird.create_function(a,void 0,b),f=d.get_frontside_element();d.update_display();$("#bird_id_"+c).replaceWith($(f).addClass("toontalk-function-bird-documentation-bird"));f.id=encodeURIComponent(b)})};l.create_queue=function(){var a=[],b=0;return{getLength:function(){return a.length-b},isEmpty:function(){return 0==a.length},enqueue:function(b){a.push(b)},dequeue:function(){var c;if(0!=a.length)return c=a[b],2*++b>=a.length&&
(a=a.slice(b),b=0),c},peek:function(){return 0<a.length?a[b]:void 0},does_any_item_satisfy:function(c){var d;for(d=b;d<a.length;d++)if(c(a[d]))return!0;return!1}}};return l}(window.TOONTALK);
