'use strict';(function(g){var m;"undefined"===typeof exports?"function"===typeof define&&"object"===typeof define.amd&&define.amd?(m={},define(function(){return m})):m="undefined"!==typeof window?window:g:m=exports;(function(a){var b={greatest_common_divisor:function(c,t){if(1===t||1===c)return 1;for(var a;0!==t;){a=t;t=c%t;if(!isFinite(t))return 0;c=a}return c}};b.gcd=b.greatest_common_divisor;b.fromRandom=function(c){return Math.random()*(1<<c)>>>0};b.fromMillitime=function(){return+new Date};b.fromUnixtime=
function(){return.001*b.fromMillitime()|0};"undefined"!==typeof a&&(a.integer=b);(function(c){function t(c,b,e){if(e!==a)return c instanceof t?c:"undefined"===typeof c?d:t.parse(c);for(c=c||[];c.length&&!c[c.length-1];)--c.length;this._d=c;this._s=c.length?b||1:0}var a={};t._construct=function(c,d){return new t(c,d,a)};t.base=1E7;t.base_log10=7;var d=new t([],0,a);t.ZERO=d;var b=new t([1],1,a);t.ONE=b;var e=new t(b._d,-1,a);t.M_ONE=e;t._0=d;t._1=b;t.small=[d,b,new t([2],1,a),new t([3],1,a),new t([4],
1,a),new t([5],1,a),new t([6],1,a),new t([7],1,a),new t([8],1,a),new t([9],1,a),new t([10],1,a),new t([11],1,a),new t([12],1,a),new t([13],1,a),new t([14],1,a),new t([15],1,a),new t([16],1,a),new t([17],1,a),new t([18],1,a),new t([19],1,a),new t([20],1,a),new t([21],1,a),new t([22],1,a),new t([23],1,a),new t([24],1,a),new t([25],1,a),new t([26],1,a),new t([27],1,a),new t([28],1,a),new t([29],1,a),new t([30],1,a),new t([31],1,a),new t([32],1,a),new t([33],1,a),new t([34],1,a),new t([35],1,a),new t([36],
1,a)];t.digits="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");t.prototype.toString=function(c){c=+c||10;if(2>c||36<c)throw Error("illegal radix "+c+".");if(0===this._s)return"0";if(10===c){c=0>this._s?"-":"";c+=this._d[this._d.length-1].toString();for(var a=this._d.length-2;0<=a;a--){for(var d=this._d[a].toString();7>d.length;)d="0"+d;c+=d}return c}a=t.digits;c=t.small[c];for(var d=this._s,b=this.abs(),e=[],h;0!==b._s;)h=b.divRem(c),b=h[0],h=h[1],e.push(a[h.valueOf()]);return(0>d?"-":"")+e.reverse().join("")};
t.radixRegex=[/^$/,/^$/,/^[01]*$/,/^[012]*$/,/^[0-3]*$/,/^[0-4]*$/,/^[0-5]*$/,/^[0-6]*$/,/^[0-7]*$/,/^[0-8]*$/,/^[0-9]*$/,/^[0-9aA]*$/,/^[0-9abAB]*$/,/^[0-9abcABC]*$/,/^[0-9a-dA-D]*$/,/^[0-9a-eA-E]*$/,/^[0-9a-fA-F]*$/,/^[0-9a-gA-G]*$/,/^[0-9a-hA-H]*$/,/^[0-9a-iA-I]*$/,/^[0-9a-jA-J]*$/,/^[0-9a-kA-K]*$/,/^[0-9a-lA-L]*$/,/^[0-9a-mA-M]*$/,/^[0-9a-nA-N]*$/,/^[0-9a-oA-O]*$/,/^[0-9a-pA-P]*$/,/^[0-9a-qA-Q]*$/,/^[0-9a-rA-R]*$/,/^[0-9a-sA-S]*$/,/^[0-9a-tA-T]*$/,/^[0-9a-uA-U]*$/,/^[0-9a-vA-V]*$/,/^[0-9a-wA-W]*$/,
/^[0-9a-xA-X]*$/,/^[0-9a-yA-Y]*$/,/^[0-9a-zA-Z]*$/];t.parse=function(c,b){function e(c){c=c.replace(/\s*[*xX]\s*10\s*(\^|\*\*)\s*/,"e");return c.replace(/^([+\-])?(\d+)\.?(\d*)[eE]([+\-]?\d+)$/,function(c,t,a,l,d){d=+d;var b=0>d,e=a.length+d;c=(b?a:l).length;d=(d=Math.abs(d))>=c?d-c+b:0;c=Array(d+1).join("0");a+=l;return(t||"")+(b?a=c+a:a+=c).substr(0,e+=b?c.length:0)+(e<a.length?"."+a.substr(e):"")})}c=c.toString();if("undefined"===typeof b||10===+b)c=e(c);var h=RegExp("^([+\\-]?)("+("undefined"===
typeof b?"0[xcb]":16==b?"0x":8==b?"0c":2==b?"0b":"")+")?([0-9a-z]*)(?:\\.\\d*)?$","i").exec(c);if(h){var f=h[1]||"+",k=h[2]||"",h=h[3]||"";if("undefined"===typeof b)b="0x"===k||"0X"===k?16:"0c"===k||"0C"===k?8:"0b"===k||"0B"===k?2:10;else if(2>b||36<b)throw Error("Illegal radix "+b+".");b=+b;if(!t.radixRegex[b].test(h))throw Error("Bad digit for radix "+b);h=h.replace(/^0+/,"").split("");if(0===h.length)return d;f="-"===f?-1:1;if(10==b){for(k=[];7<=h.length;)k.push(parseInt(h.splice(h.length-t.base_log10,
t.base_log10).join(""),10));k.push(parseInt(h.join(""),10));return new t(k,f,a)}k=d;b=t.small[b];for(var g=t.small,l=0;l<h.length;l++)k=k.multiply(b).add(g[parseInt(h[l],36)]);return new t(k._d,f,a)}throw Error("Invalid BigInteger format: "+c);};t.prototype.add=function(c){if(0===this._s)return t(c);c=t(c);if(0===c._s)return this;if(this._s!==c._s)return c=c.negate(),this.subtract(c);var d=this._d;c=c._d;for(var b=d.length,e=c.length,h=Array(Math.max(b,e)+1),f=Math.min(b,e),k=0,l=0;l<f;l++)k=d[l]+
c[l]+k,h[l]=k%1E7,k=k/1E7|0;e>b&&(d=c,b=e);for(l=f;k&&l<b;l++)k=d[l]+k,h[l]=k%1E7,k=k/1E7|0;for(k&&(h[l]=k);l<b;l++)h[l]=d[l];return new t(h,this._s,a)};t.prototype.negate=function(){return new t(this._d,-this._s|0,a)};t.prototype.abs=function(){return 0>this._s?this.negate():this};t.prototype.subtract=function(c){if(0===this._s)return t(c).negate();c=t(c);if(0===c._s)return this;if(this._s!==c._s)return c=c.negate(),this.add(c);var b=this;0>this._s&&(b=new t(c._d,1,a),c=new t(this._d,1,a));var e=
b.compareAbs(c);if(0===e)return d;if(0>e){var h=c;c=b;b=h}b=b._d;c=c._d;var h=b.length,f=c.length,k=Array(h),g=0,l,q;for(l=0;l<f;l++)q=b[l]-g-c[l],0>q?(q+=1E7,g=1):g=0,k[l]=q;for(l=f;l<h;l++){q=b[l]-g;if(0>q)q+=1E7;else{k[l++]=q;break}k[l]=q}for(;l<h;l++)k[l]=b[l];return new t(k,e,a)};(function(){function c(d,b){for(var e=d._d,h=e.slice(),f=0;;){var l=(e[f]||0)+1;h[f]=l%1E7;if(9999999>=l)break;++f}return new t(h,b,a)}function d(c,b){for(var e=c._d,h=e.slice(),f=0;;){var l=(e[f]||0)-1;if(0>l)h[f]=
l+1E7;else{h[f]=l;break}++f}return new t(h,b,a)}t.prototype.next=function(){switch(this._s){case 0:return b;case -1:return d(this,-1);default:return c(this,1)}};t.prototype.prev=function(){switch(this._s){case 0:return e;case -1:return c(this,-1);default:return d(this,1)}}})();t.prototype.compareAbs=function(c){if(this===c)return 0;if(!(c instanceof t)){if(!isFinite(c))return isNaN(c)?c:-1;c=t(c)}if(0===this._s)return 0!==c._s?-1:0;if(0===c._s)return 1;var a=this._d.length,d=c._d.length;if(a<d)return-1;
if(a>d)return 1;d=this._d;c=c._d;for(--a;0<=a;a--)if(d[a]!==c[a])return d[a]<c[a]?-1:1;return 0};t.prototype.compare=function(c){if(this===c)return 0;c=t(c);return 0===this._s?-c._s:this._s===c._s?this.compareAbs(c)*this._s:this._s};t.prototype.isUnit=function(){return this===b||this===e||1===this._d.length&&1===this._d[0]};t.prototype.multiply=function(c){if(0===this._s)return d;c=t(c);if(0===c._s)return d;if(this.isUnit())return 0>this._s?c.negate():c;if(c.isUnit())return 0>c._s?this.negate():this;
if(this===c)return this.square();var b=this._d.length>=c._d.length,e=(b?this:c)._d,b=(b?c:this)._d,h=e.length,f=b.length,k=h+f,g=Array(k),l;for(l=0;l<k;l++)g[l]=0;for(l=0;l<f;l++){for(var k=0,q=b[l],B=h+l,z,p=l;p<B;p++)z=g[p]+q*e[p-l]+k,k=z/1E7|0,g[p]=z%1E7|0;k&&(z=g[p]+k,g[p]=z%1E7)}return new t(g,this._s*c._s,a)};t.prototype.multiplySingleDigit=function(c){if(0===c||0===this._s)return d;if(1===c)return this;var b;if(1===this._d.length)return b=this._d[0]*c,1E7<=b?new t([b%1E7|0,b/1E7|0],1,a):new t([b],
1,a);if(2===c)return this.add(this);if(this.isUnit())return new t([c],1,a);var e=this._d,h=e.length;b=h+1;for(var f=Array(b),k=0;k<b;k++)f[k]=0;for(var g=k=0;g<h;g++)b=c*e[g]+k,k=b/1E7|0,f[g]=b%1E7|0;k&&(f[g]=k);return new t(f,1,a)};t.prototype.square=function(){if(0===this._s)return d;if(this.isUnit())return b;var c=this._d,e=c.length,h=Array(e+e+1),f,k,g,p;for(p=0;p<e;p++)g=2*p,f=c[p]*c[p],k=f/1E7|0,h[g]=f%1E7,h[g+1]=k;for(p=0;p<e;p++){k=0;g=2*p+1;for(var l=p+1;l<e;l++,g++)f=c[l]*c[p]*2+h[g]+k,
k=f/1E7|0,h[g]=f%1E7;g=e+p;f=k+h[g];k=f/1E7|0;h[g]=f%1E7;h[g+1]+=k}return new t(h,1,a)};t.prototype.quotient=function(c){return this.divRem(c)[0]};t.prototype.divide=t.prototype.quotient;t.prototype.remainder=function(c){return this.divRem(c)[1]};t.prototype.divRem=function(c){c=t(c);if(0===c._s)throw Error("Divide by zero");if(0===this._s)return[d,d];if(1===c._d.length)return this.divRemSmall(c._s*c._d[0]);switch(this.compareAbs(c)){case 0:return[this._s===c._s?b:e,d];case -1:return[d,this]}var h=
this._s*c._s,f=c.abs(),k=this._d,g=k.length,p=[],m,l=new t([],0,a);for(l._s=1;g;)if(l._d.unshift(k[--g]),0>l.compareAbs(c))p.push(0);else{if(0===l._s)m=0;else{var q=l._d.length;m=f._d.length;q=1E7*l._d[q-1]+l._d[q-2];m=1E7*f._d[m-1]+f._d[m-2];l._d.length>f._d.length&&(q=1E7*(q+1));m=Math.ceil(q/m)}do{q=f.multiplySingleDigit(m);if(0>=q.compareAbs(l))break;m--}while(m);p.push(m);m&&(m=l.subtract(q),l._d=m._d.slice(),0===l._d.length&&(l._s=0))}return[new t(p.reverse(),h,a),new t(l._d,this._s,a)]};t.prototype.divRemSmall=
function(c){c=+c;if(0===c)throw Error("Divide by zero");var b=this._s*(0>c?-1:1);c=Math.abs(c);if(1>c||1E7<=c)throw Error("Argument out of range");if(0===this._s)return[d,d];if(1===c||-1===c)return[1===b?this.abs():new t(this._d,b,a),d];if(1===this._d.length){var e=new t([this._d[0]/c|0],1,a);c=new t([this._d[0]%c|0],1,a);0>b&&(e=e.negate());0>this._s&&(c=c.negate());return[e,c]}for(var h=this._d.slice(),e=Array(h.length),f=0,k=0,g=0,l;h.length;)f=1E7*f+h[h.length-1],f<c?(e[g++]=0,h.pop(),k=1E7*k+
f):(l=0===f?0:f/c|0,k=f-c*l,(e[g++]=l)?(h.pop(),f=k):h.pop());c=new t([k],1,a);0>this._s&&(c=c.negate());return[new t(e.reverse(),b,a),c]};t.prototype.isEven=function(){var c=this._d;return 0===this._s||0===c.length||0===c[0]%2};t.prototype.isOdd=function(){return!this.isEven()};t.prototype.sign=function(){return this._s};t.prototype.isPositive=function(){return 0<this._s};t.prototype.isNegative=function(){return 0>this._s};t.prototype.isZero=function(){return 0===this._s};t.prototype.exp10=function(c){c=
+c;if(0===c)return this;if(Math.abs(c)>Number(h))throw Error("exponent too large in BigInteger.exp10");if(0<c){for(var b=new t(this._d.slice(),this._s,a);7<=c;c-=7)b._d.unshift(0);if(0==c)return b;b._s=1;b=b.multiplySingleDigit(Math.pow(10,c));return 0>this._s?b.negate():b}if(-c>=7*this._d.length)return d;b=new t(this._d.slice(),this._s,a);for(c=-c;7<=c;c-=7)b._d.shift();return 0==c?b:b.divRemSmall(Math.pow(10,c))[0]};t.prototype.pow=function(c){if(this.isUnit())return 0<this._s?this:t(c).isOdd()?
this:this.negate();c=t(c);if(0===c._s)return b;if(0>c._s){if(0===this._s)throw Error("Divide by zero");return d}if(0===this._s)return d;if(c.isUnit())return this;if(0<c.compareAbs(h))throw Error("exponent too large in BigInteger.pow");for(var a=this,e=b,f=t.small[2];c.isPositive()&&(!c.isOdd()||(e=e.multiply(a),!c.isUnit()));)a=a.square(),c=c.quotient(f);return e};t.prototype.modPow=function(c,a){for(var d=b,e=this;c.isPositive();)c.isOdd()&&(d=d.multiply(e).remainder(a)),c=c.quotient(t.small[2]),
c.isPositive()&&(e=e.square().remainder(a));return d};t.prototype.log=function(){switch(this._s){case 0:return-Infinity;case -1:return NaN}var c=this._d.length;if(30>7*c)return Math.log(this.valueOf());var b=Math.ceil(30/7),d=this._d.slice(c-b);return Math.log((new t(d,1,a)).valueOf())+(c-b)*Math.log(1E7)};t.prototype.valueOf=function(){return parseInt(this.toString(),10)};t.prototype.toJSValue=function(){return parseInt(this.toString(),10)};var h=t(2147483647);t.MAX_EXP=h;(function(){function c(a){return function(c){return a.call(t(c))}}
function a(c){return function(a,b){return c.call(t(a),t(b))}}function b(c){return function(a,b,d){return c.call(t(a),t(b),t(d))}}(function(){var d,e,h="toJSValue isEven isOdd sign isZero isNegative abs isUnit square negate isPositive toString next prev log".split(" "),f="compare remainder divRem subtract add quotient divide multiply pow compareAbs".split(" "),l=["modPow"];for(d=0;d<h.length;d++)e=h[d],t[e]=c(t.prototype[e]);for(d=0;d<f.length;d++)e=f[d],t[e]=a(t.prototype[e]);for(d=0;d<l.length;d++)e=
l[d],t[e]=b(t.prototype[e]);t.exp10=function(c,a){return t(c).exp10(a)}})()})();c.BigInteger=t})("undefined"!==typeof a?a:this);var d={greatest_common_divisor:function(c,t){if(t.isUnit()||c.isUnit())return BigInteger.ONE;for(var a;!t.isZero();)a=t,t=c.remainder(t),c=a;return c},create:function(){return[0]},clone:function(c){for(var t=[],a=0,b=c.length;a<b;a++)t[a]=c[a];return t},copy:function(c,t){c=[];for(var a=0,b=t.length;a<b;a++)c[a]=t[a];return c},abs:function(c,t){c[0]=Math.abs(t[0]);return c},
str:function(c){return c[0].toString()},toInteger:function(c){return out[0]},fromInteger:function(c){return[parseInt(c)]}};d.ZERO=d.fromInteger(0);d.ONE=d.fromInteger(1);"undefined"!==typeof a&&(a.bigint=d);if(!k)var k=Array;if(!f)var f=Math.pow(2,56);if(!g)var g=16777216;var e={EPSILON:2E-16};e.MAX_LOOPS=g;e.create=function(){var c=new k(2);c[0]=0;c[1]=1;return c};e.clone=function(c){var t=new k(2);t[0]=c[0];t[1]=c[1];return t};e.fromValues=function(c,t){var a=new k(2);a[0]=c;a[1]=t;return e.normalize(a,
a)};e.copy=function(c,t){c[0]=t[0];c[1]=t[1];return c};e.set=function(c,t,a){c[0]=t;c[1]=a;return e.normalize(c,c)};e.abs=function(c,a){c[0]=Math.abs(a[0]);c[1]=a[1];return c};e.invert=function(c,a){var b=a[0];c[0]=a[1];c[1]=b;return c};e.reciprocal=e.invert;e.add=function(c,a,b){a[1]===b[1]?(c[0]=a[0]+b[0],c[1]=a[1]):(c[0]=a[0]*b[1]+b[0]*a[1],c[1]=a[1]*b[1]);return e.normalize(c,c)};e.subtract=function(c,a,b){a[1]===b[1]?(c[0]=a[0]-b[0],c[1]=a[1]):(c[0]=a[0]*b[1]-b[0]*a[1],c[1]=a[1]*b[1]);return e.normalize(c,
c)};e.sub=e.subtract;e.multiply=function(c,a,b){c[0]=a[0]*b[0];c[1]=a[1]*b[1];return e.normalize(c,c)};e.mul=e.multiply;e.mediant=function(c,a,b){c[0]=a[0]+b[0];c[1]=a[1]+b[1];return e.normalize(c,c)};e.divide=function(c,a,b){c[0]=a[0]*b[1];c[1]=a[1]*b[0];return e.normalize(c,c)};e.div=e.divide;e.equals=function(c,a){return 0===c[0]&&0===a[0]||0===c[1]&&0===a[1]?!0:c[0]===a[0]&&c[1]===a[1]};e.approximates=function(c,a){if(e.equals(c,a))return!0;var b=e.create();e.sub(b,c,a);e.abs(b,b);return e.isLessThan(b,
e.INFINITESIMAL)};e.isGreaterThan=function(c,a){return e.equals(c,a)?!1:c[0]*a[1]>a[0]*c[1]};e.isLessThan=function(c,a){return e.equals(c,a)?!1:c[0]*a[1]<a[0]*c[1]};e.isNegative=function(c){return 0>c[0]};e.min=function(c,a,b){e.isLessThan(a,b)?(c[0]=a[0],c[1]=a[1]):(c[0]=b[0],c[1]=b[1]);return c};e.max=function(c,a,b){e.isGreaterThan(a,b)?(c[0]=a[0],c[1]=a[1]):(c[0]=b[0],c[1]=b[1]);return c};e.scalar_multiply=function(c,a,b){c[0]=a[0]*b;c[1]=a[1];return e.normalize(c,c)};e.scalar_divide=function(c,
a,b){c[0]=a[0];c[1]=a[1]*b;return e.normalize(c,c)};e.normalize=function(c,a){if(isNaN(a[0])||isNaN(a[1])||0===a[0]&&0===a[1])return c[0]=0,c[1]=0,c;if(0===a[0])return c[0]=0,c[1]=1,c;if(0===a[1])return c[0]=1,c[1]=0,c;if(a[0]===a[1])return c[0]=1,c[1]=1,c;0<a[1]?(c[0]=a[0],c[1]=a[1]):(c[0]=-a[0],c[1]=-a[1]);var d=b.greatest_common_divisor(Math.abs(c[0]),c[1]);1<d&&(c[0]/=d,c[1]/=d);return c};e.opposite=function(c,a){c[0]=-a[0];c[1]=a[1];return c};e.negative=e.opposite;e.neg=e.opposite;e.power=function(c,
a,b){2===b?(c[0]=a[0]*a[0],c[1]=a[1]*a[1]):0<b?(c[0]=Math.pow(a[0],b),c[1]=Math.pow(a[1],b)):0>b?(b=Math.abs(b),c[0]=Math.pow(a[1],b),c[1]=Math.pow(a[0],b)):e.copy(c,e.ONE);return e.normalize(c,c)};e.pow=e.power;e.sqrt=function(c,a){return e.nthRoot(c,a,2)};e.nthRoot=function(c,a,b){if(e.equals(a,e.ZERO))return e.copy(c,e.ZERO);if(e.equals(a,e.ONE))return e.copy(c,e.ONE);if(e.equals(a,e.INFINITY))return e.copy(c,e.INFINITY);if(e.equals(a,e.INFINULL))return e.copy(c,e.INFINULL);var d=e.isNegative(a);
d&&(a[0]=-a[0]);c=e.copy(c,e.ONE);for(var h=[1,0,0,1],f=e.clone(e.ONE),k=e.MAX_LOOPS;!e.approximates(a,f)&&k--;)e.isLessThan(a,f)?(h[0]+=h[1],h[2]+=h[3]):(h[1]+=h[0],h[3]+=h[2]),c[0]=h[0]+h[1],c[1]=h[2]+h[3],e.pow(f,c,b);d&&(a[0]=-a[0],1===b%2&&e.neg(c,c));return c};e.dot=function(c,a){return c[0]*a[0]+c[1]*a[1]};e.str=function(c){return 1===c[1]?c[0].toString():c[0]+"/"+c[1]};e.toDecimal=function(c){return c[0]/c[1]};e.dec=e.toDecimal;e.toInteger=function(c){return Math.round(e.toDecimal(c))};e.round=
e.toInteger;e.floor=function(c){return Math.floor(e.toDecimal(c))};e.ceil=function(c){return Math.ceil(e.toDecimal(c))};e.fromInteger_copy=function(c,a){c[0]=parseInt(a);c[1]=1;return c};e.fromInteger=function(c){return e.fromInteger_copy(e.create(),c)};e.fromIntegerInverse_copy=function(c,a){c[0]=1;c[1]=parseInt(a);0>c[1]&&(c[0]=-c[0],c[1]=-c[1]);return c};e.fromIntegerInverse=function(c){return e.fromIntegerInverse_copy(e.create(),c)};e.fromDecimal=function(c){return e.fromDecimal_copy(e.create(),
c)};e.fromDecimal_copy=function(c,a){a=parseFloat(a);if(isNaN(a))return e.copy(c,e.INFINULL);if(Infinity===a)return e.copy(c,e.INFINITY);if(Math.abs(a)<e.EPSILON)return e.copy(c,e.ZERO);if(Math.abs(a-1)<e.EPSILON)return e.copy(c,e.ONE);if(Math.abs(a%1)<e.EPSILON)return e.fromInteger_copy(c,a);if(Math.abs(1/a%1)<e.EPSILON)return e.fromIntegerInverse_copy(c,Math.round(1/a));e.copy(c,e.ONE);for(var b=[1,0,0,1],d=a,h=1,f=e.MAX_LOOPS;f--&&Math.abs(a-e.toDecimal(c))>e.EPSILON;)h=Math.floor(d),c[0]=h*b[0]+
b[2],c[1]=h*b[1]+b[3],d=1/(d-h),b[2]=b[0],b[3]=b[1],b[0]=c[0],b[1]=c[1];return c};e.fromRandom=function(c){c[0]=0xfffffffffffff*Math.random()<<0;c[1]=Math.abs(0xfffffffffffff*Math.random()<<0);return e.normalize(c,c)};e.sin=function(c,a){if(0===a[1])return e.copy(c,e.ZERO);e.scalar_multiply(c,a,2);var b=e.create();e.pow(b,a,2);e.add(b,b,e.ONE);e.divide(c,c,b);return c};e.cos=function(c,a){if(0===a[1])return e.neg(c,e.ONE);var b=e.create();e.pow(b,a,2);e.sub(c,e.ONE,b);var d=e.create();e.add(d,e.ONE,
b);e.divide(c,c,d);return c};e.tan=function(c,a){e.scalar_multiply(c,a,2);var b=e.create();e.pow(b,a,2);e.scalar_multiply(b,b,2);e.add(c,c,b);e.pow(b,a,4);e.sub(b,e.ONE,b);e.divide(c,c,b);return c};e.toEgyptian=function(c){c=e.clone(c);e.abs(c,c);var a=e.floor(c);a&&e.sub(c,c,e.fromInteger(a));if(!c[0])return a.toString();a||(a="");for(var b=1,d=e.create();1!==c[0];)b++,d=e.fromValues(1,b),e.isGreaterThan(c,d)&&(a&&(a+=" + "),a+=e.str(d),e.sub(c,c,d));return c?a?a+" + "+e.str(c):e.str(c):a?a:"0"};
e.toBabylonian=function(c){var a="",b=e.toDecimal(c);c=parseInt(b);for(var b=b-c,d=0,h=0;0<c;)(d=c%60)&&(a=d+" * 60^"+h+(a?" + ":"")+a),c=(c-d)/60,h++;for(h=-1;0<b;)b*=60,d=parseInt(b+1E-13),b-=d,-1E-13>b||(d&&(a+=(a?" + ":"")+d+" * 60^"+h),h--);return a?a:"0"};e.traceSternBrocot=function(c){var a="";if(e.equals(c,e.ZERO)||e.equals(c,e.ONE)||e.equals(c,e.INFINITY)||e.equals(c,e.INFINULL))return a;if(e.equals(c,e.ZERO))return e.copy(out,e.ZERO);if(e.equals(c,e.ONE))return e.copy(out,e.ONE);if(e.equals(c,
e.INFINITY))return e.copy(out,e.INFINITY);if(e.equals(c,e.INFINULL))return e.copy(out,e.INFINULL);c=e.clone(c);e.isNegative(c)&&(c[0]=-c[0]);for(var b=e.clone(e.ONE),d=[1,0,0,1],h=0,f=0,k=e.MAX_LOOPS;!e.approximates(c,b)&&k--;)e.isLessThan(c,b)?(d[0]+=d[1],d[2]+=d[3],f++,h&&(a+="R",1!==h&&(a+=h),h=0,a+=" ")):(d[1]+=d[0],d[3]+=d[2],h++,f&&(a+="L",1!==f&&(a+=f),f=0,a+=" ")),b[0]=d[0]+d[1],b[1]=d[2]+d[3];f?(a+="L",1!==f&&(a+=f)):h&&(a+="R",1!==h&&(a+=h));0>k&&(a+="...");return a};e.toContinuedFraction=
function(c,a){a="undefined"===typeof a?65536:parseInt(a);if(e.equals(c,e.ZERO))return[0];if(e.equals(c,e.ONE))return[1];if(e.equals(c,e.NEGONE))return[-1];if(e.equals(c,e.INFINITY))return[1,0];if(e.equals(c,e.INFINULL))return[0,0];var b=e.clone(c),d=e.isNegative(b);d&&(b[0]=-b[0]);for(var h=e.clone(e.ONE),f=[1,0,0,1],k=1,g=[0],p=g.length-1;!e.equals(b,h)&&a--;)e.isLessThan(b,h)?(-1===k?g[p]++:(k=-1,g.push(1),p++),f[0]+=f[1],f[2]+=f[3]):(1===k?g[p]++:(k=1,g.push(1),p++),f[1]+=f[0],f[3]+=f[2]),h[0]=
f[0]+f[1],h[1]=f[2]+f[3];0>a?g.push(0):g[p]++;if(d)for(var m in g)g[m]=-g[m];return g};e.fromContinuedFraction=function(c,a){e.fromInteger_copy(c,a[a.length-1]);for(var b=a.length-2;-1<b;b--)e.invert(c,c),e.add(c,e.fromInteger(a[b]),c);return c};e.dump=function(c){e.create();return"rat\t"+e.str(c)+"\n~\t"+e.toDecimal(c)+"\nCF:\t["+e.toContinuedFraction(c)+"]\n"};e.ZERO=e.fromInteger(0);e.ONE=e.fromInteger(1);e.NEGONE=e.fromInteger(-1);e.INFINITY=e.fromValues(1,0);e.INFINULL=e.fromValues(0,0);e.INFINITESIMAL=
e.clone([1,f]);e.PI=e.fromValues(1320192667429,420230377710);"undefined"!==typeof a&&(a.rat=e);if(!m)var m=new BigInteger("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF");if(!r)var r=1073741824;var h={EPSILON:2E-16};h.MAX_LOOPS=r;h.create=function(){var c=[];c[0]=BigInteger.ZERO;c[1]=BigInteger.ONE;return c};h.clone=function(c){var a=[];a[0]=c[0];a[1]=c[1];return a};h.fromValues=function(c,a){var b=[];b[0]=new BigInteger(c);b[1]=new BigInteger(a);return h.normalize(b,b)};h.copy=function(c,a){c[0]=a[0];c[1]=
a[1];return c};h.set=function(c,a,b){c[0]=a;c[1]=b;return h.normalize(c,c)};h.toRat=function(c,a){return e.set(c,a[0].toJSValue(),a[1].toJSValue())};h.fromRat=function(c,a){return h.set(c,BigInteger(a[0]),BigInteger(a[1]))};h.abs=function(c,a){c[0]=a[0].abs();c[1]=a[1];return c};h.invert=function(c,a){var b=a[0];c[0]=a[1];c[1]=b;return c};h.reciprocal=h.invert;h.add=function(c,a,b){0===a[1].compare(b[1])?(c[0]=a[0].add(b[0]),c[1]=a[1]):(c[0]=a[0].multiply(b[1]).add(b[0].multiply(a[1])),c[1]=a[1].multiply(b[1]));
return h.normalize(c,c)};h.subtract=function(c,a,b){0===a[1].compare(b[1])?(c[0]=a[0].subtract(b[0]),c[1]=a[1]):(c[0]=a[0].multiply(b[1]).subtract(b[0].multiply(a[1])),c[1]=a[1].multiply(b[1]));return h.normalize(c,c)};h.sub=h.subtract;h.multiply=function(c,a,b){c[0]=a[0].multiply(b[0]);c[1]=a[1].multiply(b[1]);return h.normalize(c,c)};h.mul=h.multiply;h.mediant=function(c,a,b){c[0]=a[0].add(b[0]);c[1]=a[1].add(b[1]);return h.normalize(c,c)};h.divide=function(c,a,b){c[0]=a[0].multiply(b[1]);c[1]=
a[1].multiply(b[0]);return h.normalize(c,c)};h.div=h.divide;h.equals=function(c,a){return c[0].isZero()&&a[0].isZero()||c[1].isZero()&&a[1].isZero()?!0:0===c[0].compare(a[0])&&0===c[1].compare(a[1])};h.approximates=function(c,a){if(h.equals(c,a))return!0;var b=h.create();h.sub(b,c,a);h.abs(b,b);return h.isLessThan(b,h.INFINITESIMAL)};h.isGreaterThan=function(c,a){return h.equals(c,a)?!1:0<c[0].multiply(a[1]).compare(a[0].multiply(c[1]))};h.isLessThan=function(c,a){return h.equals(c,a)?!1:0>c[0].multiply(a[1]).compare(a[0].multiply(c[1]))};
h.isNegative=function(c){return c[0].isNegative()};h.min=function(c,a,b){h.isLessThan(a,b)?(c[0]=a[0],c[1]=a[1]):(c[0]=b[0],c[1]=b[1]);return c};h.max=function(c,a,b){h.isGreaterThan(a,b)?(c[0]=a[0],c[1]=a[1]):(c[0]=b[0],c[1]=b[1]);return c};h.scalar_multiply=function(c,a,b){c[0]=a[0].multiply(b);c[1]=a[1];return h.normalize(c,c)};h.scalar_divide=function(c,a,b){c[0]=a[0];c[1]=a[1].multiply(b);return h.normalize(c,c)};h.normalize=function(c,a){if(a[0].isZero()||a[1].isZero())return a;if(0===a[0].compare(a[1]))return h.clone(h.ONE);
if(a[1].isNegative())c[0]=a[0].negate(),c[1]=a[1].negate();else if(c[0]=a[0],c[1]=a[1],c[1].isZero())return c;var b=d.greatest_common_divisor(c[0].abs(),c[1]);0<b.compare(BigInteger.ONE)&&(c[0]=c[0].quotient(b),c[1]=c[1].quotient(b));return c};h.opposite=function(a,b){a[0]=b[0].negate();a[1]=b[1];return a};h.negative=h.opposite;h.neg=h.opposite;h.power=function(a,b,d){2===d?(a[0]=b[0].square(),a[1]=b[1].square()):0<d?(a[0]=b[0].pow(d),a[1]=b[1].pow(d)):0>d?(d=Math.abs(d),a[0]=b[1].pow(d),a[1]=b[0].pow(d)):
h.copy(a,h.ONE);return a};h.pow=h.power;h.sqrt=function(a,b){return h.nthRoot(a,b,2)};h.nthRoot=function(a,b,d){if(h.equals(b,h.ZERO))return h.copy(a,h.ZERO);if(h.equals(b,h.ONE))return h.copy(a,h.ONE);if(h.equals(b,h.INFINITY))return h.copy(a,h.INFINITY);if(h.equals(b,h.INFINULL))return h.copy(a,h.INFINULL);var f=h.isNegative(b);f&&(b[0]=b[0].negate());h.copy(a,h.ONE);for(var e=[BigInteger(1),BigInteger(0),BigInteger(0),BigInteger(1)],k=h.clone(h.ONE),g=r;!h.approximates(b,k)&&g--;)h.isLessThan(b,
k)?(e[0]=e[0].add(e[1]),e[2]=e[2].add(e[3])):(e[1]=e[1].add(e[0]),e[3]=e[3].add(e[2])),a[0]=e[0].add(e[1]),a[1]=e[2].add(e[3]),h.pow(k,a,d);f&&(b[0]=b[0].negate(),1===d%2&&h.neg(a,a));return a};h.dot=function(a,b){return a[0].multiply(b[0]).add(a[1].multiply(b[1]))};h.str=function(a){return 0===a[1].compare(BigInteger.ONE)?a[0].toString():a[0].toString()+"/"+a[1].toString()};h.toDecimal=function(a){return a[0].toJSValue()/a[1].toJSValue()};h.dec=h.toDecimal;h.toInteger=function(a){return a[0].quotient(a[1]).toJSValue()};
h.round=h.toInteger;h.toBigInteger=function(a){return a[0].quotient(a[1])};h.floor=function(a){return Math.floor(h.toDecimal(a))};h.ceil=function(a){return Math.ceil(h.toDecimal(a))};h.fromInteger_copy=function(a,b){a[0]=BigInteger(b);a[1]=BigInteger.ONE;return a};h.fromInteger=function(a){return h.fromInteger_copy(h.create(),a)};h.fromIntegerInverse_copy=function(a,b){a[0]=BigInteger.ONE;a[1]=BigInteger(b);a[1].isNegative()&&(a[0]=a[0].negate(),a[1]=a[1].negate());return a};h.fromIntegerInverse=
function(a){return h.fromIntegerInverse_copy(h.create(),a)};h.fromDecimal=function(a){return h.fromDecimal_copy(h.create(),a)};h.fromDecimal_copy=function(a,b){b=parseFloat(b);if(isNaN(b))return h.copy(a,h.INFINULL);if(Infinity===b)return h.copy(a,h.INFINITY);if(Math.abs(b)<h.EPSILON)return h.copy(a,h.ZERO);if(Math.abs(b-1)<h.EPSILON)return h.copy(a,h.ONE);if(Math.abs(b%1)<h.EPSILON)return h.fromInteger_copy(a,b);if(Math.abs(1/b%1)<h.EPSILON)return h.fromIntegerInverse_copy(a,Math.round(1/b));h.copy(a,
h.ONE);for(var d=[BigInteger(1),BigInteger(0),BigInteger(0),BigInteger(1)],e=b,f=1,k=h.MAX_LOOPS;k--&&Math.abs(b-h.toDecimal(a))>h.EPSILON;)f=Math.floor(e),a[0]=BigInteger(f*d[0]+d[2]),a[1]=BigInteger(f*d[1]+d[3]),e=1/(e-f),d[2]=d[0],d[3]=d[1],d[0]=a[0],d[1]=a[1];return a};h.fromRandom=function(a){a[0]=BigInteger(0xfffffffffffff*Math.random()<<0);a[1]=BigInteger(Math.abs(0xfffffffffffff*Math.random()<<0));return h.normalize(a,a)};h.sin=function(a,b){if(b[1].isZero())return h.copy(a,h.ZERO);h.scalar_multiply(a,
b,2);var d=h.create();h.pow(d,b,2);h.add(d,d,h.ONE);h.divide(a,a,d);return a};h.cos=function(a,b){if(b[1].isZero())return h.neg(a,h.ONE);var d=h.create();h.pow(d,b,2);h.sub(a,h.ONE,d);var e=h.create();h.add(e,h.ONE,d);h.divide(a,a,e);return a};h.tan=function(a,b){h.scalar_multiply(a,b,2);var d=h.create();h.pow(d,b,2);h.scalar_multiply(d,d,2);h.add(a,a,d);h.pow(d,b,4);h.sub(d,h.ONE,d);h.divide(a,a,d);return a};h.toEgyptian=function(a){a=h.clone(a);h.abs(a,a);var b=h.floor(a);b&&h.sub(a,a,h.fromInteger(b));
if(!a[0])return b.toString();b||(b="");for(var d=1,e=h.create();1!==a[0];)d++,e=h.fromValues(1,d),h.isGreaterThan(a,e)&&(b&&(b+=" + "),b+=h.str(e),h.sub(a,a,e));return a?b?b+" + "+h.str(a):h.str(a):b?b:"0"};h.toBabylonian=function(a){var b="",d=h.toDecimal(a);a=parseInt(d);for(var d=d-a,e=0,f=0;0<a;)(e=a%60)&&(b=e+" * 60^"+f+(b?" + ":"")+b),a=(a-e)/60,f++;for(f=-1;0<d;)d*=60,e=parseInt(d+1E-13),d-=e,-1E-13>d||(e&&(b+=(b?" + ":"")+e+" * 60^"+f),f--);return b?b:"0"};h.traceSternBrocot=function(a){var b=
"";if(h.equals(a,h.ZERO)||h.equals(a,h.ONE)||h.equals(a,h.INFINITY)||h.equals(a,h.INFINULL))return b;a=h.clone(a);h.isNegative(a)&&(a[0]=a[0].negate());for(var d=h.clone(h.ONE),e=[BigInteger(1),BigInteger(0),BigInteger(0),BigInteger(1)],f=0,k=0,g=65536;!h.equals(a,d)&&g--;)h.isLessThan(a,d)?(e[0]=e[0].add(e[1]),e[2]=e[2].add(e[3]),k++,f&&(b+="R",1!==f&&(b+=f),f=0,b+=" ")):(e[1]=e[1].add(e[0]),e[3]=e[3].add(e[2]),f++,k&&(b+="L",1!==k&&(b+=k),k=0,b+=" ")),d[0]=e[0].add(e[1]),d[1]=e[2].add(e[3]);k?(b+=
"L",1!==k&&(b+=k)):f&&(b+="R",1!==f&&(b+=f));0>g&&(b+="...");return b};h.toContinuedFraction=function(a,b){b="undefined"===typeof b?65536:parseInt(b);if(h.equals(a,h.ZERO))return[0];if(h.equals(a,h.ONE))return[1];if(h.equals(a,h.NEGONE))return[-1];if(h.equals(a,h.INFINITY))return[1,0];if(h.equals(a,h.INFINULL))return[0,0];var d=h.clone(a),e=h.isNegative(d);e&&(d[0]=d[0].negate());for(var f=h.clone(h.ONE),k=[BigInteger(1),BigInteger(0),BigInteger(0),BigInteger(1)],g=1,p=[0],m=p.length-1;!h.equals(d,
f)&&b--;)h.isLessThan(d,f)?(-1===g?p[m]++:(g=-1,p.push(1),m++),k[0]=k[0].add(k[1]),k[2]=k[2].add(k[3])):(1===g?p[m]++:(g=1,p.push(1),m++),k[1]=k[1].add(k[0]),k[3]=k[3].add(k[2])),f[0]=k[0].add(k[1]),f[1]=k[2].add(k[3]);0>b?p.push(0):p[m]++;if(e)for(var v in p)p[v]=-p[v];return p};h.fromContinuedFraction=function(a,b){h.fromInteger_copy(a,b[b.length-1]);for(var d=b.length-2;-1<d;d--)h.invert(a,a),h.add(a,h.fromInteger(b[d]),a);return a};h.fromFactorial=function(a,b){if("undefined"!==typeof factorial.PREPARED[b])return h.fromInteger_copy(a,
factorial.PREPARED[b]);var d=factorial.PREPARED.length-1;for(h.fromInteger_copy(a,factorial.PREPARED[d]);d<b;)h.scalar_multiply(a,a,++d);return a};h.dump=function(a){return"bigrat\t"+h.str(a)+"\n~\t"+h.toDecimal(a)+"\nCF:\t["+h.toContinuedFraction(a)+"]\n"};h.ZERO=h.fromInteger(0);h.ONE=h.fromInteger(1);h.NEGONE=h.fromInteger(-1);h.INFINITY=h.fromValues(1,0);h.INFINULL=h.fromValues(0,0);h.INFINITESIMAL=h.clone([new BigInteger(1),m]);h.PI=h.fromValues("3141592653589793238462643383279502884197169399375105820974944592307816406286208998628034825342117067982148086513282306647093844609550582231725359408128481117450284102701938521105559644622948954930381964428810975665933446128475648233786783165271201909145648566923460348610454326648213393607260249141273724587",
"1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000");"undefined"!==typeof a&&(a.bigrat=h);var v=function(a,b){this.a=e.fromValues(parseInt(a),parseInt(b))};v.prototype.toString=function(){return e.str(this.a)};v.prototype.toContinuedFraction=function(a){return e.toContinuedFraction(this.a,
a)};v.prototype.invert=function(){return e.invert(this.a)};v.prototype.reciprocal=v.prototype.invert;v.prototype.add=function(a){var b=e.create();e.add(b,this.a,a.a);return new v(b[0],b[1])};v.prototype.plus=v.prototype.add;v.prototype.subtract=function(a){var b=e.create();e.sub(b,this.a,a.a);return new v(b[0],b[1])};v.prototype.sub=v.prototype.subtract;v.prototype.minus=v.prototype.subtract;v.prototype.multiply=function(a){var b=e.create();e.mul(b,this.a,a.a);return new v(b[0],b[1])};v.prototype.mul=
v.prototype.multiply;v.prototype.times=v.prototype.multiply;v.prototype.mediant=function(a){var b=e.create();e.mediant(b,this.a,a.a);return new v(b[0],b[1])};v.prototype.divide=function(a){var b=e.create();e.div(b,this.a,a.a);return new v(b[0],b[1])};v.prototype.div=v.prototype.divide;v.prototype.divided_by=v.prototype.divide;v.prototype.power=function(a){var b=e.create();e.pow(b,this.a,a);return new v(b[0],b[1])};v.prototype.pow=v.prototype.power;v.prototype.dump=function(){return e.dump(this.a)};
v.prototype.toRat=function(){return e.clone(this.a)};v.prototype.toDecimal=function(){return e.toDecimal(this.a)};v.fromRat=function(a){var b=new v;b.a[0]=a[0];b.a[1]=a[1];return b};v.fromInteger=function(a){return v.fromRat(e.fromInteger(a))};v.fromIntegerInverse=function(a){return v.fromRat(e.fromIntegerInverse(a))};v.fromDecimal=function(a){return v.fromRat(e.fromDecimal(a))};v.fromContinuedFraction=function(a){return v.fromRat(e.fromContinuedFraction(e.create(),a))};"undefined"!==typeof a&&(a.rational=
v)})(m)})(this);(function(g,m){"object"===typeof module&&"object"===typeof module.exports?module.exports=g.document?m(g,!0):function(a){if(!a.document)throw Error("jQuery requires a window with a document");return m(a)}:m(g)})("undefined"!==typeof window?window:this,function(g,m){function a(a){var b=a.length,c=n.type(a);return"function"===c||n.isWindow(a)?!1:1===a.nodeType&&b?!0:"array"===c||0===b||"number"===typeof b&&0<b&&b-1 in a}function b(a,b,c){if(n.isFunction(b))return n.grep(a,function(a,T){return!!b.call(a,
T,a)!==c});if(b.nodeType)return n.grep(a,function(a){return a===b!==c});if("string"===typeof b){if(zb.test(b))return n.filter(b,a,c);b=n.filter(b,a)}return n.grep(a,function(a){return 0<=ya.call(b,a)!==c})}function d(a,b){for(;(a=a[b])&&1!==a.nodeType;);return a}function k(a){var b=kb[a]={};n.each(a.match(ua)||[],function(a,T){b[T]=!0});return b}function f(){S.removeEventListener("DOMContentLoaded",f,!1);g.removeEventListener("load",f,!1);n.ready()}function p(){Object.defineProperty(this.cache={},
0,{get:function(){return{}}});this.expando=n.expando+Math.random()}function e(a,b,c){if(void 0===c&&1===a.nodeType)if(c="data-"+b.replace(Oa,"-$1").toLowerCase(),c=a.getAttribute(c),"string"===typeof c){try{c="true"===c?!0:"false"===c?!1:"null"===c?null:+c+""===c?+c:Ab.test(c)?n.parseJSON(c):c}catch(d){}X.set(a,b,c)}else c=void 0;return c}function w(){return!0}function r(){return!1}function h(){try{return S.activeElement}catch(a){}}function v(a,b){return n.nodeName(a,"table")&&n.nodeName(11!==b.nodeType?
b:b.firstChild,"tr")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function c(a){a.type=(null!==a.getAttribute("type"))+"/"+a.type;return a}function t(a){var b=ab.exec(a.type);b?a.type=b[1]:a.removeAttribute("type");return a}function x(a,b){for(var c=0,d=a.length;c<d;c++)M.set(a[c],"globalEval",!b||M.get(b[c],"globalEval"))}function A(a,b){var c,d,e,l;if(1===b.nodeType){if(M.hasData(a)&&(l=M.access(a),c=M.set(b,l),l=l.events))for(e in delete c.handle,
c.events={},l)for(c=0,d=l[e].length;c<d;c++)n.event.add(b,e,l[e][c]);X.hasData(a)&&(e=X.access(a),e=n.extend({},e),X.set(b,e))}}function D(a,b){var c=a.getElementsByTagName?a.getElementsByTagName(b||"*"):a.querySelectorAll?a.querySelectorAll(b||"*"):[];return void 0===b||b&&n.nodeName(a,b)?n.merge([a],c):c}function E(a,b){var c,d=n(b.createElement(a)).appendTo(b.body),e=g.getDefaultComputedStyle&&(c=g.getDefaultComputedStyle(d[0]))?c.display:n.css(d[0],"display");d.detach();return e}function R(a){var b=
S,c=Pa[a];c||(c=E(a,b),"none"!==c&&c||(Qa=(Qa||n("<iframe frameborder='0' width='0' height='0'/>")).appendTo(b.documentElement),b=Qa[0].contentDocument,b.write(),b.close(),c=E(a,b),Qa.detach()),Pa[a]=c);return c}function H(a,b,c){var d,e,l=a.style;(c=c||Ra(a))&&(e=c.getPropertyValue(b)||c[b]);c&&(""!==e||n.contains(a.ownerDocument,a)||(e=n.style(a,b)),sa.test(e)&&Ea.test(b)&&(a=l.width,b=l.minWidth,d=l.maxWidth,l.minWidth=l.maxWidth=l.width=e,e=c.width,l.width=a,l.minWidth=b,l.maxWidth=d));return void 0!==
e?e+"":e}function L(a,b){return{get:function(){if(a())delete this.get;else return(this.get=b).apply(this,arguments)}}}function J(a,b){if(b in a)return b;for(var c=b[0].toUpperCase()+b.slice(1),d=b,e=pa.length;e--;)if(b=pa[e]+c,b in a)return b;return d}function K(a,b,c){return(a=ia.exec(b))?Math.max(0,a[1]-(c||0))+(a[2]||"px"):b}function C(a,b,c,d,e){b=c===(d?"border":"content")?4:"width"===b?1:0;for(var l=0;4>b;b+=2)"margin"===c&&(l+=n.css(a,c+Aa[b],!0,e)),d?("content"===c&&(l-=n.css(a,"padding"+
Aa[b],!0,e)),"margin"!==c&&(l-=n.css(a,"border"+Aa[b]+"Width",!0,e))):(l+=n.css(a,"padding"+Aa[b],!0,e),"padding"!==c&&(l+=n.css(a,"border"+Aa[b]+"Width",!0,e)));return l}function F(a,b,c){var d=!0,e="width"===b?a.offsetWidth:a.offsetHeight,l=Ra(a),f="border-box"===n.css(a,"boxSizing",!1,l);if(0>=e||null==e){e=H(a,b,l);if(0>e||null==e)e=a.style[b];if(sa.test(e))return e;d=f&&(ba.boxSizingReliable()||e===a.style[b]);e=parseFloat(e)||0}return e+C(a,b,c||(f?"border":"content"),d,l)+"px"}function P(a,
b){for(var c,d,e,l=[],f=0,h=a.length;f<h;f++)d=a[f],d.style&&(l[f]=M.get(d,"olddisplay"),c=d.style.display,b?(l[f]||"none"!==c||(d.style.display=""),""===d.style.display&&Ca(d)&&(l[f]=M.access(d,"olddisplay",R(d.nodeName)))):(e=Ca(d),"none"===c&&e||M.set(d,"olddisplay",e?c:n.css(d,"display"))));for(f=0;f<h;f++)d=a[f],!d.style||b&&"none"!==d.style.display&&""!==d.style.display||(d.style.display=b?l[f]||"":"none");return a}function l(a,b,c,d,e){return new l.prototype.init(a,b,c,d,e)}function q(){setTimeout(function(){Da=
void 0});return Da=n.now()}function B(a,b){var c,d=0,e={height:a};for(b=b?1:0;4>d;d+=2-b)c=Aa[d],e["margin"+c]=e["padding"+c]=a;b&&(e.opacity=e.width=a);return e}function z(a,b,c){for(var d,e=(O[b]||[]).concat(O["*"]),l=0,f=e.length;l<f;l++)if(d=e[l].call(c,b,a))return d}function I(a,b){var c,d,e,l,f;for(c in a)if(d=n.camelCase(c),e=b[d],l=a[c],n.isArray(l)&&(e=l[1],l=a[c]=l[0]),c!==d&&(a[d]=l,delete a[c]),(f=n.cssHooks[d])&&"expand"in f)for(c in l=f.expand(l),delete a[d],l)c in a||(a[c]=l[c],b[c]=
e);else b[d]=e}function Z(a,b,c){var d,e=0,l=U.length,f=n.Deferred().always(function(){delete h.elem}),h=function(){if(d)return!1;for(var b=Da||q(),b=Math.max(0,k.startTime+k.duration-b),u=1-(b/k.duration||0),c=0,e=k.tweens.length;c<e;c++)k.tweens[c].run(u);f.notifyWith(a,[k,u,b]);if(1>u&&e)return b;f.resolveWith(a,[k]);return!1},k=f.promise({elem:a,props:n.extend({},b),opts:n.extend(!0,{specialEasing:{}},c),originalProperties:b,originalOptions:c,startTime:Da||q(),duration:c.duration,tweens:[],createTween:function(b,
u){var c=n.Tween(a,k.opts,b,u,k.opts.specialEasing[b]||k.opts.easing);k.tweens.push(c);return c},stop:function(b){var u=0,c=b?k.tweens.length:0;if(d)return this;for(d=!0;u<c;u++)k.tweens[u].run(1);b?f.resolveWith(a,[k,b]):f.rejectWith(a,[k,b]);return this}});c=k.props;for(I(c,k.opts.specialEasing);e<l;e++)if(b=U[e].call(k,a,c,k.opts))return b;n.map(c,z,k);n.isFunction(k.opts.start)&&k.opts.start.call(a,k);n.fx.timer(n.extend(h,{elem:a,anim:k,queue:k.opts.queue}));return k.progress(k.opts.progress).done(k.opts.done,
k.opts.complete).fail(k.opts.fail).always(k.opts.always)}function Q(a){return function(b,c){"string"!==typeof b&&(c=b,b="*");var d,e=0,l=b.toLowerCase().match(ua)||[];if(n.isFunction(c))for(;d=l[e++];)"+"===d[0]?(d=d.slice(1)||"*",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c)}}function ma(a,b,c,d){function e(h){var k;l[h]=!0;n.each(a[h]||[],function(a,u){var T=u(b,c,d);if("string"===typeof T&&!f&&!l[T])return b.dataTypes.unshift(T),e(T),!1;if(f)return!(k=T)});return k}var l={},f=a===bb;return e(b.dataTypes[0])||
!l["*"]&&e("*")}function Y(a,b){var c,d,e=n.ajaxSettings.flatOptions||{};for(c in b)void 0!==b[c]&&((e[c]?a:d||(d={}))[c]=b[c]);d&&n.extend(!0,a,d);return a}function V(a,b,c,d){var e;if(n.isArray(b))n.each(b,function(b,e){c||Ja.test(a)?d(a,e):V(a+"["+("object"===typeof e?b:"")+"]",e,c,d)});else if(c||"object"!==n.type(b))d(a,b);else for(e in b)V(a+"["+e+"]",b[e],c,d)}function la(a){return n.isWindow(a)?a:9===a.nodeType&&a.defaultView}var ja=[],da=ja.slice,na=ja.concat,va=ja.push,ya=ja.indexOf,wa=
{},Ka=wa.toString,ra=wa.hasOwnProperty,ba={},S=g.document,n=function(a,b){return new n.fn.init(a,b)},Sa=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,La=/^-ms-/,lb=/-([\da-z])/gi,cb=function(a,b){return b.toUpperCase()};n.fn=n.prototype={jquery:"2.1.1",constructor:n,selector:"",length:0,toArray:function(){return da.call(this)},get:function(a){return null!=a?0>a?this[a+this.length]:this[a]:da.call(this)},pushStack:function(a){a=n.merge(this.constructor(),a);a.prevObject=this;a.context=this.context;return a},
each:function(a,b){return n.each(this,a,b)},map:function(a){return this.pushStack(n.map(this,function(b,c){return a.call(b,c,b)}))},slice:function(){return this.pushStack(da.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var b=this.length;a=+a+(0>a?b:0);return this.pushStack(0<=a&&a<b?[this[a]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:va,sort:ja.sort,splice:ja.splice};n.extend=n.fn.extend=function(){var a,
b,c,d,e,l=arguments[0]||{},f=1,h=arguments.length,k=!1;"boolean"===typeof l&&(k=l,l=arguments[f]||{},f++);"object"===typeof l||n.isFunction(l)||(l={});f===h&&(l=this,f--);for(;f<h;f++)if(null!=(a=arguments[f]))for(b in a)c=l[b],d=a[b],l!==d&&(k&&d&&(n.isPlainObject(d)||(e=n.isArray(d)))?(e?(e=!1,c=c&&n.isArray(c)?c:[]):c=c&&n.isPlainObject(c)?c:{},l[b]=n.extend(k,c,d)):void 0!==d&&(l[b]=d));return l};n.extend({expando:"jQuery"+("2.1.1"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(a){throw Error(a);
},noop:function(){},isFunction:function(a){return"function"===n.type(a)},isArray:Array.isArray,isWindow:function(a){return null!=a&&a===a.window},isNumeric:function(a){return!n.isArray(a)&&0<=a-parseFloat(a)},isPlainObject:function(a){return"object"!==n.type(a)||a.nodeType||n.isWindow(a)||a.constructor&&!ra.call(a.constructor.prototype,"isPrototypeOf")?!1:!0},isEmptyObject:function(a){for(var b in a)return!1;return!0},type:function(a){return null==a?a+"":"object"===typeof a||"function"===typeof a?
wa[Ka.call(a)]||"object":typeof a},globalEval:function(a){var b;b=eval;if(a=n.trim(a))1===a.indexOf("use strict")?(b=S.createElement("script"),b.text=a,S.head.appendChild(b).parentNode.removeChild(b)):b(a)},camelCase:function(a){return a.replace(La,"ms-").replace(lb,cb)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()},each:function(b,c,d){var e,l=0,f=b.length;e=a(b);if(d)if(e)for(;l<f&&(e=c.apply(b[l],d),!1!==e);l++);else for(l in b){if(e=c.apply(b[l],d),!1===
e)break}else if(e)for(;l<f&&(e=c.call(b[l],l,b[l]),!1!==e);l++);else for(l in b)if(e=c.call(b[l],l,b[l]),!1===e)break;return b},trim:function(a){return null==a?"":(a+"").replace(Sa,"")},makeArray:function(b,c){var d=c||[];null!=b&&(a(Object(b))?n.merge(d,"string"===typeof b?[b]:b):va.call(d,b));return d},inArray:function(a,b,c){return null==b?-1:ya.call(b,a,c)},merge:function(a,b){for(var c=+b.length,d=0,e=a.length;d<c;d++)a[e++]=b[d];a.length=e;return a},grep:function(a,b,c){for(var d=[],e=0,l=a.length,
f=!c;e<l;e++)c=!b(a[e],e),c!==f&&d.push(a[e]);return d},map:function(b,c,d){var e,l=0,f=b.length,h=[];if(a(b))for(;l<f;l++)e=c(b[l],l,d),null!=e&&h.push(e);else for(l in b)e=c(b[l],l,d),null!=e&&h.push(e);return na.apply([],h)},guid:1,proxy:function(a,b){var c,d;"string"===typeof b&&(c=a[b],b=a,a=c);if(n.isFunction(a))return d=da.call(arguments,2),c=function(){return a.apply(b||this,d.concat(da.call(arguments)))},c.guid=a.guid=a.guid||n.guid++,c},now:Date.now,support:ba});n.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),
function(a,b){wa["[object "+b+"]"]=b.toLowerCase()});var Fa=function(a){function b(a,c,d,e){var l,f,y,h,k;(c?c.ownerDocument||c:L)!==F&&D(c);c=c||F;d=d||[];if(!a||"string"!==typeof a)return d;if(1!==(h=c.nodeType)&&9!==h)return[];if(E&&!e){if(l=qa.exec(a))if(y=l[1])if(9===h)if((f=c.getElementById(y))&&f.parentNode){if(f.id===y)return d.push(f),d}else return d;else{if(c.ownerDocument&&(f=c.ownerDocument.getElementById(y))&&ma(c,f)&&f.id===y)return d.push(f),d}else{if(l[2])return na.apply(d,c.getElementsByTagName(a)),
d;if((y=l[3])&&v.getElementsByClassName&&c.getElementsByClassName)return na.apply(d,c.getElementsByClassName(y)),d}if(v.qsa&&(!K||!K.test(a))){f=l=V;y=c;k=9===h&&a;if(1===h&&"object"!==c.nodeName.toLowerCase()){h=C(a);(l=c.getAttribute("id"))?f=l.replace(sa,"\\$&"):c.setAttribute("id",f);f="[id='"+f+"'] ";for(y=h.length;y--;)h[y]=f+N(h[y]);y=La.test(a)&&u(c.parentNode)||c;k=h.join(",")}if(k)try{return na.apply(d,y.querySelectorAll(k)),d}catch(T){}finally{l||c.removeAttribute("id")}}}return Z(a.replace(aa,
"$1"),c,d,e)}function c(){function a(u,c){b.push(u+" ")>I.cacheLength&&delete a[b.shift()];return a[u+" "]=c}var b=[];return a}function d(a){a[V]=!0;return a}function e(a){var b=F.createElement("div");try{return!!a(b)}catch(u){return!1}finally{b.parentNode&&b.parentNode.removeChild(b)}}function l(a,b){for(var u=a.split("|"),c=a.length;c--;)I.attrHandle[u[c]]=b}function f(a,b){var u=b&&a,c=u&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||-2147483648)-(~a.sourceIndex||-2147483648);if(c)return c;
if(u)for(;u=u.nextSibling;)if(u===b)return-1;return a?1:-1}function h(a){return function(b){return"input"===b.nodeName.toLowerCase()&&b.type===a}}function k(a){return function(b){var u=b.nodeName.toLowerCase();return("input"===u||"button"===u)&&b.type===a}}function g(a){return d(function(b){b=+b;return d(function(u,c){for(var d,e=a([],u.length,b),l=e.length;l--;)u[d=e[l]]&&(u[d]=!(c[d]=u[d]))})})}function u(a){return a&&"undefined"!==typeof a.getElementsByTagName&&a}function y(){}function N(a){for(var b=
0,u=a.length,c="";b<u;b++)c+=a[b].value;return c}function q(a,b,u){var c=b.dir,d=u&&"parentNode"===c,e=ja++;return b.first?function(b,u,e){for(;b=b[c];)if(1===b.nodeType||d)return a(b,u,e)}:function(b,u,l){var f,y,h=[Y,e];if(l)for(;b=b[c];){if((1===b.nodeType||d)&&a(b,u,l))return!0}else for(;b=b[c];)if(1===b.nodeType||d){y=b[V]||(b[V]={});if((f=y[c])&&f[0]===Y&&f[1]===e)return h[2]=f[2];y[c]=h;if(h[2]=a(b,u,l))return!0}}}function p(a){return 1<a.length?function(b,u,c){for(var d=a.length;d--;)if(!a[d](b,
u,c))return!1;return!0}:a[0]}function B(a,b,u,c,d){for(var e,l=[],f=0,y=a.length,h=null!=b;f<y;f++)if(e=a[f])if(!u||u(e,c,d))l.push(e),h&&b.push(f);return l}function z(a,u,c,e,l,f){e&&!e[V]&&(e=z(e));l&&!l[V]&&(l=z(l,f));return d(function(d,f,y,h){var k,T,N=[],g=[],q=f.length,p;if(!(p=d)){p=u||"*";for(var ca=y.nodeType?[y]:y,z=[],n=0,t=ca.length;n<t;n++)b(p,ca[n],z);p=z}p=!a||!d&&u?p:B(p,N,a,y,h);ca=c?l||(d?a:q||e)?[]:f:p;c&&c(p,ca,y,h);if(e)for(k=B(ca,g),e(k,[],y,h),y=k.length;y--;)if(T=k[y])ca[g[y]]=
!(p[g[y]]=T);if(d){if(l||a){if(l){k=[];for(y=ca.length;y--;)(T=ca[y])&&k.push(p[y]=T);l(null,ca=[],k,h)}for(y=ca.length;y--;)(T=ca[y])&&-1<(k=l?ra.call(d,T):N[y])&&(d[k]=!(f[k]=T))}}else ca=B(ca===f?ca.splice(q,ca.length):ca),l?l(null,f,ca,h):na.apply(f,ca)})}function n(a){var b,u,c,d=a.length,e=I.relative[a[0].type];u=e||I.relative[" "];for(var l=e?1:0,f=q(function(a){return a===b},u,!0),y=q(function(a){return-1<ra.call(b,a)},u,!0),h=[function(a,u,c){return!e&&(c||u!==J)||((b=u).nodeType?f(a,u,c):
y(a,u,c))}];l<d;l++)if(u=I.relative[a[l].type])h=[q(p(h),u)];else{u=I.filter[a[l].type].apply(null,a[l].matches);if(u[V]){for(c=++l;c<d&&!I.relative[a[c].type];c++);return z(1<l&&p(h),1<l&&N(a.slice(0,l-1).concat({value:" "===a[l-2].type?"*":""})).replace(aa,"$1"),u,l<c&&n(a.slice(l,c)),c<d&&n(a=a.slice(c)),c<d&&N(a))}h.push(u)}return p(h)}function t(a,u){var c=0<u.length,e=0<a.length,l=function(d,l,f,y,h){var k,T,N,g=0,q="0",p=d&&[],ca=[],z=J,n=d||e&&I.find.TAG("*",h),t=Y+=null==z?1:Math.random()||
.1,m=n.length;for(h&&(J=l!==F&&l);q!==m&&null!=(k=n[q]);q++){if(e&&k){for(T=0;N=a[T++];)if(N(k,l,f)){y.push(k);break}h&&(Y=t)}c&&((k=!N&&k)&&g--,d&&p.push(k))}g+=q;if(c&&q!==g){for(T=0;N=u[T++];)N(p,ca,l,f);if(d){if(0<g)for(;q--;)p[q]||ca[q]||(ca[q]=ba.call(y));ca=B(ca)}na.apply(y,ca);h&&!d&&0<ca.length&&1<g+u.length&&b.uniqueSort(y)}h&&(Y=t,J=z);return p};return c?d(l):l}var m,v,I,r,x,C,w,Z,J,A,Q,D,F,R,E,K,P,H,ma,V="sizzle"+-new Date,L=a.document,Y=0,ja=0,G=c(),la=c(),S=c(),da=function(a,b){a===
b&&(Q=!0);return 0},O={}.hasOwnProperty,M=[],ba=M.pop,va=M.push,na=M.push,U=M.slice,ra=M.indexOf||function(a){for(var b=0,u=this.length;b<u;b++)if(this[b]===a)return b;return-1},W="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+".replace("w","w#"),Sa="\\[[\\x20\\t\\r\\n\\f]*((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)(?:[\\x20\\t\\r\\n\\f]*([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+W+"))|)[\\x20\\t\\r\\n\\f]*\\]",X=":((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+
Sa+")*)|.*)\\)|)",aa=/^[\x20\t\r\n\f]+|((?:^|[^\\])(?:\\.)*)[\x20\t\r\n\f]+$/g,ya=/^[\x20\t\r\n\f]*,[\x20\t\r\n\f]*/,ea=/^[\x20\t\r\n\f]*([>+~]|[\x20\t\r\n\f])[\x20\t\r\n\f]*/,fa=/=[\x20\t\r\n\f]*([^\]'"]*?)[\x20\t\r\n\f]*\]/g,ka=new RegExp(X),Ka=new RegExp("^"+W+"$"),wa={ID:/^#((?:\\.|[\w-]|[^\x00-\xa0])+)/,CLASS:/^\.((?:\\.|[\w-]|[^\x00-\xa0])+)/,TAG:new RegExp("^("+"(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+".replace("w","w*")+")"),ATTR:new RegExp("^"+Sa),PSEUDO:new RegExp("^"+X),CHILD:/^:(only|first|last|nth|nth-last)-(child|of-type)(?:\([\x20\t\r\n\f]*(even|odd|(([+-]|)(\d*)n|)[\x20\t\r\n\f]*(?:([+-]|)[\x20\t\r\n\f]*(\d+)|))[\x20\t\r\n\f]*\)|)/i,
bool:/^(?:checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)$/i,needsContext:/^[\x20\t\r\n\f]*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\([\x20\t\r\n\f]*((?:-\d)?\d*)[\x20\t\r\n\f]*\)|)(?=[^-]|$)/i},oa=/^(?:input|select|textarea|button)$/i,pa=/^h\d$/i,ia=/^[^{]+\{\s*\[native \w/,qa=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,La=/[+~]/,sa=/'|\\/g,ga=/\\([\da-f]{1,6}[\x20\t\r\n\f]?|([\x20\t\r\n\f])|.)/ig,ha=function(a,b,u){a="0x"+b-65536;
return a!==a||u?b:0>a?String.fromCharCode(a+65536):String.fromCharCode(a>>10|55296,a&1023|56320)};try{na.apply(M=U.call(L.childNodes),L.childNodes),M[L.childNodes.length].nodeType}catch(ua){na={apply:M.length?function(a,b){va.apply(a,U.call(b))}:function(a,b){for(var u=a.length,c=0;a[u++]=b[c++];);a.length=u-1}}}v=b.support={};x=b.isXML=function(a){return(a=a&&(a.ownerDocument||a).documentElement)?"HTML"!==a.nodeName:!1};D=b.setDocument=function(a){var b=a?a.ownerDocument||a:L;a=b.defaultView;if(b===
F||9!==b.nodeType||!b.documentElement)return F;F=b;R=b.documentElement;E=!x(b);a&&a!==a.top&&(a.addEventListener?a.addEventListener("unload",function(){D()},!1):a.attachEvent&&a.attachEvent("onunload",function(){D()}));v.attributes=e(function(a){a.className="i";return!a.getAttribute("className")});v.getElementsByTagName=e(function(a){a.appendChild(b.createComment(""));return!a.getElementsByTagName("*").length});v.getElementsByClassName=ia.test(b.getElementsByClassName)&&e(function(a){a.innerHTML=
"<div class='a'></div><div class='a i'></div>";a.firstChild.className="i";return 2===a.getElementsByClassName("i").length});v.getById=e(function(a){R.appendChild(a).id=V;return!b.getElementsByName||!b.getElementsByName(V).length});v.getById?(I.find.ID=function(a,b){if("undefined"!==typeof b.getElementById&&E){var u=b.getElementById(a);return u&&u.parentNode?[u]:[]}},I.filter.ID=function(a){var b=a.replace(ga,ha);return function(a){return a.getAttribute("id")===b}}):(delete I.find.ID,I.filter.ID=function(a){var b=
a.replace(ga,ha);return function(a){return(a="undefined"!==typeof a.getAttributeNode&&a.getAttributeNode("id"))&&a.value===b}});I.find.TAG=v.getElementsByTagName?function(a,b){if("undefined"!==typeof b.getElementsByTagName)return b.getElementsByTagName(a)}:function(a,b){var u,c=[],d=0,e=b.getElementsByTagName(a);if("*"===a){for(;u=e[d++];)1===u.nodeType&&c.push(u);return c}return e};I.find.CLASS=v.getElementsByClassName&&function(a,b){if("undefined"!==typeof b.getElementsByClassName&&E)return b.getElementsByClassName(a)};
P=[];K=[];if(v.qsa=ia.test(b.querySelectorAll))e(function(a){a.innerHTML="<select msallowclip=''><option selected=''></option></select>";a.querySelectorAll("[msallowclip^='']").length&&K.push("[*^$]=[\\x20\\t\\r\\n\\f]*(?:''|\"\")");a.querySelectorAll("[selected]").length||K.push("\\[[\\x20\\t\\r\\n\\f]*(?:value|checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)");a.querySelectorAll(":checked").length||K.push(":checked")}),e(function(a){var u=
b.createElement("input");u.setAttribute("type","hidden");a.appendChild(u).setAttribute("name","D");a.querySelectorAll("[name=d]").length&&K.push("name[\\x20\\t\\r\\n\\f]*[*^$|!~]?=");a.querySelectorAll(":enabled").length||K.push(":enabled",":disabled");a.querySelectorAll("*,:x");K.push(",.*:")});(v.matchesSelector=ia.test(H=R.matches||R.webkitMatchesSelector||R.mozMatchesSelector||R.oMatchesSelector||R.msMatchesSelector))&&e(function(a){v.disconnectedMatch=H.call(a,"div");H.call(a,"[s!='']:x");P.push("!=",
X)});K=K.length&&new RegExp(K.join("|"));P=P.length&&new RegExp(P.join("|"));ma=(a=ia.test(R.compareDocumentPosition))||ia.test(R.contains)?function(a,b){var u=9===a.nodeType?a.documentElement:a,c=b&&b.parentNode;return a===c||!!(c&&1===c.nodeType&&(u.contains?u.contains(c):a.compareDocumentPosition&&a.compareDocumentPosition(c)&16))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1};da=a?function(a,u){if(a===u)return Q=!0,0;var c=!a.compareDocumentPosition-!u.compareDocumentPosition;
if(c)return c;c=(a.ownerDocument||a)===(u.ownerDocument||u)?a.compareDocumentPosition(u):1;return c&1||!v.sortDetached&&u.compareDocumentPosition(a)===c?a===b||a.ownerDocument===L&&ma(L,a)?-1:u===b||u.ownerDocument===L&&ma(L,u)?1:A?ra.call(A,a)-ra.call(A,u):0:c&4?-1:1}:function(a,u){if(a===u)return Q=!0,0;var c,d=0;c=a.parentNode;var e=u.parentNode,l=[a],y=[u];if(!c||!e)return a===b?-1:u===b?1:c?-1:e?1:A?ra.call(A,a)-ra.call(A,u):0;if(c===e)return f(a,u);for(c=a;c=c.parentNode;)l.unshift(c);for(c=
u;c=c.parentNode;)y.unshift(c);for(;l[d]===y[d];)d++;return d?f(l[d],y[d]):l[d]===L?-1:y[d]===L?1:0};return b};b.matches=function(a,u){return b(a,null,null,u)};b.matchesSelector=function(a,u){(a.ownerDocument||a)!==F&&D(a);u=u.replace(fa,"='$1']");if(!(!v.matchesSelector||!E||P&&P.test(u)||K&&K.test(u)))try{var c=H.call(a,u);if(c||v.disconnectedMatch||a.document&&11!==a.document.nodeType)return c}catch(d){}return 0<b(u,F,null,[a]).length};b.contains=function(a,b){(a.ownerDocument||a)!==F&&D(a);return ma(a,
b)};b.attr=function(a,b){(a.ownerDocument||a)!==F&&D(a);var u=I.attrHandle[b.toLowerCase()],u=u&&O.call(I.attrHandle,b.toLowerCase())?u(a,b,!E):void 0;return void 0!==u?u:v.attributes||!E?a.getAttribute(b):(u=a.getAttributeNode(b))&&u.specified?u.value:null};b.error=function(a){throw Error("Syntax error, unrecognized expression: "+a);};b.uniqueSort=function(a){var b,u=[],c=0,d=0;Q=!v.detectDuplicates;A=!v.sortStable&&a.slice(0);a.sort(da);if(Q){for(;b=a[d++];)b===a[d]&&(c=u.push(d));for(;c--;)a.splice(u[c],
1)}A=null;return a};r=b.getText=function(a){var b,u="",c=0;b=a.nodeType;if(!b)for(;b=a[c++];)u+=r(b);else if(1===b||9===b||11===b){if("string"===typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)u+=r(a)}else if(3===b||4===b)return a.nodeValue;return u};I=b.selectors={cacheLength:50,createPseudo:d,match:wa,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){a[1]=
a[1].replace(ga,ha);a[3]=(a[3]||a[4]||a[5]||"").replace(ga,ha);"~="===a[2]&&(a[3]=" "+a[3]+" ");return a.slice(0,4)},CHILD:function(a){a[1]=a[1].toLowerCase();"nth"===a[1].slice(0,3)?(a[3]||b.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&b.error(a[0]);return a},PSEUDO:function(a){var b,u=!a[6]&&a[2];if(wa.CHILD.test(a[0]))return null;a[3]?a[2]=a[4]||a[5]||"":u&&ka.test(u)&&(b=C(u,!0))&&(b=u.indexOf(")",u.length-b)-u.length)&&(a[0]=a[0].slice(0,
b),a[2]=u.slice(0,b));return a.slice(0,3)}},filter:{TAG:function(a){var b=a.replace(ga,ha).toLowerCase();return"*"===a?function(){return!0}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b}},CLASS:function(a){var b=G[a+" "];return b||(b=new RegExp("(^|[\\x20\\t\\r\\n\\f])"+a+"([\\x20\\t\\r\\n\\f]|$)"))&&G(a,function(a){return b.test("string"===typeof a.className&&a.className||"undefined"!==typeof a.getAttribute&&a.getAttribute("class")||"")})},ATTR:function(a,u,c){return function(d){d=
b.attr(d,a);if(null==d)return"!="===u;if(!u)return!0;d+="";return"="===u?d===c:"!="===u?d!==c:"^="===u?c&&0===d.indexOf(c):"*="===u?c&&-1<d.indexOf(c):"$="===u?c&&d.slice(-c.length)===c:"~="===u?-1<(" "+d+" ").indexOf(c):"|="===u?d===c||d.slice(0,c.length+1)===c+"-":!1}},CHILD:function(a,b,u,c,d){var e="nth"!==a.slice(0,3),l="last"!==a.slice(-4),y="of-type"===b;return 1===c&&0===d?function(a){return!!a.parentNode}:function(b,u,f){var h,k,T,N,g;u=e!==l?"nextSibling":"previousSibling";var q=b.parentNode,
ca=y&&b.nodeName.toLowerCase();f=!f&&!y;if(q){if(e){for(;u;){for(k=b;k=k[u];)if(y?k.nodeName.toLowerCase()===ca:1===k.nodeType)return!1;g=u="only"===a&&!g&&"nextSibling"}return!0}g=[l?q.firstChild:q.lastChild];if(l&&f)for(f=q[V]||(q[V]={}),h=f[a]||[],N=h[0]===Y&&h[1],T=h[0]===Y&&h[2],k=N&&q.childNodes[N];k=++N&&k&&k[u]||(T=N=0)||g.pop();){if(1===k.nodeType&&++T&&k===b){f[a]=[Y,N,T];break}}else if(f&&(h=(b[V]||(b[V]={}))[a])&&h[0]===Y)T=h[1];else for(;(k=++N&&k&&k[u]||(T=N=0)||g.pop())&&((y?k.nodeName.toLowerCase()!==
ca:1!==k.nodeType)||!++T||(f&&((k[V]||(k[V]={}))[a]=[Y,T]),k!==b)););T-=d;return T===c||0===T%c&&0<=T/c}}},PSEUDO:function(a,u){var c,e=I.pseudos[a]||I.setFilters[a.toLowerCase()]||b.error("unsupported pseudo: "+a);return e[V]?e(u):1<e.length?(c=[a,a,"",u],I.setFilters.hasOwnProperty(a.toLowerCase())?d(function(a,b){for(var c,d=e(a,u),l=d.length;l--;)c=ra.call(a,d[l]),a[c]=!(b[c]=d[l])}):function(a){return e(a,0,c)}):e}},pseudos:{not:d(function(a){var b=[],u=[],c=w(a.replace(aa,"$1"));return c[V]?
d(function(a,b,u,d){d=c(a,null,d,[]);for(var e=a.length;e--;)if(u=d[e])a[e]=!(b[e]=u)}):function(a,d,e){b[0]=a;c(b,null,e,u);return!u.pop()}}),has:d(function(a){return function(u){return 0<b(a,u).length}}),contains:d(function(a){return function(b){return-1<(b.textContent||b.innerText||r(b)).indexOf(a)}}),lang:d(function(a){Ka.test(a||"")||b.error("unsupported lang: "+a);a=a.replace(ga,ha).toLowerCase();return function(b){var u;do if(u=E?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang"))return u=
u.toLowerCase(),u===a||0===u.indexOf(a+"-");while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(b){var u=a.location&&a.location.hash;return u&&u.slice(1)===b.id},root:function(a){return a===R},focus:function(a){return a===F.activeElement&&(!F.hasFocus||F.hasFocus())&&!!(a.type||a.href||~a.tabIndex)},enabled:function(a){return!1===a.disabled},disabled:function(a){return!0===a.disabled},checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&
!!a.selected},selected:function(a){a.parentNode&&a.parentNode.selectedIndex;return!0===a.selected},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if(6>a.nodeType)return!1;return!0},parent:function(a){return!I.pseudos.empty(a)},header:function(a){return pa.test(a.nodeName)},input:function(a){return oa.test(a.nodeName)},button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},text:function(a){var b;return"input"===a.nodeName.toLowerCase()&&"text"===
a.type&&(null==(b=a.getAttribute("type"))||"text"===b.toLowerCase())},first:g(function(){return[0]}),last:g(function(a,b){return[b-1]}),eq:g(function(a,b,u){return[0>u?u+b:u]}),even:g(function(a,b){for(var u=0;u<b;u+=2)a.push(u);return a}),odd:g(function(a,b){for(var u=1;u<b;u+=2)a.push(u);return a}),lt:g(function(a,b,u){for(b=0>u?u+b:u;0<=--b;)a.push(b);return a}),gt:g(function(a,b,u){for(u=0>u?u+b:u;++u<b;)a.push(u);return a})}};I.pseudos.nth=I.pseudos.eq;for(m in{radio:!0,checkbox:!0,file:!0,password:!0,
image:!0})I.pseudos[m]=h(m);for(m in{submit:!0,reset:!0})I.pseudos[m]=k(m);y.prototype=I.filters=I.pseudos;I.setFilters=new y;C=b.tokenize=function(a,u){var c,d,e,l,y,f,h;if(y=la[a+" "])return u?0:y.slice(0);y=a;f=[];for(h=I.preFilter;y;){if(!c||(d=ya.exec(y)))d&&(y=y.slice(d[0].length)||y),f.push(e=[]);c=!1;if(d=ea.exec(y))c=d.shift(),e.push({value:c,type:d[0].replace(aa," ")}),y=y.slice(c.length);for(l in I.filter)!(d=wa[l].exec(y))||h[l]&&!(d=h[l](d))||(c=d.shift(),e.push({value:c,type:l,matches:d}),
y=y.slice(c.length));if(!c)break}return u?y.length:y?b.error(a):la(a,f).slice(0)};w=b.compile=function(a,b){var u,c=[],d=[],e=S[a+" "];if(!e){b||(b=C(a));for(u=b.length;u--;)e=n(b[u]),e[V]?c.push(e):d.push(e);e=S(a,t(d,c));e.selector=a}return e};Z=b.select=function(a,b,c,d){var e,l,y,f,h="function"===typeof a&&a,k=!d&&C(a=h.selector||a);c=c||[];if(1===k.length){l=k[0]=k[0].slice(0);if(2<l.length&&"ID"===(y=l[0]).type&&v.getById&&9===b.nodeType&&E&&I.relative[l[1].type]){b=(I.find.ID(y.matches[0].replace(ga,
ha),b)||[])[0];if(!b)return c;h&&(b=b.parentNode);a=a.slice(l.shift().value.length)}for(e=wa.needsContext.test(a)?0:l.length;e--;){y=l[e];if(I.relative[f=y.type])break;if(f=I.find[f])if(d=f(y.matches[0].replace(ga,ha),La.test(l[0].type)&&u(b.parentNode)||b)){l.splice(e,1);a=d.length&&N(l);if(!a)return na.apply(c,d),c;break}}}(h||w(a,k))(d,b,!E,c,La.test(a)&&u(b.parentNode)||b);return c};v.sortStable=V.split("").sort(da).join("")===V;v.detectDuplicates=!!Q;D();v.sortDetached=e(function(a){return a.compareDocumentPosition(F.createElement("div"))&
1});e(function(a){a.innerHTML="<a href='#'></a>";return"#"===a.firstChild.getAttribute("href")})||l("type|href|height|width",function(a,b,u){if(!u)return a.getAttribute(b,"type"===b.toLowerCase()?1:2)});v.attributes&&e(function(a){a.innerHTML="<input/>";a.firstChild.setAttribute("value","");return""===a.firstChild.getAttribute("value")})||l("value",function(a,b,u){if(!u&&"input"===a.nodeName.toLowerCase())return a.defaultValue});e(function(a){return null==a.getAttribute("disabled")})||l("checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",
function(a,b,u){var c;if(!u)return!0===a[b]?b.toLowerCase():(c=a.getAttributeNode(b))&&c.specified?c.value:null});return b}(g);n.find=Fa;n.expr=Fa.selectors;n.expr[":"]=n.expr.pseudos;n.unique=Fa.uniqueSort;n.text=Fa.getText;n.isXMLDoc=Fa.isXML;n.contains=Fa.contains;var mb=n.expr.match.needsContext,nb=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,zb=/^.[^:#\[\.,]*$/;n.filter=function(a,b,c){var d=b[0];c&&(a=":not("+a+")");return 1===b.length&&1===d.nodeType?n.find.matchesSelector(d,a)?[d]:[]:n.find.matches(a,n.grep(b,
function(a){return 1===a.nodeType}))};n.fn.extend({find:function(a){var b,c=this.length,d=[],e=this;if("string"!==typeof a)return this.pushStack(n(a).filter(function(){for(b=0;b<c;b++)if(n.contains(e[b],this))return!0}));for(b=0;b<c;b++)n.find(a,e[b],d);d=this.pushStack(1<c?n.unique(d):d);d.selector=this.selector?this.selector+" "+a:a;return d},filter:function(a){return this.pushStack(b(this,a||[],!1))},not:function(a){return this.pushStack(b(this,a||[],!0))},is:function(a){return!!b(this,"string"===
typeof a&&mb.test(a)?n(a):a||[],!1).length}});var Ta,Db=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/;(n.fn.init=function(a,b){var c;if(!a)return this;if("string"===typeof a){c="<"===a[0]&&">"===a[a.length-1]&&3<=a.length?[null,a,null]:Db.exec(a);if(!c||!c[1]&&b)return!b||b.jquery?(b||Ta).find(a):this.constructor(b).find(a);if(c[1]){if(b=b instanceof n?b[0]:b,n.merge(this,n.parseHTML(c[1],b&&b.nodeType?b.ownerDocument||b:S,!0)),nb.test(c[1])&&n.isPlainObject(b))for(c in b)if(n.isFunction(this[c]))this[c](b[c]);
else this.attr(c,b[c])}else(c=S.getElementById(c[2]))&&c.parentNode&&(this.length=1,this[0]=c),this.context=S,this.selector=a;return this}if(a.nodeType)return this.context=this[0]=a,this.length=1,this;if(n.isFunction(a))return"undefined"!==typeof Ta.ready?Ta.ready(a):a(n);void 0!==a.selector&&(this.selector=a.selector,this.context=a.context);return n.makeArray(a,this)}).prototype=n.fn;Ta=n(S);var Ua=/^(?:parents|prev(?:Until|All))/,db={children:!0,contents:!0,next:!0,prev:!0};n.extend({dir:function(a,
b,c){for(var d=[],e=void 0!==c;(a=a[b])&&9!==a.nodeType;)if(1===a.nodeType){if(e&&n(a).is(c))break;d.push(a)}return d},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c}});n.fn.extend({has:function(a){var b=n(a,this),c=b.length;return this.filter(function(){for(var a=0;a<c;a++)if(n.contains(this,b[a]))return!0})},closest:function(a,b){for(var c,d=0,e=this.length,l=[],f=mb.test(a)||"string"!==typeof a?n(a,b||this.context):0;d<e;d++)for(c=this[d];c&&c!==
b;c=c.parentNode)if(11>c.nodeType&&(f?-1<f.index(c):1===c.nodeType&&n.find.matchesSelector(c,a))){l.push(c);break}return this.pushStack(1<l.length?n.unique(l):l)},index:function(a){return a?"string"===typeof a?ya.call(n(a),this[0]):ya.call(this,a.jquery?a[0]:a):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(a,b){return this.pushStack(n.unique(n.merge(this.get(),n(a,b))))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}});n.each({parent:function(a){return(a=
a.parentNode)&&11!==a.nodeType?a:null},parents:function(a){return n.dir(a,"parentNode")},parentsUntil:function(a,b,c){return n.dir(a,"parentNode",c)},next:function(a){return d(a,"nextSibling")},prev:function(a){return d(a,"previousSibling")},nextAll:function(a){return n.dir(a,"nextSibling")},prevAll:function(a){return n.dir(a,"previousSibling")},nextUntil:function(a,b,c){return n.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return n.dir(a,"previousSibling",c)},siblings:function(a){return n.sibling((a.parentNode||
{}).firstChild,a)},children:function(a){return n.sibling(a.firstChild)},contents:function(a){return a.contentDocument||n.merge([],a.childNodes)}},function(a,b){n.fn[a]=function(c,d){var e=n.map(this,b,c);"Until"!==a.slice(-5)&&(d=c);d&&"string"===typeof d&&(e=n.filter(d,e));1<this.length&&(db[a]||n.unique(e),Ua.test(a)&&e.reverse());return this.pushStack(e)}});var ua=/\S+/g,kb={};n.Callbacks=function(a){a="string"===typeof a?kb[a]||k(a):n.extend({},a);var b,c,d,e,l,f,h=[],g=!a.once&&[],q=function(y){b=
a.memory&&y;c=!0;f=e||0;e=0;l=h.length;for(d=!0;h&&f<l;f++)if(!1===h[f].apply(y[0],y[1])&&a.stopOnFalse){b=!1;break}d=!1;h&&(g?g.length&&q(g.shift()):b?h=[]:u.disable())},u={add:function(){if(h){var c=h.length;(function ca(b){n.each(b,function(b,c){var d=n.type(c);"function"===d?a.unique&&u.has(c)||h.push(c):c&&c.length&&"string"!==d&&ca(c)})})(arguments);d?l=h.length:b&&(e=c,q(b))}return this},remove:function(){h&&n.each(arguments,function(a,b){for(var u;-1<(u=n.inArray(b,h,u));)h.splice(u,1),d&&
(u<=l&&l--,u<=f&&f--)});return this},has:function(a){return a?-1<n.inArray(a,h):!(!h||!h.length)},empty:function(){h=[];l=0;return this},disable:function(){h=g=b=void 0;return this},disabled:function(){return!h},lock:function(){g=void 0;b||u.disable();return this},locked:function(){return!g},fireWith:function(a,b){!h||c&&!g||(b=b||[],b=[a,b.slice?b.slice():b],d?g.push(b):q(b));return this},fire:function(){u.fireWith(this,arguments);return this},fired:function(){return!!c}};return u};n.extend({Deferred:function(a){var b=
[["resolve","done",n.Callbacks("once memory"),"resolved"],["reject","fail",n.Callbacks("once memory"),"rejected"],["notify","progress",n.Callbacks("memory")]],c="pending",d={state:function(){return c},always:function(){e.done(arguments).fail(arguments);return this},then:function(){var a=arguments;return n.Deferred(function(c){n.each(b,function(b,l){var f=n.isFunction(a[b])&&a[b];e[l[1]](function(){var a=f&&f.apply(this,arguments);if(a&&n.isFunction(a.promise))a.promise().done(c.resolve).fail(c.reject).progress(c.notify);
else c[l[0]+"With"](this===d?c.promise():this,f?[a]:arguments)})});a=null}).promise()},promise:function(a){return null!=a?n.extend(a,d):d}},e={};d.pipe=d.then;n.each(b,function(a,l){var f=l[2],h=l[3];d[l[1]]=f.add;h&&f.add(function(){c=h},b[a^1][2].disable,b[2][2].lock);e[l[0]]=function(){e[l[0]+"With"](this===e?d:this,arguments);return this};e[l[0]+"With"]=f.fireWith});d.promise(e);a&&a.call(e,e);return e},when:function(a){var b=0,c=da.call(arguments),d=c.length,e=1!==d||a&&n.isFunction(a.promise)?
d:0,l=1===e?a:n.Deferred(),f=function(a,b,c){return function(d){b[a]=this;c[a]=1<arguments.length?da.call(arguments):d;c===h?l.notifyWith(b,c):--e||l.resolveWith(b,c)}},h,k,g;if(1<d)for(h=Array(d),k=Array(d),g=Array(d);b<d;b++)c[b]&&n.isFunction(c[b].promise)?c[b].promise().done(f(b,g,c)).fail(l.reject).progress(f(b,k,h)):--e;e||l.resolveWith(g,c);return l.promise()}});var Va;n.fn.ready=function(a){n.ready.promise().done(a);return this};n.extend({isReady:!1,readyWait:1,holdReady:function(a){a?n.readyWait++:
n.ready(!0)},ready:function(a){(!0===a?--n.readyWait:n.isReady)||(n.isReady=!0,!0!==a&&0<--n.readyWait||(Va.resolveWith(S,[n]),n.fn.triggerHandler&&(n(S).triggerHandler("ready"),n(S).off("ready"))))}});n.ready.promise=function(a){Va||(Va=n.Deferred(),"complete"===S.readyState?setTimeout(n.ready):(S.addEventListener("DOMContentLoaded",f,!1),g.addEventListener("load",f,!1)));return Va.promise(a)};n.ready.promise();var za=n.access=function(a,b,c,d,e,l,f){var h=0,k=a.length,g=null==c;if("object"===n.type(c))for(h in e=
!0,c)n.access(a,b,h,c[h],!0,l,f);else if(void 0!==d&&(e=!0,n.isFunction(d)||(f=!0),g&&(f?(b.call(a,d),b=null):(g=b,b=function(a,b,c){return g.call(n(a),c)})),b))for(;h<k;h++)b(a[h],c,f?d:d.call(a[h],h,b(a[h],c)));return e?a:g?b.call(a):k?b(a[0],c):l};n.acceptData=function(a){return 1===a.nodeType||9===a.nodeType||!+a.nodeType};p.uid=1;p.accepts=n.acceptData;p.prototype={key:function(a){if(!p.accepts(a))return 0;var b={},c=a[this.expando];if(!c){c=p.uid++;try{b[this.expando]={value:c},Object.defineProperties(a,
b)}catch(d){b[this.expando]=c,n.extend(a,b)}}this.cache[c]||(this.cache[c]={});return c},set:function(a,b,c){var d;a=this.key(a);var e=this.cache[a];if("string"===typeof b)e[b]=c;else if(n.isEmptyObject(e))n.extend(this.cache[a],b);else for(d in b)e[d]=b[d];return e},get:function(a,b){var c=this.cache[this.key(a)];return void 0===b?c:c[b]},access:function(a,b,c){if(void 0===b||b&&"string"===typeof b&&void 0===c)return c=this.get(a,b),void 0!==c?c:this.get(a,n.camelCase(b));this.set(a,b,c);return void 0!==
c?c:b},remove:function(a,b){var c,d;c=this.key(a);var e=this.cache[c];if(void 0===b)this.cache[c]={};else for(n.isArray(b)?d=b.concat(b.map(n.camelCase)):(c=n.camelCase(b),b in e?d=[b,c]:(d=c,d=d in e?[d]:d.match(ua)||[])),c=d.length;c--;)delete e[d[c]]},hasData:function(a){return!n.isEmptyObject(this.cache[a[this.expando]]||{})},discard:function(a){a[this.expando]&&delete this.cache[a[this.expando]]}};var M=new p,X=new p,Ab=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Oa=/([A-Z])/g;n.extend({hasData:function(a){return X.hasData(a)||
M.hasData(a)},data:function(a,b,c){return X.access(a,b,c)},removeData:function(a,b){X.remove(a,b)},_data:function(a,b,c){return M.access(a,b,c)},_removeData:function(a,b){M.remove(a,b)}});n.fn.extend({data:function(a,b){var c,d,l,f=this[0],h=f&&f.attributes;if(void 0===a){if(this.length&&(l=X.get(f),1===f.nodeType&&!M.get(f,"hasDataAttrs"))){for(c=h.length;c--;)h[c]&&(d=h[c].name,0===d.indexOf("data-")&&(d=n.camelCase(d.slice(5)),e(f,d,l[d])));M.set(f,"hasDataAttrs",!0)}return l}return"object"===
typeof a?this.each(function(){X.set(this,a)}):za(this,function(b){var c,d=n.camelCase(a);if(f&&void 0===b){c=X.get(f,a);if(void 0!==c)return c;c=X.get(f,d);if(void 0!==c)return c;c=e(f,d,void 0);if(void 0!==c)return c}else this.each(function(){var c=X.get(this,d);X.set(this,d,b);-1!==a.indexOf("-")&&void 0!==c&&X.set(this,a,b)})},null,b,1<arguments.length,null,!0)},removeData:function(a){return this.each(function(){X.remove(this,a)})}});n.extend({queue:function(a,b,c){var d;if(a)return b=(b||"fx")+
"queue",d=M.get(a,b),c&&(!d||n.isArray(c)?d=M.access(a,b,n.makeArray(c)):d.push(c)),d||[]},dequeue:function(a,b){b=b||"fx";var c=n.queue(a,b),d=c.length,e=c.shift(),l=n._queueHooks(a,b),f=function(){n.dequeue(a,b)};"inprogress"===e&&(e=c.shift(),d--);e&&("fx"===b&&c.unshift("inprogress"),delete l.stop,e.call(a,f,l));!d&&l&&l.empty.fire()},_queueHooks:function(a,b){var c=b+"queueHooks";return M.get(a,c)||M.access(a,c,{empty:n.Callbacks("once memory").add(function(){M.remove(a,[b+"queue",c])})})}});
n.fn.extend({queue:function(a,b){var c=2;"string"!==typeof a&&(b=a,a="fx",c--);return arguments.length<c?n.queue(this[0],a):void 0===b?this:this.each(function(){var c=n.queue(this,a,b);n._queueHooks(this,a);"fx"===a&&"inprogress"!==c[0]&&n.dequeue(this,a)})},dequeue:function(a){return this.each(function(){n.dequeue(this,a)})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,b){var c,d=1,e=n.Deferred(),l=this,f=this.length,h=function(){--d||e.resolveWith(l,[l])};"string"!==
typeof a&&(b=a,a=void 0);for(a=a||"fx";f--;)(c=M.get(l[f],a+"queueHooks"))&&c.empty&&(d++,c.empty.add(h));h();return e.promise(b)}});var ga=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Aa=["Top","Right","Bottom","Left"],Ca=function(a,b){a=b||a;return"none"===n.css(a,"display")||!n.contains(a.ownerDocument,a)},ob=/^(?:checkbox|radio)$/i;(function(){var a=S.createDocumentFragment().appendChild(S.createElement("div")),b=S.createElement("input");b.setAttribute("type","radio");b.setAttribute("checked",
"checked");b.setAttribute("name","t");a.appendChild(b);ba.checkClone=a.cloneNode(!0).cloneNode(!0).lastChild.checked;a.innerHTML="<textarea>x</textarea>";ba.noCloneChecked=!!a.cloneNode(!0).lastChild.defaultValue})();ba.focusinBubbles="onfocusin"in g;var Eb=/^key/,Fb=/^(?:mouse|pointer|contextmenu)|click/,pb=/^(?:focusinfocus|focusoutblur)$/,W=/^([^.]*)(?:\.(.+)|)$/;n.event={global:{},add:function(a,b,c,d,e){var l,f,h,k,g,u,y,N,q;if(g=M.get(a))for(c.handler&&(l=c,c=l.handler,e=l.selector),c.guid||
(c.guid=n.guid++),(k=g.events)||(k=g.events={}),(f=g.handle)||(f=g.handle=function(b){return"undefined"!==typeof n&&n.event.triggered!==b.type?n.event.dispatch.apply(a,arguments):void 0}),b=(b||"").match(ua)||[""],g=b.length;g--;)h=W.exec(b[g])||[],N=u=h[1],q=(h[2]||"").split(".").sort(),N&&(h=n.event.special[N]||{},N=(e?h.delegateType:h.bindType)||N,h=n.event.special[N]||{},u=n.extend({type:N,origType:u,data:d,handler:c,guid:c.guid,selector:e,needsContext:e&&n.expr.match.needsContext.test(e),namespace:q.join(".")},
l),(y=k[N])||(y=k[N]=[],y.delegateCount=0,h.setup&&!1!==h.setup.call(a,d,q,f)||a.addEventListener&&a.addEventListener(N,f,!1)),h.add&&(h.add.call(a,u),u.handler.guid||(u.handler.guid=c.guid)),e?y.splice(y.delegateCount++,0,u):y.push(u),n.event.global[N]=!0)},remove:function(a,b,c,d,e){var l,f,h,k,g,u,y,N,q,p,B,z=M.hasData(a)&&M.get(a);if(z&&(k=z.events)){b=(b||"").match(ua)||[""];for(g=b.length;g--;)if(h=W.exec(b[g])||[],q=B=h[1],p=(h[2]||"").split(".").sort(),q){y=n.event.special[q]||{};q=(d?y.delegateType:
y.bindType)||q;N=k[q]||[];h=h[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)");for(f=l=N.length;l--;)u=N[l],!e&&B!==u.origType||c&&c.guid!==u.guid||h&&!h.test(u.namespace)||d&&d!==u.selector&&("**"!==d||!u.selector)||(N.splice(l,1),u.selector&&N.delegateCount--,y.remove&&y.remove.call(a,u));f&&!N.length&&(y.teardown&&!1!==y.teardown.call(a,p,z.handle)||n.removeEvent(a,q,z.handle),delete k[q])}else for(q in k)n.event.remove(a,q+b[g],c,d,!0);n.isEmptyObject(k)&&(delete z.handle,M.remove(a,
"events"))}},trigger:function(a,b,c,d){var e,l,f,h,k,q,u=[c||S],y=ra.call(a,"type")?a.type:a;q=ra.call(a,"namespace")?a.namespace.split("."):[];l=e=c=c||S;if(3!==c.nodeType&&8!==c.nodeType&&!pb.test(y+n.event.triggered)&&(0<=y.indexOf(".")&&(q=y.split("."),y=q.shift(),q.sort()),h=0>y.indexOf(":")&&"on"+y,a=a[n.expando]?a:new n.Event(y,"object"===typeof a&&a),a.isTrigger=d?2:3,a.namespace=q.join("."),a.namespace_re=a.namespace?new RegExp("(^|\\.)"+q.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,a.result=void 0,
a.target||(a.target=c),b=null==b?[a]:n.makeArray(b,[a]),q=n.event.special[y]||{},d||!q.trigger||!1!==q.trigger.apply(c,b))){if(!d&&!q.noBubble&&!n.isWindow(c)){f=q.delegateType||y;pb.test(f+y)||(l=l.parentNode);for(;l;l=l.parentNode)u.push(l),e=l;e===(c.ownerDocument||S)&&u.push(e.defaultView||e.parentWindow||g)}for(e=0;(l=u[e++])&&!a.isPropagationStopped();)a.type=1<e?f:q.bindType||y,(k=(M.get(l,"events")||{})[a.type]&&M.get(l,"handle"))&&k.apply(l,b),(k=h&&l[h])&&k.apply&&n.acceptData(l)&&(a.result=
k.apply(l,b),!1===a.result&&a.preventDefault());a.type=y;d||a.isDefaultPrevented()||q._default&&!1!==q._default.apply(u.pop(),b)||!n.acceptData(c)||!h||!n.isFunction(c[y])||n.isWindow(c)||((e=c[h])&&(c[h]=null),n.event.triggered=y,c[y](),n.event.triggered=void 0,e&&(c[h]=e));return a.result}},dispatch:function(a){a=n.event.fix(a);var b,c,d,e,l=[],f=da.call(arguments);b=(M.get(this,"events")||{})[a.type]||[];var h=n.event.special[a.type]||{};f[0]=a;a.delegateTarget=this;if(!h.preDispatch||!1!==h.preDispatch.call(this,
a)){l=n.event.handlers.call(this,a,b);for(b=0;(e=l[b++])&&!a.isPropagationStopped();)for(a.currentTarget=e.elem,c=0;(d=e.handlers[c++])&&!a.isImmediatePropagationStopped();)if(!a.namespace_re||a.namespace_re.test(d.namespace))a.handleObj=d,a.data=d.data,d=((n.event.special[d.origType]||{}).handle||d.handler).apply(e.elem,f),void 0!==d&&!1===(a.result=d)&&(a.preventDefault(),a.stopPropagation());h.postDispatch&&h.postDispatch.call(this,a);return a.result}},handlers:function(a,b){var c,d,e,l,f=[],h=
b.delegateCount,k=a.target;if(h&&k.nodeType&&(!a.button||"click"!==a.type))for(;k!==this;k=k.parentNode||this)if(!0!==k.disabled||"click"!==a.type){d=[];for(c=0;c<h;c++)l=b[c],e=l.selector+" ",void 0===d[e]&&(d[e]=l.needsContext?0<=n(e,this).index(k):n.find(e,this,null,[k]).length),d[e]&&d.push(l);d.length&&f.push({elem:k,handlers:d})}h<b.length&&f.push({elem:this,handlers:b.slice(h)});return f},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),
fixHooks:{},keyHooks:{props:["char","charCode","key","keyCode"],filter:function(a,b){null==a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode);return a}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,b){var c,d,e=b.button;null==a.pageX&&null!=b.clientX&&(c=a.target.ownerDocument||S,d=c.documentElement,c=c.body,a.pageX=b.clientX+(d&&d.scrollLeft||c&&c.scrollLeft||0)-(d&&d.clientLeft||c&&c.clientLeft||0),a.pageY=
b.clientY+(d&&d.scrollTop||c&&c.scrollTop||0)-(d&&d.clientTop||c&&c.clientTop||0));a.which||void 0===e||(a.which=e&1?1:e&2?3:e&4?2:0);return a}},fix:function(a){if(a[n.expando])return a;var b,c,d;b=a.type;var e=a,l=this.fixHooks[b];l||(this.fixHooks[b]=l=Fb.test(b)?this.mouseHooks:Eb.test(b)?this.keyHooks:{});d=l.props?this.props.concat(l.props):this.props;a=new n.Event(e);for(b=d.length;b--;)c=d[b],a[c]=e[c];a.target||(a.target=S);3===a.target.nodeType&&(a.target=a.target.parentNode);return l.filter?
l.filter(a,e):a},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==h()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===h()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&n.nodeName(this,"input"))return this.click(),!1},_default:function(a){return n.nodeName(a.target,"a")}},beforeunload:{postDispatch:function(a){void 0!==a.result&&a.originalEvent&&(a.originalEvent.returnValue=
a.result)}}},simulate:function(a,b,c,d){a=n.extend(new n.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?n.event.trigger(a,null,b):n.event.dispatch.call(b,a);a.isDefaultPrevented()&&c.preventDefault()}};n.removeEvent=function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)};n.Event=function(a,b){if(!(this instanceof n.Event))return new n.Event(a,b);a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&!1===a.returnValue?
w:r):this.type=a;b&&n.extend(this,b);this.timeStamp=a&&a.timeStamp||n.now();this[n.expando]=!0};n.Event.prototype={isDefaultPrevented:r,isPropagationStopped:r,isImmediatePropagationStopped:r,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=w;a&&a.preventDefault&&a.preventDefault()},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=w;a&&a.stopPropagation&&a.stopPropagation()},stopImmediatePropagation:function(){var a=this.originalEvent;this.isImmediatePropagationStopped=
w;a&&a.stopImmediatePropagation&&a.stopImmediatePropagation();this.stopPropagation()}};n.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(a,b){n.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=a.relatedTarget,e=a.handleObj;if(!d||d!==this&&!n.contains(this,d))a.type=e.origType,c=e.handler.apply(this,arguments),a.type=b;return c}}});ba.focusinBubbles||n.each({focus:"focusin",blur:"focusout"},function(a,b){var c=
function(a){n.event.simulate(b,a.target,n.event.fix(a),!0)};n.event.special[b]={setup:function(){var d=this.ownerDocument||this,e=M.access(d,b);e||d.addEventListener(a,c,!0);M.access(d,b,(e||0)+1)},teardown:function(){var d=this.ownerDocument||this,e=M.access(d,b)-1;e?M.access(d,b,e):(d.removeEventListener(a,c,!0),M.remove(d,b))}}});n.fn.extend({on:function(a,b,c,d,e){var l,f;if("object"===typeof a){"string"!==typeof b&&(c=c||b,b=void 0);for(f in a)this.on(f,b,c,a[f],e);return this}null==c&&null==
d?(d=b,c=b=void 0):null==d&&("string"===typeof b?(d=c,c=void 0):(d=c,c=b,b=void 0));if(!1===d)d=r;else if(!d)return this;1===e&&(l=d,d=function(a){n().off(a);return l.apply(this,arguments)},d.guid=l.guid||(l.guid=n.guid++));return this.each(function(){n.event.add(this,a,d,c,b)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,b,c){var d;if(a&&a.preventDefault&&a.handleObj)return d=a.handleObj,n(a.delegateTarget).off(d.namespace?d.origType+"."+d.namespace:d.origType,d.selector,d.handler),
this;if("object"===typeof a){for(d in a)this.off(d,b,a[d]);return this}if(!1===b||"function"===typeof b)c=b,b=void 0;!1===c&&(c=r);return this.each(function(){n.event.remove(this,a,c,b)})},trigger:function(a,b){return this.each(function(){n.event.trigger(a,b,this)})},triggerHandler:function(a,b){var c=this[0];if(c)return n.event.trigger(a,b,c,!0)}});var qb=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Ga=/<([\w:]+)/,Gb=/<|&#?\w+;/,Hb=/<(?:script|style|link)/i,rb=/checked\s*(?:[^=]|=\s*.checked.)/i,
eb=/^$|\/(?:java|ecma)script/i,ab=/^true\/(.*)/,Ib=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,qa={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};qa.optgroup=qa.option;qa.tbody=qa.tfoot=qa.colgroup=qa.caption=qa.thead;qa.th=qa.td;n.extend({clone:function(a,b,c){var d,e,l,f,h=a.cloneNode(!0),k=n.contains(a.ownerDocument,
a);if(!(ba.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||n.isXMLDoc(a)))for(f=D(h),l=D(a),d=0,e=l.length;d<e;d++){var g=l[d],u=f[d],y=u.nodeName.toLowerCase();if("input"===y&&ob.test(g.type))u.checked=g.checked;else if("input"===y||"textarea"===y)u.defaultValue=g.defaultValue}if(b)if(c)for(l=l||D(a),f=f||D(h),d=0,e=l.length;d<e;d++)A(l[d],f[d]);else A(a,h);f=D(h,"script");0<f.length&&x(f,!k&&D(a,"script"));return h},buildFragment:function(a,b,c,d){for(var e,l,f,h=b.createDocumentFragment(),k=[],
g=0,u=a.length;g<u;g++)if((e=a[g])||0===e)if("object"===n.type(e))n.merge(k,e.nodeType?[e]:e);else if(Gb.test(e)){l=l||h.appendChild(b.createElement("div"));f=(Ga.exec(e)||["",""])[1].toLowerCase();f=qa[f]||qa._default;l.innerHTML=f[1]+e.replace(qb,"<$1></$2>")+f[2];for(f=f[0];f--;)l=l.lastChild;n.merge(k,l.childNodes);l=h.firstChild;l.textContent=""}else k.push(b.createTextNode(e));h.textContent="";for(g=0;e=k[g++];)if(!d||-1===n.inArray(e,d))if(a=n.contains(e.ownerDocument,e),l=D(h.appendChild(e),
"script"),a&&x(l),c)for(f=0;e=l[f++];)eb.test(e.type||"")&&c.push(e);return h},cleanData:function(a){for(var b,c,d,e,l=n.event.special,f=0;void 0!==(c=a[f]);f++){if(n.acceptData(c)&&(e=c[M.expando])&&(b=M.cache[e])){if(b.events)for(d in b.events)l[d]?n.event.remove(c,d):n.removeEvent(c,d,b.handle);M.cache[e]&&delete M.cache[e]}delete X.cache[c[X.expando]]}}});n.fn.extend({text:function(a){return za(this,function(a){return void 0===a?n.text(this):this.empty().each(function(){if(1===this.nodeType||
11===this.nodeType||9===this.nodeType)this.textContent=a})},null,a,arguments.length)},append:function(){return this.domManip(arguments,function(a){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||v(this,a).appendChild(a)})},prepend:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=v(this,a);b.insertBefore(a,b.firstChild)}})},before:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,
this)})},after:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)})},remove:function(a,b){for(var c,d=a?n.filter(a,this):this,e=0;null!=(c=d[e]);e++)b||1!==c.nodeType||n.cleanData(D(c)),c.parentNode&&(b&&n.contains(c.ownerDocument,c)&&x(D(c,"script")),c.parentNode.removeChild(c));return this},empty:function(){for(var a,b=0;null!=(a=this[b]);b++)1===a.nodeType&&(n.cleanData(D(a,!1)),a.textContent="");return this},clone:function(a,
b){a=null==a?!1:a;b=null==b?a:b;return this.map(function(){return n.clone(this,a,b)})},html:function(a){return za(this,function(a){var b=this[0]||{},c=0,d=this.length;if(void 0===a&&1===b.nodeType)return b.innerHTML;if("string"===typeof a&&!Hb.test(a)&&!qa[(Ga.exec(a)||["",""])[1].toLowerCase()]){a=a.replace(qb,"<$1></$2>");try{for(;c<d;c++)b=this[c]||{},1===b.nodeType&&(n.cleanData(D(b,!1)),b.innerHTML=a);b=0}catch(e){}}b&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(){var a=
arguments[0];this.domManip(arguments,function(b){a=this.parentNode;n.cleanData(D(this));a&&a.replaceChild(b,this)});return a&&(a.length||a.nodeType)?this:this.remove()},detach:function(a){return this.remove(a,!0)},domManip:function(a,b){a=na.apply([],a);var d,e,l,f,h=0,k=this.length,g=this,q=k-1,u=a[0],y=n.isFunction(u);if(y||1<k&&"string"===typeof u&&!ba.checkClone&&rb.test(u))return this.each(function(c){var d=g.eq(c);y&&(a[0]=u.call(this,c,d.html()));d.domManip(a,b)});if(k&&(d=n.buildFragment(a,
this[0].ownerDocument,!1,this),e=d.firstChild,1===d.childNodes.length&&(d=e),e)){e=n.map(D(d,"script"),c);for(l=e.length;h<k;h++)f=d,h!==q&&(f=n.clone(f,!0,!0),l&&n.merge(e,D(f,"script"))),b.call(this[h],f,h);if(l)for(d=e[e.length-1].ownerDocument,n.map(e,t),h=0;h<l;h++)f=e[h],eb.test(f.type||"")&&!M.access(f,"globalEval")&&n.contains(d,f)&&(f.src?n._evalUrl&&n._evalUrl(f.src):n.globalEval(f.textContent.replace(Ib,"")))}return this}});n.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",
insertAfter:"after",replaceAll:"replaceWith"},function(a,b){n.fn[a]=function(a){for(var c=[],d=n(a),e=d.length-1,l=0;l<=e;l++)a=l===e?this:this.clone(!0),n(d[l])[b](a),va.apply(c,a.get());return this.pushStack(c)}});var Qa,Pa={},Ea=/^margin/,sa=new RegExp("^("+ga+")(?!px)[a-z%]+$","i"),Ra=function(a){return a.ownerDocument.defaultView.getComputedStyle(a,null)};(function(){function a(){l.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute";
l.innerHTML="";d.appendChild(e);var f=g.getComputedStyle(l,null);b="1%"!==f.top;c="4px"===f.width;d.removeChild(e)}var b,c,d=S.documentElement,e=S.createElement("div"),l=S.createElement("div");l.style&&(l.style.backgroundClip="content-box",l.cloneNode(!0).style.backgroundClip="",ba.clearCloneStyle="content-box"===l.style.backgroundClip,e.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",e.appendChild(l),g.getComputedStyle&&n.extend(ba,{pixelPosition:function(){a();
return b},boxSizingReliable:function(){null==c&&a();return c},reliableMarginRight:function(){var a;a=l.appendChild(S.createElement("div"));a.style.cssText=l.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0";a.style.marginRight=a.style.width="0";l.style.width="1px";d.appendChild(e);a=!parseFloat(g.getComputedStyle(a,null).marginRight);d.removeChild(e);return a}}))})();n.swap=function(a,b,c,d){var e,l={};for(e in b)l[e]=
a.style[e],a.style[e]=b[e];c=c.apply(a,d||[]);for(e in b)a.style[e]=l[e];return c};var sb=/^(none|table(?!-c[ea]).+)/,ia=new RegExp("^("+ga+")(.*)$","i"),ea=new RegExp("^([+-])=("+ga+")","i"),tb={position:"absolute",visibility:"hidden",display:"block"},fb={letterSpacing:"0",fontWeight:"400"},pa=["Webkit","O","Moz","ms"];n.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=H(a,"opacity");return""===c?"1":c}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,
opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(a,b,c,d){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var e,l,f,h=n.camelCase(b),k=a.style;b=n.cssProps[h]||(n.cssProps[h]=J(k,h));f=n.cssHooks[b]||n.cssHooks[h];if(void 0!==c)l=typeof c,"string"===l&&(e=ea.exec(c))&&(c=(e[1]+1)*e[2]+parseFloat(n.css(a,b)),l="number"),null!=c&&c===c&&("number"!==l||n.cssNumber[h]||(c+="px"),ba.clearCloneStyle||""!==c||0!==b.indexOf("background")||(k[b]="inherit"),
f&&"set"in f&&void 0===(c=f.set(a,c,d))||(k[b]=c));else return f&&"get"in f&&void 0!==(e=f.get(a,!1,d))?e:k[b]}},css:function(a,b,c,d){var e,l;l=n.camelCase(b);b=n.cssProps[l]||(n.cssProps[l]=J(a.style,l));(l=n.cssHooks[b]||n.cssHooks[l])&&"get"in l&&(e=l.get(a,!0,c));void 0===e&&(e=H(a,b,d));"normal"===e&&b in fb&&(e=fb[b]);return""===c||c?(a=parseFloat(e),!0===c||n.isNumeric(a)?a||0:e):e}});n.each(["height","width"],function(a,b){n.cssHooks[b]={get:function(a,c,d){if(c)return sb.test(n.css(a,"display"))&&
0===a.offsetWidth?n.swap(a,tb,function(){return F(a,b,d)}):F(a,b,d)},set:function(a,c,d){var e=d&&Ra(a);return K(a,c,d?C(a,b,d,"border-box"===n.css(a,"boxSizing",!1,e),e):0)}}});n.cssHooks.marginRight=L(ba.reliableMarginRight,function(a,b){if(b)return n.swap(a,{display:"inline-block"},H,[a,"marginRight"])});n.each({margin:"",padding:"",border:"Width"},function(a,b){n.cssHooks[a+b]={expand:function(c){var d=0,e={};for(c="string"===typeof c?c.split(" "):[c];4>d;d++)e[a+Aa[d]+b]=c[d]||c[d-2]||c[0];return e}};
Ea.test(a)||(n.cssHooks[a+b].set=K)});n.fn.extend({css:function(a,b){return za(this,function(a,b,c){var d,e={},l=0;if(n.isArray(b)){c=Ra(a);for(d=b.length;l<d;l++)e[b[l]]=n.css(a,b[l],!1,c);return e}return void 0!==c?n.style(a,b,c):n.css(a,b)},a,b,1<arguments.length)},show:function(){return P(this,!0)},hide:function(){return P(this)},toggle:function(a){return"boolean"===typeof a?a?this.show():this.hide():this.each(function(){Ca(this)?n(this).show():n(this).hide()})}});n.Tween=l;l.prototype={constructor:l,
init:function(a,b,c,d,e,l){this.elem=a;this.prop=c;this.easing=e||"swing";this.options=b;this.start=this.now=this.cur();this.end=d;this.unit=l||(n.cssNumber[c]?"":"px")},cur:function(){var a=l.propHooks[this.prop];return a&&a.get?a.get(this):l.propHooks._default.get(this)},run:function(a){var b,c=l.propHooks[this.prop];this.pos=this.options.duration?b=n.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):b=a;this.now=(this.end-this.start)*b+this.start;this.options.step&&this.options.step.call(this.elem,
this.now,this);c&&c.set?c.set(this):l.propHooks._default.set(this);return this}};l.prototype.init.prototype=l.prototype;l.propHooks={_default:{get:function(a){return null==a.elem[a.prop]||a.elem.style&&null!=a.elem.style[a.prop]?(a=n.css(a.elem,a.prop,""))&&"auto"!==a?a:0:a.elem[a.prop]},set:function(a){if(n.fx.step[a.prop])n.fx.step[a.prop](a);else a.elem.style&&(null!=a.elem.style[n.cssProps[a.prop]]||n.cssHooks[a.prop])?n.style(a.elem,a.prop,a.now+a.unit):a.elem[a.prop]=a.now}}};l.propHooks.scrollTop=
l.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}};n.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2}};n.fx=l.prototype.init;n.fx.step={};var Da,Wa,Jb=/^(?:toggle|show|hide)$/,G=new RegExp("^(?:([+-])=|)("+ga+")([a-z%]*)$","i"),ka=/queueHooks$/,U=[function(a,b,c){var d,e,l,f,h,k,g=this,u={},y=a.style,N=a.nodeType&&Ca(a),q=M.get(a,"fxshow");c.queue||(f=n._queueHooks(a,"fx"),null==f.unqueued&&(f.unqueued=0,h=f.empty.fire,
f.empty.fire=function(){f.unqueued||h()}),f.unqueued++,g.always(function(){g.always(function(){f.unqueued--;n.queue(a,"fx").length||f.empty.fire()})}));1===a.nodeType&&("height"in b||"width"in b)&&(c.overflow=[y.overflow,y.overflowX,y.overflowY],k=n.css(a,"display"),e="none"===k?M.get(a,"olddisplay")||R(a.nodeName):k,"inline"===e&&"none"===n.css(a,"float")&&(y.display="inline-block"));c.overflow&&(y.overflow="hidden",g.always(function(){y.overflow=c.overflow[0];y.overflowX=c.overflow[1];y.overflowY=
c.overflow[2]}));for(d in b)if(e=b[d],Jb.exec(e)){delete b[d];l=l||"toggle"===e;if(e===(N?"hide":"show"))if("show"===e&&q&&void 0!==q[d])N=!0;else continue;u[d]=q&&q[d]||n.style(a,d)}else k=void 0;if(n.isEmptyObject(u))"inline"===("none"===k?R(a.nodeName):k)&&(y.display=k);else for(d in q?"hidden"in q&&(N=q.hidden):q=M.access(a,"fxshow",{}),l&&(q.hidden=!N),N?n(a).show():g.done(function(){n(a).hide()}),g.done(function(){var b;M.remove(a,"fxshow");for(b in u)n.style(a,b,u[b])}),u)b=z(N?q[d]:0,d,g),
d in q||(q[d]=b.start,N&&(b.end=b.start,b.start="width"===d||"height"===d?1:0))}],O={"*":[function(a,b){var c=this.createTween(a,b),d=c.cur(),e=G.exec(b),l=e&&e[3]||(n.cssNumber[a]?"":"px"),f=(n.cssNumber[a]||"px"!==l&&+d)&&G.exec(n.css(c.elem,a)),h=1,k=20;if(f&&f[3]!==l){l=l||f[3];e=e||[];f=+d||1;do h=h||".5",f/=h,n.style(c.elem,a,f+l);while(h!==(h=c.cur()/d)&&1!==h&&--k)}e&&(f=c.start=+f||+d||0,c.unit=l,c.end=e[1]?f+(e[1]+1)*e[2]:+e[2]);return c}]};n.Animation=n.extend(Z,{tweener:function(a,b){n.isFunction(a)?
(b=a,a=["*"]):a=a.split(" ");for(var c,d=0,e=a.length;d<e;d++)c=a[d],O[c]=O[c]||[],O[c].unshift(b)},prefilter:function(a,b){b?U.unshift(a):U.push(a)}});n.speed=function(a,b,c){var d=a&&"object"===typeof a?n.extend({},a):{complete:c||!c&&b||n.isFunction(a)&&a,duration:a,easing:c&&b||b&&!n.isFunction(b)&&b};d.duration=n.fx.off?0:"number"===typeof d.duration?d.duration:d.duration in n.fx.speeds?n.fx.speeds[d.duration]:n.fx.speeds._default;if(null==d.queue||!0===d.queue)d.queue="fx";d.old=d.complete;
d.complete=function(){n.isFunction(d.old)&&d.old.call(this);d.queue&&n.dequeue(this,d.queue)};return d};n.fn.extend({fadeTo:function(a,b,c,d){return this.filter(Ca).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=n.isEmptyObject(a),l=n.speed(b,c,d);b=function(){var b=Z(this,n.extend({},a),l);(e||M.get(this,"finish"))&&b.stop(!0)};b.finish=b;return e||!1===l.queue?this.each(b):this.queue(l.queue,b)},stop:function(a,b,c){var d=function(a){var b=a.stop;delete a.stop;
b(c)};"string"!==typeof a&&(c=b,b=a,a=void 0);b&&!1!==a&&this.queue(a||"fx",[]);return this.each(function(){var b=!0,e=null!=a&&a+"queueHooks",l=n.timers,f=M.get(this);if(e)f[e]&&f[e].stop&&d(f[e]);else for(e in f)f[e]&&f[e].stop&&ka.test(e)&&d(f[e]);for(e=l.length;e--;)l[e].elem!==this||null!=a&&l[e].queue!==a||(l[e].anim.stop(c),b=!1,l.splice(e,1));!b&&c||n.dequeue(this,a)})},finish:function(a){!1!==a&&(a=a||"fx");return this.each(function(){var b,c=M.get(this),d=c[a+"queue"];b=c[a+"queueHooks"];
var e=n.timers,l=d?d.length:0;c.finish=!0;n.queue(this,a,[]);b&&b.stop&&b.stop.call(this,!0);for(b=e.length;b--;)e[b].elem===this&&e[b].queue===a&&(e[b].anim.stop(!0),e.splice(b,1));for(b=0;b<l;b++)d[b]&&d[b].finish&&d[b].finish.call(this);delete c.finish})}});n.each(["toggle","show","hide"],function(a,b){var c=n.fn[b];n.fn[b]=function(a,d,e){return null==a||"boolean"===typeof a?c.apply(this,arguments):this.animate(B(b,!0),a,d,e)}});n.each({slideDown:B("show"),slideUp:B("hide"),slideToggle:B("toggle"),
fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){n.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}});n.timers=[];n.fx.tick=function(){var a,b=0,c=n.timers;for(Da=n.now();b<c.length;b++)a=c[b],a()||c[b]!==a||c.splice(b--,1);c.length||n.fx.stop();Da=void 0};n.fx.timer=function(a){n.timers.push(a);a()?n.fx.start():n.timers.pop()};n.fx.interval=13;n.fx.start=function(){Wa||(Wa=setInterval(n.fx.tick,n.fx.interval))};n.fx.stop=function(){clearInterval(Wa);
Wa=null};n.fx.speeds={slow:600,fast:200,_default:400};n.fn.delay=function(a,b){a=n.fx?n.fx.speeds[a]||a:a;return this.queue(b||"fx",function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})};(function(){var a=S.createElement("input"),b=S.createElement("select"),c=b.appendChild(S.createElement("option"));a.type="checkbox";ba.checkOn=""!==a.value;ba.optSelected=c.selected;b.disabled=!0;ba.optDisabled=!c.disabled;a=S.createElement("input");a.value="t";a.type="radio";ba.radioValue="t"===
a.value})();var aa,Ha=n.expr.attrHandle;n.fn.extend({attr:function(a,b){return za(this,n.attr,a,b,1<arguments.length)},removeAttr:function(a){return this.each(function(){n.removeAttr(this,a)})}});n.extend({attr:function(a,b,c){var d,e,l=a.nodeType;if(a&&3!==l&&8!==l&&2!==l){if("undefined"===typeof a.getAttribute)return n.prop(a,b,c);1===l&&n.isXMLDoc(a)||(b=b.toLowerCase(),d=n.attrHooks[b]||(n.expr.match.bool.test(b)?aa:void 0));if(void 0!==c)if(null===c)n.removeAttr(a,b);else{if(d&&"set"in d&&void 0!==
(e=d.set(a,c,b)))return e;a.setAttribute(b,c+"");return c}else{if(d&&"get"in d&&null!==(e=d.get(a,b)))return e;e=n.find.attr(a,b);return null==e?void 0:e}}},removeAttr:function(a,b){var c,d,e=0,l=b&&b.match(ua);if(l&&1===a.nodeType)for(;c=l[e++];)d=n.propFix[c]||c,n.expr.match.bool.test(c)&&(a[d]=!1),a.removeAttribute(c)},attrHooks:{type:{set:function(a,b){if(!ba.radioValue&&"radio"===b&&n.nodeName(a,"input")){var c=a.value;a.setAttribute("type",b);c&&(a.value=c);return b}}}}});aa={set:function(a,
b,c){!1===b?n.removeAttr(a,c):a.setAttribute(c,c);return c}};n.each(n.expr.match.bool.source.match(/\w+/g),function(a,b){var c=Ha[b]||n.find.attr;Ha[b]=function(a,b,d){var e,l;d||(l=Ha[b],Ha[b]=e,e=null!=c(a,b,d)?b.toLowerCase():null,Ha[b]=l);return e}});var Kb=/^(?:input|select|textarea|button)$/i;n.fn.extend({prop:function(a,b){return za(this,n.prop,a,b,1<arguments.length)},removeProp:function(a){return this.each(function(){delete this[n.propFix[a]||a]})}});n.extend({propFix:{"for":"htmlFor","class":"className"},
prop:function(a,b,c){var d,e,l;l=a.nodeType;if(a&&3!==l&&8!==l&&2!==l){if(l=1!==l||!n.isXMLDoc(a))b=n.propFix[b]||b,e=n.propHooks[b];return void 0!==c?e&&"set"in e&&void 0!==(d=e.set(a,c,b))?d:a[b]=c:e&&"get"in e&&null!==(d=e.get(a,b))?d:a[b]}},propHooks:{tabIndex:{get:function(a){return a.hasAttribute("tabindex")||Kb.test(a.nodeName)||a.href?a.tabIndex:-1}}}});ba.optSelected||(n.propHooks.selected={get:function(a){(a=a.parentNode)&&a.parentNode&&a.parentNode.selectedIndex;return null}});n.each("tabIndex readOnly maxLength cellSpacing cellPadding rowSpan colSpan useMap frameBorder contentEditable".split(" "),
function(){n.propFix[this.toLowerCase()]=this});var Ma=/[\t\r\n\f]/g;n.fn.extend({addClass:function(a){var b,c,d,e,l;b="string"===typeof a&&a;var f=0,h=this.length;if(n.isFunction(a))return this.each(function(b){n(this).addClass(a.call(this,b,this.className))});if(b)for(b=(a||"").match(ua)||[];f<h;f++)if(c=this[f],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(Ma," "):" ")){for(l=0;e=b[l++];)0>d.indexOf(" "+e+" ")&&(d+=e+" ");d=n.trim(d);c.className!==d&&(c.className=d)}return this},
removeClass:function(a){var b,c,d,e,l;b=0===arguments.length||"string"===typeof a&&a;var f=0,h=this.length;if(n.isFunction(a))return this.each(function(b){n(this).removeClass(a.call(this,b,this.className))});if(b)for(b=(a||"").match(ua)||[];f<h;f++)if(c=this[f],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(Ma," "):"")){for(l=0;e=b[l++];)for(;0<=d.indexOf(" "+e+" ");)d=d.replace(" "+e+" "," ");d=a?n.trim(d):"";c.className!==d&&(c.className=d)}return this},toggleClass:function(a,b){var c=
typeof a;return"boolean"===typeof b&&"string"===c?b?this.addClass(a):this.removeClass(a):n.isFunction(a)?this.each(function(c){n(this).toggleClass(a.call(this,c,this.className,b),b)}):this.each(function(){if("string"===c)for(var b,d=0,e=n(this),l=a.match(ua)||[];b=l[d++];)e.hasClass(b)?e.removeClass(b):e.addClass(b);else if("undefined"===c||"boolean"===c)this.className&&M.set(this,"__className__",this.className),this.className=this.className||!1===a?"":M.get(this,"__className__")||""})},hasClass:function(a){a=
" "+a+" ";for(var b=0,c=this.length;b<c;b++)if(1===this[b].nodeType&&0<=(" "+this[b].className+" ").replace(Ma," ").indexOf(a))return!0;return!1}});var Pb=/\r/g;n.fn.extend({val:function(a){var b,c,d,e=this[0];if(arguments.length)return d=n.isFunction(a),this.each(function(c){1===this.nodeType&&(c=d?a.call(this,c,n(this).val()):a,null==c?c="":"number"===typeof c?c+="":n.isArray(c)&&(c=n.map(c,function(a){return null==a?"":a+""})),b=n.valHooks[this.type]||n.valHooks[this.nodeName.toLowerCase()],b&&
"set"in b&&void 0!==b.set(this,c,"value")||(this.value=c))});if(e){if((b=n.valHooks[e.type]||n.valHooks[e.nodeName.toLowerCase()])&&"get"in b&&void 0!==(c=b.get(e,"value")))return c;c=e.value;return"string"===typeof c?c.replace(Pb,""):null==c?"":c}}});n.extend({valHooks:{option:{get:function(a){var b=n.find.attr(a,"value");return null!=b?b:n.trim(n.text(a))}},select:{get:function(a){for(var b,c=a.options,d=a.selectedIndex,e=(a="select-one"===a.type||0>d)?null:[],l=a?d+1:c.length,f=0>d?l:a?d:0;f<l;f++)if(b=
c[f],!(!b.selected&&f!==d||(ba.optDisabled?b.disabled:null!==b.getAttribute("disabled"))||b.parentNode.disabled&&n.nodeName(b.parentNode,"optgroup"))){b=n(b).val();if(a)return b;e.push(b)}return e},set:function(a,b){for(var c,d,e=a.options,l=n.makeArray(b),f=e.length;f--;)if(d=e[f],d.selected=0<=n.inArray(d.value,l))c=!0;c||(a.selectedIndex=-1);return l}}}});n.each(["radio","checkbox"],function(){n.valHooks[this]={set:function(a,b){if(n.isArray(b))return a.checked=0<=n.inArray(n(a).val(),b)}};ba.checkOn||
(n.valHooks[this].get=function(a){return null===a.getAttribute("value")?"on":a.value})});n.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){n.fn[b]=function(a,c){return 0<arguments.length?this.on(b,null,a,c):this.trigger(b)}});n.fn.extend({hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)},bind:function(a,
b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,"**"):this.off(b,a||"**",c)}});var ub=n.now(),vb=/\?/;n.parseJSON=function(a){return JSON.parse(a+"")};n.parseXML=function(a){var b,c;if(!a||"string"!==typeof a)return null;try{c=new DOMParser,b=c.parseFromString(a,"text/xml")}catch(d){b=void 0}b&&!b.getElementsByTagName("parsererror").length||n.error("Invalid XML: "+
a);return b};var Ba,oa,Lb=/#.*$/,wb=/([?&])_=[^&]*/,xb=/^(.*?):[ \t]*([^\r\n]*)$/mg,Mb=/^(?:GET|HEAD)$/,xa=/^\/\//,Na=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,Ia={},bb={},gb="*/".concat("*");try{oa=location.href}catch(ha){oa=S.createElement("a"),oa.href="",oa=oa.href}Ba=Na.exec(oa.toLowerCase())||[];n.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:oa,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Ba[1]),global:!0,processData:!0,async:!0,
contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":gb,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":n.parseJSON,"text xml":n.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,b){return b?Y(Y(a,n.ajaxSettings),b):Y(n.ajaxSettings,
a)},ajaxPrefilter:Q(Ia),ajaxTransport:Q(bb),ajax:function(a,b){function c(a,b,u,f){var k,t,m,I;I=b;if(2!==v){v=2;h&&clearTimeout(h);d=void 0;l=f||"";r.readyState=0<a?4:0;f=200<=a&&300>a||304===a;if(u){m=y;for(var x=r,C,w,Z,ta,J=m.contents,A=m.dataTypes;"*"===A[0];)A.shift(),void 0===C&&(C=m.mimeType||x.getResponseHeader("Content-Type"));if(C)for(w in J)if(J[w]&&J[w].test(C)){A.unshift(w);break}if(A[0]in u)Z=A[0];else{for(w in u){if(!A[0]||m.converters[w+" "+A[0]]){Z=w;break}ta||(ta=w)}Z=Z||ta}Z?(Z!==
A[0]&&A.unshift(Z),m=u[Z]):m=void 0}a:{u=y;C=m;w=r;Z=f;var Cb,Q,D,x={},J=u.dataTypes.slice();if(J[1])for(Q in u.converters)x[Q.toLowerCase()]=u.converters[Q];for(ta=J.shift();ta;)if(u.responseFields[ta]&&(w[u.responseFields[ta]]=C),!D&&Z&&u.dataFilter&&(C=u.dataFilter(C,u.dataType)),D=ta,ta=J.shift())if("*"===ta)ta=D;else if("*"!==D&&D!==ta){Q=x[D+" "+ta]||x["* "+ta];if(!Q)for(Cb in x)if(m=Cb.split(" "),m[1]===ta&&(Q=x[D+" "+m[0]]||x["* "+m[0]])){!0===Q?Q=x[Cb]:!0!==x[Cb]&&(ta=m[0],J.unshift(m[1]));
break}if(!0!==Q)if(Q&&u["throws"])C=Q(C);else try{C=Q(C)}catch(F){m={state:"parsererror",error:Q?F:"No conversion from "+D+" to "+ta};break a}}m={state:"success",data:C}}if(f)y.ifModified&&((I=r.getResponseHeader("Last-Modified"))&&(n.lastModified[e]=I),(I=r.getResponseHeader("etag"))&&(n.etag[e]=I)),204===a||"HEAD"===y.type?I="nocontent":304===a?I="notmodified":(I=m.state,k=m.data,t=m.error,f=!t);else if(t=I,a||!I)I="error",0>a&&(a=0);r.status=a;r.statusText=(b||I)+"";f?p.resolveWith(N,[k,I,r]):
p.rejectWith(N,[r,I,t]);r.statusCode(z);z=void 0;g&&q.trigger(f?"ajaxSuccess":"ajaxError",[r,y,f?k:t]);B.fireWith(N,[r,I]);g&&(q.trigger("ajaxComplete",[r,y]),--n.active||n.event.trigger("ajaxStop"))}}"object"===typeof a&&(b=a,a=void 0);b=b||{};var d,e,l,f,h,k,g,u,y=n.ajaxSetup({},b),N=y.context||y,q=y.context&&(N.nodeType||N.jquery)?n(N):n.event,p=n.Deferred(),B=n.Callbacks("once memory"),z=y.statusCode||{},t={},m={},v=0,I="canceled",r={readyState:0,getResponseHeader:function(a){var b;if(2===v){if(!f)for(f=
{};b=xb.exec(l);)f[b[1].toLowerCase()]=b[2];b=f[a.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return 2===v?l:null},setRequestHeader:function(a,b){var c=a.toLowerCase();v||(a=m[c]=m[c]||a,t[a]=b);return this},overrideMimeType:function(a){v||(y.mimeType=a);return this},statusCode:function(a){var b;if(a)if(2>v)for(b in a)z[b]=[z[b],a[b]];else r.always(a[r.status]);return this},abort:function(a){a=a||I;d&&d.abort(a);c(0,a);return this}};p.promise(r).complete=B.add;r.success=
r.done;r.error=r.fail;y.url=((a||y.url||oa)+"").replace(Lb,"").replace(xa,Ba[1]+"//");y.type=b.method||b.type||y.method||y.type;y.dataTypes=n.trim(y.dataType||"*").toLowerCase().match(ua)||[""];null==y.crossDomain&&(k=Na.exec(y.url.toLowerCase()),y.crossDomain=!(!k||k[1]===Ba[1]&&k[2]===Ba[2]&&(k[3]||("http:"===k[1]?"80":"443"))===(Ba[3]||("http:"===Ba[1]?"80":"443"))));y.data&&y.processData&&"string"!==typeof y.data&&(y.data=n.param(y.data,y.traditional));ma(Ia,y,b,r);if(2===v)return r;(g=y.global)&&
0===n.active++&&n.event.trigger("ajaxStart");y.type=y.type.toUpperCase();y.hasContent=!Mb.test(y.type);e=y.url;y.hasContent||(y.data&&(e=y.url+=(vb.test(e)?"&":"?")+y.data,delete y.data),!1===y.cache&&(y.url=wb.test(e)?e.replace(wb,"$1_="+ub++):e+(vb.test(e)?"&":"?")+"_="+ub++));y.ifModified&&(n.lastModified[e]&&r.setRequestHeader("If-Modified-Since",n.lastModified[e]),n.etag[e]&&r.setRequestHeader("If-None-Match",n.etag[e]));(y.data&&y.hasContent&&!1!==y.contentType||b.contentType)&&r.setRequestHeader("Content-Type",
y.contentType);r.setRequestHeader("Accept",y.dataTypes[0]&&y.accepts[y.dataTypes[0]]?y.accepts[y.dataTypes[0]]+("*"!==y.dataTypes[0]?", "+gb+"; q=0.01":""):y.accepts["*"]);for(u in y.headers)r.setRequestHeader(u,y.headers[u]);if(y.beforeSend&&(!1===y.beforeSend.call(N,r,y)||2===v))return r.abort();I="abort";for(u in{success:1,error:1,complete:1})r[u](y[u]);if(d=ma(bb,y,b,r)){r.readyState=1;g&&q.trigger("ajaxSend",[r,y]);y.async&&0<y.timeout&&(h=setTimeout(function(){r.abort("timeout")},y.timeout));
try{v=1,d.send(t,c)}catch(x){if(2>v)c(-1,x);else throw x;}}else c(-1,"No Transport");return r},getJSON:function(a,b,c){return n.get(a,b,c,"json")},getScript:function(a,b){return n.get(a,void 0,b,"script")}});n.each(["get","post"],function(a,b){n[b]=function(a,c,d,e){n.isFunction(c)&&(e=e||d,d=c,c=void 0);return n.ajax({url:a,type:b,dataType:e,data:c,success:d})}});n.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(a,b){n.fn[b]=function(a){return this.on(b,
a)}});n._evalUrl=function(a){return n.ajax({url:a,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})};n.fn.extend({wrapAll:function(a){var b;if(n.isFunction(a))return this.each(function(b){n(this).wrapAll(a.call(this,b))});this[0]&&(b=n(a,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){for(var a=this;a.firstElementChild;)a=a.firstElementChild;return a}).append(this));return this},wrapInner:function(a){return n.isFunction(a)?this.each(function(b){n(this).wrapInner(a.call(this,
b))}):this.each(function(){var b=n(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=n.isFunction(a);return this.each(function(c){n(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){n.nodeName(this,"body")||n(this).replaceWith(this.childNodes)}).end()}});n.expr.filters.hidden=function(a){return 0>=a.offsetWidth&&0>=a.offsetHeight};n.expr.filters.visible=function(a){return!n.expr.filters.hidden(a)};var Xa=/%20/g,Ja=/\[\]$/,Ya=
/\r?\n/g,Qb=/^(?:submit|button|image|reset|file)$/i,Rb=/^(?:input|select|textarea|keygen)/i;n.param=function(a,b){var c,d=[],e=function(a,b){b=n.isFunction(b)?b():null==b?"":b;d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};void 0===b&&(b=n.ajaxSettings&&n.ajaxSettings.traditional);if(n.isArray(a)||a.jquery&&!n.isPlainObject(a))n.each(a,function(){e(this.name,this.value)});else for(c in a)V(c,a[c],b,e);return d.join("&").replace(Xa,"+")};n.fn.extend({serialize:function(){return n.param(this.serializeArray())},
serializeArray:function(){return this.map(function(){var a=n.prop(this,"elements");return a?n.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!n(this).is(":disabled")&&Rb.test(this.nodeName)&&!Qb.test(a)&&(this.checked||!ob.test(a))}).map(function(a,b){var c=n(this).val();return null==c?null:n.isArray(c)?n.map(c,function(a){return{name:b.name,value:a.replace(Ya,"\r\n")}}):{name:b.name,value:c.replace(Ya,"\r\n")}}).get()}});n.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(a){}};
var Nb=0,fa={},Sb={0:200,1223:204},Za=n.ajaxSettings.xhr();if(g.ActiveXObject)n(g).on("unload",function(){for(var a in fa)fa[a]()});ba.cors=!!Za&&"withCredentials"in Za;ba.ajax=Za=!!Za;n.ajaxTransport(function(a){var b;if(ba.cors||Za&&!a.crossDomain)return{send:function(c,d){var e,l=a.xhr(),f=++Nb;l.open(a.type,a.url,a.async,a.username,a.password);if(a.xhrFields)for(e in a.xhrFields)l[e]=a.xhrFields[e];a.mimeType&&l.overrideMimeType&&l.overrideMimeType(a.mimeType);a.crossDomain||c["X-Requested-With"]||
(c["X-Requested-With"]="XMLHttpRequest");for(e in c)l.setRequestHeader(e,c[e]);b=function(a){return function(){b&&(delete fa[f],b=l.onload=l.onerror=null,"abort"===a?l.abort():"error"===a?d(l.status,l.statusText):d(Sb[l.status]||l.status,l.statusText,"string"===typeof l.responseText?{text:l.responseText}:void 0,l.getAllResponseHeaders()))}};l.onload=b();l.onerror=b("error");b=fa[f]=b("abort");try{l.send(a.hasContent&&a.data||null)}catch(h){if(b)throw h;}},abort:function(){b&&b()}}});n.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},
contents:{script:/(?:java|ecma)script/},converters:{"text script":function(a){n.globalEval(a);return a}}});n.ajaxPrefilter("script",function(a){void 0===a.cache&&(a.cache=!1);a.crossDomain&&(a.type="GET")});n.ajaxTransport("script",function(a){if(a.crossDomain){var b,c;return{send:function(d,e){b=n("<script>").prop({async:!0,charset:a.scriptCharset,src:a.url}).on("load error",c=function(a){b.remove();c=null;a&&e("error"===a.type?404:200,a.type)});S.head.appendChild(b[0])},abort:function(){c&&c()}}}});
var yb=[],$a=/(=)\?(?=&|$)|\?\?/;n.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=yb.pop()||n.expando+"_"+ub++;this[a]=!0;return a}});n.ajaxPrefilter("json jsonp",function(a,b,c){var d,e,l,f=!1!==a.jsonp&&($a.test(a.url)?"url":"string"===typeof a.data&&!(a.contentType||"").indexOf("application/x-www-form-urlencoded")&&$a.test(a.data)&&"data");if(f||"jsonp"===a.dataTypes[0])return d=a.jsonpCallback=n.isFunction(a.jsonpCallback)?a.jsonpCallback():a.jsonpCallback,f?a[f]=a[f].replace($a,"$1"+
d):!1!==a.jsonp&&(a.url+=(vb.test(a.url)?"&":"?")+a.jsonp+"="+d),a.converters["script json"]=function(){l||n.error(d+" was not called");return l[0]},a.dataTypes[0]="json",e=g[d],g[d]=function(){l=arguments},c.always(function(){g[d]=e;a[d]&&(a.jsonpCallback=b.jsonpCallback,yb.push(d));l&&n.isFunction(e)&&e(l[0]);l=e=void 0}),"script"});n.parseHTML=function(a,b,c){if(!a||"string"!==typeof a)return null;"boolean"===typeof b&&(c=b,b=!1);b=b||S;var d=nb.exec(a);c=!c&&[];if(d)return[b.createElement(d[1])];
d=n.buildFragment([a],b,c);c&&c.length&&n(c).remove();return n.merge([],d.childNodes)};var hb=n.fn.load;n.fn.load=function(a,b,c){if("string"!==typeof a&&hb)return hb.apply(this,arguments);var d,e,l,f=this,h=a.indexOf(" ");0<=h&&(d=n.trim(a.slice(h)),a=a.slice(0,h));n.isFunction(b)?(c=b,b=void 0):b&&"object"===typeof b&&(e="POST");0<f.length&&n.ajax({url:a,type:e,dataType:"html",data:b}).done(function(a){l=arguments;f.html(d?n("<div>").append(n.parseHTML(a)).find(d):a)}).complete(c&&function(a,b){f.each(c,
l||[a.responseText,b,a])});return this};n.expr.filters.animated=function(a){return n.grep(n.timers,function(b){return a===b.elem}).length};var ib=g.document.documentElement;n.offset={setOffset:function(a,b,c){var d,e,l,f=n.css(a,"position"),h=n(a),k={};"static"===f&&(a.style.position="relative");l=h.offset();e=n.css(a,"top");d=n.css(a,"left");("absolute"===f||"fixed"===f)&&-1<(e+d).indexOf("auto")?(d=h.position(),e=d.top,d=d.left):(e=parseFloat(e)||0,d=parseFloat(d)||0);n.isFunction(b)&&(b=b.call(a,
c,l));null!=b.top&&(k.top=b.top-l.top+e);null!=b.left&&(k.left=b.left-l.left+d);"using"in b?b.using.call(a,k):h.css(k)}};n.fn.extend({offset:function(a){if(arguments.length)return void 0===a?this:this.each(function(b){n.offset.setOffset(this,a,b)});var b,c;c=this[0];var d={top:0,left:0},e=c&&c.ownerDocument;if(e){b=e.documentElement;if(!n.contains(b,c))return d;"undefined"!==typeof c.getBoundingClientRect&&(d=c.getBoundingClientRect());c=la(e);return{top:d.top+c.pageYOffset-b.clientTop,left:d.left+
c.pageXOffset-b.clientLeft}}},position:function(){if(this[0]){var a,b,c=this[0],d={top:0,left:0};"fixed"===n.css(c,"position")?b=c.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),n.nodeName(a[0],"html")||(d=a.offset()),d.top+=n.css(a[0],"borderTopWidth",!0),d.left+=n.css(a[0],"borderLeftWidth",!0));return{top:b.top-d.top-n.css(c,"marginTop",!0),left:b.left-d.left-n.css(c,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent||ib;a&&!n.nodeName(a,
"html")&&"static"===n.css(a,"position");)a=a.offsetParent;return a||ib})}});n.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,b){var c="pageYOffset"===b;n.fn[a]=function(d){return za(this,function(a,d,e){var l=la(a);if(void 0===e)return l?l[b]:a[d];l?l.scrollTo(c?g.pageXOffset:e,c?e:g.pageYOffset):a[d]=e},a,d,arguments.length,null)}});n.each(["top","left"],function(a,b){n.cssHooks[b]=L(ba.pixelPosition,function(a,c){if(c)return c=H(a,b),sa.test(c)?n(a).position()[b]+"px":c})});
n.each({Height:"height",Width:"width"},function(a,b){n.each({padding:"inner"+a,content:b,"":"outer"+a},function(c,d){n.fn[d]=function(d,e){var l=arguments.length&&(c||"boolean"!==typeof d),f=c||(!0===d||!0===e?"margin":"border");return za(this,function(b,c,d){return n.isWindow(b)?b.document.documentElement["client"+a]:9===b.nodeType?(c=b.documentElement,Math.max(b.body["scroll"+a],c["scroll"+a],b.body["offset"+a],c["offset"+a],c["client"+a])):void 0===d?n.css(b,c,f):n.style(b,c,d,f)},b,l?d:void 0,
l,null)}})});n.fn.size=function(){return this.length};n.fn.andSelf=n.fn.addBack;"function"===typeof define&&define.amd&&define("jquery",[],function(){return n});var jb=g.jQuery,Tb=g.$;n.noConflict=function(a){g.$===n&&(g.$=Tb);a&&g.jQuery===n&&(g.jQuery=jb);return n};"undefined"===typeof m&&(g.jQuery=g.$=n);return n});/*
   Copyright 2008-2014 SpryMedia Ltd.

 This source file is free software, available under the following license:
   MIT license - http://datatables.net/license

 This source file is distributed in the hope that it will be useful, but
 WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY
 or FITNESS FOR A PARTICULAR PURPOSE. See the license files for details.

 For details please refer to: http://www.datatables.net
*/
(function(g,m,a){(function(a){"function"===typeof define&&define.amd?define("datatables",["jquery"],a):"object"===typeof exports?a(require("jquery")):jQuery&&!jQuery.fn.dataTable&&a(jQuery)})(function(b){function d(a){var c,e,l={};b.each(a,function(b,f){(c=b.match(/^([^A-Z]+?)([A-Z])/))&&-1!=="a aa ai ao as b fn i m o s ".indexOf(c[1]+" ")&&(e=b.replace(c[0],c[2].toLowerCase()),l[e]=b,"o"===c[1]&&d(a[b]))});a._hungarianMap=l}function k(c,e,l){c._hungarianMap||d(c);var f;b.each(e,function(d,h){f=c._hungarianMap[d];
f===a||!l&&e[f]!==a||("o"===f.charAt(0)?(e[f]||(e[f]={}),b.extend(!0,e[f],e[d]),k(c[f],e[f],l)):e[f]=e[d])})}function f(a){var b=G.defaults.oLanguage,c=a.sZeroRecords;!a.sEmptyTable&&c&&"No data available in table"===b.sEmptyTable&&sa(a,a,"sZeroRecords","sEmptyTable");!a.sLoadingRecords&&c&&"Loading..."===b.sLoadingRecords&&sa(a,a,"sZeroRecords","sLoadingRecords");a.sInfoThousands&&(a.sThousands=a.sInfoThousands);(a=a.sDecimal)&&Wa(a)}function p(a){ha(a,"ordering","bSort");ha(a,"orderMulti","bSortMulti");
ha(a,"orderClasses","bSortClasses");ha(a,"orderCellsTop","bSortCellsTop");ha(a,"order","aaSorting");ha(a,"orderFixed","aaSortingFixed");ha(a,"paging","bPaginate");ha(a,"pagingType","sPaginationType");ha(a,"pageLength","iDisplayLength");ha(a,"searching","bFilter");if(a=a.aoSearchCols)for(var b=0,c=a.length;b<c;b++)a[b]&&k(G.models.oSearch,a[b])}function e(a){ha(a,"orderable","bSortable");ha(a,"orderData","aDataSort");ha(a,"orderSequence","asSorting");ha(a,"orderDataType","sortDataType")}function w(a){a=
a.oBrowser;var c=b("<div/>").css({position:"absolute",top:0,left:0,height:1,width:1,overflow:"hidden"}).append(b("<div/>").css({position:"absolute",top:1,left:1,width:100,overflow:"scroll"}).append(b('<div class="test"/>').css({width:"100%",height:10}))).appendTo("body"),d=c.find(".test");a.bScrollOversize=100===d[0].offsetWidth;a.bScrollbarLeft=1!==d.offset().left;c.remove()}function r(b,c,d,e,l,f){var h,k=!1;d!==a&&(h=d,k=!0);for(;e!==l;)b.hasOwnProperty(e)&&(h=k?c(h,b[e],e,b):b[e],k=!0,e+=f);return h}
function h(a,c){var d=G.defaults.column,e=a.aoColumns.length,d=b.extend({},G.models.oColumn,d,{nTh:c?c:m.createElement("th"),sTitle:d.sTitle?d.sTitle:c?c.innerHTML:"",aDataSort:d.aDataSort?d.aDataSort:[e],mData:d.mData?d.mData:e,idx:e});a.aoColumns.push(d);d=a.aoPreSearchCols;d[e]=b.extend({},G.models.oSearch,d[e]);v(a,e,null)}function v(c,d,l){d=c.aoColumns[d];var f=c.oClasses,h=b(d.nTh);if(!d.sWidthOrig){d.sWidthOrig=h.attr("width")||null;var g=(h.attr("style")||"").match(/width:\s*(\d+[pxem%]+)/);
g&&(d.sWidthOrig=g[1])}l!==a&&null!==l&&(e(l),k(G.defaults.column,l),l.mDataProp===a||l.mData||(l.mData=l.mDataProp),l.sType&&(d._sManualType=l.sType),l.className&&!l.sClass&&(l.sClass=l.className),b.extend(d,l),sa(d,l,"sWidth","sWidthOrig"),"number"===typeof l.iDataSort&&(d.aDataSort=[l.iDataSort]),sa(d,l,"aDataSort"));var q=d.mData,p=F(q),B=d.mRender?F(d.mRender):null;l=function(a){return"string"===typeof a&&-1!==a.indexOf("@")};d._bAttrSrc=b.isPlainObject(q)&&(l(q.sort)||l(q.type)||l(q.filter));
d.fnGetData=function(b,c,d){var e=p(b,c,a,d);return B&&c?B(e,c,b,d):e};d.fnSetData=function(a,b,c){return P(q)(a,b,c)};"number"!==typeof q&&(c._rowReadObject=!0);c.oFeatures.bSort||(d.bSortable=!1,h.addClass(f.sSortableNone));c=-1!==b.inArray("asc",d.asSorting);l=-1!==b.inArray("desc",d.asSorting);d.bSortable&&(c||l)?c&&!l?(d.sSortingClass=f.sSortableAsc,d.sSortingClassJUI=f.sSortJUIAscAllowed):!c&&l?(d.sSortingClass=f.sSortableDesc,d.sSortingClassJUI=f.sSortJUIDescAllowed):(d.sSortingClass=f.sSortable,
d.sSortingClassJUI=f.sSortJUI):(d.sSortingClass=f.sSortableNone,d.sSortingClassJUI="")}function c(a){if(!1!==a.oFeatures.bAutoWidth){var b=a.aoColumns;Aa(a);for(var c=0,d=b.length;c<d;c++)b[c].nTh.style.width=b[c].sWidth}b=a.oScroll;""===b.sY&&""===b.sX||Oa(a);ea(a,null,"column-sizing",[a])}function t(a,b){var c=D(a,"bVisible");return"number"===typeof c[b]?c[b]:null}function x(a,c){var d=D(a,"bVisible"),d=b.inArray(c,d);return-1!==d?d:null}function A(a){return D(a,"bVisible").length}function D(a,
c){var d=[];b.map(a.aoColumns,function(a,b){a[c]&&d.push(b)});return d}function E(b){var c=b.aoColumns,d=b.aoData,e=G.ext.type.detect,l,f,h,k,g,q,p,B,z;l=0;for(f=c.length;l<f;l++)if(p=c[l],z=[],!p.sType&&p._sManualType)p.sType=p._sManualType;else if(!p.sType){h=0;for(k=e.length;h<k;h++){g=0;for(q=d.length;g<q;g++){z[g]===a&&(z[g]=J(b,g,l,"type"));B=e[h](z[g],b);if(!B&&h!==e.length-1)break;if("html"===B)break}if(B){p.sType=B;break}}p.sType||(p.sType="string")}}function R(c,d,e,l){var f,k,g,q,p,B,z=
c.aoColumns;if(d)for(f=d.length-1;0<=f;f--){B=d[f];var m=B.targets!==a?B.targets:B.aTargets;b.isArray(m)||(m=[m]);k=0;for(g=m.length;k<g;k++)if("number"===typeof m[k]&&0<=m[k]){for(;z.length<=m[k];)h(c);l(m[k],B)}else if("number"===typeof m[k]&&0>m[k])l(z.length+m[k],B);else if("string"===typeof m[k])for(q=0,p=z.length;q<p;q++)("_all"==m[k]||b(z[q].nTh).hasClass(m[k]))&&l(q,B)}if(e)for(f=0,c=e.length;f<c;f++)l(f,e[f])}function H(a,c,d,e){var l=a.aoData.length,f=b.extend(!0,{},G.models.oRow,{src:d?
"dom":"data"});f._aData=c;a.aoData.push(f);c=a.aoColumns;for(var f=0,h=c.length;f<h;f++)d&&K(a,l,f,J(a,l,f)),c[f].sType=null;a.aiDisplayMaster.push(l);!d&&a.oFeatures.bDeferRender||Z(a,l,d,e);return l}function L(a,c){var d;c instanceof b||(c=b(c));return c.map(function(b,c){d=I(a,c);return H(a,d.data,c,d.cells)})}function J(b,c,d,e){var l=b.iDraw,f=b.aoColumns[d],h=b.aoData[c]._aData,k=f.sDefaultContent;d=f.fnGetData(h,e,{settings:b,row:c,col:d});if(d===a)return b.iDrawError!=l&&null===k&&(Ea(b,0,
"Requested unknown parameter "+("function"==typeof f.mData?"{function}":"'"+f.mData+"'")+" for row "+c,4),b.iDrawError=l),k;if((d===h||null===d)&&null!==k)d=k;else if("function"===typeof d)return d.call(h);return null===d&&"display"==e?"":d}function K(a,b,c,d){a.aoColumns[c].fnSetData(a.aoData[b]._aData,d,{settings:a,row:b,col:c})}function C(a){return b.map(a.match(/(\\.|[^\.])+/g),function(a){return a.replace(/\\./g,".")})}function F(c){if(b.isPlainObject(c)){var d={};b.each(c,function(a,b){b&&(d[a]=
F(b))});return function(b,c,e,l){var u=d[c]||d._;return u!==a?u(b,c,e,l):b}}if(null===c)return function(a){return a};if("function"===typeof c)return function(a,b,d,e){return c(a,b,d,e)};if("string"!==typeof c||-1===c.indexOf(".")&&-1===c.indexOf("[")&&-1===c.indexOf("("))return function(a,b){return a[c]};var e=function(b,c,d){var l,u;if(""!==d){u=C(d);for(var f=0,h=u.length;f<h;f++){d=u[f].match(Xa);l=u[f].match(Ja);if(d){u[f]=u[f].replace(Xa,"");""!==u[f]&&(b=b[u[f]]);l=[];u.splice(0,f+1);u=u.join(".");
f=0;for(h=b.length;f<h;f++)l.push(e(b[f],c,u));b=d[0].substring(1,d[0].length-1);b=""===b?l:l.join(b);break}else if(l){u[f]=u[f].replace(Ja,"");b=b[u[f]]();continue}if(null===b||b[u[f]]===a)return a;b=b[u[f]]}}return b};return function(a,b){return e(a,b,c)}}function P(c){if(b.isPlainObject(c))return P(c._);if(null===c)return function(){};if("function"===typeof c)return function(a,b,d){c(a,"set",b,d)};if("string"!==typeof c||-1===c.indexOf(".")&&-1===c.indexOf("[")&&-1===c.indexOf("("))return function(a,
b){a[c]=b};var d=function(b,c,e){e=C(e);var l;l=e[e.length-1];for(var u,f,h=0,k=e.length-1;h<k;h++){u=e[h].match(Xa);f=e[h].match(Ja);if(u){e[h]=e[h].replace(Xa,"");b[e[h]]=[];l=e.slice();l.splice(0,h+1);u=l.join(".");f=0;for(k=c.length;f<k;f++)l={},d(l,c[f],u),b[e[h]].push(l);return}f&&(e[h]=e[h].replace(Ja,""),b=b[e[h]](c));if(null===b[e[h]]||b[e[h]]===a)b[e[h]]={};b=b[e[h]]}if(l.match(Ja))b[l.replace(Ja,"")](c);else b[l.replace(Xa,"")]=c};return function(a,b){return d(a,b,c)}}function l(a){return xa(a.aoData,
"_aData")}function q(a){a.aoData.length=0;a.aiDisplayMaster.length=0;a.aiDisplay.length=0}function B(b,c,d){for(var e=-1,l=0,f=b.length;l<f;l++)b[l]==c?e=l:b[l]>c&&b[l]--; -1!=e&&d===a&&b.splice(e,1)}function z(b,c,d,e){var l=b.aoData[c],f,h=function(a,d){for(;a.childNodes.length;)a.removeChild(a.firstChild);a.innerHTML=J(b,c,d,"display")};if("dom"!==d&&(d&&"auto"!==d||"dom"!==l.src)){var k=l.anCells;if(k)if(e!==a)h(k[e],e);else for(d=0,f=k.length;d<f;d++)h(k[d],d)}else l._aData=I(b,l,e,e===a?a:l._aData).data;
l._aSortData=null;l._aFilterData=null;h=b.aoColumns;if(e!==a)h[e].sType=null;else{d=0;for(f=h.length;d<f;d++)h[d].sType=null;Q(l)}}function I(c,d,e,l){var f=[],h=d.firstChild,k,g=0,q,p=c.aoColumns,B=c._rowReadObject;l=l||B?{}:[];var z=function(a,b){if("string"===typeof a){var c=a.indexOf("@");-1!==c&&(c=a.substring(c+1),P(a)(l,b.getAttribute(c)))}};c=function(c){if(e===a||e===g)k=p[g],q=b.trim(c.innerHTML),k&&k._bAttrSrc?(P(k.mData._)(l,q),z(k.mData.sort,c),z(k.mData.type,c),z(k.mData.filter,c)):
B?(k._setter||(k._setter=P(k.mData)),k._setter(l,q)):l[g]=q;g++};if(h)for(;h;){d=h.nodeName.toUpperCase();if("TD"==d||"TH"==d)c(h),f.push(h);h=h.nextSibling}else for(f=d.anCells,h=0,d=f.length;h<d;h++)c(f[h]);return{data:l,cells:f}}function Z(a,b,c,d){var e=a.aoData[b],l=e._aData,f=[],h,k,g,q,p;if(null===e.nTr){h=c||m.createElement("tr");e.nTr=h;e.anCells=f;h._DT_RowIndex=b;Q(e);q=0;for(p=a.aoColumns.length;q<p;q++){g=a.aoColumns[q];k=c?d[q]:m.createElement(g.sCellType);f.push(k);if(!c||g.mRender||
g.mData!==q)k.innerHTML=J(a,b,q,"display");g.sClass&&(k.className+=" "+g.sClass);g.bVisible&&!c?h.appendChild(k):!g.bVisible&&c&&k.parentNode.removeChild(k);g.fnCreatedCell&&g.fnCreatedCell.call(a.oInstance,k,J(a,b,q),l,b,q)}ea(a,"aoRowCreatedCallback",null,[h,l,b])}e.nTr.setAttribute("role","row")}function Q(a){var c=a.nTr,d=a._aData;if(c){d.DT_RowId&&(c.id=d.DT_RowId);if(d.DT_RowClass){var e=d.DT_RowClass.split(" ");a.__rowc=a.__rowc?gb(a.__rowc.concat(e)):e;b(c).removeClass(a.__rowc.join(" ")).addClass(d.DT_RowClass)}d.DT_RowData&&
b(c).data(d.DT_RowData)}}function ma(a){var c,d,e,l,f,h=a.nTHead,k=a.nTFoot,g=0===b("th, td",h).length,q=a.oClasses,p=a.aoColumns;g&&(l=b("<tr/>").appendTo(h));c=0;for(d=p.length;c<d;c++)f=p[c],e=b(f.nTh).addClass(f.sClass),g&&e.appendTo(l),a.oFeatures.bSort&&(e.addClass(f.sSortingClass),!1!==f.bSortable&&(e.attr("tabindex",a.iTabIndex).attr("aria-controls",a.sTableId),eb(a,f.nTh,c))),f.sTitle!=e.html()&&e.html(f.sTitle),fb(a,"header")(a,e,f,q);g&&da(a.aoHeader,h);b(h).find(">tr").attr("role","row");
b(h).find(">tr>th, >tr>td").addClass(q.sHeaderTH);b(k).find(">tr>th, >tr>td").addClass(q.sFooterTH);if(null!==k)for(a=a.aoFooter[0],c=0,d=a.length;c<d;c++)f=p[c],f.nTf=a[c].cell,f.sClass&&b(f.nTf).addClass(f.sClass)}function Y(c,d,e){var l,f,h,k=[],g=[],q=c.aoColumns.length,p;if(d){e===a&&(e=!1);l=0;for(f=d.length;l<f;l++){k[l]=d[l].slice();k[l].nTr=d[l].nTr;for(h=q-1;0<=h;h--)c.aoColumns[h].bVisible||e||k[l].splice(h,1);g.push([])}l=0;for(f=k.length;l<f;l++){if(c=k[l].nTr)for(;h=c.firstChild;)c.removeChild(h);
h=0;for(d=k[l].length;h<d;h++)if(p=q=1,g[l][h]===a){c.appendChild(k[l][h].cell);for(g[l][h]=1;k[l+q]!==a&&k[l][h].cell==k[l+q][h].cell;)g[l+q][h]=1,q++;for(;k[l][h+p]!==a&&k[l][h].cell==k[l][h+p].cell;){for(e=0;e<q;e++)g[l+e][h+p]=1;p++}b(k[l][h].cell).attr("rowspan",q).attr("colspan",p)}}}}function V(c){var d=ea(c,"aoPreDrawCallback","preDraw",[c]);if(-1!==b.inArray(!1,d))X(c,!1);else{var d=[],e=0,f=c.asStripeClasses,h=f.length,k=c.oLanguage,g=c.iInitDisplayStart,q="ssp"==pa(c),p=c.aiDisplay;c.bDrawing=
!0;g!==a&&-1!==g&&(c._iDisplayStart=q?g:g>=c.fnRecordsDisplay()?0:g,c.iInitDisplayStart=-1);var g=c._iDisplayStart,B=c.fnDisplayEnd();if(c.bDeferLoading)c.bDeferLoading=!1,c.iDraw++,X(c,!1);else if(!q)c.iDraw++;else if(!c.bDestroying&&!ya(c))return;if(0!==p.length)for(k=q?c.aoData.length:B,q=q?0:g;q<k;q++){var z=p[q],m=c.aoData[z];null===m.nTr&&Z(c,z);z=m.nTr;if(0!==h){var n=f[e%h];m._sRowStripe!=n&&(b(z).removeClass(m._sRowStripe).addClass(n),m._sRowStripe=n)}ea(c,"aoRowCallback",null,[z,m._aData,
e,q]);d.push(z);e++}else e=k.sZeroRecords,1==c.iDraw&&"ajax"==pa(c)?e=k.sLoadingRecords:k.sEmptyTable&&0===c.fnRecordsTotal()&&(e=k.sEmptyTable),d[0]=b("<tr/>",{"class":h?f[0]:""}).append(b("<td />",{valign:"top",colSpan:A(c),"class":c.oClasses.sRowEmpty}).html(e))[0];ea(c,"aoHeaderCallback","header",[b(c.nTHead).children("tr")[0],l(c),g,B,p]);ea(c,"aoFooterCallback","footer",[b(c.nTFoot).children("tr")[0],l(c),g,B,p]);f=b(c.nTBody);f.children().detach();f.append(b(d));ea(c,"aoDrawCallback","draw",
[c]);c.bSorted=!1;c.bFiltered=!1;c.bDrawing=!1}}function la(a,b){var c=a.oFeatures,d=c.bFilter;c.bSort&&Gb(a);d?S(a,a.oPreviousSearch):a.aiDisplay=a.aiDisplayMaster.slice();!0!==b&&(a._iDisplayStart=0);a._drawHold=b;V(a);a._drawHold=!1}function ja(a){var c=a.oClasses,d=b(a.nTable),d=b("<div/>").insertBefore(d),e=a.oFeatures,l=b("<div/>",{id:a.sTableId+"_wrapper","class":c.sWrapper+(a.nTFoot?"":" "+c.sNoFooter)});a.nHolding=d[0];a.nTableWrapper=l[0];a.nTableReinsertBefore=a.nTable.nextSibling;for(var f=
a.sDom.split(""),h,k,g,q,p,B,z=0;z<f.length;z++){h=null;k=f[z];if("<"==k){g=b("<div/>")[0];q=f[z+1];if("'"==q||'"'==q){p="";for(B=2;f[z+B]!=q;)p+=f[z+B],B++;"H"==p?p=c.sJUIHeader:"F"==p&&(p=c.sJUIFooter);-1!=p.indexOf(".")?(q=p.split("."),g.id=q[0].substr(1,q[0].length-1),g.className=q[1]):"#"==p.charAt(0)?g.id=p.substr(1,p.length-1):g.className=p;z+=B}l.append(g);l=b(g)}else if(">"==k)l=l.parent();else if("l"==k&&e.bPaginate&&e.bLengthChange)h=kb(a);else if("f"==k&&e.bFilter)h=ba(a);else if("r"==
k&&e.bProcessing)h=M(a);else if("t"==k)h=Ab(a);else if("i"==k&&e.bInfo)h=zb(a);else if("p"==k&&e.bPaginate)h=Va(a);else if(0!==G.ext.feature.length)for(g=G.ext.feature,B=0,q=g.length;B<q;B++)if(k==g[B].cFeature){h=g[B].fnInit(a);break}h&&(g=a.aanFeatures,g[k]||(g[k]=[]),g[k].push(h),l.append(h))}d.replaceWith(l)}function da(a,c){var d=b(c).children("tr"),e,l,f,h,k,g,q,p,B,z;a.splice(0,a.length);f=0;for(g=d.length;f<g;f++)a.push([]);f=0;for(g=d.length;f<g;f++)for(e=d[f],l=e.firstChild;l;){if("TD"==
l.nodeName.toUpperCase()||"TH"==l.nodeName.toUpperCase()){p=1*l.getAttribute("colspan");B=1*l.getAttribute("rowspan");p=p&&0!==p&&1!==p?p:1;B=B&&0!==B&&1!==B?B:1;h=0;for(k=a[f];k[h];)h++;q=h;z=1===p?!0:!1;for(k=0;k<p;k++)for(h=0;h<B;h++)a[f+h][q+k]={cell:l,unique:z},a[f+h].nTr=e}l=l.nextSibling}}function na(a,b,c){var d=[];c||(c=a.aoHeader,b&&(c=[],da(c,b)));b=0;for(var e=c.length;b<e;b++)for(var l=0,f=c[b].length;l<f;l++)!c[b][l].unique||d[l]&&a.bSortCellsTop||(d[l]=c[b][l].cell);return d}function va(a,
c,d){ea(a,"aoServerParams","serverParams",[c]);if(c&&b.isArray(c)){var e={},l=/(.*?)\[\]$/;b.each(c,function(a,b){var c=b.name.match(l);c?(c=c[0],e[c]||(e[c]=[]),e[c].push(b.value)):e[b.name]=b.value});c=e}var f,h=a.ajax,k=a.oInstance;if(b.isPlainObject(h)&&h.data){f=h.data;var g=b.isFunction(f)?f(c):f;c=b.isFunction(f)&&g?g:b.extend(!0,c,g);delete h.data}g={data:c,success:function(b){var c=b.error||b.sError;c&&a.oApi._fnLog(a,0,c);a.json=b;ea(a,null,"xhr",[a,b]);d(b)},dataType:"json",cache:!1,type:a.sServerMethod,
error:function(b,c,d){d=a.oApi._fnLog;"parsererror"==c?d(a,0,"Invalid JSON response",1):4===b.readyState&&d(a,0,"Ajax error",7);X(a,!1)}};a.oAjaxData=c;ea(a,null,"preXhr",[a,c]);a.fnServerData?a.fnServerData.call(k,a.sAjaxSource,b.map(c,function(a,b){return{name:b,value:a}}),d,a):a.sAjaxSource||"string"===typeof h?a.jqXHR=b.ajax(b.extend(g,{url:h||a.sAjaxSource})):b.isFunction(h)?a.jqXHR=h.call(k,c,d,a):(a.jqXHR=b.ajax(b.extend(g,h)),h.data=f)}function ya(a){return a.bAjaxDataGet?(a.iDraw++,X(a,!0),
va(a,wa(a),function(b){Ka(a,b)}),!1):!0}function wa(a){var c=a.aoColumns,d=c.length,e=a.oFeatures,l=a.oPreviousSearch,f=a.aoPreSearchCols,h,k=[],g,q,p,B=Ga(a);h=a._iDisplayStart;g=!1!==e.bPaginate?a._iDisplayLength:-1;var z=function(a,b){k.push({name:a,value:b})};z("sEcho",a.iDraw);z("iColumns",d);z("sColumns",xa(c,"sName").join(","));z("iDisplayStart",h);z("iDisplayLength",g);var m={draw:a.iDraw,columns:[],order:[],start:h,length:g,search:{value:l.sSearch,regex:l.bRegex}};for(h=0;h<d;h++)q=c[h],
p=f[h],g="function"==typeof q.mData?"function":q.mData,m.columns.push({data:g,name:q.sName,searchable:q.bSearchable,orderable:q.bSortable,search:{value:p.sSearch,regex:p.bRegex}}),z("mDataProp_"+h,g),e.bFilter&&(z("sSearch_"+h,p.sSearch),z("bRegex_"+h,p.bRegex),z("bSearchable_"+h,q.bSearchable)),e.bSort&&z("bSortable_"+h,q.bSortable);e.bFilter&&(z("sSearch",l.sSearch),z("bRegex",l.bRegex));e.bSort&&(b.each(B,function(a,b){m.order.push({column:b.col,dir:b.dir});z("iSortCol_"+a,b.col);z("sSortDir_"+
a,b.dir)}),z("iSortingCols",B.length));c=G.ext.legacy.ajax;return null===c?a.sAjaxSource?k:m:c?k:m}function Ka(b,c){var d=function(b,d){return c[b]!==a?c[b]:c[d]},e=d("sEcho","draw"),l=d("iTotalRecords","recordsTotal"),d=d("iTotalDisplayRecords","recordsFiltered");if(e){if(1*e<b.iDraw)return;b.iDraw=1*e}q(b);b._iRecordsTotal=parseInt(l,10);b._iRecordsDisplay=parseInt(d,10);e=ra(b,c);l=0;for(d=e.length;l<d;l++)H(b,e[l]);b.aiDisplay=b.aiDisplayMaster.slice();b.bAjaxDataGet=!1;V(b);b._bInitComplete||
db(b,c);b.bAjaxDataGet=!0;X(b,!1)}function ra(c,d){var e=b.isPlainObject(c.ajax)&&c.ajax.dataSrc!==a?c.ajax.dataSrc:c.sAjaxDataProp;return"data"===e?d.aaData||d[e]:""!==e?F(e)(d):d}function ba(a){var c=a.oClasses,d=a.sTableId,e=a.oLanguage,l=a.oPreviousSearch,f=a.aanFeatures,h='<input type="search" class="'+c.sFilterInput+'"/>',k=e.sSearch,k=k.match(/_INPUT_/)?k.replace("_INPUT_",h):k+h,c=b("<div/>",{id:f.f?null:d+"_filter","class":c.sFilter}).append(b("<label/>").append(k)),f=function(){var b=this.value?
this.value:"";b!=l.sSearch&&(S(a,{sSearch:b,bRegex:l.bRegex,bSmart:l.bSmart,bCaseInsensitive:l.bCaseInsensitive}),a._iDisplayStart=0,V(a))},h=null!==a.searchDelay?a.searchDelay:"ssp"===pa(a)?400:0,g=b("input",c).val(l.sSearch).attr("placeholder",e.sSearchPlaceholder).bind("keyup.DT search.DT input.DT paste.DT cut.DT",h?Ca(f,h):f).bind("keypress.DT",function(a){if(13==a.keyCode)return!1}).attr("aria-controls",d);b(a.nTable).on("search.dt.DT",function(b,c){if(a===c)try{g[0]!==m.activeElement&&g.val(l.sSearch)}catch(d){}});
return c[0]}function S(b,c,d){var e=b.oPreviousSearch,l=b.aoPreSearchCols,f=function(a){e.sSearch=a.sSearch;e.bRegex=a.bRegex;e.bSmart=a.bSmart;e.bCaseInsensitive=a.bCaseInsensitive},h=function(b){return b.bEscapeRegex!==a?!b.bEscapeRegex:b.bRegex};E(b);if("ssp"!=pa(b)){La(b,c.sSearch,d,h(c),c.bSmart,c.bCaseInsensitive);f(c);for(c=0;c<l.length;c++)Sa(b,l[c].sSearch,c,h(l[c]),l[c].bSmart,l[c].bCaseInsensitive);n(b)}else f(c);b.bFiltered=!0;ea(b,null,"search",[b])}function n(a){for(var b=G.ext.search,
c=a.aiDisplay,d,e,l=0,f=b.length;l<f;l++){for(var h=[],k=0,g=c.length;k<g;k++)e=c[k],d=a.aoData[e],b[l](a,d._aFilterData,e,d._aData,k)&&h.push(e);c.length=0;c.push.apply(c,h)}}function Sa(a,b,c,d,e,l){if(""!==b){var f=a.aiDisplay;d=lb(b,d,e,l);for(e=f.length-1;0<=e;e--)b=a.aoData[f[e]]._aFilterData[c],d.test(b)||f.splice(e,1)}}function La(a,b,c,d,e,l){d=lb(b,d,e,l);e=a.oPreviousSearch.sSearch;l=a.aiDisplayMaster;var f;0!==G.ext.search.length&&(c=!0);f=Fa(a);if(0>=b.length)a.aiDisplay=l.slice();else{if(f||
c||e.length>b.length||0!==b.indexOf(e)||a.bSorted)a.aiDisplay=l.slice();b=a.aiDisplay;for(c=b.length-1;0<=c;c--)d.test(a.aoData[b[c]]._sFilterRow)||b.splice(c,1)}}function lb(a,c,d,e){a=c?a:cb(a);d&&(a="^(?=.*?"+b.map(a.match(/"[^"]+"|[^ ]+/g)||"",function(a){if('"'===a.charAt(0)){var b=a.match(/^"(.*)"$/);a=b?b[1]:a}return a.replace('"',"")}).join(")(?=.*?")+").*$");return new RegExp(a,e?"i":"")}function cb(a){return a.replace(vb,"\\$1")}function Fa(a){var b=a.aoColumns,c,d,e,l,f,h,k,g,q=G.ext.type.search;
c=!1;d=0;for(l=a.aoData.length;d<l;d++)if(g=a.aoData[d],!g._aFilterData){h=[];e=0;for(f=b.length;e<f;e++)c=b[e],c.bSearchable?(k=J(a,d,e,"filter"),q[c.sType]&&(k=q[c.sType](k)),null===k&&(k=""),"string"!==typeof k&&k.toString&&(k=k.toString())):k="",k.indexOf&&-1!==k.indexOf("&")&&(Ya.innerHTML=k,k=Qb?Ya.textContent:Ya.innerText),k.replace&&(k=k.replace(/[\r\n]/g,"")),h.push(k);g._aFilterData=h;g._sFilterRow=h.join("  ");c=!0}return c}function mb(a){return{search:a.sSearch,smart:a.bSmart,regex:a.bRegex,
caseInsensitive:a.bCaseInsensitive}}function nb(a){return{sSearch:a.search,bSmart:a.smart,bRegex:a.regex,bCaseInsensitive:a.caseInsensitive}}function zb(a){var c=a.sTableId,d=a.aanFeatures.i,e=b("<div/>",{"class":a.oClasses.sInfo,id:d?null:c+"_info"});d||(a.aoDrawCallback.push({fn:Ta,sName:"information"}),e.attr("role","status").attr("aria-live","polite"),b(a.nTable).attr("aria-describedby",c+"_info"));return e[0]}function Ta(a){var c=a.aanFeatures.i;if(0!==c.length){var d=a.oLanguage,e=a._iDisplayStart+
1,l=a.fnDisplayEnd(),f=a.fnRecordsTotal(),h=a.fnRecordsDisplay(),k=h?d.sInfo:d.sInfoEmpty;h!==f&&(k+=" "+d.sInfoFiltered);k+=d.sInfoPostFix;k=Db(a,k);d=d.fnInfoCallback;null!==d&&(k=d.call(a.oInstance,a,e,l,f,h,k));b(c).html(k)}}function Db(a,b){var c=a.fnFormatNumber,d=a._iDisplayStart+1,e=a._iDisplayLength,l=a.fnRecordsDisplay(),f=-1===e;return b.replace(/_START_/g,c.call(a,d)).replace(/_END_/g,c.call(a,a.fnDisplayEnd())).replace(/_MAX_/g,c.call(a,a.fnRecordsTotal())).replace(/_TOTAL_/g,c.call(a,
l)).replace(/_PAGE_/g,c.call(a,f?1:Math.ceil(d/e))).replace(/_PAGES_/g,c.call(a,f?1:Math.ceil(l/e)))}function Ua(a){var b,c,d=a.iInitDisplayStart,e=a.aoColumns,l;c=a.oFeatures;if(a.bInitialised){ja(a);ma(a);Y(a,a.aoHeader);Y(a,a.aoFooter);X(a,!0);c.bAutoWidth&&Aa(a);b=0;for(c=e.length;b<c;b++)l=e[b],l.sWidth&&(l.nTh.style.width=W(l.sWidth));la(a);e=pa(a);"ssp"!=e&&("ajax"==e?va(a,[],function(c){var e=ra(a,c);for(b=0;b<e.length;b++)H(a,e[b]);a.iInitDisplayStart=d;la(a);X(a,!1);db(a,c)},a):(X(a,!1),
db(a)))}else setTimeout(function(){Ua(a)},200)}function db(a,b){a._bInitComplete=!0;b&&c(a);ea(a,"aoInitComplete","init",[a,b])}function ua(a,b){var c=parseInt(b,10);a._iDisplayLength=c;tb(a);ea(a,null,"length",[a,c])}function kb(a){for(var c=a.oClasses,d=a.sTableId,e=a.aLengthMenu,l=b.isArray(e[0]),f=l?e[0]:e,e=l?e[1]:e,l=b("<select/>",{name:d+"_length","aria-controls":d,"class":c.sLengthSelect}),h=0,k=f.length;h<k;h++)l[0][h]=new Option(e[h],f[h]);var g=b("<div><label/></div>").addClass(c.sLength);
a.aanFeatures.l||(g[0].id=d+"_length");g.children().append(a.oLanguage.sLengthMenu.replace("_MENU_",l[0].outerHTML));b("select",g).val(a._iDisplayLength).bind("change.DT",function(c){ua(a,b(this).val());V(a)});b(a.nTable).bind("length.dt.DT",function(c,d,e){a===d&&b("select",g).val(e)});return g[0]}function Va(a){var c=a.sPaginationType,d=G.ext.pager[c],e="function"===typeof d,l=function(a){V(a)},c=b("<div/>").addClass(a.oClasses.sPaging+c)[0],f=a.aanFeatures;e||d.fnInit(a,c,l);f.p||(c.id=a.sTableId+
"_paginate",a.aoDrawCallback.push({fn:function(a){if(e){var b=a._iDisplayStart,c=a._iDisplayLength,h=a.fnRecordsDisplay(),k=-1===c,b=k?0:Math.ceil(b/c),c=k?1:Math.ceil(h/c),h=d(b,c),u,k=0;for(u=f.p.length;k<u;k++)fb(a,"pageButton")(a,f.p[k],k,h,b,c)}else d.fnUpdate(a,l)},sName:"pagination"}));return c}function za(a,b,c){var d=a._iDisplayStart,e=a._iDisplayLength,l=a.fnRecordsDisplay();0===l||-1===e?d=0:"number"===typeof b?(d=b*e,d>l&&(d=0)):"first"==b?d=0:"previous"==b?(d=0<=e?d-e:0,0>d&&(d=0)):"next"==
b?d+e<l&&(d+=e):"last"==b?d=Math.floor((l-1)/e)*e:Ea(a,0,"Unknown paging action: "+b,5);b=a._iDisplayStart!==d;a._iDisplayStart=d;b&&(ea(a,null,"page",[a]),c&&V(a));return b}function M(a){return b("<div/>",{id:a.aanFeatures.r?null:a.sTableId+"_processing","class":a.oClasses.sProcessing}).html(a.oLanguage.sProcessing).insertBefore(a.nTable)[0]}function X(a,c){a.oFeatures.bProcessing&&b(a.aanFeatures.r).css("display",c?"block":"none");ea(a,null,"processing",[a,c])}function Ab(a){var c=b(a.nTable);c.attr("role",
"grid");var d=a.oScroll;if(""===d.sX&&""===d.sY)return a.nTable;var e=d.sX,l=d.sY,f=a.oClasses,h=c.children("caption"),k=h.length?h[0]._captionSide:null,g=b(c[0].cloneNode(!1)),q=b(c[0].cloneNode(!1)),p=c.children("tfoot");d.sX&&"100%"===c.attr("width")&&c.removeAttr("width");p.length||(p=null);d=b("<div/>",{"class":f.sScrollWrapper}).append(b("<div/>",{"class":f.sScrollHead}).css({overflow:"hidden",position:"relative",border:0,width:e?e?W(e):null:"100%"}).append(b("<div/>",{"class":f.sScrollHeadInner}).css({"box-sizing":"content-box",
width:d.sXInner||"100%"}).append(g.removeAttr("id").css("margin-left",0).append("top"===k?h:null).append(c.children("thead"))))).append(b("<div/>",{"class":f.sScrollBody}).css({overflow:"auto",height:l?W(l):null,width:e?W(e):null}).append(c));p&&d.append(b("<div/>",{"class":f.sScrollFoot}).css({overflow:"hidden",border:0,width:e?e?W(e):null:"100%"}).append(b("<div/>",{"class":f.sScrollFootInner}).append(q.removeAttr("id").css("margin-left",0).append("bottom"===k?h:null).append(c.children("tfoot")))));
var c=d.children(),B=c[0],f=c[1],z=p?c[2]:null;e&&b(f).scroll(function(a){a=this.scrollLeft;B.scrollLeft=a;p&&(z.scrollLeft=a)});a.nScrollHead=B;a.nScrollBody=f;a.nScrollFoot=z;a.aoDrawCallback.push({fn:Oa,sName:"scrolling"});return d[0]}function Oa(a){var c=a.oScroll,d=c.sX,e=c.sXInner,l=c.sY,f=c.iBarWidth,h=b(a.nScrollHead),k=h[0].style,g=h.children("div"),q=g[0].style,p=g.children("table"),g=a.nScrollBody,B=b(g),z=g.style,m=b(a.nScrollFoot).children("div"),n=m.children("table"),v=b(a.nTHead),I=
b(a.nTable),r=I[0],x=r.style,C=a.nTFoot?b(a.nTFoot):null,w=a.oBrowser,Z=w.bScrollOversize,J,A,Q,D,F,R=[],E=[],K=[],P,H=function(a){a=a.style;a.paddingTop="0";a.paddingBottom="0";a.borderTopWidth="0";a.borderBottomWidth="0";a.height=0};I.children("thead, tfoot").remove();F=v.clone().prependTo(I);J=v.find("tr");Q=F.find("tr");F.find("th, td").removeAttr("tabindex");C&&(D=C.clone().prependTo(I),A=C.find("tr"),D=D.find("tr"));d||(z.width="100%",h[0].style.width="100%");b.each(na(a,F),function(b,c){P=
t(a,b);c.style.width=a.aoColumns[P].sWidth});C&&ga(function(a){a.style.width=""},D);c.bCollapse&&""!==l&&(z.height=B[0].offsetHeight+v[0].offsetHeight+"px");h=I.outerWidth();""===d?(x.width="100%",Z&&(I.find("tbody").height()>g.offsetHeight||"scroll"==B.css("overflow-y"))&&(x.width=W(I.outerWidth()-f))):""!==e?x.width=W(e):h==B.width()&&B.height()<I.height()?(x.width=W(h-f),I.outerWidth()>h-f&&(x.width=W(h))):x.width=W(h);h=I.outerWidth();ga(H,Q);ga(function(a){K.push(a.innerHTML);R.push(W(b(a).css("width")))},
Q);ga(function(a,b){a.style.width=R[b]},J);b(Q).height(0);C&&(ga(H,D),ga(function(a){E.push(W(b(a).css("width")))},D),ga(function(a,b){a.style.width=E[b]},A),b(D).height(0));ga(function(a,b){a.innerHTML='<div class="dataTables_sizing" style="height:0;overflow:hidden;">'+K[b]+"</div>";a.style.width=R[b]},Q);C&&ga(function(a,b){a.innerHTML="";a.style.width=E[b]},D);I.outerWidth()<h?(A=g.scrollHeight>g.offsetHeight||"scroll"==B.css("overflow-y")?h+f:h,Z&&(g.scrollHeight>g.offsetHeight||"scroll"==B.css("overflow-y"))&&
(x.width=W(A-f)),""!==d&&""===e||Ea(a,1,"Possible column misalignment",6)):A="100%";z.width=W(A);k.width=W(A);C&&(a.nScrollFoot.style.width=W(A));!l&&Z&&(z.height=W(r.offsetHeight+f));l&&c.bCollapse&&(z.height=W(l),c=d&&r.offsetWidth>g.offsetWidth?f:0,r.offsetHeight<g.offsetHeight&&(z.height=W(r.offsetHeight+c)));c=I.outerWidth();p[0].style.width=W(c);q.width=W(c);p=I.height()>g.clientHeight||"scroll"==B.css("overflow-y");w="padding"+(w.bScrollbarLeft?"Left":"Right");q[w]=p?f+"px":"0px";C&&(n[0].style.width=
W(c),m[0].style.width=W(c),m[0].style[w]=p?f+"px":"0px");B.scroll();!a.bSorted&&!a.bFiltered||a._drawHold||(g.scrollTop=0)}function ga(a,b,c){for(var d=0,e=0,l=b.length,f,h;e<l;){f=b[e].firstChild;for(h=c?c[e].firstChild:null;f;)1===f.nodeType&&(c?a(f,h,d):a(f,d),d++),f=f.nextSibling,h=c?h.nextSibling:null;e++}}function Aa(a){var d=a.nTable,e=a.aoColumns,l=a.oScroll,f=l.sY,h=l.sX,k=l.sXInner,q=e.length,l=D(a,"bVisible"),p=b("th",a.nTHead),B=d.getAttribute("width"),z=d.parentNode,m=!1,n,t;for(n=0;n<
l.length;n++)t=e[l[n]],null!==t.sWidth&&(t.sWidth=ob(t.sWidthOrig,z),m=!0);if(m||h||f||q!=A(a)||q!=p.length){q=b(d).clone().empty().css("visibility","hidden").removeAttr("id").append(b(a.nTHead).clone(!1)).append(b(a.nTFoot).clone(!1)).append(b("<tbody><tr/></tbody>"));q.find("tfoot th, tfoot td").css("width","");var v=q.find("tbody tr"),p=na(a,q.find("thead")[0]);for(n=0;n<l.length;n++)t=e[l[n]],p[n].style.width=null!==t.sWidthOrig&&""!==t.sWidthOrig?W(t.sWidthOrig):"";if(a.aoData.length)for(n=0;n<
l.length;n++)m=l[n],t=e[m],b(Fb(a,m)).clone(!1).append(t.sContentPadding).appendTo(v);q.appendTo(z);h&&k?q.width(k):h?(q.css("width","auto"),q.width()<z.offsetWidth&&q.width(z.offsetWidth)):f?q.width(z.offsetWidth):B&&q.width(B);Eb(a,q[0]);if(h){for(n=k=0;n<l.length;n++)t=e[l[n]],f=b(p[n]).outerWidth(),k+=null===t.sWidthOrig?f:parseInt(t.sWidth,10)+f-b(p[n]).width();q.width(W(k));d.style.width=W(k)}for(n=0;n<l.length;n++)if(t=e[l[n]],f=b(p[n]).width())t.sWidth=W(f);d.style.width=W(q.css("width"));
q.remove()}else for(n=0;n<q;n++)e[n].sWidth=W(p.eq(n).width());B&&(d.style.width=W(B));!B&&!h||a._reszEvt||(b(g).bind("resize.DT-"+a.sInstance,Ca(function(){c(a)})),a._reszEvt=!0)}function Ca(b,c){var d=c!==a?c:200,e,l;return function(){var c=this,f=+new Date,h=arguments;e&&f<e+d?(clearTimeout(l),l=setTimeout(function(){e=a;b.apply(c,h)},d)):e?(e=f,b.apply(c,h)):e=f}}function ob(a,c){if(!a)return 0;var d=b("<div/>").css("width",W(a)).appendTo(c||m.body),e=d[0].offsetWidth;d.remove();return e}function Eb(a,
c){var d=a.oScroll;if(d.sX||d.sY)d=d.sX?0:d.iBarWidth,c.style.width=W(b(c).outerWidth()-d)}function Fb(a,c){var d=pb(a,c);if(0>d)return null;var e=a.aoData[d];return e.nTr?e.anCells[c]:b("<td/>").html(J(a,d,c,"display"))[0]}function pb(a,b){for(var c,d=-1,e=-1,l=0,f=a.aoData.length;l<f;l++)c=J(a,l,b,"display")+"",c=c.replace(Rb,""),c.length>d&&(d=c.length,e=l);return e}function W(a){return null===a?"0px":"number"==typeof a?0>a?"0px":a+"px":a.match(/\d$/)?a+"px":a}function qb(){if(!G.__scrollbarWidth){var a=
b("<p/>").css({width:"100%",height:200,padding:0})[0],c=b("<div/>").css({position:"absolute",top:0,left:0,width:200,height:150,padding:0,overflow:"hidden",visibility:"hidden"}).append(a).appendTo("body"),d=a.offsetWidth;c.css("overflow","scroll");a=a.offsetWidth;d===a&&(a=c[0].clientWidth);c.remove();G.__scrollbarWidth=d-a}return G.__scrollbarWidth}function Ga(c){var d,e,l=[],f=c.aoColumns,h,k,g,q;d=c.aaSortingFixed;e=b.isPlainObject(d);var p=[];h=function(a){a.length&&!b.isArray(a[0])?p.push(a):
p.push.apply(p,a)};b.isArray(d)&&h(d);e&&d.pre&&h(d.pre);h(c.aaSorting);e&&d.post&&h(d.post);for(c=0;c<p.length;c++)for(q=p[c][0],h=f[q].aDataSort,d=0,e=h.length;d<e;d++)k=h[d],g=f[k].sType||"string",p[c]._idx===a&&(p[c]._idx=b.inArray(p[c][1],f[k].asSorting)),l.push({src:q,col:k,dir:p[c][1],index:p[c]._idx,type:g,formatter:G.ext.type.order[g+"-pre"]});return l}function Gb(a){var b,c,d=[],e=G.ext.type.order,l=a.aoData,f=0,h,k=a.aiDisplayMaster,g;E(a);g=Ga(a);b=0;for(c=g.length;b<c;b++)h=g[b],h.formatter&&
f++,Ib(a,h.col);if("ssp"!=pa(a)&&0!==g.length){b=0;for(c=k.length;b<c;b++)d[k[b]]=b;f===g.length?k.sort(function(a,b){var c,e,f,h,k=g.length,u=l[a]._aSortData,q=l[b]._aSortData;for(f=0;f<k;f++)if(h=g[f],c=u[h.col],e=q[h.col],c=c<e?-1:c>e?1:0,0!==c)return"asc"===h.dir?c:-c;c=d[a];e=d[b];return c<e?-1:c>e?1:0}):k.sort(function(a,b){var c,f,h,k,u=g.length,q=l[a]._aSortData,p=l[b]._aSortData;for(h=0;h<u;h++)if(k=g[h],c=q[k.col],f=p[k.col],k=e[k.type+"-"+k.dir]||e["string-"+k.dir],c=k(c,f),0!==c)return c;
c=d[a];f=d[b];return c<f?-1:c>f?1:0})}a.bSorted=!0}function Hb(a){var b,c,d=a.aoColumns,e=Ga(a);a=a.oLanguage.oAria;for(var l=0,f=d.length;l<f;l++){c=d[l];var h=c.asSorting;b=c.sTitle.replace(/<.*?>/g,"");var k=c.nTh;k.removeAttribute("aria-sort");c.bSortable&&(0<e.length&&e[0].col==l?(k.setAttribute("aria-sort","asc"==e[0].dir?"ascending":"descending"),c=h[e[0].index+1]||h[0]):c=h[0],b+="asc"===c?a.sSortAscending:a.sSortDescending);k.setAttribute("aria-label",b)}}function rb(c,d,e,l){var f=c.aaSorting,
h=c.aoColumns[d].asSorting,k=function(c,d){var e=c._idx;e===a&&(e=b.inArray(c[1],h));return e+1<h.length?e+1:d?null:0};"number"===typeof f[0]&&(f=c.aaSorting=[f]);e&&c.oFeatures.bSortMulti?(e=b.inArray(d,xa(f,"0")),-1!==e?(d=k(f[e],!0),null===d?f.splice(e,1):(f[e][1]=h[d],f[e]._idx=d)):(f.push([d,h[0],0]),f[f.length-1]._idx=0)):f.length&&f[0][0]==d?(d=k(f[0]),f.length=1,f[0][1]=h[d],f[0]._idx=d):(f.length=0,f.push([d,h[0]]),f[0]._idx=0);la(c);"function"==typeof l&&l(c)}function eb(a,b,c,d){var e=
a.aoColumns[c];sb(b,{},function(b){!1!==e.bSortable&&(a.oFeatures.bProcessing?(X(a,!0),setTimeout(function(){rb(a,c,b.shiftKey,d);"ssp"!==pa(a)&&X(a,!1)},0)):rb(a,c,b.shiftKey,d))})}function ab(a){var c=a.aLastSort,d=a.oClasses.sSortColumn,e=Ga(a),l=a.oFeatures,f,h;if(l.bSort&&l.bSortClasses){l=0;for(f=c.length;l<f;l++)h=c[l].src,b(xa(a.aoData,"anCells",h)).removeClass(d+(2>l?l+1:3));l=0;for(f=e.length;l<f;l++)h=e[l].src,b(xa(a.aoData,"anCells",h)).addClass(d+(2>l?l+1:3))}a.aLastSort=e}function Ib(a,
b){var c=a.aoColumns[b],d=G.ext.order[c.sSortDataType],e;d&&(e=d.call(a.oInstance,a,b,x(a,b)));for(var l,f=G.ext.type.order[c.sType+"-pre"],h=0,k=a.aoData.length;h<k;h++)if(c=a.aoData[h],c._aSortData||(c._aSortData=[]),!c._aSortData[b]||d)l=d?e[h]:J(a,h,b,"sort"),c._aSortData[b]=f?f(l):l}function qa(a){if(a.oFeatures.bStateSave&&!a.bDestroying){var c={time:+new Date,start:a._iDisplayStart,length:a._iDisplayLength,order:b.extend(!0,[],a.aaSorting),search:mb(a.oPreviousSearch),columns:b.map(a.aoColumns,
function(b,c){return{visible:b.bVisible,search:mb(a.aoPreSearchCols[c])}})};ea(a,"aoStateSaveParams","stateSaveParams",[a,c]);a.oSavedState=c;a.fnStateSaveCallback.call(a.oInstance,a,c)}}function Qa(a,c){var d,e,l=a.aoColumns;if(a.oFeatures.bStateSave){var f=a.fnStateLoadCallback.call(a.oInstance,a);if(f&&f.time&&(d=ea(a,"aoStateLoadParams","stateLoadParams",[a,f]),-1===b.inArray(!1,d)&&(d=a.iStateDuration,!(0<d&&f.time<+new Date-1E3*d)&&l.length===f.columns.length))){a.oLoadedState=b.extend(!0,{},
f);a._iDisplayStart=f.start;a.iInitDisplayStart=f.start;a._iDisplayLength=f.length;a.aaSorting=[];b.each(f.order,function(b,c){a.aaSorting.push(c[0]>=l.length?[0,c[1]]:c)});b.extend(a.oPreviousSearch,nb(f.search));d=0;for(e=f.columns.length;d<e;d++){var h=f.columns[d];l[d].bVisible=h.visible;b.extend(a.aoPreSearchCols[d],nb(h.search))}ea(a,"aoStateLoaded","stateLoaded",[a,f])}}}function Pa(a){var c=G.settings;a=b.inArray(a,xa(c,"nTable"));return-1!==a?c[a]:null}function Ea(a,b,c,d){c="DataTables warning: "+
(null!==a?"table id="+a.sTableId+" - ":"")+c;d&&(c+=". For more information about this error, please see http://datatables.net/tn/"+d);if(b)g.console&&console.log&&console.log(c);else if(a=G.ext,"alert"==(a.sErrMode||a.errMode))alert(c);else throw Error(c);}function sa(c,d,e,l){b.isArray(e)?b.each(e,function(a,e){b.isArray(e)?sa(c,d,e[0],e[1]):sa(c,d,e)}):(l===a&&(l=e),d[e]!==a&&(c[l]=d[e]))}function Ra(a,c,d){var e,l;for(l in c)c.hasOwnProperty(l)&&(e=c[l],b.isPlainObject(e)?(b.isPlainObject(a[l])||
(a[l]={}),b.extend(!0,a[l],e)):d&&"data"!==l&&"aaData"!==l&&b.isArray(e)?a[l]=e.slice():a[l]=e);return a}function sb(a,c,d){b(a).bind("click.DT",c,function(b){a.blur();d(b)}).bind("keypress.DT",c,function(a){13===a.which&&(a.preventDefault(),d(a))}).bind("selectstart.DT",function(){return!1})}function ia(a,b,c,d){c&&a[b].push({fn:c,sName:d})}function ea(a,c,d,e){var l=[];c&&(l=b.map(a[c].slice().reverse(),function(b,c){return b.fn.apply(a.oInstance,e)}));null!==d&&b(a.nTable).trigger(d+".dt",e);return l}
function tb(a){var b=a._iDisplayStart,c=a.fnDisplayEnd(),d=a._iDisplayLength;b>=c&&(b=c-d);b-=b%d;if(-1===d||0>b)b=0;a._iDisplayStart=b}function fb(a,c){var d=a.renderer,e=G.ext.renderer[c];return b.isPlainObject(d)&&d[c]?e[d[c]]||e._:"string"===typeof d?e[d]||e._:e._}function pa(a){return a.oFeatures.bServerSide?"ssp":a.ajax||a.sAjaxSource?"ajax":"dom"}function Da(a,b){var c=[],c=Wb.numbers_length,d=Math.floor(c/2);b<=c?c=Ia(0,b):a<=d?(c=Ia(0,c-2),c.push("ellipsis"),c.push(b-1)):(a>=b-1-d?c=Ia(b-
(c-2),b):(c=Ia(a-1,a+2),c.push("ellipsis"),c.push(b-1)),c.splice(0,0,"ellipsis"),c.splice(0,0,0));c.DT_el="span";return c}function Wa(a){b.each({num:function(b){return Bb(b,a)},"num-fmt":function(b){return Bb(b,a,Ba)},"html-num":function(b){return Bb(b,a,Ma)},"html-num-fmt":function(b){return Bb(b,a,Ma,Ba)}},function(b,c){ka.type.order[b+a+"-pre"]=c;b.match(/^html\-/)&&(ka.type.search[b+a]=ka.type.search.html)})}function Jb(a){return function(){var b=[Pa(this[G.ext.iApiIndex])].concat(Array.prototype.slice.call(arguments));
return G.ext.internal[a].apply(this,b)}}var G,ka,U,O,aa,Ha={},Kb=/[\r\n]/g,Ma=/<.*?>/g,Pb=/^[\w\+\-]/,ub=/[\w\+\-]$/,vb=/(\/|\.|\*|\+|\?|\||\(|\)|\[|\]|\{|\}|\\|\$|\^|\-)/g,Ba=/[',$\u00a3\u20ac\u00a5%\u2009\u202F]/g,oa=function(a){return a&&!0!==a&&"-"!==a?!1:!0},Lb=function(a){var b=parseInt(a,10);return!isNaN(b)&&isFinite(a)?b:null},wb=function(a,b){Ha[b]||(Ha[b]=new RegExp(cb(b),"g"));return"string"===typeof a&&"."!==b?a.replace(/\./g,"").replace(Ha[b],"."):a},xb=function(a,b,c){var d="string"===
typeof a;b&&d&&(a=wb(a,b));c&&d&&(a=a.replace(Ba,""));return oa(a)||!isNaN(parseFloat(a))&&isFinite(a)},Mb=function(a,b,c){return oa(a)?!0:oa(a)||"string"===typeof a?xb(a.replace(Ma,""),b,c)?!0:null:null},xa=function(b,c,d){var e=[],l=0,f=b.length;if(d!==a)for(;l<f;l++)b[l]&&b[l][c]&&e.push(b[l][c][d]);else for(;l<f;l++)b[l]&&e.push(b[l][c]);return e},Na=function(b,c,d,e){var l=[],f=0,h=c.length;if(e!==a)for(;f<h;f++)b[c[f]][d]&&l.push(b[c[f]][d][e]);else for(;f<h;f++)l.push(b[c[f]][d]);return l},
Ia=function(b,c){var d=[],e;c===a?(c=0,e=b):(e=c,c=b);for(var l=c;l<e;l++)d.push(l);return d},bb=function(a){for(var b=[],c=0,d=a.length;c<d;c++)a[c]&&b.push(a[c]);return b},gb=function(a){var b=[],c,d,e=a.length,l,f=0;d=0;a:for(;d<e;d++){c=a[d];for(l=0;l<f;l++)if(b[l]===c)continue a;b.push(c);f++}return b},ha=function(b,c,d){b[c]!==a&&(b[d]=b[c])},Xa=/\[.*?\]$/,Ja=/\(\)$/,Ya=b("<div>")[0],Qb=Ya.textContent!==a,Rb=/<.*?>/g;G=function(c){this.$=function(a,b){return this.api(!0).$(a,b)};this._=function(a,
b){return this.api(!0).rows(a,b).data()};this.api=function(a){return a?new U(Pa(this[ka.iApiIndex])):new U(this)};this.fnAddData=function(c,d){var e=this.api(!0),l=b.isArray(c)&&(b.isArray(c[0])||b.isPlainObject(c[0]))?e.rows.add(c):e.row.add(c);(d===a||d)&&e.draw();return l.flatten().toArray()};this.fnAdjustColumnSizing=function(b){var c=this.api(!0).columns.adjust(),d=c.settings()[0],e=d.oScroll;b===a||b?c.draw(!1):""===e.sX&&""===e.sY||Oa(d)};this.fnClearTable=function(b){var c=this.api(!0).clear();
(b===a||b)&&c.draw()};this.fnClose=function(a){this.api(!0).row(a).child.hide()};this.fnDeleteRow=function(b,c,d){var e=this.api(!0);b=e.rows(b);var l=b.settings()[0],f=l.aoData[b[0][0]];b.remove();c&&c.call(this,l,f);(d===a||d)&&e.draw();return f};this.fnDestroy=function(a){this.api(!0).destroy(a)};this.fnDraw=function(a){this.api(!0).draw(!a)};this.fnFilter=function(b,c,d,e,l,f){l=this.api(!0);null===c||c===a?l.search(b,d,e,f):l.column(c).search(b,d,e,f);l.draw()};this.fnGetData=function(b,c){var d=
this.api(!0);if(b!==a){var e=b.nodeName?b.nodeName.toLowerCase():"";return c!==a||"td"==e||"th"==e?d.cell(b,c).data():d.row(b).data()||null}return d.data().toArray()};this.fnGetNodes=function(b){var c=this.api(!0);return b!==a?c.row(b).node():c.rows().nodes().flatten().toArray()};this.fnGetPosition=function(a){var b=this.api(!0),c=a.nodeName.toUpperCase();return"TR"==c?b.row(a).index():"TD"==c||"TH"==c?(a=b.cell(a).index(),[a.row,a.columnVisible,a.column]):null};this.fnIsOpen=function(a){return this.api(!0).row(a).child.isShown()};
this.fnOpen=function(a,b,c){return this.api(!0).row(a).child(b,c).show().child()[0]};this.fnPageChange=function(b,c){var d=this.api(!0).page(b);(c===a||c)&&d.draw(!1)};this.fnSetColumnVis=function(b,c,d){b=this.api(!0).column(b).visible(c);(d===a||d)&&b.columns.adjust().draw()};this.fnSettings=function(){return Pa(this[ka.iApiIndex])};this.fnSort=function(a){this.api(!0).order(a).draw()};this.fnSortListener=function(a,b,c){this.api(!0).order.listener(a,b,c)};this.fnUpdate=function(b,c,d,e,l){var f=
this.api(!0);d===a||null===d?f.row(c).data(b):f.cell(c,d).data(b);(l===a||l)&&f.columns.adjust();(e===a||e)&&f.draw();return 0};this.fnVersionCheck=ka.fnVersionCheck;var d=this,l=c===a,g=this.length;l&&(c={});this.oApi=this.internal=ka.internal;for(var q in G.ext.internal)q&&(this[q]=Jb(q));this.each(function(){var q={},q=1<g?Ra(q,c,!0):c,B=0,z,m=this.getAttribute("id"),n=!1,t=G.defaults;if("table"!=this.nodeName.toLowerCase())Ea(null,0,"Non-table node initialisation ("+this.nodeName+")",2);else{p(t);
e(t.column);k(t,t,!0);k(t.column,t.column,!0);k(t,q);var r=G.settings,B=0;for(z=r.length;B<z;B++){if(r[B].nTable==this){z=q.bRetrieve!==a?q.bRetrieve:t.bRetrieve;if(l||z)return r[B].oInstance;if(q.bDestroy!==a?q.bDestroy:t.bDestroy){r[B].oInstance.fnDestroy();break}else{Ea(r[B],0,"Cannot reinitialise DataTable",3);return}}if(r[B].sTableId==this.id){r.splice(B,1);break}}if(null===m||""===m)this.id=m="DataTables_Table_"+G.ext._unique++;var x=b.extend(!0,{},G.models.oSettings,{nTable:this,oApi:d.internal,
oInit:q,sDestroyWidth:b(this)[0].style.width,sInstance:m,sTableId:m});r.push(x);x.oInstance=1===d.length?d:b(this).dataTable();p(q);q.oLanguage&&f(q.oLanguage);q.aLengthMenu&&!q.iDisplayLength&&(q.iDisplayLength=b.isArray(q.aLengthMenu[0])?q.aLengthMenu[0][0]:q.aLengthMenu[0]);q=Ra(b.extend(!0,{},t),q);sa(x.oFeatures,q,"bPaginate bLengthChange bFilter bSort bSortMulti bInfo bProcessing bAutoWidth bSortClasses bServerSide bDeferRender".split(" "));sa(x,q,["asStripeClasses","ajax","fnServerData","fnFormatNumber",
"sServerMethod","aaSorting","aaSortingFixed","aLengthMenu","sPaginationType","sAjaxSource","sAjaxDataProp","iStateDuration","sDom","bSortCellsTop","iTabIndex","fnStateLoadCallback","fnStateSaveCallback","renderer","searchDelay",["iCookieDuration","iStateDuration"],["oSearch","oPreviousSearch"],["aoSearchCols","aoPreSearchCols"],["iDisplayLength","_iDisplayLength"],["bJQueryUI","bJUI"]]);sa(x.oScroll,q,[["sScrollX","sX"],["sScrollXInner","sXInner"],["sScrollY","sY"],["bScrollCollapse","bCollapse"]]);
sa(x.oLanguage,q,"fnInfoCallback");ia(x,"aoDrawCallback",q.fnDrawCallback,"user");ia(x,"aoServerParams",q.fnServerParams,"user");ia(x,"aoStateSaveParams",q.fnStateSaveParams,"user");ia(x,"aoStateLoadParams",q.fnStateLoadParams,"user");ia(x,"aoStateLoaded",q.fnStateLoaded,"user");ia(x,"aoRowCallback",q.fnRowCallback,"user");ia(x,"aoRowCreatedCallback",q.fnCreatedRow,"user");ia(x,"aoHeaderCallback",q.fnHeaderCallback,"user");ia(x,"aoFooterCallback",q.fnFooterCallback,"user");ia(x,"aoInitComplete",q.fnInitComplete,
"user");ia(x,"aoPreDrawCallback",q.fnPreDrawCallback,"user");m=x.oClasses;q.bJQueryUI?(b.extend(m,G.ext.oJUIClasses,q.oClasses),q.sDom===t.sDom&&"lfrtip"===t.sDom&&(x.sDom='<"H"lfr>t<"F"ip>'),x.renderer)?b.isPlainObject(x.renderer)&&!x.renderer.header&&(x.renderer.header="jqueryui"):x.renderer="jqueryui":b.extend(m,G.ext.classes,q.oClasses);b(this).addClass(m.sTable);if(""!==x.oScroll.sX||""!==x.oScroll.sY)x.oScroll.iBarWidth=qb();!0===x.oScroll.sX&&(x.oScroll.sX="100%");x.iInitDisplayStart===a&&
(x.iInitDisplayStart=q.iDisplayStart,x._iDisplayStart=q.iDisplayStart);null!==q.iDeferLoading&&(x.bDeferLoading=!0,B=b.isArray(q.iDeferLoading),x._iRecordsDisplay=B?q.iDeferLoading[0]:q.iDeferLoading,x._iRecordsTotal=B?q.iDeferLoading[1]:q.iDeferLoading);var C=x.oLanguage;b.extend(!0,C,q.oLanguage);""!==C.sUrl&&(b.ajax({dataType:"json",url:C.sUrl,success:function(a){f(a);k(t.oLanguage,a);b.extend(!0,C,a);Ua(x)},error:function(){Ua(x)}}),n=!0);null===q.asStripeClasses&&(x.asStripeClasses=[m.sStripeOdd,
m.sStripeEven]);var B=x.asStripeClasses,Z=b("tbody tr:eq(0)",this);-1!==b.inArray(!0,b.map(B,function(a,b){return Z.hasClass(a)}))&&(b("tbody tr",this).removeClass(B.join(" ")),x.asDestroyStripes=B.slice());var r=[],J,B=this.getElementsByTagName("thead");0!==B.length&&(da(x.aoHeader,B[0]),r=na(x));if(null===q.aoColumns)for(J=[],B=0,z=r.length;B<z;B++)J.push(null);else J=q.aoColumns;B=0;for(z=J.length;B<z;B++)h(x,r?r[B]:null);R(x,q.aoColumnDefs,J,function(a,b){v(x,a,b)});if(Z.length){var A=function(a,
b){return a.getAttribute("data-"+b)?b:null};b.each(I(x,Z[0]).cells,function(b,c){var d=x.aoColumns[b];if(d.mData===b){var e=A(c,"sort")||A(c,"order"),l=A(c,"filter")||A(c,"search");if(null!==e||null!==l)d.mData={_:b+".display",sort:null!==e?b+".@data-"+e:a,type:null!==e?b+".@data-"+e:a,filter:null!==l?b+".@data-"+l:a},v(x,b)}})}var Q=x.oFeatures;q.bStateSave&&(Q.bStateSave=!0,Qa(x,q),ia(x,"aoDrawCallback",qa,"state_save"));if(q.aaSorting===a)for(r=x.aaSorting,B=0,z=r.length;B<z;B++)r[B][1]=x.aoColumns[B].asSorting[0];
ab(x);Q.bSort&&ia(x,"aoDrawCallback",function(){if(x.bSorted){var a=Ga(x),c={};b.each(a,function(a,b){c[b.src]=b.dir});ea(x,null,"order",[x,a,c]);Hb(x)}});ia(x,"aoDrawCallback",function(){(x.bSorted||"ssp"===pa(x)||Q.bDeferRender)&&ab(x)},"sc");w(x);B=b(this).children("caption").each(function(){this._captionSide=b(this).css("caption-side")});z=b(this).children("thead");0===z.length&&(z=b("<thead/>").appendTo(this));x.nTHead=z[0];z=b(this).children("tbody");0===z.length&&(z=b("<tbody/>").appendTo(this));
x.nTBody=z[0];z=b(this).children("tfoot");0===z.length&&0<B.length&&(""!==x.oScroll.sX||""!==x.oScroll.sY)&&(z=b("<tfoot/>").appendTo(this));0===z.length||0===z.children().length?b(this).addClass(m.sNoFooter):0<z.length&&(x.nTFoot=z[0],da(x.aoFooter,x.nTFoot));if(q.aaData)for(B=0;B<q.aaData.length;B++)H(x,q.aaData[B]);else(x.bDeferLoading||"dom"==pa(x))&&L(x,b(x.nTBody).children("tr"));x.aiDisplay=x.aiDisplayMaster.slice();x.bInitialised=!0;!1===n&&Ua(x)}});d=null;return this};var Nb=[],fa=Array.prototype,
Sb=function(a){var c,d,e=G.settings,l=b.map(e,function(a,b){return a.nTable});if(a){if(a.nTable&&a.oApi)return[a];if(a.nodeName&&"table"===a.nodeName.toLowerCase())return c=b.inArray(a,l),-1!==c?[e[c]]:null;if(a&&"function"===typeof a.settings)return a.settings().toArray();"string"===typeof a?d=b(a):a instanceof b&&(d=a)}else return[];if(d)return d.map(function(a){c=b.inArray(this,l);return-1!==c?e[c]:null}).toArray()};U=function(a,c){if(!this instanceof U)throw"DT API must be constructed as a new object";
var d=[],e=function(a){(a=Sb(a))&&d.push.apply(d,a)};if(b.isArray(a))for(var l=0,f=a.length;l<f;l++)e(a[l]);else e(a);this.context=gb(d);c&&this.push.apply(this,c.toArray?c.toArray():c);this.selector={rows:null,cols:null,opts:null};U.extend(this,this,Nb)};G.Api=U;U.prototype={concat:fa.concat,context:[],each:function(a){for(var b=0,c=this.length;b<c;b++)a.call(this,this[b],b,this);return this},eq:function(a){var b=this.context;return b.length>a?new U(b[a],this[a]):null},filter:function(a){var b=[];
if(fa.filter)b=fa.filter.call(this,a,this);else for(var c=0,d=this.length;c<d;c++)a.call(this,this[c],c,this)&&b.push(this[c]);return new U(this.context,b)},flatten:function(){var a=[];return new U(this.context,a.concat.apply(a,this.toArray()))},join:fa.join,indexOf:fa.indexOf||function(a,b){for(var c=b||0,d=this.length;c<d;c++)if(this[c]===a)return c;return-1},iterator:function(b,c,d,e){var l=[],f,h,k,g,q,p=this.context,B,z,m=this.selector;"string"===typeof b&&(e=d,d=c,c=b,b=!1);h=0;for(k=p.length;h<
k;h++){var n=new U(p[h]);if("table"===c)f=d.call(n,p[h],h),f!==a&&l.push(f);else if("columns"===c||"rows"===c)f=d.call(n,p[h],this[h],h),f!==a&&l.push(f);else if("column"===c||"column-rows"===c||"row"===c||"cell"===c)for(z=this[h],"column-rows"===c&&(B=jb(p[h],m.opts)),g=0,q=z.length;g<q;g++)f=z[g],f="cell"===c?d.call(n,p[h],f.row,f.column,h,g):d.call(n,p[h],f,h,g,B),f!==a&&l.push(f)}return l.length||e?(b=new U(p,b?l.concat.apply([],l):l),c=b.selector,c.rows=m.rows,c.cols=m.cols,c.opts=m.opts,b):
this},lastIndexOf:fa.lastIndexOf||function(a,b){return this.indexOf.apply(this.toArray.reverse(),arguments)},length:0,map:function(a){var b=[];if(fa.map)b=fa.map.call(this,a,this);else for(var c=0,d=this.length;c<d;c++)b.push(a.call(this,this[c],c));return new U(this.context,b)},pluck:function(a){return this.map(function(b){return b[a]})},pop:fa.pop,push:fa.push,reduce:fa.reduce||function(a,b){return r(this,a,b,0,this.length,1)},reduceRight:fa.reduceRight||function(a,b){return r(this,a,b,this.length-
1,-1,-1)},reverse:fa.reverse,selector:null,shift:fa.shift,sort:fa.sort,splice:fa.splice,toArray:function(){return fa.slice.call(this)},to$:function(){return b(this)},toJQuery:function(){return b(this)},unique:function(){return new U(this.context,gb(this))},unshift:fa.unshift};U.extend=function(a,c,d){if(c&&(c instanceof U||c.__dt_wrapper)){var e,l,f,h=function(a,b,c){return function(){var d=b.apply(a,arguments);U.extend(d,d,c.methodExt);return d}};e=0;for(l=d.length;e<l;e++)f=d[e],c[f.name]="function"===
typeof f.val?h(a,f.val,f):b.isPlainObject(f.val)?{}:f.val,c[f.name].__dt_wrapper=!0,U.extend(a,c[f.name],f.propExt)}};U.register=O=function(a,c){if(b.isArray(a))for(var d=0,e=a.length;d<e;d++)U.register(a[d],c);else for(var l=a.split("."),f=Nb,h,k,d=0,e=l.length;d<e;d++){h=(k=-1!==l[d].indexOf("()"))?l[d].replace("()",""):l[d];var g;a:{g=0;for(var q=f.length;g<q;g++)if(f[g].name===h){g=f[g];break a}g=null}g||(g={name:h,val:{},methodExt:[],propExt:[]},f.push(g));d===e-1?g.val=c:f=k?g.methodExt:g.propExt}};
U.registerPlural=aa=function(c,d,e){U.register(c,e);U.register(d,function(){var c=e.apply(this,arguments);return c===this?this:c instanceof U?c.length?b.isArray(c[0])?new U(c.context,c[0]):c[0]:a:c})};var Za=function(a,c){if("number"===typeof a)return[c[a]];var d=b.map(c,function(a,b){return a.nTable});return b(d).filter(a).map(function(a){a=b.inArray(this,d);return c[a]}).toArray()};O("tables()",function(a){return a?new U(Za(a,this.context)):this});O("table()",function(a){a=this.tables(a);var b=
a.context;return b.length?new U(b[0]):a});aa("tables().nodes()","table().node()",function(){return this.iterator("table",function(a){return a.nTable},1)});aa("tables().body()","table().body()",function(){return this.iterator("table",function(a){return a.nTBody},1)});aa("tables().header()","table().header()",function(){return this.iterator("table",function(a){return a.nTHead},1)});aa("tables().footer()","table().footer()",function(){return this.iterator("table",function(a){return a.nTFoot},1)});aa("tables().containers()",
"table().container()",function(){return this.iterator("table",function(a){return a.nTableWrapper},1)});O("draw()",function(a){return this.iterator("table",function(b){la(b,!1===a)})});O("page()",function(b){return b===a?this.page.info().page:this.iterator("table",function(a){za(a,b)})});O("page.info()",function(b){if(0===this.context.length)return a;b=this.context[0];var c=b._iDisplayStart,d=b._iDisplayLength,e=b.fnRecordsDisplay(),l=-1===d;return{page:l?0:Math.floor(c/d),pages:l?1:Math.ceil(e/d),
start:c,end:b.fnDisplayEnd(),length:d,recordsTotal:b.fnRecordsTotal(),recordsDisplay:e}});O("page.len()",function(b){return b===a?0!==this.context.length?this.context[0]._iDisplayLength:a:this.iterator("table",function(a){ua(a,b)})});var yb=function(a,b,c){"ssp"==pa(a)?la(a,b):(X(a,!0),va(a,[],function(c){q(a);c=ra(a,c);for(var d=0,e=c.length;d<e;d++)H(a,c[d]);la(a,b);X(a,!1)}));if(c){var d=new U(a);d.one("draw",function(){c(d.ajax.json())})}};O("ajax.json()",function(){var a=this.context;if(0<a.length)return a[0].json});
O("ajax.params()",function(){var a=this.context;if(0<a.length)return a[0].oAjaxData});O("ajax.reload()",function(a,b){return this.iterator("table",function(c){yb(c,!1===b,a)})});O("ajax.url()",function(c){var d=this.context;if(c===a){if(0===d.length)return a;d=d[0];return d.ajax?b.isPlainObject(d.ajax)?d.ajax.url:d.ajax:d.sAjaxSource}return this.iterator("table",function(a){b.isPlainObject(a.ajax)?a.ajax.url=c:a.ajax=c})});O("ajax.url().load()",function(a,b){return this.iterator("table",function(c){yb(c,
!1===b,a)})});var $a=function(c,d){var e=[],l,f,h,k,g,q;l=typeof c;c&&"string"!==l&&"function"!==l&&c.length!==a||(c=[c]);h=0;for(k=c.length;h<k;h++)for(f=c[h]&&c[h].split?c[h].split(","):[c[h]],g=0,q=f.length;g<q;g++)(l=d("string"===typeof f[g]?b.trim(f[g]):f[g]))&&l.length&&e.push.apply(e,l);return e},hb=function(a){a||(a={});a.filter&&!a.search&&(a.search=a.filter);return{search:a.search||"none",order:a.order||"current",page:a.page||"all"}},ib=function(a){for(var b=0,c=a.length;b<c;b++)if(0<a[b].length)return a[0]=
a[b],a.length=1,a.context=[a.context[b]],a;a.length=0;return a},jb=function(a,c){var d,e,l,f=[],h=a.aiDisplay;d=a.aiDisplayMaster;var k=c.search;e=c.order;l=c.page;if("ssp"==pa(a))return"removed"===k?[]:Ia(0,d.length);if("current"==l)for(d=a._iDisplayStart,e=a.fnDisplayEnd();d<e;d++)f.push(h[d]);else if("current"==e||"applied"==e)f="none"==k?d.slice():"applied"==k?h.slice():b.map(d,function(a,c){return-1===b.inArray(a,h)?a:null});else if("index"==e||"original"==e)for(d=0,e=a.aoData.length;d<e;d++)"none"==
k?f.push(d):(l=b.inArray(d,h),(-1===l&&"removed"==k||0<=l&&"applied"==k)&&f.push(d));return f},Tb=function(a,c,d){return $a(c,function(c){var e=Lb(c);if(null!==e&&!d)return[e];var l=jb(a,d);if(null!==e&&-1!==b.inArray(e,l))return[e];if(!c)return l;if("function"===typeof c)return b.map(l,function(b){var d=a.aoData[b];return c(b,d._aData,d.nTr)?b:null});e=bb(Na(a.aoData,l,"nTr"));return c.nodeName&&-1!==b.inArray(c,e)?[c._DT_RowIndex]:b(e).filter(c).map(function(){return this._DT_RowIndex}).toArray()})};
O("rows()",function(c,d){c===a?c="":b.isPlainObject(c)&&(d=c,c="");d=hb(d);var e=this.iterator("table",function(a){return Tb(a,c,d)},1);e.selector.rows=c;e.selector.opts=d;return e});O("rows().nodes()",function(){return this.iterator("row",function(b,c){return b.aoData[c].nTr||a},1)});O("rows().data()",function(){return this.iterator(!0,"rows",function(a,b){return Na(a.aoData,b,"_aData")},1)});aa("rows().cache()","row().cache()",function(a){return this.iterator("row",function(b,c){var d=b.aoData[c];
return"search"===a?d._aFilterData:d._aSortData},1)});aa("rows().invalidate()","row().invalidate()",function(a){return this.iterator("row",function(b,c){z(b,c,a)})});aa("rows().indexes()","row().index()",function(){return this.iterator("row",function(a,b){return b},1)});aa("rows().remove()","row().remove()",function(){var a=this;return this.iterator("row",function(c,d,e){var l=c.aoData;l.splice(d,1);for(var f=0,h=l.length;f<h;f++)null!==l[f].nTr&&(l[f].nTr._DT_RowIndex=f);b.inArray(d,c.aiDisplay);
B(c.aiDisplayMaster,d);B(c.aiDisplay,d);B(a[e],d,!1);tb(c)})});O("rows.add()",function(a){var b=this.iterator("table",function(b){var c,d,e,l=[];d=0;for(e=a.length;d<e;d++)c=a[d],c.nodeName&&"TR"===c.nodeName.toUpperCase()?l.push(L(b,c)[0]):l.push(H(b,c));return l},1),c=this.rows(-1);c.pop();c.push.apply(c,b.toArray());return c});O("row()",function(a,b){return ib(this.rows(a,b))});O("row().data()",function(b){var c=this.context;if(b===a)return c.length&&this.length?c[0].aoData[this[0]]._aData:a;c[0].aoData[this[0]]._aData=
b;z(c[0],this[0],"data");return this});O("row().node()",function(){var a=this.context;return a.length&&this.length?a[0].aoData[this[0]].nTr||null:null});O("row.add()",function(a){a instanceof b&&a.length&&(a=a[0]);var c=this.iterator("table",function(b){return a.nodeName&&"TR"===a.nodeName.toUpperCase()?L(b,a)[0]:H(b,a)});return this.row(c[0])});var T=function(a,c,d,e){var l=[],f=function(c,d){if(c.nodeName&&"tr"===c.nodeName.toLowerCase())l.push(c);else{var e=b("<tr><td/></tr>").addClass(d);b("td",
e).addClass(d).html(c)[0].colSpan=A(a);l.push(e[0])}};if(b.isArray(d)||d instanceof b)for(var h=0,k=d.length;h<k;h++)f(d[h],e);else f(d,e);c._details&&c._details.remove();c._details=b(l);c._detailsShow&&c._details.insertAfter(c.nTr)},Ob=function(b,c){var d=b.context;d.length&&(d=d[0].aoData[c!==a?c:b[0]],d._details&&(d._details.remove(),d._detailsShow=a,d._details=a))},Ub=function(a,b){var c=a.context;if(c.length&&a.length){var d=c[0].aoData[a[0]];d._details&&((d._detailsShow=b)?d._details.insertAfter(d.nTr):
d._details.detach(),Xb(c[0]))}},Xb=function(a){var b=new U(a),c=a.aoData;b.off("draw.dt.DT_details column-visibility.dt.DT_details destroy.dt.DT_details");0<xa(c,"_details").length&&(b.on("draw.dt.DT_details",function(d,e){a===e&&b.rows({page:"current"}).eq(0).each(function(a){a=c[a];a._detailsShow&&a._details.insertAfter(a.nTr)})}),b.on("column-visibility.dt.DT_details",function(b,d,e,l){if(a===d)for(d=A(d),e=0,l=c.length;e<l;e++)b=c[e],b._details&&b._details.children("td[colspan]").attr("colspan",
d)}),b.on("destroy.dt.DT_details",function(d,e){if(a===e)for(var l=0,f=c.length;l<f;l++)c[l]._details&&Ob(b,l)}))};O("row().child()",function(b,c){var d=this.context;if(b===a)return d.length&&this.length?d[0].aoData[this[0]]._details:a;!0===b?this.child.show():!1===b?Ob(this):d.length&&this.length&&T(d[0],d[0].aoData[this[0]],b,c);return this});O(["row().child.show()","row().child().show()"],function(a){Ub(this,!0);return this});O(["row().child.hide()","row().child().hide()"],function(){Ub(this,!1);
return this});O(["row().child.remove()","row().child().remove()"],function(){Ob(this);return this});O("row().child.isShown()",function(){var a=this.context;return a.length&&this.length?a[0].aoData[this[0]]._detailsShow||!1:!1});var Yb=/^(.+):(name|visIdx|visible)$/,Vb=function(a,b,c,d,e){c=[];d=0;for(var l=e.length;d<l;d++)c.push(J(a,e[d],b));return c},Zb=function(a,c,d){var e=a.aoColumns,l=xa(e,"sName"),f=xa(e,"nTh");return $a(c,function(c){var h=Lb(c);if(""===c)return Ia(e.length);if(null!==h)return[0<=
h?h:e.length+h];if("function"===typeof c){var k=jb(a,d);return b.map(e,function(b,d){return c(d,Vb(a,d,0,0,k),f[d])?d:null})}var g="string"===typeof c?c.match(Yb):"";if(g)switch(g[2]){case "visIdx":case "visible":h=parseInt(g[1],10);if(0>h){var q=b.map(e,function(a,b){return a.bVisible?b:null});return[q[q.length+h]]}return[t(a,h)];case "name":return b.map(l,function(a,b){return a===g[1]?b:null})}else return b(f).filter(c).map(function(){return b.inArray(this,f)}).toArray()})};O("columns()",function(c,
d){c===a?c="":b.isPlainObject(c)&&(d=c,c="");d=hb(d);var e=this.iterator("table",function(a){return Zb(a,c,d)},1);e.selector.cols=c;e.selector.opts=d;return e});aa("columns().header()","column().header()",function(a,b){return this.iterator("column",function(a,b){return a.aoColumns[b].nTh},1)});aa("columns().footer()","column().footer()",function(a,b){return this.iterator("column",function(a,b){return a.aoColumns[b].nTf},1)});aa("columns().data()","column().data()",function(){return this.iterator("column-rows",
Vb,1)});aa("columns().dataSrc()","column().dataSrc()",function(){return this.iterator("column",function(a,b){return a.aoColumns[b].mData},1)});aa("columns().cache()","column().cache()",function(a){return this.iterator("column-rows",function(b,c,d,e,l){return Na(b.aoData,l,"search"===a?"_aFilterData":"_aSortData",c)},1)});aa("columns().nodes()","column().nodes()",function(){return this.iterator("column-rows",function(a,b,c,d,e){return Na(a.aoData,e,"anCells",b)},1)});aa("columns().visible()","column().visible()",
function(d,e){return this.iterator("column",function(l,f){if(d===a)return l.aoColumns[f].bVisible;var h=l.aoColumns,k=h[f],g=l.aoData,q,p,B;if(d!==a&&k.bVisible!==d){if(d){var z=b.inArray(!0,xa(h,"bVisible"),f+1);q=0;for(p=g.length;q<p;q++)B=g[q].nTr,h=g[q].anCells,B&&B.insertBefore(h[f],h[z]||null)}else b(xa(l.aoData,"anCells",f)).detach();k.bVisible=d;Y(l,l.aoHeader);Y(l,l.aoFooter);if(e===a||e)c(l),(l.oScroll.sX||l.oScroll.sY)&&Oa(l);ea(l,null,"column-visibility",[l,f,d]);qa(l)}})});aa("columns().indexes()",
"column().index()",function(a){return this.iterator("column",function(b,c){return"visible"===a?x(b,c):c},1)});O("columns.adjust()",function(){return this.iterator("table",function(a){c(a)},1)});O("column.index()",function(a,b){if(0!==this.context.length){var c=this.context[0];if("fromVisible"===a||"toData"===a)return t(c,b);if("fromData"===a||"toVisible"===a)return x(c,b)}});O("column()",function(a,b){return ib(this.columns(a,b))});var $b=function(c,d,e){var l=c.aoData,f=jb(c,e);e=bb(Na(l,f,"anCells"));
var h=b([].concat.apply([],e)),k,g=c.aoColumns.length,q,p,B,z,m,n;return $a(d,function(d){var e="function"===typeof d;if(null===d||d===a||e){q=[];p=0;for(B=f.length;p<B;p++)for(k=f[p],z=0;z<g;z++)m={row:k,column:z},e?(n=c.aoData[k],d(m,J(c,k,z),n.anCells[z])&&q.push(m)):q.push(m);return q}return b.isPlainObject(d)?[d]:h.filter(d).map(function(a,c){k=c.parentNode._DT_RowIndex;return{row:k,column:b.inArray(c,l[k].anCells)}}).toArray()})};O("cells()",function(c,d,e){b.isPlainObject(c)&&(typeof c.row!==
a?(e=d,d=null):(e=c,c=null));b.isPlainObject(d)&&(e=d,d=null);if(null===d||d===a)return this.iterator("table",function(a){return $b(a,c,hb(e))});var l=this.columns(d,e),f=this.rows(c,e),h,k,g,q,p,B=this.iterator("table",function(a,b){h=[];k=0;for(g=f[b].length;k<g;k++)for(q=0,p=l[b].length;q<p;q++)h.push({row:f[b][k],column:l[b][q]});return h},1);b.extend(B.selector,{cols:d,rows:c,opts:e});return B});aa("cells().nodes()","cell().node()",function(){return this.iterator("cell",function(b,c,d){return(b=
b.aoData[c].anCells)?b[d]:a},1)});O("cells().data()",function(){return this.iterator("cell",function(a,b,c){return J(a,b,c)},1)});aa("cells().cache()","cell().cache()",function(a){a="search"===a?"_aFilterData":"_aSortData";return this.iterator("cell",function(b,c,d){return b.aoData[c][a][d]},1)});aa("cells().render()","cell().render()",function(a){return this.iterator("cell",function(b,c,d){return J(b,c,d,a)},1)});aa("cells().indexes()","cell().index()",function(){return this.iterator("cell",function(a,
b,c){return{row:b,column:c,columnVisible:x(a,c)}},1)});aa("cells().invalidate()","cell().invalidate()",function(a){return this.iterator("cell",function(b,c,d){z(b,c,a,d)})});O("cell()",function(a,b,c){return ib(this.cells(a,b,c))});O("cell().data()",function(b){var c=this.context,d=this[0];if(b===a)return c.length&&d.length?J(c[0],d[0].row,d[0].column):a;K(c[0],d[0].row,d[0].column,b);z(c[0],d[0].row,"data",d[0].column);return this});O("order()",function(c,d){var e=this.context;if(c===a)return 0!==
e.length?e[0].aaSorting:a;"number"===typeof c?c=[[c,d]]:b.isArray(c[0])||(c=Array.prototype.slice.call(arguments));return this.iterator("table",function(a){a.aaSorting=c.slice()})});O("order.listener()",function(a,b,c){return this.iterator("table",function(d){eb(d,a,b,c)})});O(["columns().order()","column().order()"],function(a){var c=this;return this.iterator("table",function(d,e){var l=[];b.each(c[e],function(b,c){l.push([c,a])});d.aaSorting=l})});O("search()",function(c,d,e,l){var f=this.context;
return c===a?0!==f.length?f[0].oPreviousSearch.sSearch:a:this.iterator("table",function(a){a.oFeatures.bFilter&&S(a,b.extend({},a.oPreviousSearch,{sSearch:c+"",bRegex:null===d?!1:d,bSmart:null===e?!0:e,bCaseInsensitive:null===l?!0:l}),1)})});aa("columns().search()","column().search()",function(c,d,e,l){return this.iterator("column",function(f,h){var k=f.aoPreSearchCols;if(c===a)return k[h].sSearch;f.oFeatures.bFilter&&(b.extend(k[h],{sSearch:c+"",bRegex:null===d?!1:d,bSmart:null===e?!0:e,bCaseInsensitive:null===
l?!0:l}),S(f,f.oPreviousSearch,1))})});O("state()",function(){return this.context.length?this.context[0].oSavedState:null});O("state.clear()",function(){return this.iterator("table",function(a){a.fnStateSaveCallback.call(a.oInstance,a,{})})});O("state.loaded()",function(){return this.context.length?this.context[0].oLoadedState:null});O("state.save()",function(){return this.iterator("table",function(a){qa(a)})});G.versionCheck=G.fnVersionCheck=function(a){var b=G.version.split(".");a=a.split(".");
for(var c,d,e=0,l=a.length;e<l;e++)if(c=parseInt(b[e],10)||0,d=parseInt(a[e],10)||0,c!==d)return c>d;return!0};G.isDataTable=G.fnIsDataTable=function(a){var c=b(a).get(0),d=!1;b.each(G.settings,function(a,b){if(b.nTable===c||b.nScrollHead===c||b.nScrollFoot===c)d=!0});return d};G.tables=G.fnTables=function(a){return b.map(G.settings,function(c){if(!a||a&&b(c.nTable).is(":visible"))return c.nTable})};G.util={throttle:Ca,escapeRegex:cb};G.camelToHungarian=k;O("$()",function(a,c){var d=this.rows(c).nodes(),
d=b(d);return b([].concat(d.filter(a).toArray(),d.find(a).toArray()))});b.each(["on","one","off"],function(a,c){O(c+"()",function(){var a=Array.prototype.slice.call(arguments);a[0].match(/\.dt\b/)||(a[0]+=".dt");var d=b(this.tables().nodes());d[c].apply(d,a);return this})});O("clear()",function(){return this.iterator("table",function(a){q(a)})});O("settings()",function(){return new U(this.context,this.context)});O("data()",function(){return this.iterator("table",function(a){return xa(a.aoData,"_aData")}).flatten()});
O("destroy()",function(a){a=a||!1;return this.iterator("table",function(c){var d=c.nTableWrapper.parentNode,e=c.oClasses,l=c.nTable,f=c.nTBody,h=c.nTHead,k=c.nTFoot,q=b(l),f=b(f),p=b(c.nTableWrapper),B=b.map(c.aoData,function(a){return a.nTr}),z;c.bDestroying=!0;ea(c,"aoDestroyCallback","destroy",[c]);a||(new U(c)).columns().visible(!0);p.unbind(".DT").find(":not(tbody *)").unbind(".DT");b(g).unbind(".DT-"+c.sInstance);l!=h.parentNode&&(q.children("thead").detach(),q.append(h));k&&l!=k.parentNode&&
(q.children("tfoot").detach(),q.append(k));q.detach();p.detach();c.aaSorting=[];c.aaSortingFixed=[];ab(c);b(B).removeClass(c.asStripeClasses.join(" "));b("th, td",h).removeClass(e.sSortable+" "+e.sSortableAsc+" "+e.sSortableDesc+" "+e.sSortableNone);c.bJUI&&(b("th span."+e.sSortIcon+", td span."+e.sSortIcon,h).detach(),b("th, td",h).each(function(){var a=b("div."+e.sSortJUIWrapper,this);b(this).append(a.contents());a.detach()}));!a&&d&&d.insertBefore(l,c.nTableReinsertBefore);f.children().detach();
f.append(B);q.css("width",c.sDestroyWidth).removeClass(e.sTable);(z=c.asDestroyStripes.length)&&f.children().each(function(a){b(this).addClass(c.asDestroyStripes[a%z])});d=b.inArray(c,G.settings);-1!==d&&G.settings.splice(d,1)})});G.version="1.10.4";G.settings=[];G.models={};G.models.oSearch={bCaseInsensitive:!0,sSearch:"",bRegex:!1,bSmart:!0};G.models.oRow={nTr:null,anCells:null,_aData:[],_aSortData:null,_aFilterData:null,_sFilterRow:null,_sRowStripe:"",src:null};G.models.oColumn={idx:null,aDataSort:null,
asSorting:null,bSearchable:null,bSortable:null,bVisible:null,_sManualType:null,_bAttrSrc:!1,fnCreatedCell:null,fnGetData:null,fnSetData:null,mData:null,mRender:null,nTh:null,nTf:null,sClass:null,sContentPadding:null,sDefaultContent:null,sName:null,sSortDataType:"std",sSortingClass:null,sSortingClassJUI:null,sTitle:null,sType:null,sWidth:null,sWidthOrig:null};G.defaults={aaData:null,aaSorting:[[0,"asc"]],aaSortingFixed:[],ajax:null,aLengthMenu:[10,25,50,100],aoColumns:null,aoColumnDefs:null,aoSearchCols:[],
asStripeClasses:null,bAutoWidth:!0,bDeferRender:!1,bDestroy:!1,bFilter:!0,bInfo:!0,bJQueryUI:!1,bLengthChange:!0,bPaginate:!0,bProcessing:!1,bRetrieve:!1,bScrollCollapse:!1,bServerSide:!1,bSort:!0,bSortMulti:!0,bSortCellsTop:!1,bSortClasses:!0,bStateSave:!1,fnCreatedRow:null,fnDrawCallback:null,fnFooterCallback:null,fnFormatNumber:function(a){return a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,this.oLanguage.sThousands)},fnHeaderCallback:null,fnInfoCallback:null,fnInitComplete:null,fnPreDrawCallback:null,
fnRowCallback:null,fnServerData:null,fnServerParams:null,fnStateLoadCallback:function(a){try{return JSON.parse((-1===a.iStateDuration?sessionStorage:localStorage).getItem("DataTables_"+a.sInstance+"_"+location.pathname))}catch(b){}},fnStateLoadParams:null,fnStateLoaded:null,fnStateSaveCallback:function(a,b){try{(-1===a.iStateDuration?sessionStorage:localStorage).setItem("DataTables_"+a.sInstance+"_"+location.pathname,JSON.stringify(b))}catch(c){}},fnStateSaveParams:null,iStateDuration:7200,iDeferLoading:null,
iDisplayLength:10,iDisplayStart:0,iTabIndex:0,oClasses:{},oLanguage:{oAria:{sSortAscending:": activate to sort column ascending",sSortDescending:": activate to sort column descending"},oPaginate:{sFirst:"First",sLast:"Last",sNext:"Next",sPrevious:"Previous"},sEmptyTable:"No data available in table",sInfo:"Showing _START_ to _END_ of _TOTAL_ entries",sInfoEmpty:"Showing 0 to 0 of 0 entries",sInfoFiltered:"(filtered from _MAX_ total entries)",sInfoPostFix:"",sDecimal:"",sThousands:",",sLengthMenu:"Show _MENU_ entries",
sLoadingRecords:"Loading...",sProcessing:"Processing...",sSearch:"Search:",sSearchPlaceholder:"",sUrl:"",sZeroRecords:"No matching records found"},oSearch:b.extend({},G.models.oSearch),sAjaxDataProp:"data",sAjaxSource:null,sDom:"lfrtip",searchDelay:null,sPaginationType:"simple_numbers",sScrollX:"",sScrollXInner:"",sScrollY:"",sServerMethod:"GET",renderer:null};d(G.defaults);G.defaults.column={aDataSort:null,iDataSort:-1,asSorting:["asc","desc"],bSearchable:!0,bSortable:!0,bVisible:!0,fnCreatedCell:null,
mData:null,mRender:null,sCellType:"td",sClass:"",sContentPadding:"",sDefaultContent:null,sName:"",sSortDataType:"std",sTitle:null,sType:null,sWidth:null};d(G.defaults.column);G.models.oSettings={oFeatures:{bAutoWidth:null,bDeferRender:null,bFilter:null,bInfo:null,bLengthChange:null,bPaginate:null,bProcessing:null,bServerSide:null,bSort:null,bSortMulti:null,bSortClasses:null,bStateSave:null},oScroll:{bCollapse:null,iBarWidth:0,sX:null,sXInner:null,sY:null},oLanguage:{fnInfoCallback:null},oBrowser:{bScrollOversize:!1,
bScrollbarLeft:!1},ajax:null,aanFeatures:[],aoData:[],aiDisplay:[],aiDisplayMaster:[],aoColumns:[],aoHeader:[],aoFooter:[],oPreviousSearch:{},aoPreSearchCols:[],aaSorting:null,aaSortingFixed:[],asStripeClasses:null,asDestroyStripes:[],sDestroyWidth:0,aoRowCallback:[],aoHeaderCallback:[],aoFooterCallback:[],aoDrawCallback:[],aoRowCreatedCallback:[],aoPreDrawCallback:[],aoInitComplete:[],aoStateSaveParams:[],aoStateLoadParams:[],aoStateLoaded:[],sTableId:"",nTable:null,nTHead:null,nTFoot:null,nTBody:null,
nTableWrapper:null,bDeferLoading:!1,bInitialised:!1,aoOpenRows:[],sDom:null,searchDelay:null,sPaginationType:"two_button",iStateDuration:0,aoStateSave:[],aoStateLoad:[],oSavedState:null,oLoadedState:null,sAjaxSource:null,sAjaxDataProp:null,bAjaxDataGet:!0,jqXHR:null,json:a,oAjaxData:a,fnServerData:null,aoServerParams:[],sServerMethod:null,fnFormatNumber:null,aLengthMenu:null,iDraw:0,bDrawing:!1,iDrawError:-1,_iDisplayLength:10,_iDisplayStart:0,_iRecordsTotal:0,_iRecordsDisplay:0,bJUI:null,oClasses:{},
bFiltered:!1,bSorted:!1,bSortCellsTop:null,oInit:null,aoDestroyCallback:[],fnRecordsTotal:function(){return"ssp"==pa(this)?1*this._iRecordsTotal:this.aiDisplayMaster.length},fnRecordsDisplay:function(){return"ssp"==pa(this)?1*this._iRecordsDisplay:this.aiDisplay.length},fnDisplayEnd:function(){var a=this._iDisplayLength,b=this._iDisplayStart,c=b+a,d=this.aiDisplay.length,e=this.oFeatures,l=e.bPaginate;return e.bServerSide?!1===l||-1===a?b+d:Math.min(b+a,this._iRecordsDisplay):!l||c>d||-1===a?d:c},
oInstance:null,sInstance:null,iTabIndex:0,nScrollHead:null,nScrollFoot:null,aLastSort:[],oPlugins:{}};G.ext=ka={classes:{},errMode:"alert",feature:[],search:[],internal:{},legacy:{ajax:null},pager:{},renderer:{pageButton:{},header:{}},order:{},type:{detect:[],search:{},order:{}},_unique:0,fnVersionCheck:G.fnVersionCheck,iApiIndex:0,oJUIClasses:{},sVersion:G.version};b.extend(ka,{afnFiltering:ka.search,aTypes:ka.type.detect,ofnSearch:ka.type.search,oSort:ka.type.order,afnSortData:ka.order,aoFeatures:ka.feature,
oApi:ka.internal,oStdClasses:ka.classes,oPagination:ka.pager});b.extend(G.ext.classes,{sTable:"dataTable",sNoFooter:"no-footer",sPageButton:"paginate_button",sPageButtonActive:"current",sPageButtonDisabled:"disabled",sStripeOdd:"odd",sStripeEven:"even",sRowEmpty:"dataTables_empty",sWrapper:"dataTables_wrapper",sFilter:"dataTables_filter",sInfo:"dataTables_info",sPaging:"dataTables_paginate paging_",sLength:"dataTables_length",sProcessing:"dataTables_processing",sSortAsc:"sorting_asc",sSortDesc:"sorting_desc",
sSortable:"sorting",sSortableAsc:"sorting_asc_disabled",sSortableDesc:"sorting_desc_disabled",sSortableNone:"sorting_disabled",sSortColumn:"sorting_",sFilterInput:"",sLengthSelect:"",sScrollWrapper:"dataTables_scroll",sScrollHead:"dataTables_scrollHead",sScrollHeadInner:"dataTables_scrollHeadInner",sScrollBody:"dataTables_scrollBody",sScrollFoot:"dataTables_scrollFoot",sScrollFootInner:"dataTables_scrollFootInner",sHeaderTH:"",sFooterTH:"",sSortJUIAsc:"",sSortJUIDesc:"",sSortJUI:"",sSortJUIAscAllowed:"",
sSortJUIDescAllowed:"",sSortJUIWrapper:"",sSortIcon:"",sJUIHeader:"",sJUIFooter:""});(function(){var a="",a="",c=a+"ui-state-default",d=a+"css_right ui-icon ui-icon-",a=a+"fg-toolbar ui-toolbar ui-widget-header ui-helper-clearfix";b.extend(G.ext.oJUIClasses,G.ext.classes,{sPageButton:"fg-button ui-button "+c,sPageButtonActive:"ui-state-disabled",sPageButtonDisabled:"ui-state-disabled",sPaging:"dataTables_paginate fg-buttonset ui-buttonset fg-buttonset-multi ui-buttonset-multi paging_",sSortAsc:c+
" sorting_asc",sSortDesc:c+" sorting_desc",sSortable:c+" sorting",sSortableAsc:c+" sorting_asc_disabled",sSortableDesc:c+" sorting_desc_disabled",sSortableNone:c+" sorting_disabled",sSortJUIAsc:d+"triangle-1-n",sSortJUIDesc:d+"triangle-1-s",sSortJUI:d+"carat-2-n-s",sSortJUIAscAllowed:d+"carat-1-n",sSortJUIDescAllowed:d+"carat-1-s",sSortJUIWrapper:"DataTables_sort_wrapper",sSortIcon:"DataTables_sort_icon",sScrollHead:"dataTables_scrollHead "+c,sScrollFoot:"dataTables_scrollFoot "+c,sHeaderTH:c,sFooterTH:c,
sJUIHeader:a+" ui-corner-tl ui-corner-tr",sJUIFooter:a+" ui-corner-bl ui-corner-br"})})();var Wb=G.ext.pager;b.extend(Wb,{simple:function(a,b){return["previous","next"]},full:function(a,b){return["first","previous","next","last"]},simple_numbers:function(a,b){return["previous",Da(a,b),"next"]},full_numbers:function(a,b){return["first","previous",Da(a,b),"next","last"]},_numbers:Da,numbers_length:7});b.extend(!0,G.ext.renderer,{pageButton:{_:function(a,c,d,e,l,f){var h=a.oClasses,k=a.oLanguage.oPaginate,
g,q,p=0,B=function(c,e){var z,m,n,t,v=function(b){za(a,b.data.action,!0)};z=0;for(m=e.length;z<m;z++)if(t=e[z],b.isArray(t))n=b("<"+(t.DT_el||"div")+"/>").appendTo(c),B(n,t);else{q=g="";switch(t){case "ellipsis":c.append("<span>&hellip;</span>");break;case "first":g=k.sFirst;q=t+(0<l?"":" "+h.sPageButtonDisabled);break;case "previous":g=k.sPrevious;q=t+(0<l?"":" "+h.sPageButtonDisabled);break;case "next":g=k.sNext;q=t+(l<f-1?"":" "+h.sPageButtonDisabled);break;case "last":g=k.sLast;q=t+(l<f-1?"":
" "+h.sPageButtonDisabled);break;default:g=t+1,q=l===t?h.sPageButtonActive:""}g&&(n=b("<a>",{"class":h.sPageButton+" "+q,"aria-controls":a.sTableId,"data-dt-idx":p,tabindex:a.iTabIndex,id:0===d&&"string"===typeof t?a.sTableId+"_"+t:null}).html(g).appendTo(c),sb(n,{action:t},v),p++)}};try{var z=b(m.activeElement).data("dt-idx");B(b(c).empty(),e);null!==z&&b(c).find("[data-dt-idx="+z+"]").focus()}catch(n){}}}});b.extend(G.ext.type.detect,[function(a,b){var c=b.oLanguage.sDecimal;return xb(a,c)?"num"+
c:null},function(a,b){if(!(!a||a instanceof Date||Pb.test(a)&&ub.test(a)))return null;var c=Date.parse(a);return null!==c&&!isNaN(c)||oa(a)?"date":null},function(a,b){var c=b.oLanguage.sDecimal;return xb(a,c,!0)?"num-fmt"+c:null},function(a,b){var c=b.oLanguage.sDecimal;return Mb(a,c)?"html-num"+c:null},function(a,b){var c=b.oLanguage.sDecimal;return Mb(a,c,!0)?"html-num-fmt"+c:null},function(a,b){return oa(a)||"string"===typeof a&&-1!==a.indexOf("<")?"html":null}]);b.extend(G.ext.type.search,{html:function(a){return oa(a)?
a:"string"===typeof a?a.replace(Kb," ").replace(Ma,""):""},string:function(a){return oa(a)?a:"string"===typeof a?a.replace(Kb," "):a}});var Bb=function(a,b,c,d){if(0!==a&&(!a||"-"===a))return-Infinity;b&&(a=wb(a,b));a.replace&&(c&&(a=a.replace(c,"")),d&&(a=a.replace(d,"")));return 1*a};b.extend(ka.type.order,{"date-pre":function(a){return Date.parse(a)||0},"html-pre":function(a){return oa(a)?"":a.replace?a.replace(/<.*?>/g,"").toLowerCase():a+""},"string-pre":function(a){return oa(a)?"":"string"===
typeof a?a.toLowerCase():a.toString?a.toString():""},"string-asc":function(a,b){return a<b?-1:a>b?1:0},"string-desc":function(a,b){return a<b?1:a>b?-1:0}});Wa("");b.extend(!0,G.ext.renderer,{header:{_:function(a,c,d,e){b(a.nTable).on("order.dt.DT",function(b,l,f,h){a===l&&(b=d.idx,c.removeClass(d.sSortingClass+" "+e.sSortAsc+" "+e.sSortDesc).addClass("asc"==h[b]?e.sSortAsc:"desc"==h[b]?e.sSortDesc:d.sSortingClass))})},jqueryui:function(a,c,d,e){b("<div/>").addClass(e.sSortJUIWrapper).append(c.contents()).append(b("<span/>").addClass(e.sSortIcon+
" "+d.sSortingClassJUI)).appendTo(c);b(a.nTable).on("order.dt.DT",function(b,l,f,h){a===l&&(b=d.idx,c.removeClass(e.sSortAsc+" "+e.sSortDesc).addClass("asc"==h[b]?e.sSortAsc:"desc"==h[b]?e.sSortDesc:d.sSortingClass),c.find("span."+e.sSortIcon).removeClass(e.sSortJUIAsc+" "+e.sSortJUIDesc+" "+e.sSortJUI+" "+e.sSortJUIAscAllowed+" "+e.sSortJUIDescAllowed).addClass("asc"==h[b]?e.sSortJUIAsc:"desc"==h[b]?e.sSortJUIDesc:d.sSortingClassJUI))})}}});G.render={number:function(a,b,c,d){return{display:function(e){var l=
0>e?"-":"";e=Math.abs(parseFloat(e));var f=parseInt(e,10);e=c?b+(e-f).toFixed(c).substring(2):"";return l+(d||"")+f.toString().replace(/\B(?=(\d{3})+(?!\d))/g,a)+e}}}};b.extend(G.ext.internal,{_fnExternApiFunc:Jb,_fnBuildAjax:va,_fnAjaxUpdate:ya,_fnAjaxParameters:wa,_fnAjaxUpdateDraw:Ka,_fnAjaxDataSrc:ra,_fnAddColumn:h,_fnColumnOptions:v,_fnAdjustColumnSizing:c,_fnVisibleToColumnIndex:t,_fnColumnIndexToVisible:x,_fnVisbleColumns:A,_fnGetColumns:D,_fnColumnTypes:E,_fnApplyColumnDefs:R,_fnHungarianMap:d,
_fnCamelToHungarian:k,_fnLanguageCompat:f,_fnBrowserDetect:w,_fnAddData:H,_fnAddTr:L,_fnNodeToDataIndex:function(b,c){return c._DT_RowIndex!==a?c._DT_RowIndex:null},_fnNodeToColumnIndex:function(a,c,d){return b.inArray(d,a.aoData[c].anCells)},_fnGetCellData:J,_fnSetCellData:K,_fnSplitObjNotation:C,_fnGetObjectDataFn:F,_fnSetObjectDataFn:P,_fnGetDataMaster:l,_fnClearTable:q,_fnDeleteIndex:B,_fnInvalidate:z,_fnGetRowElements:I,_fnCreateTr:Z,_fnBuildHead:ma,_fnDrawHead:Y,_fnDraw:V,_fnReDraw:la,_fnAddOptionsHtml:ja,
_fnDetectHeader:da,_fnGetUniqueThs:na,_fnFeatureHtmlFilter:ba,_fnFilterComplete:S,_fnFilterCustom:n,_fnFilterColumn:Sa,_fnFilter:La,_fnFilterCreateSearch:lb,_fnEscapeRegex:cb,_fnFilterData:Fa,_fnFeatureHtmlInfo:zb,_fnUpdateInfo:Ta,_fnInfoMacros:Db,_fnInitialise:Ua,_fnInitComplete:db,_fnLengthChange:ua,_fnFeatureHtmlLength:kb,_fnFeatureHtmlPaginate:Va,_fnPageChange:za,_fnFeatureHtmlProcessing:M,_fnProcessingDisplay:X,_fnFeatureHtmlTable:Ab,_fnScrollDraw:Oa,_fnApplyToChildren:ga,_fnCalculateColumnWidths:Aa,
_fnThrottle:Ca,_fnConvertToWidth:ob,_fnScrollingWidthAdjust:Eb,_fnGetWidestNode:Fb,_fnGetMaxLenString:pb,_fnStringToCss:W,_fnScrollBarWidth:qb,_fnSortFlatten:Ga,_fnSort:Gb,_fnSortAria:Hb,_fnSortListener:rb,_fnSortAttachListener:eb,_fnSortingClasses:ab,_fnSortData:Ib,_fnSaveState:qa,_fnLoadState:Qa,_fnSettingsFromNode:Pa,_fnLog:Ea,_fnMap:sa,_fnBindAction:sb,_fnCallbackReg:ia,_fnCallbackFire:ea,_fnLengthOverflow:tb,_fnRenderer:fb,_fnDataSource:pa,_fnRowAttributes:Q,_fnCalculateEnd:function(){}});b.fn.dataTable=
G;b.fn.dataTableSettings=G.settings;b.fn.dataTableExt=G.ext;b.fn.DataTable=function(a){return b(this).dataTable(a).api()};b.each(G,function(a,c){b.fn.DataTable[a]=c});return b.fn.dataTable})})(window,document);window.TOONTALK||(window.TOONTALK={});window.TOONTALK.creators_from_json={};window.TOONTALK.widget=function(g){var m=function(a){var b=this.get_frontside&&this.get_frontside(!0);if(b)return a&&this.rerender(),b.get_element()};g.creators_from_json.top_level=function(a){a=g.widget.create_top_level_widget(a.settings);$(a.get_backside(!0).get_element()).addClass("toontalk-top-level-backside");return a};return{add_standard_widget_functionality:function(a){var b=function(){return!1},d;this.add_sides_functionality(a);this.runnable(a);this.stackable(a);this.animatable(a);this.has_title(a);
this.has_parent(a);this.has_description(a);this.has_listeners(a);this.droppable(a);this.erasable(a);a.top_level_widget=function(){var a;if(d)return d;if(this.is_top_level())return this;if(d=g.UTILITIES.widget_from_jquery($(this.get_frontside_element()).closest(".toontalk-top-level-backside")))return d;if(a=this.get_parent_of_frontside()||this.get_parent_of_backside())return d=a.get_widget().top_level_widget();a=$(".toontalk-top-level-backside");if(0<a.length)return 1<a.length&&console.log("Cannot find the top-level widget of "+
this+" but found "+a.length+" top-level backsides so picked one."),d=g.UTILITIES.widget_from_jquery(a);console.log("Could not find top_level_widget of "+this+". Created one instead");return d=this.create_top_level_widget()};a.is_of_type||(a.is_of_type=function(a){return this.get_type_name()===a});a.dereference||(a.dereference=function(){return this});a.is_number||(a.is_number=b);a.is_box||(a.is_box=b);a.is_empty_hole||(a.is_empty_hole=b);a.is_hole||(a.is_hole=b);a.is_scale||(a.is_scale=b);a.is_bird||
(a.is_bird=b);a.is_nest||(a.is_nest=b);a.is_robot||(a.is_robot=b);a.is_element||(a.is_element=b);a.is_function_nest||(a.is_function_nest=b);a.is_plain_text_element||(a.is_plain_text_element=b);a.maintain_proportional_dimensions||(a.maintain_proportional_dimensions=b);a.ok_to_set_dimensions=function(){return!this.is_plain_text_element()};a.set_name&&(a.receive_name_from_dropped=function(a){if(a.get_text&&(a=a.get_text(),this.set_name(a,!0)))return this.get_name()});!g.debugging&&!g.logging||a.to_debug_string||
(a.to_debug_string=function(){var a=this.get_parent_of_frontside(),b=this._debug_id,d=this.get_description(),d=d?d+" ":"";b||(b=a&&a.id?"id of parent is "+a.id:"");return this.toString({plain_text:!0})+" ("+d+" "+(this.get_name&&this.get_name()+" "||"")+b+")"});a.is_top_level=b;a.is_widget=!0;return a},erasable:function(a){var b;a.get_erased||(a.get_erased=function(){return b});a.set_erased||(a.set_erased=function(a,k){b=a;k&&this.rerender()});return a},add_sides_functionality:function(a){var b,d;
a.get_frontside||(a.get_frontside=function(d){d&&!b&&(b=g.frontside.create(a));return b},a.save_dimensions=function(){return this.save_dimensions_of(this)},a.save_dimensions_of=function(a){var b;if(a.is_element()){if(!this.get_original_width())return;b=a.get_attribute("width");a=a.get_attribute("height")}else a=a.get_frontside_element(),b=$(a).width(),a=$(a).height();0<b&&(this.saved_width=b);0<a&&(this.saved_height=a);return!0},a.restore_dimensions=function(){var a,b;0<this.saved_width&&(a=this.get_frontside_element(),
this.ok_to_set_dimensions()?this.set_size_attributes?this.set_size_attributes(this.saved_width,this.saved_height):$(a).css({width:this.saved_width,height:this.saved_height}):(b={width:"",height:""},g.UTILITIES.set_css_transform(b,""),$(a).css(b)),this.saved_height=this.saved_width=void 0)});a.get_backside||(a.get_backside=function(a){a&&!d&&(d=this.create_backside());return d});a.set_backside||(a.set_backside=function(a){d=a});a.forget_backside||(a.forget_backside=function(){d=void 0});a.create_backside||
(a.create_backside=function(){return g.backside.create(a)});return a},runnable:function(a){var b=!1,d=!1;a.get_running||(a.get_running=function(){var a=!1,d;b&&(d=this.get_backside_widgets(),0===d.length?b=!1:d.some(function(b){if(b.get_widget().get_running())return a=!0}));return a});a.is_ok_to_run||(a.is_ok_to_run=function(){return d},a.set_ok_to_run=function(a){d=a});a.set_running||(a.set_running=function(k,f){var g=b===k,e,m;d=k;e=this.get_backside_widgets();b=k;this.get_backside()&&this.get_backside().run_status_changed(b);
e.forEach(function(d){m=d.get_widget();d.is_backside()&&0<=this.backside_widgets.indexOf(m)||(m.is_robot()&&!m.being_trained?(b?(m.set_stopped(!1),m.run(a,f),m.set_ok_to_run(!0)):(m.set_stopped(!0),m.set_running(!1)),m.rerender()):m.set_running&&(!f&&d.is_backside()&&"top-level"!==a.get_type_name()?m.set_running(k,a):m.set_running(k)))}.bind(this));this.walk_children&&this.walk_children(function(a){a.set_running&&a.set_running(b);return!0});this.is_robot()&&(b?a.get_parent_of_backside()&&(this.set_stopped(!1),
this.run(a.get_parent_of_backside().get_widget(),f)):this.set_stopped(!0));g||this.rerender()});return a},droppable:function(a){a.drop_on||(a.drop_on=function(a,d,k,f){if(a.widget_dropped_on_me)return a.widget_dropped_on_me(this,d,k,f);console.log("No handler for drop of '"+this+"' on '"+a+"'")})},stackable:function(a){var b=!1;a.get_infinite_stack||(a.get_infinite_stack=function(){return b});a.set_infinite_stack||(a.set_infinite_stack=function(d){var k=a.get_backside_element(),f=a.get_frontside_element();
b=d;k&&$(k).find(".toontalk-infinite-stack-check-box").prop("checked",d);f&&(d?$(f).addClass("toontalk-infinite-stack"):$(f).removeClass("toontalk-infinite-stack"))});return a},animatable:function(a){var b;a.animate_to_widget||(b=function(a){var b=a.get_element();b&&(a.is_backside()||$(b).is(":visible"))||(b=g.UTILITIES.find_resource_equal_to_widget(a));return b},a.animate_to_widget=function(a,k,f,g,e,m,r){var h=function(){this.animate_to_element(b(a),k,f,g,e,m,r&&Math.max(0,r-100));this.render()}.bind(this);
0===r?h():setTimeout(h,100)});a.animate_to_element||(a.animate_to_element=function(a,b,f,g,e,m,r){var h=$(a).offset(),v=$(this.get_frontside_element()),c=$(a).is(".toontalk-backside");if(a&&$(a).is(":visible")){if("number"===typeof a.animation_left_offset)g=a.animation_left_offset;else if("undefined"===typeof g||c)g=($(a).width()-v.width())*Math.random();if("number"===typeof a.animation_top_offset)e=a.animation_top_offset;else if("undefined"===typeof e||c)e=($(a).height()-v.height())*Math.random();
h?(h.left+=g,h.top+=e):h={left:0,top:0};this.animate_to_absolute_position(h,b,f,m,r)}else b&&b()});a.animate_to_absolute_position||(a.animate_to_absolute_position=function(a,b,f,p,e){g.UTILITIES.animate_to_absolute_position(this.get_frontside_element(),a,b,f,p,e)});return a},has_title:function(a){a.get_title||(a.get_title=function(){var a=this.get_type_name(),d=this.get_backside(),k=this.get_frontside_element(),f=this.get_description(),p="";$(k).is(".toontalk-top-level-resource")?p=this.can_run&&
this.can_run()?this.get_running()?"Click elsewhere to stop me from running. Click on it to start me up again.":"Click to start me running. Click elsewhere to stop me.":"Drag me to a work area.":d&&d.get_element()&&$(d.get_element()).is(":visible")||(p=this.can_run&&this.can_run()?this.get_running()?"Robots on my back are running (or waiting to run).\nTo see them click the stop sign "+g.UTILITIES.encode_HTML_for_title("<span class='toontalk-stop-sign-icon'></span>")+" and then click on me.":"There are robots on my back.\nTo see them in action click me to open my back side and then click the green flag "+
g.UTILITIES.encode_HTML_for_title("<span class='toontalk-green-flag-icon'></span>")+".":"Click to see my back side.");f&&(f="I'm "+f,p=p?f+"\n"+p:f);if(this.get_erased())return this.get_title_of_erased_widget();p=this.get_custom_title_prefix&&!$(k).is(".toontalk-top-level-resource")?this.get_custom_title_prefix()+"\n"+p:"I'm "+g.UTILITIES.add_a_or_an(a)+". "+p;p=p.trim();0>".?!".indexOf(p[p.length-1])&&(p+=".");return p});a.update_title=function(){g.UTILITIES.give_tooltip(this.get_frontside_element(),
this.get_title())};return a},get_title_of_erased_widget:function(){var a=this.get_frontside_element(),b=this.get_type_name();return a&&$(a).closest(".toontalk-conditions-contents-container").is("*")?"I'm an erased "+b+".\nI'll match with any other "+b+".":"I'm an erased "+b+".\nDusty the Vacuum can restore me to normal."},has_parent:function(a){var b,d;a.get_parent_of_frontside=function(){return b};a.get_parent_of_backside=function(){return d};a.set_parent_of_frontside=function(a,d,g){var e=b;a&&
d&&(a=a.get_backside(!0));if(b===a)return;b=a;e&&!g&&e.is_backside()&&e.get_widget().remove_backside_widget(this,!1,!0)};a.set_parent_of_backside=function(a,b,g){d&&!g&&d.is_backside()&&d.get_widget().remove_backside_widget(this,!0,!0);d=a&&b?a.get_backside(!0):a};a.closest_visible_ancestor=function(){for(var a=this;a&&!a.visible();)a=a.is_backside()?a.get_parent_of_backside():a.get_parent_of_frontside();return a||this};a.closest_visible_ancestor_or_frontside=function(){for(var a=this,b;a&&!$(a.get_frontside_element()).is(":visible");)b=
a,a.is_backside()?(a=a.get_parent_of_backside())||(a=b.get_widget()):a=a.get_parent_of_frontside();return a||this};a.ancestor_of_type=function(a){for(var b=this;b&&!b.is_of_type(a);)b=b.is_backside()?b.get_widget().get_parent_of_backside():b.get_parent_of_frontside();return b};a.has_ancestor=function(a){for(var b=this;b;){if(a===b)return!0;b=b.is_backside()?b.get_widget().get_parent_of_backside():b.get_parent_of_frontside()}return!1};a.remove_from_parent_of_frontside=function(a){b&&(b.is_backside()?
b.remove_backside_widget(this,!1,!a):b.removed_from_container&&b.removed_from_container(this,!1,a,void 0,!0))};return a},has_description:function(a){var b;a.get_description||(a.get_description=function(){return b});a.set_description||(a.set_description=function(a,k){if(b===a||!b&&""===a)return!1;b=a;k&&this.rerender();return!0});a.receive_description_from_dropped=function(a){if(a.get_text&&(a=a.get_text(),this.set_description(a,!0)))return this.get_description()}},has_name:function(a){var b;a.get_name||
(a.get_name=function(){"string"!==typeof b&&a.generate_name&&(b=a.generate_name());return b});a.set_name||(a.set_name=function(a,k){if(b===a||"string"!==typeof a)return!1;b=a;k&&this.rerender();return!0})},has_listeners:function(a){var b={};a.add_listener||(a.add_listener=function(a,k){var f=b[a];f?0>f.indexOf(k)&&f.push(k):b[a]=[k]});a.remove_listener||(a.remove_listener=function(a,k,f){if(a=b[a])if(k=a.indexOf(k),0<=k){a.splice(k,1);return}!f&&g.debugging&&console.log("Listener of type "+type_name+
" could not be removed.")});a.get_listeners||(a.get_listeners=function(a){return b[a]})},get_full_description:function(a){var b;if(this.get_erased&&this.get_erased())return a&&"conditions"===a.role?"any "+this.get_type_name():"erased "+this.get_type_name();b=this.get_description(a);a=this.toString(a);return b?a+" ("+b+")":a},remove:function(a){var b=this.get_backside(),d=this.get_frontside(),k=this.get_parent_of_frontside();this.get_parent_of_backside();b&&b.hide_backside();d&&(d.remove(),k&&this.remove_from_parent_of_frontside(a));
this.set_running(!1);this.set_visible(!1);this.walk_children&&this.walk_children(function(a){a.remove&&a.remove();return!0})},get_frontside_element:m,get_element:m,get_backside_element:function(a){if(a=this.get_backside&&this.get_backside(a))return a.get_element()},add_to_json:function(a,b){var d,k,f,g,e;if(a){a.view?(k=a,d=a.view,a=a.semantic):(d={},k={semantic:a,view:d});k.version=1;this.get_erased&&this.get_erased()&&(a.erased=!0);this.get_infinite_stack&&this.get_infinite_stack()&&(a.infinite_stack=
!0);this.get_running&&this.get_running()&&(a.running=!0);if(!this.get_parent_of_frontside()||this.get_parent_of_frontside().is_backside())if(g=this.get_frontside_element&&this.get_frontside_element())e=$(g).width(),$(g).is(".toontalk-plain-text-element")||0===e||(d.frontside_width=$(g).width(),d.frontside_height=$(g).height()),0!==e&&(f=$(g).position()),f&&(d.frontside_left=f.left,d.frontside_top=f.top);if(g=this.get_backside()){if(e=g.get_element())d.backside_width=$(e).width(),d.backside_height=
$(e).height(),d.backside_left||(f=$(e).position(),d.backside_left=f.left,d.backside_top=f.top,"&lt;"===$(e).find(".toontalk-settings-backside-button").html()&&(d.advanced_settings_open=!0));g.get_backside_dimensions()&&(d.backside_geometry=g.get_backside_dimensions())}!d.backside_geometry&&this.backside_geometry&&(d.backside_geometry=this.backside_geometry);a.description=this.get_description&&this.get_description();d.saved_width=this.saved_width;d.saved_height=this.saved_height;return k}console.log("get_json not defined");
return{}},add_backside_widgets_to_json:function(a,b){var d=this.get_backside_widgets(),k;0<d.length&&(a.semantic.backside_widgets=g.UTILITIES.get_json_of_array(d,b),(d=this.get_backside_widgets_json_views())&&d.forEach(function(d,g){var e;if(k=a.semantic.backside_widgets[g]){if(0<=k.widget.shared_widget_index){e=b.widgets_encountered.indexOf(b.shared_widgets[k.widget.shared_widget_index]);if(!b.json_of_widgets_encountered[e])return;e=b.json_of_widgets_encountered[e].view}else e=k.widget.view;k.is_backside?
d.backside_left&&(e.backside_left=d.backside_left,e.backside_top=d.backside_top):d.frontside_left&&(e.frontside_left=d.frontside_left,e.frontside_top=d.frontside_top)}}))},get_backside_widgets:function(){return this.backside_widgets||[]},add_backside_widget:function(a,b){var d=this.get_backside(!0),k=b?a.get_backside():a;g.debugging&&a===this?g.UTILITIES.report_internal_error("Adding a widget to a list of its backside widgets!"):(this.backside_widgets?0>this.backside_widgets.indexOf(k)&&this.backside_widgets.push(k):
this.backside_widgets=[k],b?a.set_parent_of_backside(this,!0):a.set_parent_of_frontside(this,!0),d.visible()&&(k.set_visible(!0),a.render()))},remove_all_backside_widgets:function(){if(this.backside_widgets)for(;0<this.backside_widgets.length;)this.backside_widgets[0].remove()},remove_backside_widget:function(a,b,d){this.get_backside();var k=b?a.get_backside(!0):a,f;g.debugging&&!this.backside_widgets?d?console.log("remove_backside_widget called and there are no backside_widgets"):g.UTILITIES.report_internal_error("Couldn't remove a widget from backside widgets."):
(f=this.backside_widgets.indexOf(k),0>f?d?g.debugging&&console.log("Warning: Probable redundant call to remove_backside_widget"):g.UTILITIES.report_internal_error("Couldn't find a widget to remove it from backside widgets. "+k.get_widget()+" ("+k.get_widget()._debug_id+")"):(this.backside_widgets.splice(f,1),this.backside_widgets_json_views&&this.backside_widgets_json_views.splice(f,1),b?(b=a.get_parent_of_backside())&&b.get_widget()===this&&a.set_parent_of_backside(void 0,!0,!0):(b=a.get_parent_of_frontside())&&
b.get_widget()===this&&a.set_parent_of_frontside(void 0,void 0,!0),k.set_visible(!1)))},set_backside_widget_sides:function(a,b){var d=this.get_backside(),k=d&&d.visible();this.backside_widgets=a;0<a.length&&(this.get_backside()?this.get_backside().add_backside_widgets(a,b):this.backside_widgets_json_views=b,a.forEach(function(a){a&&(a.is_backside()?a.get_widget().set_parent_of_backside(this,!0):a.get_widget().set_parent_of_frontside(this,!0),a.set_visible(k))}.bind(this)))},get_backside_widgets_json_views:function(a){!this.backside_widgets_json_views&&
a&&(this.backside_widgets_json_views=[]);return this.backside_widgets_json_views},can_run:function(){var a=!1,b;this.get_backside_widgets().some(function(d){b=d.get_widget();if(b.get_body&&!b.get_body().is_empty()||b.can_run())return a=!0});return a},add_to_copy:function(a,b){var d;this.get_erased&&this.get_erased()&&(a.set_erased||g.widget.erasable(a),a.set_erased(this.get_erased()));b&&b.just_value||(d=this.get_backside_widgets(),0<d.length&&a.set_backside_widget_sides(g.UTILITIES.copy_widget_sides(d,
b),this.get_backside_widgets_json_views()));a.set_visible(this.visible());return a},get_type_name:function(){return""},copy:function(){console.assert(!1,"copy not implemented")},add_copy_to_container:function(a,b,d){a||(a=this.copy({}));var k=this.get_frontside_element(),f=a.get_frontside_element(),p=$(k).closest(".toontalk-backside"),e=a.ok_to_set_dimensions(),m,r;0===p.length&&(p=$(".toontalk-backside"));"undefined"===typeof b&&(b=30);"undefined"===typeof d&&(d=30);m=g.UTILITIES.relative_position(k,
p.get(0));r=g.UTILITIES.widget_from_jquery(p);$(f).css({width:e?$(k).width():"",height:e?$(k).height():"",left:m.left+b,top:m.top+d});p.get(0).appendChild(f);r&&r.add_backside_widget(a);this.robot_in_training()&&this.robot_in_training().copied(this,a,!1);return a},visible:function(){var a=this.get_frontside();return a?a.visible():!1},set_visible:function(a){var b=this.get_frontside(a);b&&b.set_visible(a)},is_backside:function(){return!1},get_parent:function(){return this.get_parent_of_frontside()},
drag_started:function(a,b){this.robot_in_training()&&this.robot_in_training().picked_up(this,a,b)},match:function(a){console.assert(!1,"match not implemented for "+a.toString())},removed:function(a){g.UTILITIES.report_internal_error("removed not implemented")},equals_box:function(){return!1},equals_number:function(){return!1},open_backside:function(a){var b=this.get_backside(),d=a&&function(){setTimeout(a)},k=function(a,b){g.UTILITIES.set_timeout(function(){$(a).addClass("toontalk-side-appearing");
g.UTILITIES.add_one_shot_event_handler(a,"transitionend",2500,function(){$(a).removeClass("toontalk-side-appearing");d&&d()});$(a).css({left:m,top:r,opacity:b});this.apply_backside_geometry()}.bind(this))}.bind(this),f,p,e,m,r,h,v,c;if(b){f=b.get_element();if($(f).is(":visible"))return g.UTILITIES.highlight_element(f,void 0,1E3),d&&d(),b;if((b=this.get_parent_of_backside())&&b.is_backside())return b.get_widget().open_backside(a)}p=this.get_frontside_element();e=$(p).parent();b=$(p);if(b.is(".toontalk-top-level-resource"))d&&
d();else{for(;0<e.length&&!e.is(".toontalk-backside");)b=e,e=e.parent();b.get(0);b=this.get_backside(!0);f=b.get_element();f.toontalk_widget=this;h=$(p).offset();v=e.offset();c=e.width();v||(v={left:0,top:0});$(f).css({left:h.left-v.left,top:h.top-v.top,opacity:.01});e.append(f);(e=g.UTILITIES.widget_from_jquery(e))&&e.add_backside_widget(this,!0);e=this.is_element()?this.get_attribute("height"):$(p).height();p=$(f).width();m=h.left-v.left;m+p>c&&(m=Math.max(0,c-p));r=h.top-v.top+e+34;this.is_box()&&
(r+=28);k(f,"inherit");b.render();this.backside_widgets&&this.backside_widgets.forEach(function(a){a.render();a.set_visible(!0)});return b}},hide_backside:function(){var a=this.get_backside();a&&a.hide_backside()},apply_backside_geometry:function(){var a=this.get_backside(!0),b=a.get_element();this.backside_geometry&&b&&(g.backside.scale_backside($(b),this.backside_geometry.x_scale,this.backside_geometry.y_scale,this.backside_geometry.original_width,this.backside_geometry.original_height),a.set_dimensions(this.backside_geometry))},
robot_in_training:function(){return this.top_level_widget().robot_in_training()},robot_training_this_robot:function(){return this.top_level_widget().robot_training_this_robot()},robot_started_training:function(a){this.top_level_widget().robot_started_training(a)},robot_finished_training:function(){this.top_level_widget().robot_finished_training()},backup_all:function(a){var b=this.top_level_widget();b&&b.save(a)},render:function(){g.DISPLAY_UPDATES.pending_update(this)},rerender:function(){this.visible()&&
this.render()},hide:function(){$(this.get_frontside_element()).hide()},close_button_ok:function(a){return"top-level"!==this.get_type_name()&&!$(a).is(".toontalk-top-level-resource")&&!$(a).closest(".toontalk-conditions-panel").is("*")},get_widget:function(){return this},add_to_top_level_backside:function(a,b){var d=this.top_level_widget(),k=a.get_frontside_element(!0);d.add_backside_widget(a);d.get_backside_element().appendChild(k);a.render();b&&this.robot_in_training()&&this.robot_in_training().dropped_on(a,
d);return k},create_top_level_widget:function(a){var b=Object.create(g.widget),d=[],k=function(){return!1};a||(a={});b.is_top_level=function(){return!0};b.is_number=k;b.is_box=k;b.is_empty_hole=k;b.is_scale=k;b.is_bird=k;b.is_nest=k;b.is_robot=k;b.is_element=k;b.is_function_nest=k;b.is_hole=k;b.is_plain_text_element=k;b.ok_to_set_dimensions=k;b.get_json=function(b){b=this.get_backside(!0).get_element();b=document.defaultView.getComputedStyle(b,null).getPropertyValue("background-color");return{semantic:{type:"top_level",
settings:a},view:{background_color:b}}};b.get_type_name=function(){return"top-level"};b.is_of_type=function(a){return"top-level"===a};b.toString=function(){return"top level widget"};b.get_description=function(){};b.match=function(){return"matched"};b.update_display=function(){this.backside_widgets&&this.backside_widgets.forEach(function(a){a&&a.visible()&&a.update_display()})};b.copy=function(){return this};b.visible=function(){return!0};b.get_parent_of_frontside=function(){};b.get_parent_of_backside=
function(){};b.closest_visible_ancestor=function(){return this};b.get_infinite_stack=function(){return!1};b.top_level_widget=function(){return this};if(g.debugging||g.logging)b.to_debug_string=function(){var a=$(this.get_backside_element()).offset();return"top-level widget at "+Math.round(a.left)+", "+Math.round(a.top)};b=b.add_sides_functionality(b);b=b.runnable(b);b=b.has_parent(b);b.removed_from_container=function(a,b,d,k,g){this.robot_in_training()||this.remove_backside_widget(a,b,g)};b.widget_dropped_on_me=
function(a,b,d,k,g){return this.get_backside().widget_dropped_on_me(a,b,d,k,g)};b.get_element=function(){return this.get_backside().get_element()};b.get_setting=function(b,d){"undefined"!==typeof a[b]||d||(a[b]=g.DEFAULT_SETTINGS&&g.DEFAULT_SETTINGS[b]);return a[b]};b.set_setting=function(b,d){a[b]=d};b.open_settings=function(){g.SETTINGS.open(b)};b.robot_in_training=function(){if(0<d.length)return d[d.length-1]};b.robot_training_this_robot=function(){if(1<d.length)return d[d.length-2]};b.robot_started_training=
function(a){d.push(a)};b.robot_finished_training=function(){d.pop()};b.save=function(a,b,d){var k=this.get_setting("program_name",!0),m;k&&(b||(b={}),"undefined"===typeof b.google_drive&&(b.google_drive=g.google_drive&&this.get_setting("auto_save_to_google_drive")),"undefined"===typeof b.local_storage&&(b.local_storage=this.get_setting("auto_save_to_local_storage")),a?(b.google_drive&&!this.get_setting("google_drive_unavailable")&&(m=g.UTILITIES.get_json_top_level(this),a=g.google_drive.get_status(),
"Ready"===a?(g.google_drive.upload_file(k,"json",JSON.stringify(m,g.UTILITIES.clean_JSON),d),d=void 0):g.google_drive.connection_to_google_drive_possible()&&("Need to authorize"===a?(g.UTILITIES.display_message_if_new("Unable to save to your Google Drive because you need to log in. Click on the settings icon "+g.UTILITIES.encode_HTML_for_title("<span class='toontalk-settings-icon'></span>")+" to log in."),g.UTILITIES.display_tooltip($(".toontalk-settings-button"))):console.log("Unable to save to Google Drive because: "+
a))),b.local_storage&&(m||(m=g.UTILITIES.get_json_top_level(this)),this.save_to_local_storage(m)),d&&d()):setTimeout(function(){this.save(!0,b,d)}.bind(this),100))};b.publish=function(a,b){g.publish.publish_widget(this.get_setting("program_name"),this,b,a)};b.save_to_local_storage=function(a,b){var d=this.get_setting("program_name"),k=g.UTILITIES.local_storage_program_key(d),m=g.UTILITIES.local_storage_program_meta_data_key(d),h,v,c;b||(b=Date.now());try{v=(v=window.localStorage.getItem(m))?JSON.parse(v):
{created:b},v.last_modified=b,c=JSON.stringify(a,g.UTILITIES.clean_json),v.file_size=c.length,window.localStorage.setItem(m,JSON.stringify(v)),window.localStorage.setItem(k,c),window.localStorage.setItem("toontalk-last-key",k),h=g.UTILITIES.get_all_locally_stored_program_names(),0>h.indexOf(d)&&(h.push(d),g.UTILITIES.set_all_locally_stored_program_names(h))}catch(t){d=c?"Failed to save state to local storage since it requires "+c.length+" bytes. Error message is "+t:"Error while saving to local storage. Error message is "+
t,g.UTILITIES.is_internet_explorer()?console.error(d):g.UTILITIES.display_message(d),this.last_local_storage_error=d}};b.load=function(a,d,e){var k=this.get_setting("program_name"),m=k+".json",h=g.UTILITIES.local_storage_program_key(k),v=function(a){var c;if(a)try{c=JSON.parse(a),b.remove_all_backside_widgets(),g.UTILITIES.add_backside_widgets_from_json(b,c.semantic.backside_widgets,{json_of_shared_widgets:c.shared_widgets,shared_widgets:[],shared_html:c.shared_html}),d&&d()}catch(f){g.UTILITIES.display_message("Error encountered loading "+
k+" : "+f)}else e&&e()},c=function(a){a?g.google_drive.download_file(a,v):v(window.localStorage.getItem(h))};a&&g.google_drive&&"Ready"===g.google_drive.get_status()?g.google_drive.get_toontalk_program_file(m,c):v(window.localStorage.getItem(h))};b.walk_children=function(){};b.render=function(){};b.is_widget=!0;b.get_backside(!0).set_visible(!0);g.debugging&&(b._debug_id=g.UTILITIES.generate_unique_id(),b.debug_string="Top-level widget");return b}}}(window.TOONTALK);window.TOONTALK.backside=function(g){return{create:function(m){var a=Object.create(this),b=document.createElement("div"),d=$(b),k=1,f=1,p=document.createElement("div"),e=document.createElement("div"),w=m.get_help_URL&&m.get_help_URL(),r,h,v,c,t,x,A,D,E,R,H,L=function(a){a?($(p).addClass("toontalk-green-flag-active").removeClass("toontalk-green-flag-inactive"),$(e).addClass("toontalk-stop-sign-inactive").removeClass("toontalk-stop-sign-active")):($(p).addClass("toontalk-green-flag-inactive").removeClass("toontalk-green-flag-active"),
$(e).addClass("toontalk-stop-sign-active").removeClass("toontalk-stop-sign-inactive"))},J=function(){var a=d.width();d.height();var b,c,l;0===a?setTimeout(J,100):(a=$(e).width(),b=(b=$(A).width())?b+14:0,$(e).css({right:b}),$(p).css({right:b+a+6}),c=$(p).width(),E&&$(E).css({right:b+a+c+12}),r&&(l=$(E).width()||0,$(r).css({right:b+a+c+l+12})))};D=this.create_description_label(a,m);var K=function(){var a;a=m.get_running()?"To stop this click on the stop sign "+g.UTILITIES.encode_HTML_for_title("<span class='toontalk-stop-sign-icon'></span>"):
m.can_run()?"Click this to start this running.":"There is nothing to run on this.";g.UTILITIES.give_tooltip(p,a)},C=function(){var a;a=m.get_running()?"Click to stop this from running.":m.can_run()?"This has stopped. Click on the flag "+g.UTILITIES.encode_HTML_for_title("<span class='toontalk-green-flag-icon'></span>")+" to start running it.":"There is nothing to run here.";g.UTILITIES.give_tooltip(e,a)},F,P,l,q,B;g.TRANSLATION_ENABLED&&(w=g.UTILITIES.add_URL_parameter(w,"translate","1"));m.close_button_ok(b)&&
(P=function(b){var c=function(){a.hide_backside(b);m.robot_in_training()&&m.robot_in_training().backside_closed(m)},e,l;m.get_running()?(e=m.get_backside_widgets(),e.some(function(a){a=a.get_widget();if(a.is_robot())return a.finish_cycle_immediately(c),l=!0}),l||(console.log("Expected to find a robot on back of "+m),c()),d.css({opacity:1}),d.addClass("toontalk-animating-element"),d.css({opacity:0})):c();b.stopPropagation()},F=(F=m.get_description())?"the "+m.get_type_name()+" who "+F:"the "+m.get_type_name(),
A=g.UTILITIES.create_close_button(P,"Click to hide this back side of "+F+"."),b.appendChild(A));$(p).addClass("toontalk-green-flag toontalk-green-flag-inactive").click(function(a){m.can_run()?(L(!0),m.set_running(!0),C()):m.is_top_level()?g.UTILITIES.display_message("There is nothing to run."):g.UTILITIES.display_message("This "+m.get_type_name()+" has nothing to run. Add some robots on the back.");m.robot_in_training()&&m.robot_in_training().button_clicked(".toontalk-green-flag",m);a.stopPropagation()}).on("mouseenter",
C);$(e).addClass("toontalk-stop-sign toontalk-stop-sign-active").click(function(a){L(!1);m.set_running(!1);K();m.robot_in_training()&&m.robot_in_training().button_clicked(".toontalk-stop-sign",m);a.stopPropagation()}).on("mouseenter",K);b.appendChild(p);b.appendChild(e);g.UTILITIES.use_custom_tooltip(p);g.UTILITIES.use_custom_tooltip(e);w&&(B=0>w.indexOf("://"),E=document.createElement(B?"div":"a"),$(E).addClass("toontalk-help-button notranslate toontalk-widget-help-button").click(function(a){B?(R=
document.createElement("iframe"),$(R).addClass("toontalk-help-frame"),R.src=w,document.body.appendChild(H),document.body.appendChild(R),a.stopPropagation()):(E.href=w,E.target="_blank")}),E.innerHTML="i",E.translate=!1,g.UTILITIES.give_tooltip(E,"Click to learn more about "+m.get_type_name(!0,!0)+"."),H=document.createElement("div"),$(H).addClass("toontalk-close-help-frame-button").button().click(function(a){$(R).remove();$(H).remove();a.stopPropagation()}),H.innerHTML="Return to ToonTalk",b.appendChild(E));
D&&b.appendChild(D);m.is_top_level()&&(r=document.createElement("div"),$(r).addClass("toontalk-settings-button").click(function(a){m.open_settings();a.stopPropagation()}),g.UTILITIES.give_tooltip(r,"Click to change settings or open a different program."),b.appendChild(r));g.UTILITIES.set_timeout(J);d.addClass("toontalk-backside toontalk-side toontalk-backside-of-"+m.get_type_name());d.css({"z-index":g.UTILITIES.next_z_index()});a.get_element=function(){return b};a.get_backside_element=function(){return b};
a.get_widget=function(){return m};a.visible=function(){return h};a.set_visible=function(a){var b=this.get_widget().get_backside_widgets();h=a;b.forEach(function(b){b.set_visible(a);a&&b.render()})};m.get_backside||(m.get_backside=function(){return a});a.get_parent_of_backside=function(){return m.get_parent_of_backside()};a.get_parent_of_frontside=function(){return m.get_parent_of_frontside()};a.get_frontside=function(){return m.get_frontside()};a.get_frontside_element=function(){return m.get_frontside_element()};
a.get_description_text_area=function(){return l};a.set_description_text_area=function(a){l=a};a.get_name_text_input=function(){return q};a.set_name_text_input=function(a){q=a};m.removed_from_container||(m.removed_from_container=function(a,b,c,d,e){m.robot_in_training()||this.remove_backside_widget(a,b,e)});a.widget_dropped_on_me=function(a,b,c,e,l){var f,h,k;g.sounds&&c&&g.sounds.drop.play();b?(f=a.get_backside(!0),h=f.get_element(),f.rerender()):(f=a.get_frontside(!0),h=f.get_element(),a.rerender());
f=$(h);d.append(f);this.get_widget().is_top_level()&&e&&!e.visible()&&f.addClass("toontalk-widget-added-to-backside-by-unwatched-robot");g.UTILITIES.set_position_is_absolute(h,!0,c);m.robot_in_training()&&!l&&c&&setTimeout(function(){m.robot_in_training().dropped_on(a,this,c)}.bind(this));b&&"top-level"!=this.get_widget().get_type_name()&&(k=a.get_backside(),a.forget_backside(),a.remove(c),a.set_backside(k));this.add_backside_widget(a,b);a.dropped_on_other&&a.dropped_on_other(this.get_widget(),!0,
c,e);c&&a.get_body&&a.get_body().is_empty()&&!a.being_trained&&setTimeout(function(){(k=a.open_backside())&&$(k.get_element()).find(".toontalk-train-backside-button").click()});c&&a.get_widget().backup_all();return!0};a.add_backside_widget=function(a,b){return this.get_widget().add_backside_widget(a,b)};a.add_backside_widgets=function(a,c){0!==a.length&&g.UTILITIES.set_timeout(function(){var e=this.visible(),l,f,h;a.forEach(function(a,k){if(a){var q=a.get_widget().get_backside();l=a.get_element();
l.toontalk_widget=a.get_widget();c&&(f=c[k])&&(a.is_backside()?(h={left:f.backside_left,top:f.backside_top,width:f.backside_width,height:f.backside_height},a.get_widget().apply_backside_geometry(),f.advanced_settings_open&&q.set_advanced_settings_showing(!0,q.get_element())):(0===f.frontside_width&&(f.frontside_width=""),0===f.frontside_height&&(f.frontside_height=""),h={left:f.frontside_left,top:f.frontside_top,width:f.frontside_width,height:f.frontside_height}),g.UTILITIES.constrain_css_to_fit_inside(b,
h),$(l).css(h));d.append(l);a.set_visible(e);a.get_widget().rerender()}})}.bind(this))};a.get_backside_dimensions=function(){if(1!==k||1!==f)return{x_scale:k,y_scale:f,original_width:v,original_height:c}};a.set_dimensions=function(a){k=a.x_scale;f=a.y_scale;v=a.original_width;c=a.original_height};a.scale_to_fit=function(a,b){var d;!v&&this.get_widget().backside_geometry&&(v=this.get_widget().backside_geometry.original_width,c=this.get_widget().backside_geometry.original_height);d=g.UTILITIES.scale_to_fit(a,
b,v,c);k=d.x_scale;f=d.y_scale};a.run_status_changed=function(a){L(a)};if(g.debugging||g.logging)a.to_debug_string=function(){return"backside of "+this.get_widget().to_debug_string()};b.toontalk_widget=m;g.UTILITIES.drag_and_drop(b);d.resizable({start:function(){t=d.width();x=d.height();v||(v=t);c||(c=x)},resize:function(a,b){var e=b.size.width,l=b.size.height;d.is(".toontalk-top-level-backside")||(k*=e/t,f*=l/x,t=e,x=l,g.backside.scale_backside(d,k,f,v,c))},handles:"e,s,se"});b.addEventListener("mouseenter",
function(a){a=m.get_frontside();var b=m.get_parent_of_backside();!a||b&&!b.get_widget().is_top_level()||g.UTILITIES.highlight_element(a.get_element())});b.addEventListener("mouseleave",function(a){m.is_top_level()||g.UTILITIES.remove_highlight()});a.update_display=function(){var b=this.get_description_text_area(),c=this.get_name_text_input(),d;b&&(d=this.get_widget().get_description())&&(b.button.value=d);c&&(c.button.value=this.get_widget().get_name());a.display_updated()};a.display_updated=function(){var a=
$(this.get_element());v||(v=a.width());c||(c=a.height())};m.get_backside_widgets&&(D=m.get_backside_widgets(),a.add_backside_widgets(D,m.get_backside_widgets_json_views()));g.debugging&&(b.id=m.debug_id);return a},toString:function(){return"backside of "+this.get_widget()},remove_element:function(){$(this.get_element()).remove()},create_infinite_stack_check_box:function(m,a){var b=g.UTILITIES.create_check_box(a.get_infinite_stack(),"toontalk-infinite-stack-check-box","Copy when dragged.","Check this if you want the "+
a.get_type_name()+" to be copied instead of moved.");$(b.button).click(function(d){var k=b.button.checked,f;a.set_infinite_stack(k);a.robot_in_training()&&(f=k?"change dragging to make a copy of ":"change dragging back to moving for ",a.robot_in_training().edited(a,{setter_name:"set_infinite_stack",argument_1:k,toString:f,button_selector:".toontalk-infinite-stack-check-box"}));d.stopPropagation()});return b},create_description_label:function(m,a){var b=a.get_description();if(b)return g.UTILITIES.create_text_element("I'm the back side of a "+
a.get_type_name()+" that is "+b)},add_advanced_settings:function(m){var a=this.get_widget(),b=this.create_infinite_stack_check_box(this,a),d=a.get_type_name(),k=g.UTILITIES.create_text_area(a.get_description(),"toontalk-description-input","I'm ","Type here to provide additional information about this "+d+".",function(b){(b=g.UTILITIES.input_area_drop_handler(b,a.receive_description_from_dropped.bind(a),a))&&a.robot_in_training()&&a.robot_in_training().dropped_on_text_area(b,a,{area_selector:".toontalk-description-input",
setter:"receive_description_from_dropped",toString:"for a widget's description"})}),f=$("<button>Make a sensor nest</button>").button(),p=$("<button>Make a function bird</button>").button(),e=function(){var b=k.button.value.trim();a.set_description(b,!0)&&a.robot_in_training()&&a.robot_in_training().edited(a,{setter_name:"set_description",argument_1:b,toString:"change the description to '"+b+"'' of the "+d,button_selector:".toontalk-description-input"})},w=document.createElement("table"),r=this.get_element(),
h=function(b,c){var d=a.get_parent_of_frontside(),e=b.get_frontside_element(!0),f;d&&d.add_backside_widget&&!d.get_widget().is_top_level()?(d.add_backside_widget(b),f=d.get_element(),f.appendChild(e),d=$(f).offset(),d.top+=.6*$(f).height()):(a.add_to_top_level_backside(b,!1),d=c.offset(),d.left-=120,0>d.left&&(d.left=0));g.UTILITIES.set_absolute_position($(e),d)},v,c;a.set_name&&(c=function(b){(b=a.receive_name_from_dropped&&g.UTILITIES.input_area_drop_handler(b,a.receive_name_from_dropped.bind(a),
a))&&a.robot_in_training()&&a.robot_in_training().dropped_on_text_area(b,a,{area_selector:".toontalk-name-input",setter:"receive_name_from_dropped",toString:"for a widget's name"})},v=g.UTILITIES.create_text_input(a.get_name(),"toontalk-name-input",a.get_name_input_label?a.get_name_input_label():"My name is ",a.get_name_input_title?a.get_name_input_title():"Edit the name of this "+d+". There is not much room so keep it short.",void 0,"string",c),c=function(){var b=v.button.value.trim();a.set_name(b,
!0)&&a.robot_in_training()&&a.robot_in_training().edited(a,{setter_name:"set_name",argument_1:b,toString:"change the name to '"+b+"'' of the "+d,button_selector:".toontalk-name-input"})},v.button.addEventListener("change",c),v.button.addEventListener("mouseout",c),this.set_name_text_input(v));$(w).addClass("toontalk-advanced-setting");$(k.button).val(a.get_description());k.button.addEventListener("change",e);k.button.addEventListener("mouseout",e);this.set_description_text_area(k);f.addClass("toontalk-make-sensor_nest_button").click(function(b){var c=
g.sensor.create("click","which",void 0,void 0,!0,a);h(c,f);a.robot_in_training()&&a.robot_in_training().created_widget(c,a,".toontalk-make-sensor_nest_button");b.stopPropagation()});f.attr("title","Click to create a nest which receives messages when events happen to this "+a.get_type_name()+".");p.addClass("toontalk-make-function_bird_button").click(function(b){var c=g.bird.create_function(d);h(c,p);a.robot_in_training()&&a.robot_in_training().created_widget(c,a,".toontalk-make-function_bird_button");
b.stopPropagation()});a.is_number()?p.attr("title","Click to get a bird that flies to functions of "+a.get_type_name(!0)+"."):(p.attr("title","There are no functions that operate on "+a.get_type_name(!0)+" (yet)."),p.button("option","disabled",!0));w.appendChild(g.UTILITIES.create_row(k.container));v&&w.appendChild(g.UTILITIES.create_row(v.container));w.appendChild(g.UTILITIES.create_row(f.get(0),p.get(0),b.container));r.appendChild(w);m?$(r).find(".toontalk-settings-backside-button").remove():$(r).find(".toontalk-advanced-setting").hide()},
get_type_name:function(){return"the backside of "+g.UTILITIES.add_a_or_an(this.get_widget().get_type_name())},hide_backside:function(m){var a=this.get_widget(),b=a.get_frontside_element(),d=$(a.get_backside_element()),k=d.position(),f=d.parent().closest(".toontalk-backside"),p=a.get_parent_of_backside();g.UTILITIES.remove_highlight();(function(){var b=a.get_backside_widgets(),d=a.get_backside_widgets_json_views(!0),f;b.forEach(function(a,b){a.get_widget();var c;if(f=a.get_element())d[b]||(d[b]={}),
a.start_position?(c=a.start_position,a.start_position=void 0):c=$(f).position(),a.is_backside()?(d[b].backside_left=c.left,d[b].backside_top=c.top):(d[b].frontside_left=c.left,d[b].frontside_top=c.top)})})();a.backside_geometry=this.get_backside_dimensions();p&&(p.is_backside()?a.set_parent_of_backside(void 0,!0):p.removed_from_container(a,!0,m,void 0,!0),a.forget_backside&&a.forget_backside());(function(a){var d=$(b).offset(),k=f.position(),h=function(){a.remove()};a.is(":visible")&&("0"===a.css("opacity")?
(a.removeClass("toontalk-animating-element"),a.remove()):(a.addClass("toontalk-side-appearing"),g.UTILITIES.add_one_shot_event_handler(a.get(0),"transitionend",2500,h),k||(k={left:0,top:0}),a.css({left:d.left-k.left,top:d.top-k.top,opacity:.1})))})(d);this.set_visible(!1);!$(b).is(":visible")&&(k&&$(b).css({left:k.left,top:k.top}),m=g.UTILITIES.widget_from_jquery(f))&&(m.add_backside_widget(a),f.append(b),a.render());a.backside_widgets&&a.backside_widgets.forEach(function(a){a.set_visible(!1)});if(a.on_backside_hidden)a.on_backside_hidden()},
create_advanced_settings_button:function(m,a){var b=document.createElement("div"),d=$(b),k=!1;b.innerHTML="&gt;";d.addClass("toontalk-settings-backside-button");d.css({"z-index":g.UTILITIES.next_z_index()});d.click(function(b){k=!k;this.set_advanced_settings_showing(k,m.get_element(),d);b.stopPropagation();a.robot_in_training()&&a.robot_in_training().button_clicked(".toontalk-settings-backside-button",m)}.bind(this));g.UTILITIES.give_tooltip(d.get(0),"Click to see the advanced settings of this "+
a.get_type_name()+".");return d.get(0)},set_advanced_settings_showing:function(m,a,b){a||(a=this.get_element());b||(b=$(a).find(".toontalk-settings-backside-button"));m?($(a).find(".toontalk-advanced-setting").show(),b.html("<"),g.UTILITIES.give_tooltip(b.get(0),"Click to hide the advanced settings.")):($(a).find(".toontalk-advanced-setting").hide(),b.html(">"),g.UTILITIES.give_tooltip(b.get(0),"Click to show the advanced settings."))},get_widgets:function(){var g=[];$(this.get_element()).children().each(function(a,
b){var d=b.toontalk_widget;d&&0>g.indexOf(d)&&g.push(d)});return g},scale_backside:function(g,a,b,d,k){var f=Math.min(1,a,b);1===a&&1===b?g.css({width:"",height:""}):g.css({transform:"scale("+f+", "+f+")","transform-origin":"left top",width:d*a/f,height:k*b/f})},render:function(){g.DISPLAY_UPDATES.pending_update(this)},rerender:function(){this.visible()&&g.DISPLAY_UPDATES.pending_update(this)},remove_backside_widget:function(g,a,b){return this.get_widget().remove_backside_widget(g,a,b)},remove:function(){this.get_widget().remove()},
is_backside:function(){return!0},get_parent:function(){return this.get_parent_of_backside()},is_of_type:function(g){return this.get_widget().is_of_type(g)},save_dimensions:function(){return!1}}}(window.TOONTALK);window.TOONTALK.frontside=function(g){return{create:function(m){var a=Object.create(this),b=document.createElement("div"),d=$(b),k=function(a){if(!$(a.target).is(".ui-resizable-handle")&&("click"!==a.type||1===a.which)){if(d.is(".toontalk-top-level-resource"))m.set_running(!m.get_running());else if(!m.get_running()||m.robot_in_training())m.open_backside(),m.robot_in_training()&&m.robot_in_training().backside_opened(m);a.stopPropagation()}},f;$(b).addClass("toontalk-frontside toontalk-side");b.toontalk_widget=
m;g.UTILITIES.drag_and_drop(b);a.get_element=function(){return b};a.get_widget=function(){return m};a.visible=function(){return f};a.set_visible=function(a){var b;f!==a&&(f=a,b=this.get_widget(),b.walk_children&&b.walk_children(function(b){b.set_visible(a);return!0}))};b.addEventListener("click",k);b.addEventListener("touchstart",k);b.addEventListener("mouseenter",function(a){var b=m.get_backside(),d=(m.is_empty_hole()?wiget.get_parent_of_frontside():m).get_frontside_element();b&&g.UTILITIES.highlight_element(b.get_element());
$(".toontalk-wiggle").removeClass("toontalk-wiggle");$(d).is(".toontalk-top-level-resource")||$(d).addClass("toontalk-wiggle");a.stopPropagation()});b.addEventListener("mouseleave",function(a){a=m.get_backside();var b=m.is_empty_hole()?wiget.get_parent_of_frontside():m;a&&g.UTILITIES.remove_highlight();$(b.get_frontside_element()).removeClass("toontalk-wiggle")});g.debugging&&(b.id=m.debug_id);return a},update_display:function(){return this.get_widget().update_display()},remove:function(){$(this.get_element()).remove()}}}(window.TOONTALK);(function(g){var m=180/Math.PI,a=Math.log(10),b=bigrat.fromInteger(10),d=bigrat.fromValues(1,2),k=bigrat.fromValues(-1,2),f=bigrat.fromInteger(360),p=bigrat.fromDecimal(2*Math.PI),e=Math.log10?Math.log10:function(b){return Math.log(b)/a},w=function(a){var b=bigrat.fromValues(bigrat.toBigInteger(a),1);a=bigrat.subtract(bigrat.create(),a,b);return{integer_part:b,fractional_part:a}},r=function(a){var b=w(a),c=g.number.ZERO(g.number.function_bird_results_default_format),d=g.number.ZERO(g.number.function_bird_results_default_format);
c.set_value(b.integer_part);d.set_value(b.fractional_part);return g.box.create(2,!0,[c,d],"The integer and fraction parts of "+a.toString().replace(",","/"))},h=function(a,b){var c=bigrat.divide(bigrat.create(),a,b),d=w(c);return bigrat.multiply(c,d.fractional_part,b)},v=function(a){a=w(a);return bigrat.isLessThan(a.fractional_part,k)?bigrat.subtract(a.integer_part,a.integer_part,bigrat.ONE):bigrat.isLessThan(a.fractional_part,bigrat.ZERO)||bigrat.isLessThan(a.fractional_part,d)?a.integer_part:bigrat.add(a.integer_part,
a.integer_part,bigrat.ONE)},c=function(a){a=w(a);return bigrat.isLessThan(a.fractional_part,bigrat.ZERO)?bigrat.subtract(a.integer_part,a.integer_part,bigrat.ONE):a.integer_part},t=function(a){a=w(a);return bigrat.isLessThan(a.fractional_part,bigrat.ZERO)||bigrat.equals(a.fractional_part,bigrat.ZERO)?a.integer_part:bigrat.add(a.integer_part,a.integer_part,bigrat.ONE)};window.TOONTALK.number=function(){var a=Object.create(g.widget),c=function(a,b,c,d){var e="",f=100;c=50/c;b/=1+b;if(d)for(d=0;f>=c&&
d<a.length;)e=e+"<span class='toontalk-digit' style='font-size:"+f+"%'>"+a[d]+"</span>",d+=1,"-"!==a[d]&&(f*=b);else for(d=a.length-1;f>=c&&0<d;)e="<span class='toontalk-digit' style='font-size:"+f+"%'>"+a[d]+"</span>"+e,--d,"-"!==a[d]&&(f*=b);return e},d=function(a,b){var c=a/(1+a);return Math.ceil(Math.log(.5/b)/Math.log(c))},f=function(a,b,d){if(a.length<=Math.round(b))return'<span class="toontalk-digit" style="font-size:100%">'+a+"</span>";if(1>b)return"";if(5>b)return"<span style='font-size: 80%'>"+
f(a,1.25*b,.8*d)+"</span>";b=b/2-1;return c(a,b,d,!0)+c(a,b,d,!1)},h=function(a,c){bigrat.isNegative(a)&&bigrat.abs(a,a);var d;a:{d=bigrat.fromValues(a[0],1);var e=bigrat.fromValues(a[1],1),f="",h=bigrat.create(),g=bigrat.create(),p=bigrat.create();for(bigrat.multiply(d,d,b);c>f.length;){if(bigrat.isLessThan(d,e))f+="0";else if(bigrat.divide(h,d,e),g=bigrat.toBigInteger(h),f+=g.toString(),bigrat.subtract(p,h,bigrat.fromValues(g,1)),bigrat.multiply(d,p,e),bigrat.equals(d,bigrat.ZERO)){d=f=k(f);break a}bigrat.multiply(d,
d,b)}d=f}return d},k=function(a){return 0<a.length&&"0"===a.charAt(a.length-1)?k(a.substring(0,a.length-1)):a},p=function(a,b){var c=Math.min(b,a/2);return a-(c+1)},m=function(a,b){b||(b=1);if(!("number"!==typeof a&&"string"!==typeof a||"number"!==typeof b&&"string"!==typeof b))return bigrat.fromValues(a,b);var c=bigrat.create();1===b?bigrat.set(c,bigrat.toBigInteger(a.get_value()),BigInteger.ONE):a.get_value&&b.get_value?bigrat.set(c,bigrat.toBigInteger(a.get_value()),bigrat.toBigInteger(b.get_value())):
bigrat.set(c,a,b);return c},t=function(a){switch(a){case "+":return"";case "-":return"&minus;";case "*":return"&times;";case "/":return"&divide;";case "=":return"&equals;";case "^":return"^";default:return g.UTILITIES.report_internal_error("Number has an unsupported operator: "+a),""}};a.default_format="mixed_number";a.function_bird_results_default_format="decimal";a.create=function(b,c,d,e,f,h){var k=Object.create(a),p=m(b,c);d||(d="+");k.is_number=function(){return!0};k.set_value=function(a,b){if(b||
!bigrat.equals(p,a))return this.fire_value_change_listeners(p,a),p=a,this.rerender(),g.debugging&&(this._debug_string=this.to_debug_string(),"0,0"===a.toString()&&g.UTILITIES.report_internal_error("Impossible numeric value -- can be caused by decimal string not being parsable as a number.")),this};k.set_value_from_sub_classes=k.set_value;k.fire_value_change_listeners=function(a,b){var c=this.get_listeners("value_changed"),d;c&&(d={type:"value_changed",old_value:a,new_value:b},c.forEach(function(a){a(d)}))};
k.get_value=function(){return p};k.set_value_from_decimal=function(a){this.set_value(bigrat.fromDecimal(a))};k.copy=function(b){return this.add_to_copy(a.create(p[0],p[1],d,e,f,h),b)};k.get_format=function(){return e||a.default_format};k.set_format=function(a,b){e=a;b&&this.rerender();return this};k.get_operator=function(){return d};k.set_operator=function(a,b){d=a;b&&this.rerender();return this};k.get_approximate=function(){return h};k.set_approximate=function(a,b){h=a;b&&this.rerender();return this};
k=a.add_standard_widget_functionality(k);k.set_description(f);g.debugging&&(k._debug_string=k.toString(),k._debug_id=g.UTILITIES.generate_unique_id(),p._debug_id_new=k._debug_id);return k};a.create_from_bigrat=function(a){var b=g.number.ZERO();b.set_value(a);return b};a.create_backside=function(){return g.number_backside.create(this)};a.set_from_values=function(a,b){return this.set_value(m(a,b))};a.set_numerator=function(a){return this.set_value(m(a,this.get_value()[1].toString()))};a.set_denominator=
function(a){return this.set_value(m(this.get_value()[0].toString(),a))};a.ONE=function(){return g.number.create(1)};a.ZERO=function(a){return g.number.create(0,void 0,void 0,a)};a.equals=function(a){return a.equals_number&&a.equals_number(this)};a.equals_number=function(a){return bigrat.equals(this.get_value(),a.get_value())};a.compare_with=function(a){if(a.compare_with_number)return-1*a.compare_with_number(this)};a.compare_with_number=function(a){return bigrat.equals(this.get_value(),a.get_value())?
0:bigrat.isGreaterThan(this.get_value(),a.get_value())?1:-1};a.update_display=function(){var a=this.get_frontside(!0),b,c,d,e;g.logging&&0<=g.logging.indexOf("display")&&console.log("Updating display of "+this.to_debug_string());a=a.get_element();$(a).is(".toontalk-conditions-contents")?b=$(a):$(a).parent().is(".toontalk-backside, .toontalk-json")?(b=$(a),e=!0):b=$(a).parent().is(".toontalk-scale-half")?$(a):$(a).parent();0===b.length&&(c=this.get_parent_of_frontside())&&(c.get_widget().is_hole()&&
(c=c.get_parent_of_frontside()),b=$(c.get_frontside_element()));if($(a).is(".toontalk-carried-by-bird"))c=100,d=40;else if($(a).is(".toontalk-element-attribute"))c=200,d=32;else{if(!b.is(":visible")){g.logging&&0<=g.logging.indexOf("display")&&console.log("Container not visible so no display of "+this.to_debug_string());return}c=b.width();d=b.height();if(0===c||0===d){g.logging&&0<=g.logging.indexOf("display")&&console.log("Container has zero dimensions so no display of "+this.to_debug_string());
return}b.is(".toontalk-nest")&&(c*=g.nest.CONTENTS_WIDTH_FACTOR,d*=g.nest.CONTENTS_HEIGHT_FACTOR)}$(a).removeClass("toontalk-number-eighth-size-border toontalk-number-quarter-size-border toontalk-number-half-size-border toontalk-number-full-size-border");64>=c||64>=d?($(a).addClass("toontalk-number-eighth-size-border toontalk-number"),a.toontalk_border_size=4):128>=c||128>=d?($(a).addClass("toontalk-number-quarter-size-border toontalk-number"),a.toontalk_border_size=8):256>=c||256>=d?($(a).addClass("toontalk-number-half-size-border toontalk-number"),
a.toontalk_border_size=16):($(a).addClass("toontalk-number-full-size-border toontalk-number"),a.toontalk_border_size=32);d-=2*a.toontalk_border_size;e=this.to_HTML(c/(.64*d),d,this.get_format(),!0,this.get_operator(),e);g.UTILITIES.on_a_nest_in_a_box(a)&&(c="width:"+c+"px;",d=e.indexOf('style="'),e=0<=d?e.substring(0,d+7)+c+e.substring(d+7):e);c=$(a).children(".toontalk-widget");c.is("*")?c=c.get(0):(c=document.createElement("div"),a.appendChild(c));c.innerHTML=e;c.translate=!1;$(c).addClass("toontalk-widget notranslate");
b.is(".toontalk-box-hole")&&$(a).css({width:"",height:""});g.UTILITIES.give_tooltip(a,this.get_title())};a.to_HTML=function(a,k,g,l,q,B){var m,v,r,x,w,J,H=!1!==l?" toontalk-top-level-number":"";this.is_attribute_widget&&this.is_attribute_widget()?H+=" toontalk-attribute-number":this.get_approximate()&&(H+=" toontalk-approximate-number");B&&(H+=" toontalk-number-size-unconstrained-by-container");v=q?t(q):"";a||(a=4);k||(k=16);if(this.get_erased&&this.get_erased())return'<div class="toontalk-number toontalk-integer'+
H+'" style="font-size: '+k+'px;"></div>';0<v.length&&(--a,2>a&&(k*=Math.max(1,a)/2,a=2));if(this.is_integer()&&"scientific_notation"!==g){try{m=bigrat.toBigInteger(this.get_value()).toString()}catch(la){console.log("Error converting number to a string: "+la),m="0"}l=m.length;0<v.length&&l++;4>a&&l>a&&(l=Math.min(4,l),k*=a/l,a=l);return'<div class="toontalk-number toontalk-integer'+H+'" style="font-size: '+k+'px;">'+v+f(m,a,k)+"</div>"}m=' style="font-size:'+.4*k+'px;"';if("improper_fraction"===g||
!g)return k='<table class="toontalk-number toontalk-improper-fraction'+H+'"'+m+'><tr class="toontalk-numerator"><td align="center" class="toontalk-number">'+f(this.numerator_string(),2*a,k)+'</td></tr><tr class="toontalk-fraction-line-as-row"><td  class="toontalk-fraction-line-as-table-entry"><div class="toontalk-fraction-line"></div></tr><tr class="toontalk-denominator"><td align="center" class="toontalk-number">'+f(this.denominator_string(),2*a,k)+"</td></tr></table>",""===v?k:"<table class='toontalk-operator-and-fraction'"+
m+"><tr><td>"+v+"</td><td>"+k+"</td></tr></table>";if("mixed_number"===g||"proper_fraction"===g){v=this.integer_part();if(v.is_zero())return this.to_HTML(a,k,"improper_fraction",l,q);l=this.copy({just_value:!0}).subtract(v).absolute_value();return'<table class="toontalk-number toontalk-mixed-number'+H+'"'+m+'><tr><td class="toontalk-number toontalk-integer-part-of-mixed-number">'+v.to_HTML(a/2,k,"",!1,this.get_operator())+'</td><td class="toontalk-number toontalk-fraction-part-of-mixed-number">'+
l.to_HTML(a/2,k,"improper_fraction",!1)+"</td></tr></table>"}if("decimal"===g)return 4>a&&(k*=Math.max(1,a)/4,a=4),'<div class="toontalk-number toontalk-decimal'+H+'" style="font-size: '+k+'px;">'+v+this.decimal_string(a,k)+"</div>";if("scientific_notation"===g){J=bigrat.isNegative(this.get_value());r=this.get_value();x=bigrat.abs(bigrat.create(),r);r=bigrat.isLessThan(x,bigrat.ONE);x=(r?bigrat.toBigInteger(bigrat.divide(bigrat.create(),bigrat.ONE,x)):bigrat.toBigInteger(x)).toString();r=r?-x.length:
x.length-1;x=bigrat.power(bigrat.create(),b,r+1);w=bigrat.divide(bigrat.create(),this.get_value(),x);x=6+(0===r?1:Math.ceil(e(Math.abs(r)))/2);J&&x++;if(a<x+1)return this.to_HTML(x+1,k*a/(x+1),g,l,q,B);l=d(p(a,x),k);l=h(w,l);q=J?"-"+l.substring(0,1):l.substring(0,1);l=l.substring(1);a=c(l,a*(1-x/a),k,!0);0<a.length&&(a="<span class='toontalk-decimal-point'>.</span>"+a);return'<table class="toontalk-number toontalk-scientific_notation'+H+'"'+m+'><tr><td class="toontalk-number toontalk-significand-of-scientific-notation"><div class="toontalk-number toontalk-decimal'+
H+'" style="font-size: '+k+'px;">'+v+q+a+'</td><td class="toontalk-number toontalk-exponent-of-scientific-notation"><div style="font-size: '+k+'px;"> &times;10<sup style="font-size: '+k/2+'px;">'+r+"</sup></div></td></tr></table>"}};a.drop_on=function(a,b,c,d){if(a.number_dropped_on_me)return a.number_dropped_on_me(this,b,c,d),!0;if(a.widget_dropped_on_me)return a.widget_dropped_on_me(this,b,c,d);console.log("No handler for drop of '"+this+"' on '"+a+"'")};a.number_dropped_on_me=function(a,b,c,d){var e,
f,h,k;if(a.visible()&&(c||d)){if(d){if(!d.animate_consequences_of_actions())return a.remove(),this.number_dropped_on_me_semantics(a,c,d);a.robot_waiting_before_next_step=d}e=document.createElement("div");$(e).addClass("toontalk-bammer-down");f=$(this.get_frontside_element()).closest(".toontalk-top-level-backside");e.style.left="-10px";e.style.top=f.height()+"px";f.append(e);b=this.get_frontside_element();h=$(b).offset();h.left-=.75*$(e).width();h.left+=.5*$(b).width()+.1*$(e).width();h.top-=.5*$(b).height()+
.4*$(e).height();b=function(){g.sounds&&g.sounds.bammer_hammer.play();this.number_dropped_on_me_semantics(a,c,d)&&d&&d.run_next_step();c&&this.backup_all();$(e).removeClass("toontalk-bammer-down");g.UTILITIES.set_timeout(function(){var a=f.offset();a||(a={left:0,top:0});$(e).addClass("toontalk-bammer-away");h.left=a.left+f.width()-100;h.top=a.top+f.height()+100;k=function(){$(e).remove()};g.UTILITIES.animate_to_absolute_position(e,h,k,d&&d.transform_animation_speed(g.UTILITIES.default_animation_speed));
$(e).css({opacity:.01})})}.bind(this);g.UTILITIES.animate_to_absolute_position(e,h,b,d&&d.transform_animation_speed(g.UTILITIES.default_animation_speed));$(e).css({opacity:1,"z-index":g.UTILITIES.next_z_index()+100});return this}return this.number_dropped_on_me_semantics(a,c,d)};a.number_dropped_on_me_semantics=function(a,b,c){b&&this.robot_in_training()&&this.robot_in_training().dropped_on(a,this);a.get_approximate()&&this.set_approximate(!0);a.remove();switch(a.get_operator()){case "+":return this.add(a);
case "-":return this.subtract(a);case "*":return this.multiply(a);case "/":return this.divide(a);case "=":return this.set_value(a.get_value());case "^":return this.power(a);default:g.UTILITIES.report_internal_error("Number received a number with unsupported operator: "+a.get_operator())}};a.widget_dropped_on_me=function(a,b,c,d){return a.number_dropped_on_me?this.number_dropped_on_me(a,b,c,d):!1};a.add=function(a){this.set_value(bigrat.add(this.get_value(),this.get_value(),a.get_value()),!0);return this};
a.subtract=function(a){this.set_value(bigrat.subtract(this.get_value(),this.get_value(),a.get_value()),!0);return this};a.multiply=function(a){this.set_value(bigrat.multiply(this.get_value(),this.get_value(),a.get_value()),!0);return this};a.divide=function(a){this.set_value(bigrat.divide(this.get_value(),this.get_value(),a.get_value()),!0);return this};a.minimum=function(a){this.set_value(bigrat.min(this.get_value(),this.get_value(),a.get_value()),!0);return this};a.maximum=function(a){this.set_value(bigrat.max(this.get_value(),
this.get_value(),a.get_value()),!0);return this};a.power=function(a){this.set_value(bigrat.power(this.get_value(),this.get_value(),bigrat.toInteger(a.get_value())),!0);return this};a.absolute_value=function(){this.set_value(bigrat.abs(this.get_value(),this.get_value()),!0);return this};a.is_zero=function(){return bigrat.equals(this.get_value(),bigrat.ZERO)};a.is_negative=function(){return bigrat.isNegative(this.get_value())};a.toString=function(){return this.get_erased()?"erased number":("+"===this.get_operator()?
"":this.get_operator())+bigrat.str(this.get_value())};a.operator_word=function(a){switch(this.get_operator()){case "+":return"add "+a+" to";case "-":return"subtract "+a+" from";case "*":return"multiply "+a+" with";case "/":return"divide "+a+" into"}};a.get_text=function(){return this.is_integer()||"improper_fraction"===this.get_format()?this.toString():bigrat.toDecimal(this.get_value()).toString()};a.to_float=function(){return bigrat.toDecimal(this.get_value())};a.get_type_name=function(a){return a?
"numbers":"number"};a.get_help_URL=function(){return"docs/manual/numbers.html"};a.get_json=function(){return{type:"number",operator:this.get_operator(),numerator:this.numerator_string(),denominator:this.denominator_string(),format:this.get_format(),approximate:this.get_approximate()}};g.creators_from_json.number=function(b){return a.create(b.numerator,b.denominator,b.operator,b.format,b.description,b.approximate)};a.is_integer=function(){return 0===this.get_value()[1].compare(BigInteger.ONE)||0===
this.get_value()[0].compare(BigInteger.ZERO)};a.numerator=function(){var a=bigrat.create();return bigrat.set(a,this.get_value()[0],BigInteger.ONE)};a.denominator=function(){var a=bigrat.create();return bigrat.set(a,this.get_value()[1],BigInteger.ONE)};a.numerator_string=function(){return this.get_value()[0].toString()};a.denominator_string=function(){return this.get_value()[1].toString()};a.integer_part=function(){return this.create(this)};a.decimal_string=function(b,e){if(this.is_integer())return this.numerator_string();
var k=this.get_value(),l=a.create(k[0],k[1]),g=l.integer_part(),k=g.toString();"0"===k&&this.is_negative()&&(k="-"+k);l=l.get_value();bigrat.subtract(l,l,g.get_value());var B=p(b,k.length),m=d(B,e),g=Math.min(k.length,b/2),l=h(l,m),l=l.length<b?l:c(l,B,e,!0);return f(k,g,e)+"<span class='toontalk-decimal-point'>.</span>"+l};a.match=function(a){return this.get_erased&&this.get_erased()?a.match_with_any_number?a.match_with_any_number():this:a.match_with_this_number?a.match_with_this_number(this):this};
a.match_with_any_number=function(){return"matched"};a.match_with_this_number=function(a){return a.equals(this)?"matched":a};a.get_custom_title_prefix=function(){var a;a="="===this.get_operator()?"Drop me on another number I'll give him my value.":"Drop me on another number and I'll "+this.operator_word("myself")+" him.";this.get_approximate()&&(a+="\nI look a bit yellow because I'm the result of an "+g.UTILITIES.encode_HTML_for_title("<i>approximate</i>")+" calculation.");return a};return a}();window.TOONTALK.number_backside=
function(){return{create:function(a){var b=g.backside.create(a),c=b.get_element(),d=document.createElement("div"),e=a.numerator_string(),f=a.denominator_string(),h=g.UTILITIES.create_text_area(e,"toontalk-numerator-input","","Type here to edit the numerator",void 0,"number"),k=g.UTILITIES.create_text_area(f,"toontalk-denominator-input","","Type here to edit the denominator",void 0,"number"),p=g.UTILITIES.create_radio_button("number_format","decimal","toontalk-decimal-radio-button","Decimal number",
"Display number as a decimal."),m=g.UTILITIES.create_radio_button("number_format","proper_fraction","toontalk-proper-fraction-radio-button","Mixed number","Display number as an integer part and a proper fraction."),t=g.UTILITIES.create_radio_button("number_format","improper_fraction","toontalk-improper-fraction-radio-button","Improper fraction","Display number as a simple fraction."),v=g.UTILITIES.create_radio_button("number_format","scientific_notation","toontalk-scientific-notation-radio-button",
"Scientific notation","Display number as a decimal between 1 and 10 multiplied by ten to some power."),l=g.UTILITIES.create_radio_button("operator","+","toontalk-plus-radio-button","+","Add me to what I'm dropped on."),q=g.UTILITIES.create_radio_button("operator","-","toontalk-minus-radio-button","&minus;","Subtract me from what I'm dropped on."),B=g.UTILITIES.create_radio_button("operator","*","toontalk-times-radio-button","&times;","Multiply me with what I'm dropped on."),z=g.UTILITIES.create_radio_button("operator",
"/","toontalk-divide-radio-button","&divide;","Divide me into what I'm dropped on."),r=g.UTILITIES.create_radio_button("operator","=","toontalk-set-equal-radio-button","&equals;","Set what I'm dropped on to my value."),w=function(b){var c=h.button.value.trim(),d=k.button.value.trim(),l=function(a,b,c){if(1>a.length)return{message:"Empty "+b+" treated as 1.",replacement:"1"};if("-"===a.charAt(0)){if(c)return{message:"'-' only allowed as the first character of the "+b+". Ignoring extra '-'s.",replacement:l(a,
b).replacement};a=l(a.substring(1,a.length),b,!0);a.message||(a.replacement="-"+a.replacement);return a}return/^\d+$/.test(a)?{replacement:a}:{message:"The "+b+" can only contain digits. '"+a+"' doesn't make sense.",replacement:a.replace(/[^\d]*/g,"")}},q;if(c!==e||d!==f)q=l(c,"numerator"),q.message&&(g.UTILITIES.display_message(q.message),c=q.replacement),"0"===d?(g.UTILITIES.display_message("It doesn't make sense for a fraction to have a denominator of 0. Resetting it to 1."),d="1"):(q=l(d,"denominator"),
q.message&&(g.UTILITIES.display_message(q.message),d=q.replacement)),a.set_from_values(c,d)&&(e=c,f=d,a.robot_in_training()&&(b=b.srcElement.className.split(" ",1)[0],"toontalk-denominator-input"===b?a.robot_in_training().edited(a,{setter_name:"set_denominator",argument_1:d,toString:"by changing the value of the denominator to "+d,button_selector:"."+b}):a.robot_in_training().edited(a,{setter_name:"set_numerator",argument_1:c,toString:"by changing the value of the numerator to "+c,button_selector:"."+
b})),a.rerender())},Q=function(){var b=g.UTILITIES.selected_radio_button(p.button,m.button,t.button,v.button),c=b.value;a.set_format(c,!0);a.robot_in_training()&&a.robot_in_training().edited(a,{setter_name:"set_format",argument_1:c,toString:"by changing the format to "+c+" of the number",button_selector:"."+b.className.split(" ",1)[0]});a.rerender()},ma=function(){var b=g.UTILITIES.selected_radio_button(l.button,q.button,B.button,z.button,r.button),c=b.value;a.set_operator(c,!0);a.robot_in_training()&&
a.robot_in_training().edited(a,{setter_name:"set_operator",argument_1:c,toString:"by changing the operator to "+c+" of the number",button_selector:"."+b.className.split(" ",1)[0]})},Y=g.UTILITIES.create_horizontal_table(h.container,d,k.container),V=$(g.UTILITIES.create_horizontal_table(p.container,m.container,t.container,v.container)).buttonset().get(0),la=$(g.UTILITIES.create_horizontal_table(l.container,q.container,B.container,z.container,r.container)).buttonset().get(0),ja=g.backside.create_advanced_settings_button(b,
a),da=b.update_display.bind(b);d.innerHTML="/";$(d).addClass("ui-widget");c.appendChild(Y);c.appendChild(ja);h.button.addEventListener("change",w);h.button.addEventListener("mouseout",w);h.button.addEventListener("mouseenter",function(){e=h.button.value.trim()});k.button.addEventListener("change",w);k.button.addEventListener("mouseout",w);k.button.addEventListener("mouseenter",function(){f=k.button.value.trim()});p.button.addEventListener("change",Q);m.button.addEventListener("change",Q);t.button.addEventListener("change",
Q);v.button.addEventListener("change",Q);switch(a.get_format()){case "decimal":g.UTILITIES.check_radio_button(p);break;case "improper_fraction":g.UTILITIES.check_radio_button(t);break;case "mixed_number":case "proper_fraction":g.UTILITIES.check_radio_button(m);break;case "scientific_format":g.UTILITIES.check_radio_button(v)}switch(a.get_operator()){case "+":g.UTILITIES.check_radio_button(l);break;case "-":g.UTILITIES.check_radio_button(q);break;case "*":g.UTILITIES.check_radio_button(B);break;case "/":g.UTILITIES.check_radio_button(z);
break;case "=":g.UTILITIES.check_radio_button(r)}l.button.addEventListener("change",ma);q.button.addEventListener("change",ma);B.button.addEventListener("change",ma);z.button.addEventListener("change",ma);r.button.addEventListener("change",ma);b.update_display=function(){$(h.button).val(a.numerator_string());$(k.button).val(a.denominator_string());da()};$(V).addClass("toontalk-advanced-setting");$(la).addClass("toontalk-advanced-setting");c.appendChild(V);c.appendChild(la);b.add_advanced_settings();
return b}}}();window.TOONTALK.number.function=function(){var a=function(a){var b;if(a.is_box())if(b=a.get_size(),1>b)g.UTILITIES.display_message("Function birds can only respond to boxes with holes.");else if(a=a.get_hole_contents(0)){if(a.is_bird())return{box_size:b,bird:a};g.UTILITIES.display_message("Function birds can only respond to boxes with a bird in the first hole. The first hole contains "+g.UTILITIES.add_a_or_an(a.get_type_name()+"."))}else g.UTILITIES.display_message("Function birds can only respond to boxes with something in the first hole.");
else g.UTILITIES.display_message("Function birds can only respond to boxes. One was given "+g.UTILITIES.add_a_or_an(a.get_type_name()))},b=function(b,c,d,e){if(d=a(b))return(c=c(d.bird,d.box_size))&&d.bird.widget_dropped_on_me(c,!1,void 0,e,!0),b.remove(),c},d=function(a,b,c){if(!a)return g.UTILITIES.display_message("Birds for the "+b+" function can only respond to boxes with a number in the "+g.UTILITIES.ordinal(c)+" hole. The "+g.UTILITIES.ordinal(c)+" hole is empty."),!1;if(a.dereference().is_number())return!0;
if(a.is_nest())throw{wait_for_nest_to_receive_something:a};g.UTILITIES.display_message("Birds for the "+b+" function can only respond to boxes with a number in the "+g.UTILITIES.ordinal(c)+" hole. The "+g.UTILITIES.ordinal(c)+" hole contains "+g.UTILITIES.add_a_or_an(a.get_type_name()+"."));return!1},e=function(a,c,e,l,f,h){return b(a,function(b,f){var h,k,g,q;if(1===f)return c();k=1;g=a.get_hole_contents(k).dereference();if(q=d(g,l,k)){for(k++;k<f;){h=a.get_hole_contents(k).dereference();q=d(h,l,
k);if(!q)return;e.call(g,h);k++}return g}},f,h)},k=function(a,c,e,l,f,h){return b(a,function(b,f){var h,k,q,p;if(f<e+1)g.UTILITIES.display_message("Birds for the "+l+" function can only respond to boxes with at least "+(e+1)+" holes. Not "+f+" holes.");else{q=[];for(k=1;k<f;){h=a.get_hole_contents(k).dereference();p=d(h,l,k);if(!p)return;q.push(h.get_value());k++}return c.apply(null,q)}},f,h)},w=function(a,b){for(var c=a.length,d=0,e=[];d<c;)e.push(b(a[d])),d++;return e},L=function(a,b,c){return function(){var d=
g.number.ZERO(g.number.function_bird_results_default_format);d.set_value_from_decimal(a.apply(null,w(arguments,c||bigrat.toDecimal)));b&&d.set_approximate(!0);return d}},J=function(a){return bigrat.toDecimal(h(a,f))},K=function(a){return bigrat.toDecimal(h(a,p))},C=function(a,b){return function(){var c=g.number.create_from_bigrat(a.apply(null,arguments));b&&c.set_approximate(!0);return c}},F=function(){return"If you give me a box with another bird and some numbers then "+g.UTILITIES.lower_case_first_letter(this.title)+
"\nOn my back side you can change me to compute other functions."},P=function(){return g.UTILITIES.add_a_or_an("'"+this.name+"' function bird")},l={},q=function(a,b,c,d){l[a]={name:a,short_name:d||a,respond_to_message:b,get_description:F,toString:P,title:c}};q("sum",function(a,b,c){return e(a,g.number.ZERO,g.number.add,"sum",b,c)},"The bird will return with the sum of the numbers in the box.","+");q("difference",function(a,b,c){return e(a,g.number.ZERO,g.number.subtract,"difference",b,c)},"The bird will return with the result of subtracting the numbers in the box from the first number.",
"-");q("product",function(a,b,c){return e(a,g.number.ONE,g.number.multiply,"product",b,c)},"The bird will return with the product of the numbers in the box.","\u00d7");q("division",function(a,b,c){return e(a,g.number.ONE,g.number.divide,"division",b,c)},"The bird will return with the result of dividing the numbers into the first number in the box.","\u00f7");q("modulo",function(a,b,c){return k(a,C(h),2,"modulo",b,c)},"The bird will return with the first number modulo the second number. For positive numbers this is like the remainder after division.",
"mod");q("minimum",function(a,b,c){return e(a,g.number.ONE,g.number.minimum,"minimum",b,c)},"The bird will return with the smallest of the numbers in the box.","min");q("maximum",function(a,b,c){return e(a,g.number.ONE,g.number.maximum,"maximum",b,c)},"The bird will return with the largest of the numbers in the box.","max");q("absolute value",function(a,b,c){return k(a,function(b){var c=g.number.ZERO(a.get_hole_contents(1).get_format());bigrat.abs(c.get_value(),b);return c},1,"absolute value",b,c)},
"The bird will return with the positive version of the number.","abs");q("power",function(a,b,c){return k(a,C(function(a,b){var c=bigrat.power(bigrat.create(),a,b[0].valueOf()),d=b[1].valueOf();return 1===d?c:bigrat.nthRoot(c,c,d)},!0),2,"power",b,c)},"The bird will return with the first number to the power of the second number.");q("logarithm",function(a,b,c){return k(a,L(function(){return 1===arguments.length?Math.log(arguments[0]):Math.log(arguments[0])/Math.log(arguments[1])},!0),1,"logarithm",
b,c)},"The bird will return an approximation of the logarithm number of the first number.\nIf a second number is provided then it is used as the base of the logarithm.\nIf there is no second number the logarithm is natural (the base is e).","log");q("random",function(a,b,c){return k(a,L(function(){return 0===arguments.length?Math.random():1===arguments.length?Math.random()*arguments[0]:arguments[0]+Math.random()*arguments[1]}),0,"random",b,c)},"The bird will return a random number between the first and second numbers.\nIf the second number isn't provided a number less than the first number is returned.\nIf no numbers are given then the bird returns with a number between 0 and 1.",
"rand");q("round",function(a,b,c){return k(a,C(v),1,"round",b,c)},"The bird will return the number rounded to the nearest integer.");q("floor",function(a,b,d){return k(a,C(c),1,"floor",b,d)},"The bird will return the largest integer less than or equal to the number.");q("ceiling",function(a,b,c){return k(a,C(t),1,"ceiling",b,c)},"The bird will return the smallest integer greater than or equal to the number.","ceil");q("delay",function(b,c,d){var e=Date.now(),l=a(b);if(l)if(2>l.size)g.UTILITIES.display_message("Delay function birds need a number in the second hole.");
else return c=b.get_hole_contents(1).to_float(),setTimeout(function(){var a=g.number.ZERO(g.number.function_bird_results_default_format);a.set_value_from_decimal((Date.now()-e)/1E3);a.set_approximate(!0);a&&l.bird.widget_dropped_on_me(a,!1,void 0,d,!0);b.remove()},1E3*c),!0},"The bird will return after waiting the number of seconds in the second hole. She will return with the exact amount of time since she received the box.");q("integer and fraction parts",function(a,b,c){return k(a,r,1,"integer and fraction parts",
b,c)},"The bird will return with a box containing the integer part and the fraction.","parts");q("sine",function(a,b,c){return k(a,L(function(a){return Math.sin(a/m)},!0,J),1,"sine",b,c)},"The bird will return with an approximation of the sine of the number (in degrees).","sin");q("cosine",function(a,b,c){return k(a,L(function(a){return Math.cos(a/m)},!0,J),1,"cosine",b,c)},"The bird will return with an approximation of the cosine of the number (in degrees).","cos");q("arc tangent",function(a,b,c){return k(a,
L(function(a){return m*Math.atan(a)},!0),1,"arc tangent",b,c)},"The bird will return with an approximation of the arc tangent (in degrees) of the number.","atan");q("arc tangent of y and x",function(a,b,c){return k(a,L(function(a,b){return m*Math.atan2(a,b)},!0),2,"arc tangent of y and x",b,c)},"The bird will return with an approximation of the arc tangent (in degrees) of the point where the first number is the y coordinate and the second one is the x.","atan2");q("sine (in radians)",function(a,b,
c){return k(a,L(Math.sin,!0,K),1,"sine (in radians)",b,c)},"The bird will return with an approximation of the sine of the number (in radians).","sin rad");q("cosine (in radians)",function(a,b,c){return k(a,L(Math.cos,!0,K),1,"cosine (in radians)",b,c)},"The bird will return with an approximation of the cosine of the number (in radians).","cos rad");q("arc tangent (in radians)",function(a,b,c){return k(a,L(Math.atan,!0),1,"arc tangent (in radians)",b,c)},"The bird will return with an approximation of the arc tangent (in radians) of the number.",
"atan rad");q("arc tangent of y and x (in radians)",function(a,b,c){return k(a,L(Math.atan2,!0),2,"arc tangent of y and x (in radians)",b,c)},"The bird will return with an approximation of the arc tangent (in radians) of the point where the first number is the y coordinate and the second one is the x.","atan2 rad");return l}()})(window.TOONTALK);(function(g){var m=function(a,b,d,k){var f;a&&0<=d&&a.maintain_proportional_dimensions()&&a.get_default_width?(f=a.get_default_width(),a=a.get_default_height(),d/f>=k/a?(f=f*k/a,d={left:(d-f)/2,top:0,width:f,height:k}):(f=a*d/f,d={left:0,top:(k-f)/2,width:d,height:f})):d={left:0,top:0};$(b).css(d)};window.TOONTALK.box=function(a){var b=Object.create(a.widget);b.create=function(d,k,f,g,e){var w=Object.create(b),r=[];"undefined"===typeof k&&(k=!0);w.is_box=function(){return!0};w.get_horizontal=function(){return k};
w.set_horizontal=function(a,b){k=a;b&&($(this.get_frontside_element()).children(".toontalk-side").remove(),this.rerender());return this};w.get_hole=function(a){return r[a]};w.get_hole_contents=function(a){return r[a].get_contents()};w.set_hole=function(b,d,c){var e;r[b].set_contents(d);if(c){d&&d.save_dimensions();c=this.get_frontside_element();b=$(c).children(".toontalk-hole-number-"+b);b.empty();if(!d)return;e=this.get_hole_dimensions();c=d.get_frontside_element(!0);b.append(c);m(d,c,e.width,e.height);
d.rerender()}this.rerender();a.debugging&&(this._debug_string=this.to_debug_string())};w.get_holes=function(){return r};w.temporarily_remove_contents=function(a,b){var c=this.get_index_of(a);this.temporarily_removed_contents||(this.temporarily_removed_contents=[]);this.temporarily_removed_contents[c]=a;this.set_hole(c,void 0,b);return function(){this.set_hole(c,a,b);this.temporarily_removed_contents[c]=void 0}.bind(this)};w.get_contents_temporarily_removed=function(a){if(this.temporarily_removed_contents)return this.temporarily_removed_contents[a]};
w.set_contents=function(a){a.forEach(function(a,b){r[b].set_contents(a)})};w.get_size=function(){return d};w.set_size=function(b,e){var c,f;if(d===b||0>b||isNaN(b))return!1;f=this.visible();r.length=b;if(b>d)for(c=d;c<b;c++)r[c]=a.box_hole.create(c),r[c].set_parent_of_frontside(w),r[c].set_visible(f);d=b;e&&this.rerender();a.debugging&&(this._debug_string=this.to_debug_string());return!0};w.get_hole_dimensions=function(){var b=this.get_frontside_element(),e=$(b).width()||a.box.get_default_width(),
b=$(b).height()||a.box.get_default_height();return k?{width:e/d,height:b}:{width:e,height:b/d}};w.receive_size_from_dropped=function(b,d){var c;if(b.is_number())return c=a.number.create(this.get_size()),c.number_dropped_on_me_semantics(b),c=Math.max(0,Math.round(c.to_float())),this.set_size(c),c.toString()};w.copy=function(a){var e;a||(a={});e=r.map(function(b){if(b=b.get_contents())return b.copy(a)});e=b.create(d,k,e,this.get_description(),this.get_name());return this.add_to_copy(e,a)};w.generate_name=
function(){for(var a="",b=this.get_size();0<b;)a+=";",b--;return a};w.add_standard_widget_functionality(w);w.has_name(w);w.set_name(e);for(e=0;e<d;e++)r[e]=a.box_hole.create(e),r[e].set_parent_of_frontside(w);w.set_description(g);w.set_contents(f);a.debugging&&(w._debug_id=a.UTILITIES.generate_unique_id(),w._debug_string=w.to_debug_string());return w};b.create_backside=function(){return a.box_backside.create(this)};b.equals=function(a){return a.equals_box&&this.get_type_name()===a.get_type_name()&&
a.equals_box(this)};b.equals_box=function(a){var b=this.get_size(),f,g,e;if(b!==a.get_size())return!1;for(f=0;f<b;f++)if(g=this.get_hole_contents(f),e=a.get_hole_contents(f),!g&&e||g&&!e||g&&e&&(!g.equals||!g.equals(e)))return!1;return!0};b.compare_with=function(a){if(a.compare_with_box)return-1*a.compare_with_box(this)};b.compare_with_box=function(a){var b=this.get_size(),f=a.get_size(),g,e;if(b>f)return 1;if(b<f)return-1;for(f=0;f<b;f++){g=this.get_hole_contents(f);e=a.get_hole_contents(f);if(g&&
!e)return 1;if(!g&&e)return-1;if(g&&e)if(g.compare_with){if(g=g.compare_with(e),1===g||-1===g)return g}else return}return 0};b.match=function(a){return this.get_erased&&this.get_erased()?a.match_with_any_box?a.match_with_any_box():this:a.match_with_this_box?a.match_with_this_box(this):this};b.match_with_any_box=function(){return"matched"};b.match_with_this_box=function(b){var k=this.get_size(),f=[],g,e,m;if(k!==b.get_size())return b;for(g=0;g<k;g++)if(m=b.get_hole_contents(g))if(e=this.get_hole_contents(g)){e=
a.UTILITIES.match(m,e);if(e.is_widget)return e;"matched"!==e&&(f=0===f.length?e:f.concat(e))}else if(e=this.get_contents_temporarily_removed(g))f.push(e);else return b;return 0<f.length?f:"matched"};b.toString=function(a){var b="",f=this.get_size(),g,e,m=this.get_type_name()+" that looks like ";for(g=0;g<f;g++)e=this.get_hole(g),b+=e.get_full_description(a),g<f-1&&(b+=" | ");return m+"["+b.replace(m,"")+"]"};b.get_type_name=function(a){return a?"boxes":"box"};b.get_help_URL=function(){return"docs/manual/boxes.html"};
b.get_json=function(b){var k=[],f=this.get_size(),g;for(g=0;g<f;g++)this.get_hole_contents(g)?k[g]=a.UTILITIES.get_json(this.get_hole_contents(g),b):k[g]=null;return{type:"box",size:f,contents:k,horizontal:this.get_horizontal(),name:this.get_name()}};b.walk_children=function(a){var b=this.get_size(),f;for(f=0;f<b&&a(this.get_hole(f));f++);};a.creators_from_json.box=function(d,k){return b.create(d.size,d.horizontal,a.UTILITIES.create_array_from_json(d.contents,k),d.description,d.name)};b.update_display=
function(){var b=this.get_frontside(!0).get_element(),k=this.get_size(),f=function(b,c,d){var e=c.get_contents(),f=(e||c).get_frontside_element(!0),h=$(b).parents(".toontalk-box-hole"),r=function(){$(b).parents(".toontalk-box-hole").children(".toontalk-nest").is("*")&&(P/=a.nest.CONTENTS_WIDTH_FACTOR,l/=a.nest.CONTENTS_HEIGHT_FACTOR)},C,F,P,l;g?(F=0,0<h.length?(P=v-2*A/k,l=t-2*A):(P=v,l=t),r(),C=P*d,1<d&&(C+=A*(d-1))):(C=0,0<h.length?(P=v-2*A,l=t-2*A/k):(P=v,l=t),r(),F=l*d,1<d&&(F+=A*(d-1)));$(b).css({left:C,
top:F,width:P,height:l});w[d]&&b.setAttribute("toontalk_name",w[d]);a.UTILITIES.has_animating_image(f)||(0<d&&($(b).removeClass("toontalk-box-eighth-size-border-left toontalk-box-quarter-size-border-left toontalk-box-half-size-border-left toontalk-box-full-size-border-left"),$(b).removeClass("toontalk-box-eighth-size-border-top toontalk-box-quarter-size-border-top toontalk-box-half-size-border-top toontalk-box-full-size-border-top"),g?$(b).addClass(x+"-left"):$(b).addClass(x+"-top")),b.toontalk_border_size=
A);b!==f&&(m(e,f,P,l),b.appendChild(f),c.get_contents().update_display());c.is_element()&&(c=c.get_contents(),c.set_size_attributes(P,l,!0))},g=this.get_horizontal();$(b).is(".toontalk-box");var e=function(){var a=$(b).children(".toontalk-box-hole");a.length===k?a.each(function(a,b){var c=this.get_hole(a);c&&f(b,c,a)}.bind(this)):(a.remove(),this.get_holes().forEach(function(a,c){r=a.get_element();$(r).addClass("toontalk-hole-number-"+c);f(r,a,c);b.appendChild(r)}));$(b).parent(".toontalk-conditions-contents-container").is("*")||
($(b).parent(".toontalk-box-hole").is("*")?$(b).css({width:"",height:""}):$(b).css({width:h,height:c}))}.bind(this),w=this.get_name().split(";"),r,h,v,c,t,x,A;a.logging&&0<=a.logging.indexOf("display")&&console.log("Updating display of "+this.to_debug_string());$(b).addClass("toontalk-box");$(b).removeClass("toontalk-box-eighth-size-border toontalk-box-quarter-size-border toontalk-box-half-size-border toontalk-box-full-size-border");a.UTILITIES.give_tooltip(b,this.get_title());a.debugging&&(this._debug_string=
this.to_debug_string());this.get_erased()?($(b).addClass("toontalk-box-erased"),$(b).children(".toontalk-side").remove()):($(b).removeClass("toontalk-box-erased"),h=$(b).width()||a.box.get_default_width(),c=$(b).height()||a.box.get_default_height(),g?(v=h/k,t=c):(v=h,t=c/k),32>=v||32>=t?(x="toontalk-box-eighth-size-border",A=4):64>=v||64>=t?(x="toontalk-box-quarter-size-border",A=8):128>=v||128>=t?(x="toontalk-box-half-size-border",A=16):(x="toontalk-box-full-size-border",A=32),g?v-=(k-1)*A/k:t-=
(k-1)*A/k,$(b).addClass(x),b.toontalk_border_size=A,a.UTILITIES.set_timeout(e))};b.get_default_width=function(){return 164};b.get_default_height=function(){return 68};b.get_name_input_label=function(){return"The labels of my holes are"};b.get_name_input_title=function(){return"Each hole label is followed by a ';'. Yoou may enter as many hole labels as there are holes."};b.drop_on=function(a,b,f,g){if(a.box_dropped_on_me)return b=a.box_dropped_on_me(this,f,g),f&&a.rerender(),b&&this.remove(),b;if(a.widget_dropped_on_me)return a.widget_dropped_on_me(this,
b,f,g);console.log("No handler for drop of "+this+" on "+a)};b.box_dropped_on_me=function(a,b){console.log("box on box not yet implemented");return!1};b.widget_dropped_on_me=function(b,k,f,g){var e=this.which_hole(f),m;if(0<=e)return m=this.get_hole(e),(e=m.get_contents())?b.drop_on(e,k,f,g):m.widget_dropped_on_me(b,k,f,g);a.UTILITIES.report_internal_error(b+" dropped on "+this+" but no event was provided.")};b.get_index_of=function(a){return a.get_parent_of_frontside()&&a.get_parent_of_frontside().get_index&&
a.get_parent_of_frontside().get_index()};b.removed_from_container=function(b,k,f,g,e){k=!!f;"undefined"===typeof g&&(g=this.get_index_of(b));0<=g?(this.set_hole(g,void 0,k),k&&(this.rerender(),b.restore_dimensions())):e&&a.UTILITIES.report_internal_error("Attempted to remove "+b+" from "+this+" but not found.")};b.get_path_to=function(b,k){var f=this.get_size(),g,e;if("empty hole"===b.get_type_name()){f=b.get_parent_of_frontside();e=a.box.path.create(b.get_index());if(f===this)return e;f=this.get_path_to(f);
if(!f)return;f.next=e;return f}for(g=0;g<f;g++)if(e=this.get_hole_contents(g)||this.get_contents_temporarily_removed(g)){if(b===e||e.top_contents_is&&e.top_contents_is(b))return a.box.path.create(g);if(e.get_path_to&&(e=e.get_path_to(b,k)))return f=a.box.path.create(g),f.next=e,f}};b.element_to_highlight=function(a){a=this.which_hole(a,!0);var b;if(0>a)return this.get_frontside_element();a=this.get_hole(a);return(b=a.get_contents())?b.get_frontside_element():a.get_frontside_element()};b.which_hole=
function(a){var b=this.get_horizontal(),f=this.get_frontside_element(),g=this.get_size(),e;if(0!==g&&(e=$(f).offset(),f=b?$(f).width()/g:$(f).height()/g,e=b?e.left:e.top,a))for(a=0;a<g;a++)if(e+=f,(b?event.pageX<=e:event.pageY<=e)||a+1===g)return a};b.dereference_path=function(b,k,f){var g,e;if(b){g=b.get_index&&b.get_index();if(!a.debugging||"number"===typeof g){if(e=this.get_hole_contents(g)){if(e.dereference_contents&&!b.not_to_be_dereferenced)return e.dereference_contents(b,k,f);if(b.next){if(e.dereference_path)return e.dereference_path(b.next,
k,f);a.UTILITIES.report_internal_error("Expected to refer to a part of "+e+" but it lacks a method to obtain "+a.path.toString(b.next))}b.removing_widget&&("empty hole"===e.get_type_name()?a.UTILITIES.report_internal_error("Robot is trying to remove something from an empty hole. "):e.get_infinite_stack()||f.remove_from_container(e,this));return e}return this.get_hole(g)}a.UTILITIES.report_internal_error(this+" unable to dereference the path: "+a.path.toString(b))}else return this};b.path={create:function(b){return{get_index:function(){return b},
toString:function(){return"scale"===this.true_type?0===b?"the left pan ":"the right pan ":"the "+a.UTILITIES.ordinal(b)+" hole "},get_json:function(a){return{type:"box_path",index:b,true_type:this.true_type,next:this.next&&this.next.get_json(a)}}}}};b.get_custom_title_prefix=function(){return"Drop things in my holes to store them."};a.creators_from_json.box_path=function(d,k){var f=b.path.create(d.index);d.next&&(f.next=a.UTILITIES.create_from_json(d.next,k));d.true_type&&(f.true_type=d.true_type);
return f};return b}(window.TOONTALK);window.TOONTALK.box_backside=function(a){return{create:function(b){var d=a.backside.create(b),k=a.UTILITIES.create_text_input(b.get_size().toString(),"toontalk-box-size-input","Number of holes","Type here to edit the number of holes.",void 0,"number",function(c){(c=a.UTILITIES.input_area_drop_handler(c,b.receive_size_from_dropped.bind(b),b))&&b.robot_in_training()&&b.robot_in_training().dropped_on_text_area(c,b,{area_selector:".toontalk-box-size-input",setter:"receive_size_from_dropped",
toString:"for the box's size"})}),f=a.UTILITIES.create_radio_button("box_orientation","horizontal","toontalk-horizontal-radio-button","Left to right","Show box horizontally."),g=a.UTILITIES.create_radio_button("box_orientation","vertical","toontalk-vertical-radio-button","Top to bottom","Show box vertically."),e=function(){var a=parseInt(k.button.value.trim(),10);b.set_size(a,!0)&&b.robot_in_training()&&b.robot_in_training().edited(b,{setter_name:"set_size",argument_1:a,toString:"by changing the number of holes to "+
a+" of the box",button_selector:".toontalk-box-size-input"})},m=function(){var c=a.UTILITIES.selected_radio_button(f.button,g.button),d=c.value,e="horizontal"===d;b.set_horizontal(e,!0);b.robot_in_training()&&b.robot_in_training().edited(b,{setter_name:"set_horizontal",argument_1:e,toString:"by changing the orientation to "+d+" of the box",button_selector:"."+c.className.split(" ",1)[0]})},r=d.get_element(),h=a.backside.create_advanced_settings_button(d,b),v=d.update_display.bind(d);k.button.addEventListener("change",
e);k.button.addEventListener("mouseout",e);f.button.addEventListener("change",m);g.button.addEventListener("change",m);d.update_display=function(){k.button.value=b.get_size().toString();b.get_horizontal()?a.UTILITIES.check_radio_button(f):a.UTILITIES.check_radio_button(g);v()};r.appendChild(k.container);r.appendChild($(a.UTILITIES.create_horizontal_table(f.container,g.container)).buttonset().get(0));r.appendChild(h);d.add_advanced_settings();d.rerender();return d}}}(window.TOONTALK);window.TOONTALK.box_hole=
function(a){return{create:function(b){var d=Object.create(this),k,f,g;d.is_hole=function(){return!0};d.is_empty_hole=function(){return!k};d.get_element=function(){g||(g=document.createElement("div"),g.className="toontalk-box-hole toontalk-frontside toontalk-side",g.toontalk_widget=d);return g};d.get_frontside=function(a){return k?k.get_frontside(a):this.get_element()};d.get_side_element=function(){return this.get_element()};d.get_frontside_element=function(a){return this.get_element()};d.get_frontside=
function(){return this};d.widget_dropped_on_me=function(b,d,f,h){var k=this.get_parent_of_frontside(),c,g,m;b.dropped_on_other&&b.dropped_on_other(this,!1,f,h);f?(a.sounds&&a.sounds.fall_inside.play(),d=this.get_element(),h=b.is_plain_text_element(),m=b.get_element(),$(m).css({"z-index":a.UTILITIES.next_z_index()}),g=$(m.parentElement).offset(),c=$(d).offset(),h||(m.style.left=f.pageX-g.left+"px",m.style.top=f.pageY-g.top+"px",$(m).addClass("toontalk-animating-element")),m.style.width=d.style.width,
m.style.height=d.style.height,m.style.left=c.left-g.left+"px",m.style.top=c.top-g.top+"px",f=function(){$(m).removeClass("toontalk-animating-element");k.render();this.set_contents(b)}.bind(this),setTimeout(f,h||a.UTILITIES.has_animating_image(m)?0:1200),k.robot_in_training()&&k.robot_in_training().dropped_on(b,this),b.save_dimensions&&b.set_size_attributes&&b.set_size_attributes($(d).width(),$(d).height())):(k.render(),this.set_contents(b));return!0};d.get_json=function(){return null};d.add_to_json=
function(a){return a};d.copy=function(d){return a.box_hole.create(b)};d.match=function(){return"matched"};d.get_type_name=function(a){return k?k.get_type_name(a):a?"empty holes":"empty hole"};d.is_of_type=function(a){return k?k.is_of_type(a):"empty hole"===a};d.get_box=function(){return this.get_parent_of_frontside()};d.update_display=function(){var a;k&&(a=this.get_frontside_element(),m(k,k.get_frontside_element(),$(a).width(),$(a).height()))};d.dereference=function(){return k?k[0].dereference():
this};d.get_index=function(){return b};d.get_contents=function(){return k};d.set_contents=function(b){var d=this.get_listeners("value_changed");d&&(k!==b&&d.forEach(function(a){a({type:"value_changed",old_value:k,new_value:b})}),k&&d.forEach(function(a){k.remove_listener("value_changed",a,!0)}),b&&d.forEach(function(a){b.add_listener("value_changed",a)}));k&&k.set_parent_of_frontside(void 0);(k=b)?(k.set_parent_of_frontside(this),a.debugging&&(this._debug_string="A hole containing "+k.to_debug_string()),
k.set_visible(f)):a.debugging&&(this._debug_string=this.to_debug_string())};d.visible=function(){return this.get_parent_of_frontside().visible()};d.set_visible=function(a){f=a;k&&k.set_visible(a)};d.remove=function(){k&&k.remove()};d.render=function(){k&&a.DISPLAY_UPDATES.pending_update(this)};d.rerender=function(){if(k.visible())return this.render()};d.set_running=function(a){k&&k.set_running(a)};d.removed_from_container=function(b,d,f,h,g){k?(f&&k.restore_dimensions(),this.set_contents(void 0),
f&&this.get_parent_of_frontside().render()):g&&a.UTILITIES.report_internal_error("Holes can't be removed from containers.")};d.temporarily_remove_contents=function(a,b){if(k)return this.get_parent_of_frontside().temporarily_remove_contents(a,b)};d.toString=function(){return k?k.toString():"_"};d.get_description=function(){return k?k.get_description():"_"};d.get_full_description=function(a){return k?k.get_full_description(a):"_"};d.is_backside=function(){return!1};d.get_widget=function(){return this.get_parent_of_frontside()};
d.is_number=function(){return k?k.is_number():!1};d.is_box=function(){return k?k.is_box():!1};d.is_scale=function(){return k?k.is_scale():!1};d.is_bird=function(){return k?k.is_bird():!1};d.is_nest=function(){return k?k.is_nest():!1};d.is_robot=function(){return k?k.is_robot():!1};d.is_element=function(){return k?k.is_element():!1};d.is_top_level=function(){return!1};a.widget.has_parent(d);a.widget.has_listeners(d);if(a.debugging||a.logging)d.to_debug_string=function(){var d="the "+a.UTILITIES.ordinal(b)+
" hole of the "+(this.get_parent_of_frontside()?this.get_parent_of_frontside().to_debug_string():"not-yet-defined box");return k?d+" which contains "+k.to_debug_string():d+" which is empty"},d._debug_string=d.to_debug_string();return d}}}(window.TOONTALK)})(window.TOONTALK);(function(){var g,m,a,b,d;window.TOONTALK.bird=function(a){var b=Object.create(a.widget),p=function(b,d,f){b.get_function_type();b=b.get_function_object();var h=Object.keys(TOONTALK.number.function),g=h.map(function(a){return TOONTALK.number.function[a].title}),h=a.UTILITIES.create_select_menu("functions",h,"toontalk-select-function","Which function should I fly to? ","Click to select the function that this bird will use when given a box.",g);d=d.get_element();b&&(h.menu.value=b.name);h.menu.addEventListener("change",
function(a){f.set_function_name(a.target.value)});d.insertBefore(h.container,d.firstChild)};b.create=function(e,w){var r=Object.create(b),h=[],v=[];g=function(a){e=a};r.is_bird=function(){return!0};r.widget_dropped_on_me=function(b,d,f,h,g){var m=d?b.get_backside():b,p,v;if(e){if(e.has_ancestor(b))return a.UTILITIES.display_message("Bird can't take its nest to its nest!"),!1;!(e.visible()||this.visible()||e.any_nest_copies_visible())||h&&h.visible()&&!h.animate_consequences_of_actions()?(e.add_to_contents(m,
f,h),h&&h===m.robot_waiting_before_next_step&&(m.robot_waiting_before_next_step=void 0,h.run_next_step())):(b.save_dimensions(),p=this.get_frontside_element(),setTimeout(function(){$(p).removeClass("toontalk-bird-gimme")}),b.set_visible(!0),h&&!g&&(b.robot_waiting_before_next_step=h,b.remove_from_parent_of_frontside(),h.run_next_step&&(v=function(){m.robot_waiting_before_next_step=void 0;h.run_next_step()})),e.animate_bird_delivery(m,this,v,f,h))}else console.log("TODO: handle drop on a nestless bird -- just removes other?");
f&&this.robot_in_training()&&this.robot_in_training().dropped_on(b,this);return!0};r.animate_delivery_to=function(b,d,f,g,m,p,r,w){var L=!!f,J=this.get_parent_of_frontside(),K=this.get_frontside_element();$(K).width();var C=this.closest_visible_ancestor_or_frontside(),F=$(C.get_frontside_element()).offset(),P=function(){var b=$(Z).offset(),c;a.sounds&&a.sounds.bird_fly.pause();L?this.remove():this.visible()&&(c=function(){$(K).removeClass("toontalk-bird-morph-to-static");$(K).addClass(this.get_class_name_with_color("toontalk-bird-static"));
J&&J.get_widget().rerender()}.bind(this),K.style.position=Q,b&&(F.left-=b.left,F.top-=b.top),$(K).css(F),Z&&Z.appendChild(K),J&&(J.get_widget().is_top_level()?this.rerender():J.get_widget().rerender()),V&&(na.remove_backside_widget(this,!1,!0),V(),h&&(b=h,h=[],v=[],b.forEach(function(a){a()}))),a.UTILITIES.add_animation_class(K,"toontalk-bird-morph-to-static"),a.UTILITIES.add_one_shot_event_handler(K,"animationend",1E3,c));p&&p()}.bind(this),l=function(){try{f.add_to_contents(b,r,w,this,!0)}catch(d){if(d.wait_for_nest_to_receive_something){d.wait_for_nest_to_receive_something.run_when_non_empty(l,
this);p&&(p(),p=void 0);return}throw d;}B();a.UTILITIES.set_timeout(function(){this.fly_to(F,P,w)}.bind(this))}.bind(this),q=function(b,c){b.width_before_carry=$(b).width();b.height_before_carry=$(b).height();this.element_to_display_when_flying=b;c&&(this.update_display(),setTimeout(function(){c.update_display()}));$(this.element_to_display_when_flying).addClass("toontalk-carried-by-bird");a.UTILITIES.set_timeout(function(){$(this.element_to_display_when_flying).css({left:"",top:"",width:"",height:"",
position:""});this.update_display()}.bind(this))}.bind(this),B=function(b){if(this.element_to_display_when_flying){var c=this.element_to_display_when_flying.width_before_carry,d=this.element_to_display_when_flying.height_before_carry;$(this.element_to_display_when_flying).removeClass("toontalk-carried-by-bird");b?($(this.element_to_display_when_flying).css({width:c||"",height:d||"","z-index":a.UTILITIES.next_z_index()}),$(K).closest(".toontalk-top-level-backside").append(this.element_to_display_when_flying),
a.UTILITIES.set_absolute_position($(this.element_to_display_when_flying),b)):$(this.element_to_display_when_flying).remove();this.element_to_display_when_flying=void 0;this.update_display()}}.bind(this),z,I,Z,Q,ma,Y,V,la,ja,da,na;a.sounds&&a.sounds.bird_fly.play();f||(f=e);da=b.get_element();q(da,b);d.is_function_nest()||(I=d.get_widget().closest_visible_ancestor_or_frontside().get_widget().get_frontside_element());if(!d.visible()&&!this.visible()||!d.is_function_nest()&&!$(I).is(":visible"))f.add_to_contents(b,
r,w,this,!0);else if(d.is_function_nest()||(I=d.get_widget().closest_visible_ancestor_or_frontside().get_widget().get_frontside_element(),z=$(I).offset(),Y=$(f.get_frontside_element()).closest(".toontalk-top-level-backside")),Y&&Y.is("*")||(Y=$(this.get_frontside_element()).closest(".toontalk-top-level-backside")),(d=Y.offset())||(d={left:0,top:0}),g?F={left:g+d.left,top:m+d.top}:0===F.left&&0===F.top&&(F={left:-da.clientWidth,top:d.top+Y.height()/2}),z||(z={left:-da.clientWidth,top:d.top+Y.height()/
2}),Z=K.parentElement,C=$(K).width(),ma=$(K).height(),Q=K.style.position,K.style.position="absolute",na=this.top_level_widget(),J&&J.temporarily_remove_contents&&(V=J.temporarily_remove_contents(this,!0))&&na.add_to_top_level_backside(this),Y.append(K),$(K).css({left:g||F.left-d.left,top:m||F.top-d.top,width:C,height:ma}),a.logging&&0<=a.logging.indexOf("bird")&&console.log(this.to_debug_string()+" from "+(g||F.left-d.left)+", "+(m||F.top-d.top)+" to "+z.left+", "+z.top),(la=f.get_contents_frontside_element&&
f.get_contents_frontside_element())&&f.visible()&&(!w||w.animate_consequences_of_actions())){g=$(I).width();m=$(I).height();ja=$(I).offset();d.max_left=d.left+Y.width();d.max_top=d.top+Y.height();z.left+=g;z.top+=m;var va={left:Math.min(ja.left+g,d.max_left-g),top:Math.min(ja.top+m,d.max_top-m)},ya={left:Math.max(ja.left-g,d.left),top:Math.max(ja.top-m,d.top)};z=function(){var a=function(){f.set_locked(!0);this.fly_to(ja,wa,w,300)}.bind(this);B(va);f.get_locked()?f.run_when_unlocked(a):a()}.bind(this);
var wa=function(){q(la);this.fly_to(ya,Ka,w,300)}.bind(this),Ka=function(){B(ya);this.fly_to(va,ra,w,300)}.bind(this),ra=function(){q(da,b);this.fly_to(ja,ba,w,300)}.bind(this),ba=function(){B(ja);this.fly_to(ya,S,w,300)}.bind(this),S=function(){q(la);this.fly_to(ja,n,w,300)}.bind(this),n=function(){f.set_locked(!1);B();f.update_display();l()}.bind(this);this.fly_to(va,z,w,300)}else this.fly_to(z,l,w,300)};r.get_json=function(b){return{type:"bird",nest:e&&a.UTILITIES.get_json(e,b)}};r.copy=function(a){var b,
f,h;if(a)if(a.just_value)b=this.create(void 0,this.get_description());else{if((h=e.get_guid())&&a.nests_copied&&a.nests_copied[h]){b=a.nests_copied[h][0];d.call(b);for(f=1;f<a.nests_copied[h].length;f++)m.call(a.nests_copied[h][f],b);b=this.create(b,this.get_description())}else b=this.create(e,this.get_description());a.birds_copied||(a.birds_copied={});h&&(a.birds_copied[h]||(a.birds_copied[h]=[]),a.birds_copied[h].push(b))}else b=e&&e.is_function_nest()?this.create(e.copy(),this.get_description()):
this.create(e,this.get_description());return this.add_to_copy(b,a)};r.run_when_non_empty=function(a,b){0>v.indexOf(b)&&(h.push(a),v.push(b))};r.create_backside=function(){var b=a.bird_backside.create(this);e&&e.is_function_nest()&&p(e,b,this);return b};r.get_help_URL=function(){return e&&e.is_function_nest()?"docs/manual/function-birds.html":"docs/manual/birds-nests.html"};r.is_function_bird=function(){return e&&e.is_function_nest()};r.get_custom_title_prefix=function(){var a;return e?e.is_function_nest()&&
(a=e.get_function_object())?a.get_description():"Drop something on me and I'll take it to my nest.":"This bird no longer knows where her nest is. She'll get rid of anything you give her."};r.toString=function(a){return e?e.is_function_nest()?e.get_function_object().toString():"a bird":a&&"conditions"===a.role?"any bird":"a bird without a nest"};r.update_display=function(){var b=this.get_frontside(!0);this.get_backside();var d;d=b.get_element();e&&d.setAttribute("toontalk_name",e.get_name());a.UTILITIES.give_tooltip(d,
this.get_title());$(d).is(".toontalk-bird, .toontalk-side-animating")||($(d).addClass(this.get_class_name_with_color("toontalk-bird toontalk-bird-static")),d.addEventListener("dragenter",function(b){0<=d.className.indexOf("toontalk-bird-static")&&($(d).removeClass(this.get_class_name_with_color("toontalk-bird-static")),a.UTILITIES.add_animation_class(d,"toontalk-bird-gimme"))}.bind(this)),d.addEventListener("dragleave",function(a){$(d).is(".toontalk-bird-gimme")&&($(d).addClass(this.get_class_name_with_color("toontalk-bird-static")).removeClass("toontalk-bird-gimme"),
this.get_parent_of_frontside().render())}.bind(this)));this.element_to_display_when_flying?d.appendChild(this.element_to_display_when_flying):$(d).children(".toontalk-side").remove()};r.set_function_name=function(a){e&&e.is_function_nest()&&e.set_function_name(a)&&(this.rerender(),this.robot_in_training()&&this.robot_in_training().edited(this,{setter_name:"set_function_name",argument_1:a,toString:"change the function bird to '"+a+"'",button_selector:".toontalk-select-function"}))};r.get_class_name_with_color=
function(a){return e&&e.get_class_name_with_color?e.get_class_name_with_color(a):a};r.get_name=function(){return e&&e.get_name()};e&&e.set_name&&(r.set_name=function(a,b){return e.set_name(a,b)});r=r.add_standard_widget_functionality(r);r.set_description(w);a.debugging&&(r._debug_id=a.UTILITIES.generate_unique_id(),r._debug_string=r.to_debug_string());return r};b.create_function=function(d,g,m){return b.create(a.nest.create_function(g,d,m||a.UTILITIES.get_first_property(a[d].function)))};b.match=
function(a){return a.match_with_any_bird?a.match_with_any_bird(this):this};b.match_with_any_bird=function(){return"matched"};b.fly_to=function(b,d,f,h){var g=this.get_frontside_element(),c=$(g).offset(),c=Math.atan2(b.top-c.top,b.left-c.left),m="toontalk-fly-west toontalk-fly-northwest toontalk-fly-north toontalk-fly-northeast toontalk-fly-east toontalk-fly-southeast toontalk-fly-south toontalk-fly-southwest".split(" ")[Math.round(4*(c/Math.PI+1))%8];$(g).position();c=function(){$(g).removeClass(m);
h?setTimeout(d,f?f.transform_step_duration(h):h):d()}.bind(this);a.UTILITIES.add_animation_class(g,m);$(g).removeClass($(g).removeClass(this.get_class_name_with_color("toontalk-bird-static")));this.animate_to_absolute_position(b,c,f&&f.transform_animation_speed(a.UTILITIES.default_animation_speed))};b.get_type_name=function(a,b){return a?b&&this.is_function_bird()?"function birds":"birds":"bird"};b.maintain_proportional_dimensions=function(){return!0};b.matching_resource=function(a){return a.get_type_name&&
a.get_type_name()===this.get_type_name()};b.drop_on=function(a,b,d,f){if(a.widget_dropped_on_me)return a.widget_dropped_on_me(this,!1,d,f)};a.creators_from_json.bird=function(b,d){return a.bird.create(a.UTILITIES.create_from_json(b.nest,d),b.description)};return b}(window.TOONTALK);window.TOONTALK.bird_backside=function(a){return{create:function(b){b=a.backside.create(b);b.add_advanced_settings(!0);return b}}}(window.TOONTALK);window.TOONTALK.nest=function(k){var f=Object.create(k.widget),p,e=0,w=
0;f.default_maximum_capacity=10;f.maximum_capacity=f.default_maximum_capacity;f.create=function(r,h,v,c,t,x){var A=Object.create(f),D=[],E=[],R=[],H,L;h||(h=[]);t||(e++,t=e);m=function(d){c&&b.call(c,this);c=d;v=d.get_guid();a.call(d,this)};d=function(){c&&b.call(c,this);c=void 0;v=k.UTILITIES.generate_unique_id()};a=function(a){p||(p=k.UTILITIES.generate_unique_id());this[p](a)};b=function(a){p||(p=k.UTILITIES.generate_unique_id());this[p](a,!0)};A.is_nest=function(){return!0};A.get_guid=function(){return v};
A.matched_by=function(a){return 0<h.length?k.UTILITIES.match(a,h[0].get_widget()):[[this,a]]};A.run_when_non_empty=function(a,b){0<h.length?a(h[0]):0>R.indexOf(b)&&(D.push(a),R.push(b))};A.dereference=function(){return 0<h.length?h[0]:this};A.match=function(a){return 0<h.length?h[0].match(a):a.match_nest_with_nest?a.match_nest_with_nest(this):a};A.add_to_contents=function(a,b,c,d,e){var l;l=h.push(a);l>f.maximum_capacity&&!c.visible()&&!this.visible()&&(k.logging&&0<=k.logging.indexOf("nest")&&console.log(this.to_debug_string()+
" postponing addition of "+a.to_debug_string()+" by "+c.to_debug_string()+". Stack is "+h.length+" long. "+E.length+" previously postponed."),c.add_body_finished_listener(function(a,b,d){c.set_stopped(!0);E.push(function(){c.set_stopped(!1);c.run_actions(a,b,d)})}));k.logging&&0<=k.logging.indexOf("nest")&&console.log(this.to_debug_string()+" added "+a.to_debug_string()+" nest now contains "+h.length+" widgets.");1===l?(0<D.length&&(l=D,D=[],R=[],l.forEach(function(b){b(a)})),a.set_visible(this.visible())):
(a.get_widget().hide(),a.set_visible(!1));a.is_backside()?a.get_widget().set_parent_of_backside(this):a.get_widget().set_parent_of_frontside(this);H&&!e&&(d?H.forEach(function(e){e.has_ancestor(a.get_widget())||e.animate_bird_delivery(k.UTILITIES.copy_side(a),d,void 0,b,c)}):H.forEach(function(d){d.has_ancestor(a.get_widget())||d.add_to_contents(k.UTILITIES.copy_side(a,!1,!0),b,c)}));this.rerender()};A.animate_bird_delivery=function(a,b,c,d,e){var l,f,h;b.animate_delivery_to(a,this,void 0,void 0,
void 0,c,d,e);H&&(l=$(b.closest_visible_ancestor().get_widget().get_frontside_element()).closest(":visible").position(),f=b.get_parent_of_frontside().get_element(),h=this.visible(),H.forEach(function(c){var g=k.UTILITIES.copy_side(a,!1,h),m,p;c.has_ancestor(a.get_widget())||(l&&(c.visible()||h)?(m=b.copy({just_value:!0}),p=m.get_frontside_element(!0),$(f).append(p),m.animate_delivery_to(g,c,c,l.left,l.top,void 0,d,e)):c.add_to_contents(g,void 0,e))}))};A.get_contents_frontside_element=function(){if(0<
h.length)return h[0].get_widget().get_frontside_element()};A.get_locked=function(){return this.locked_for_animating_deliveries};A.set_locked=function(a){this.locked_for_animating_deliveries=a;!a&&this.to_run_when_unlocked&&0<this.to_run_when_unlocked.length&&this.to_run_when_unlocked.shift()()};A.run_when_unlocked=function(a){this.to_run_when_unlocked?this.to_run_when_unlocked.push(a):this.to_run_when_unlocked=[a]};A.removed_from_container=function(a,b,c,d,e){a=h.shift();k.logging&&0<=k.logging.indexOf("nest")&&
console.log(this.to_debug_string()+" removed "+a.to_debug_string()+" remaining widgets is "+h.length);if(a)return a.is_backside()?a.get_widget().set_parent_of_backside(void 0):a.get_widget().set_parent_of_frontside(void 0),this.visible()&&(a.get_widget().restore_dimensions(),0<h.length&&(h[0].set_visible(!0),$(h[0].get_element()).show()),this.render()),h.length<f.maximum_capacity&&0<E.length&&(k.logging&&0<=k.logging.indexOf("nest")&&console.log(this.to_debug_string()+" running "+E.length+" postponed additions. Stack is "+
h.length+" long."),f.maximum_capacity=Number.MAX_VALUE,E.forEach(function(a){a()}),f.maximum_capacity=f.default_maximum_capacity,E=[]),a;e&&k.UTILITIES.report_internal_error("Nothing removed from nest!")};A.dereference_path=function(a,b,c){if(0===h.length)return this.get_guid()?{wait_until_this_nest_receives_something:this}:this;if(h)return h[0].dereference_path(a,b,c);k.UTILITIES.display_message("Robot expected to find a nest something that it could get "+k.path.toString(a)+". But the nest is empty.");
return this};A.dereference_contents=function(a,b,c){var d,e,l,f;return 0===h.length?{wait_until_this_nest_receives_something:this}:a.removing_widget?(a=h[0],c.remove_from_container(a,this),this.visible()&&(l=this.get_frontside_element(),c=$(l).offset(),b=$(l).closest(".toontalk-backside-of-top-level"),(d=b.offset())||(d={left:0,top:0}),e=a.get_frontside_element(),f=$(l).width(),l=$(l).height(),$(e).css({left:.1*f+c.left-d.left,top:.1*l+c.top-d.top,width:f*k.nest.CONTENTS_WIDTH_FACTOR,height:l*k.nest.CONTENTS_HEIGHT_FACTOR}),
b.append(e)),a):a.next?h[0].get_widget().dereference_path(a.next,b,c):h[0].get_widget()};A.get_json=function(a){return{type:"nest",contents:k.UTILITIES.get_json_of_array(h,a),guid:v,original_nest:c&&k.UTILITIES.get_json(c,a),serial_number:t,name:this.get_name()}};A.copy=function(a){var b,d,e,f;if(a&&a.just_value){if(0<h.length&&(b=h[0].get_widget().copy(a),!a.copy_covered_nests))return b;d=k.nest.create(this.get_description(),[],"in a robot's condition",void 0,t,this.get_name());b&&d.add_to_contents(b);
return d}b=k.UTILITIES.copy_widget_sides(h,a);a?a.fresh_copy?d=k.nest.create(this.get_description(),b,v&&k.UTILITIES.generate_unique_id()):(e=c||this,a.birds_copied&&a.birds_copied[v]?(f=e.get_guid(),a.nests_copied&&a.nests_copied[f]?(d=a.nests_copied[f][0].copy(),a.nests_copied[f].forEach(function(a){m.call(a,d)})):d=k.nest.create(this.get_description(),b,k.UTILITIES.generate_unique_id()),a.birds_copied[v].forEach(function(a){g.call(a,d)})):d=k.nest.create(this.get_description(),b,v,e,t,this.get_name()),
a.nests_copied||(a.nests_copied={}),a.nests_copied[e]?a.nests_copied[f].push(d):a.nests_copied[f]=[d]):d=k.nest.create(this.get_description(),b,v,c||this,t,this.get_name());return this.add_to_copy(d,a)};A.has_contents=function(){return 0<h.length};A.dropped_on_other=function(a,b,c,d){var e,l,f,h,g,m,p;if(!v){v=k.UTILITIES.generate_unique_id();k.debugging&&(this._debug_string=this.to_debug_string());e=k.bird.create(this);if(d){d.add_newly_created_widget(e);if(!this.visible())return;this.robot_waiting_before_next_step=
d}c&&this.robot_in_training()&&this.robot_in_training().add_newly_created_widget(e);k.sounds&&setTimeout(function(){k.sounds.hatching.play()},1E3);this.rerender();l=this.get_frontside_element(!0);k.UTILITIES.add_animation_class(l,"toontalk-hatch-egg");g=function(){var g,t,v;if(b)g=a.get_backside();else if((v=k.UTILITIES.widget_from_jquery($(l).closest(".toontalk-top-level-backside")))||(v=k.UTILITIES.widget_from_jquery($(a.get_widget().get_frontside_element(!0)).closest(".toontalk-top-level-backside"))),
v)g=v.get_backside();else{k.UTILITIES.report_internal_error("Unable to find the top-level backside for bird to go to.");return}t=g.get_element();v=$(t).offset();f=e.get_frontside_element(!0);$(f).removeClass(this.get_class_name_with_color("toontalk-bird-static"));k.UTILITIES.add_animation_class(f,"toontalk-fly-southwest");h=k.UTILITIES.relative_position(l,t);$(f).css({left:h.left,top:h.top});c&&this.robot_in_training()?g.widget_dropped_on_me(e,!1,c,void 0,!0):g.widget_dropped_on_me(e,!1,c);$(l).removeClass("toontalk-hatch-egg").addClass(this.get_class_name_with_color("toontalk-empty-nest")).css({width:"",
height:""});this.get_parent_of_frontside().get_widget().is_top_level()&&$(l).css({left:h.left-5,top:h.top+45});this.get_parent_of_frontside().render();p=function(){$(f).removeClass("toontalk-fly-southwest");k.UTILITIES.set_timeout(function(){k.UTILITIES.add_animation_class(f,"toontalk-fly-down");$(f).removeClass(this.get_class_name_with_color("toontalk-bird-static"));m=function(){var a=function(){$(f).removeClass("toontalk-bird-morph-to-static toontalk-side-animating").addClass(this.get_class_name_with_color("toontalk-bird-static"))}.bind(this);
$(f).removeClass("toontalk-fly-down");k.UTILITIES.add_animation_class(f,"toontalk-bird-morph-to-static");k.UTILITIES.add_one_shot_event_handler(f,"animationend",1E3,a);d&&(this.robot_waiting_before_next_step=void 0,d.run_next_step());e.update_display()}.bind(this);k.UTILITIES.add_one_shot_event_handler(l,"animationend",1E3,m)}.bind(this))}.bind(this);$(f).removeClass(this.get_class_name_with_color("toontalk-bird-static"));g=Math.max(10,h.left-70);t=Math.max(10,h.top+70);e.animate_to_absolute_position({left:g+
v.left,top:t+v.top},p,d&&d.transform_animation_speed(k.UTILITIES.default_animation_speed));this.rerender()}.bind(this);k.UTILITIES.add_one_shot_event_handler(l,"animationend",2E3,g)}return!0};A.widget_dropped_on_me=function(a,b,c,d){c&&a.save_dimensions&&a.save_dimensions();0===h.length?(this.add_to_contents(b?a.get_backside():a,c,d),a.dropped_on_other?a.dropped_on_other(this,b,c,d):c&&this.robot_in_training()&&this.robot_in_training().dropped_on(a,this)):a.drop_on(h[0].get_widget(),b,c,d);return!0};
A.drop_on=function(a,b,c,d){return a.widget_dropped_on_me?(a.widget_dropped_on_me(this,!1,c,d),!0):!1};A.element_to_highlight=function(){return 0===h.length?this.get_frontside_element():h[0].get_frontside_element()};A.update_display=function(){var a=this.get_frontside(!0),b=this.get_backside(),c,d,e,l,f,a=a.get_element();a.setAttribute("toontalk_name",this.get_name());0<h.length?(c=h[0].get_widget(),h[0].is_backside()?(l=c.get_backside(!0),f=l.get_element(),l.update_display(),l.scale_to_fit(f,a)):
(c.render(),f=h[0].get_element(),$(f).show()),d=$(a).width(),e=$(a).height(),0<d&&0<e&&k.UTILITIES.set_timeout(function(){for(var a=2*f.toontalk_border_size||0,b=k.nest.CONTENTS_WIDTH_FACTOR*d,l=k.nest.CONTENTS_HEIGHT_FACTOR*e;2*a>=b||2*a>=l;)a/=2;b-=a;l-=a;$(f).css({width:b,height:l,left:.1*d,top:.1*e});c.set_size_attributes&&c.set_size_attributes(b,l)},2),a.appendChild(f),$(a).addClass(this.get_class_name_with_color("toontalk-empty-nest")),h[0].is_backside()?c.set_parent_of_backside(this):c.set_parent_of_frontside(this)):
(k.UTILITIES.give_tooltip(a,this.get_title()),v?($(a).removeClass(this.get_class_name_with_color("toontalk-nest-with-egg")),$(a).addClass(this.get_class_name_with_color("toontalk-empty-nest"))):k.UTILITIES.add_animation_class(a,this.get_class_name_with_color("toontalk-nest-with-egg")));$(a).addClass("toontalk-nest");b&&b.rerender()};p||(p=k.UTILITIES.generate_unique_id());A[p]=function(a,b){if(!H){if(b)return;H=[]}b?H.splice(H.indexOf(a),1):H.push(a)};A.get_path_to=function(a,b){var c;if(0<h.length){c=
h[0].get_widget();if(c===a)return k.path.to_widget_on_nest();if(c.get_path_to)return c.get_path_to(a,b)}};A.walk_children=function(a){if(0<h.length)return a(h[0])};A.top_contents_is=function(a){return 0<h.length&&h[0].get_widget()===a};A.any_nest_copies_visible=function(){var a=!1;if(!H)return!1;H.some(function(b){b.visible()&&(a=!0)});return a};A.compare_with=function(a){if(0<h.length)return h[0].compare_with(a);if(a.compare_with_nest)return-1*a.compare_with_nest(this)};A.compare_with_nest=function(a){return 0===
h.length?0:1};A.compare_with_number=function(a){return 0<h.length?h[0].compare_with(a):-1};A.get_class_name_with_color=function(a){return t?a+["","-magenta","-yellow"][t%3]:a};A.generate_name=function(){w++;return"#"+w.toString()};A.has_name(A);L=A.set_name;A.set_name=function(a,b){var c=this.get_name();if(!L.call(this,a,b))return!1;b&&$(".toontalk-bird").each(function(){this.getAttribute("toontalk_name")===c&&k.UTILITIES.widget_of_element(this).rerender()})};A.set_name(x);A.compare_with_box=A.compare_with_number;
A.compare_with_scale=A.compare_with_number;A.add_standard_widget_functionality(A);A.set_description(r);k.debugging&&(A._debug_id=k.UTILITIES.generate_unique_id(),A._debug_string=A.to_debug_string());c&&v&&(p||(p=k.UTILITIES.generate_unique_id()),c[p](A));return A};f.create_function=function(a,b,d){var c=function(){return!1},e=k[b]&&k[b].function&&k[b].function[d],c={get_function_type:function(){return b},get_function_object:function(){return e},set_function_name:function(a){if(d===a)return!1;d=a;
e=k[b]&&k[b].function&&k[b].function[d];this.add_to_contents=e.respond_to_message;return!0},is_function_nest:function(){return!0},copy:function(){return k.nest.create_function(a,b,d)},animate_bird_delivery:function(a,b,c,d,e){b.animate_delivery_to(a,this,void 0,void 0,void 0,c,d,e)},get_json:function(a){return{type:"function_nest",function_type:b,function_name:e?e.name:k.UTILITIES.get_first_property(k[b].function)}},add_to_json:k.widget.add_to_json,get_widget:function(){return this},get_guid:function(){},
get_name:function(){return e.short_name},has_ancestor:c,visible:c,any_nest_copies_visible:c,is_backside:c};k.widget.has_parent(c);k.widget.has_description(c);k.widget.add_sides_functionality(c);c.set_description(a);e?(c.add_to_contents=e.respond_to_message,k.debugging&&(c._debug_id=k.UTILITIES.generate_unique_id(),c._debug_string="a function nest that "+e.toString())):k.UTILITIES.report_internal_error("Cannot create a function nest because TOONTALK."+b+"."+d+" is not defined.");return c};k.creators_from_json.function_nest=
function(a,b){return k.nest.create_function(a.description,a.function_type,a.function_name)};f.create_backside=function(){return k.nest_backside.create(this)};f.match_nest_with_nest=function(a){return"matched"};f.toString=function(){return"a nest"};f.get_help_URL=function(){return"docs/manual/birds-nests.html"};f.get_type_name=function(a){return a?"nests":"nest"};f.maintain_proportional_dimensions=function(){return!0};f.matching_resource=function(a){return a.get_type_name&&a.get_type_name()===this.get_type_name()};
f.get_custom_title_prefix=function(){return"Drop something on my bird and she'll take it here."};k.creators_from_json.nest=function(a,b){var d=!a.original_nest&&a.guid&&b&&b.guid_to_nest_table&&b.guid_to_nest_table[a.guid];d||(d=k.nest.create(a.description,k.UTILITIES.create_array_from_json(a.contents,b),a.guid,a.original_nest&&k.UTILITIES.create_from_json(a.original_nest,b),a.serial_number,a.name),b.guid_to_nest_table[a.guid]=d);return d};f.CONTENTS_WIDTH_FACTOR=.8;f.CONTENTS_HEIGHT_FACTOR=.8;return f}(window.TOONTALK);
window.TOONTALK.nest_backside=function(a){return{create:function(b){b=a.backside.create(b);b.add_advanced_settings(!0);return b}}}(window.TOONTALK)})();window.TOONTALK.scale=function(g){var m=Object.create(g.widget);m.create=function(a,b,d,k){var f=function(){d.rerender()},m,e,w;d||(d=g.box.create(2,void 0,a,b));m=d.get_json;e=d.copy;w=d.get_path_to;d.is_scale=function(){return!0};d.copy=function(a){var b;a||(a={});b=e.call(this,a);b=g.scale.create(void 0,void 0,b,a.just_value&&this.get_state());return d.add_to_copy(b,a)};d.get_json=function(a){a=m.call(this,a);a.type="scale";a.inactive_state=this.get_inactive_state();return a};d.get_path_to=function(a,
b){var d=w.call(this,a,b);d&&(d.true_type="scale");return d};d.drop_on=function(a,b,d,c){if(a.widget_dropped_on_me)return a.widget_dropped_on_me(this,b,d,c)};d.widget_dropped_on_me=function(a,b,d,c){var e=this.get_hole_contents(0),f=this.get_hole_contents(1),k;a.dropped_on_other&&a.dropped_on_other(this,!1,d,c);if(e&&!f)return this.get_hole(1).widget_dropped_on_me(a,b,d,c),!0;if(!e&&(f||!d))return this.get_hole(0).widget_dropped_on_me(a,b,d,c),!0;k=this.which_hole(d,!1);if(0===k){if(e){if(e.drop_on)return a.drop_on(e,
b,d,c);return}}else if(f){if(f.drop_on)return a.drop_on(f,b,d,c);return}this.get_hole(k).widget_dropped_on_me(a,b,d,c);return!0};d.which_hole=function(a,b){var e=$(d.get_frontside_element()),c=e.offset(),e=e.width(),c=a.clientX-(c.left+e/2),e=b?e/10:0;return-c>e?0:c>e?1:-1};d.get_inactive_state=function(){return k};d.update_display=function(){var a=this.get_frontside_element(),b=$(a),d=$(a).children(".toontalk-scale-half"),c=$(a).parent(),c=c.is(".toontalk-backside")?a:c.get(0),e=$(c).width(),f=$(c).height(),
k=function(a,b,c){var d=(b.get_contents()||b).get_frontside_element(!0),h=c*e*.5,k=.5*e,g=f;b=b.get_contents();$(a).css({left:h,top:0,width:k,height:g});a!==d&&(h=0===c?-.05*e:.15*e,c="toontalk-scale-balanced"===p?.1*f:0===c&&"toontalk-scale-left_heavier"===p||1===c&&"toontalk-scale-right_heavier"===p?.25*f:1===c&&"toontalk-scale-left_heavier"===p||0===c&&"toontalk-scale-right_heavier"===p?-.1*f:.2*f,k=.4*e,g=.4*f,$(d).css({left:h,top:c,width:k,height:g}),b&&(b.set_location_attributes&&b.set_location_attributes(h,
c),b.set_size_attributes&&b.set_size_attributes(k,g)),a.appendChild(d))},m,p;b.is(".toontalk-top-level-resource")?p="toontalk-scale-balanced":(m=this.get_state(),p="undefined"===typeof m?"toontalk-scale-unbalanced":["toontalk-scale-right_heavier","toontalk-scale-balanced","toontalk-scale-left_heavier"][m+1]);b.removeClass("toontalk-scale-balanced toontalk-scale-left_heavier toontalk-scale-right_heavier toontalk-scale-unbalanced");b.addClass(p);b.addClass("toontalk-scale");b=g.UTILITIES.scale_to_fit(a,
c,123,91);0===e&&(e=1);0===f&&(f=1);e/=b.x_scale;f/=b.y_scale;2===d.length?d.each(function(a,b){g.UTILITIES.set_timeout(function(){k(b,this.get_hole(a),a)}.bind(this))}.bind(this)):this.get_holes().forEach(function(b,c){var d=b.get_element();0===c?$(d).addClass("toontalk-left_scale  toontalk-scale-half"):$(d).addClass("toontalk-right_scale toontalk-scale-half");k(d,b,c);a.appendChild(d)});g.UTILITIES.give_tooltip(a,this.get_title());g.debugging&&(this._debug_string=this.to_debug_string())};d.render=
function(){g.DISPLAY_UPDATES.pending_update(this)};d.get_type_name=function(a){return a?"scales":"scale"};d.get_help_URL=function(){return"docs/manual/scales.html"};d.toString=function(){var a=this.get_hole_contents(0),b=this.get_hole_contents(1),d,c,e;switch(this.get_state()){case -1:d="scale leaning to the right";break;case 1:d="scale leaning to the left";break;case 0:d="balanced scale";break;default:if(d="unbalanced scale",!c&&!e)return d}c=a?"contains "+g.UTILITIES.add_a_or_an(a.get_full_description()):
"is empty";e=b?"contains "+g.UTILITIES.add_a_or_an(b.get_full_description()):"is empty";return d+" and the left pan "+c+" and the right pan "+e};d.create_backside=function(){return g.scale_backside.create(this)};d.get_state=function(){var a=this.get_inactive_state(),b;if(a)return a;a=this.get_hole_contents(0);b=this.get_hole_contents(1);if(a||b)if(a){if(!b)return 1;if(a.compare_with)return a.compare_with(b)}else return-1};d.match=function(a){return a.match_with_scale?a.match_with_scale(this):this};
d.match_with_scale=function(a){return this.get_state()===a.get_state()?"matched":a};d.compare_with=function(a){if(a.compare_with_scale)return-1*a.compare_with_scale(this)};d.compare_with_scale=function(a){var b=this.get_state();a=a.get_state();return b&&!a?1:!b&&a?-1:b>a?1:b<a?-1:0};d.get_hole(0).add_listener("value_changed",f);d.get_hole(1).add_listener("value_changed",f);d.get_hole_contents(0)&&d.get_hole_contents(0).add_listener("value_changed",f);d.get_hole_contents(1)&&d.get_hole_contents(1).add_listener("value_changed",
f);d.get_custom_title_prefix=function(){var a=this.get_state(),b=this.get_hole_contents(0),d=this.get_hole_contents(1);if("undefined"===typeof a)return b&&d?"I can't compare "+b+" and "+d+".":"Use me to compare two things. Drop them in my pans.";b||(b="empty pan");d||(d="empty pan");return["The "+d+" is greater than the "+b+".","The "+d+" is equal to the "+b+".","The "+d+" is less than the "+b+"."][a+1]};g.debugging&&(d._debug_id=g.UTILITIES.generate_unique_id(),d._debug_string=d.to_debug_string());
return d};g.creators_from_json.scale=function(a,b){return m.create(g.UTILITIES.create_array_from_json(a.contents,b),a.description,void 0,a.inactive_state)};return m}(window.TOONTALK);window.TOONTALK.scale_backside=function(g){return{create:function(m){m=g.backside.create(m);m.add_advanced_settings(!0);return m}}}(window.TOONTALK);(function(){window.TOONTALK.robot=function(g){var m=function(a,b,f,m,e){var w;f.current_action_name=b;(a=g.path.get_path_to(a,f))?(m||(m={}),w=Date.now(),m.time=w-f.time_of_last_step,f.time_of_last_step=w,f.add_step(g.robot_action.create(a,b,m),e)):console.log("No path found for "+b);f.current_action_name=void 0},a=Object.create(g.widget),b=0;a.create=function(b,k,f,m,e,w,r,h,v){var c=Object.create(a),t,x,A,D=[],E=[],R,H,L;f||(f=g.actions.create());t||(t=c);c.is_robot=function(){return!0};c.get_frontside_conditions=
function(){return b};c.set_frontside_conditions=function(a){b=a;b.set_parent_of_frontside(this)};b&&b.set_parent_of_frontside(c);c.get_backside_conditions=function(){return k};c.set_backside_conditions=function(a){(k=a)&&g.UTILITIES.available_types.forEach(function(a){k[a]&&(g.widget.erasable(k[a]),k[a].set_parent_of_frontside(this))}.bind(this))};k&&c.set_backside_conditions(k);c.initialize_backside_conditions=function(){var a=this.get_context();L=g.UTILITIES.copy_widget_sides(a.get_backside_widgets(),
{just_value:!0,copy_covered_nests:!0});a.get_backside_widgets().forEach(function(a){a.is_backside()||(a.is_nest()&&a.dereference()!==a?this.add_to_backside_conditions(a):a.walk_children&&a.walk_children(function(b){return b.is_nest()&&!b.is_hole()&&b.dereference()!==b?(this.add_to_backside_conditions(a),!1):!0}.bind(this)))}.bind(this))};c.add_to_backside_conditions=function(a){var b,c;if(!(0<=this.get_newly_created_widgets().indexOf(a))){c=a.get_type_name();if(k){if(k[c])return}else k={};L.some(function(a){if(a.is_of_type(c))return b=
a,!0});b&&(k[c]=b,g.widget.erasable(b))}};c.get_body=function(){return f};c.get_running=function(){return R||this.is_ok_to_run()};c.running_or_in_run_queue=function(){return R};c.set_running_or_in_run_queue=function(a){R=a};c.stopped=function(){return H};c.set_stopped=function(a){if(H=a)this.visible()&&$(this.get_frontside_element()).removeClass("toontalk-robot-waiting"),R=!1;this.get_next_robot()&&this.get_next_robot().set_stopped(a)};c.finish_cycle_immediately=function(a){var b=A,c=function(){A=
b;this.set_visible(!1);a()}.bind(this);A=0;this.add_body_finished_listener(c)};c.get_maximum_step_duration=function(){return A};c.animate_consequences_of_actions=function(){return this.visible()&&0!==A};c.transform_step_duration=function(a){return void 0===a&&0===A?0:v&&a?a/v:"number"===typeof A?Math.min(a,A):a};c.transform_original_step_duration=function(a){if(!v)return a};c.transform_animation_speed=function(a){return v?a*v:a};c.set_animating=function(a,b){var c=this.get_frontside_element();a?(b||
(b=$(c).offset()),$(c).addClass("toontalk-robot-animating toontalk-side-animating"),$(c).css({width:"",height:"","z-index":g.UTILITIES.next_z_index()}),g.UTILITIES.set_position_relative_to_top_level_backside($(c),b),$(c).closest(".toontalk-top-level-backside").append(c)):$(c).removeClass("toontalk-robot-animating toontalk-side-animating")};c.add_body_finished_listener=function(a){D.push(a)};c.run_body_finished_listeners=function(a,b,c){D.forEach(function(d){d(a,b,c)});D=[]};c.add_watched_step_end_listeners=
function(a){E.push(a)};c.run_watched_step_end_listeners=function(){E.forEach(function(a){a()});E=[]};c.get_thing_in_hand=function(){return e};c.set_thing_in_hand=function(a){if(g.debugging){if(a&&"empty hole"===a.get_type_name()){g.UTILITIES.report_internal_error("Robot trying to pick up an empty hole.");return}g.logging&&0<=g.logging.indexOf("thing_in_hand")&&console.log(this.to_debug_string()+" now has in his hand "+(a?a.to_debug_string():"nothing"))}e=a};c.get_next_robot=function(){return r};c.set_next_robot=
function(a){var b=this.get_backside_element();a&&a.set_first_in_team(this.get_first_in_team());!a&&r&&(r.set_first_in_team(r),r.set_previous_robot(void 0));(r=a)&&r.set_previous_robot(this);b&&(a=a?"When the robot can't run then this one will try: ":window.TOONTALK.robot.empty_drop_area_instructions,$(b).find(".toontalk-drop-area-instructions").get(0).innerHTML=a)};c.get_previous_robot=function(){return x};c.set_previous_robot=function(a){x=a};c.get_first_in_team=function(){return t};c.set_first_in_team=
function(a){t=a;r&&r.set_first_in_team(a)};c.walk_children=function(a){var b;r&&!a(r)||!(b=this.get_frontside_conditions())||b.is_top_level()||a(b)};c.get_run_once=function(){return w};c.set_run_once=function(a){w=a;this.update_title();return!0};c.get_watched_speed=function(){return v};c.set_watched_speed=function(a){v=a;return!0};c.can_run=function(){return this.get_frontside_conditions()&&this.get_frontside_conditions().is_top_level()||g.widget.can_run.call(this)};c.training_started=function(a){var b=
this.get_context();b?this.being_trained||(this.time_of_last_step=Date.now(),this.being_trained=!0,this.set_frontside_conditions(b.copy({just_value:!0})),this.initialize_backside_conditions(),a||($("*").css({cursor:"url("+g.UTILITIES.absolute_file_path("images/RB19.32x32.PNG")+"), default"}),$(this.get_frontside_element()).addClass("toontalk-ghost_robot")),this.update_title(),a=this.get_backside_element(),$(a).find(".toontalk-conditions-panel").remove(),this.robot_training_this_robot()&&this.robot_training_this_robot().started_training_another(this)):
g.UTILITIES.report_internal_error("Robot started training but can't find its 'context'.")};c.training_finished=function(){if(this.being_trained){var a,b,c;a=this.get_body().get_newly_created_widgets();for(b=0;b<a.length;b++)c=a[b],"drop it on top-level"!==c.last_action&&"copy"!==c.last_action||this.add_step(g.robot_action.create(g.newly_created_widgets_path.create(b),"add to the top-level backside"));$(this.get_frontside_element()).removeClass("toontalk-ghost_robot");this.rerender();this.being_trained=
!1;this.update_title();this.backup_all();this.robot_finished_training();this.robot_in_training()?this.robot_in_training().finished_training_another(this):$("*").css({cursor:""})}};if(g.debugging||g.logging)c.to_debug_string=function(){return" ("+(this.get_description()||"")+" "+this.get_name()+")"};r&&c.set_next_robot(r);c=c.add_standard_widget_functionality(c);c.has_name(c);c.set_name(h);c.set_description(m);g.debugging&&(c._debug_id=g.UTILITIES.generate_unique_id(),c._debug_string=c.to_debug_string());
return c};a.create_backside=function(){return g.robot_backside.create(this)};a.copy=function(a){var b=this.get_frontside_conditions(),f=this.get_backside_conditions(),b=b?b.copy({just_value:!0}):void 0,m=this.get_next_robot(),m=m?m.copy(a):void 0,e;f&&(e={},g.UTILITIES.available_types.forEach(function(a){e[a]&&(e[a]=e[a].copy({just_value:!0}))}));f=this.create(b,e,this.get_body().copy(),this.get_description(),this.get_thing_in_hand(),this.get_run_once(),m,(!a||!a.fresh_copy)&&this.get_name(),this.get_watched_speed());
return this.add_to_copy(f,a)};a.match=function(a){var b;return a.is_robot()&&(b=this.get_body().is_empty(),a=a.get_body().is_empty(),b===a)?"matched":this};a.generate_name=function(){b++;return"#"+b.toString()};a.run=function(a,b,f){var m=this.get_frontside_conditions(),e,w,r,h;if(this.being_trained||this.running_or_in_run_queue())return this;h=function(a){a.visible()&&$(a.get_frontside_element()).removeClass("toontalk-conditions-not-matched toontalk-conditions-waiting").find(".toontalk-conditions-not-matched, .toontalk-conditions-waiting").removeClass("toontalk-conditions-not-matched toontalk-conditions-waiting")};
h(m);this.rerender();this.match_status=g.UTILITIES.match(m,a);"matched"===this.match_status&&(e=this.get_backside_conditions())&&((w=a.get_backside_widgets())&&w.some(function(a){var b=!a.is_backside()&&e[a.get_widget().get_type_name()];if(b&&(h(b),a=g.UTILITIES.match(b,a.get_widget()),"matched"!==a))return this.match_status=a,!0}.bind(this)),"matched"===this.match_status&&Object.keys(e).some(function(a){var b;if(e[a]&&(w.some(function(d){if(d.get_widget().is_of_type(a))return b=!0}),!b))return this.match_status=
e[a],!0}.bind(this)));if("matched"===this.match_status)return f||(f=g.QUEUE),this.get_body().reset_newly_created_widgets(),f.enqueue({robot:this,context:a,top_level_context:b,queue:f}),this.match_status;if(this.match_status.is_widget)return $(this.match_status.get_frontside_element()).addClass("toontalk-conditions-not-matched"),this.rerender(),this.get_next_robot()?this.get_next_robot().run(a,b,f):this.match_status;this.match_status.forEach(function(a){a[1]&&$(a[1].get_frontside_element()).addClass("toontalk-conditions-waiting")});
if(this.get_next_robot()){m=this.get_next_robot().run(a,b,f);if("matched"===m)return m;m.is_widget||m.forEach(function(a){0>this.match_status.indexOf(a)&&this.match_status.push(a)}.bind(this))}this.get_first_in_team()===this&&(r=function(){this.set_waiting(!1);this.run(a,b,f)}.bind(this),this.match_status.forEach(function(a){a[0]?a[0].run_when_non_empty(r,this):a.run_when_non_empty(r,this)}.bind(this)),this.set_waiting(!0));return this.match_status};a.set_waiting=function(a){var b=this.get_frontside_element();
a?(g.UTILITIES.add_animation_class(b,"toontalk-robot-waiting"),g.UTILITIES.give_tooltip(b,"This robot is waiting for a bird to deliver something.")):($(b).removeClass("toontalk-robot-waiting"),g.UTILITIES.give_tooltip(b,this.get_title()))};a.run_actions=function(a,b,f){return this.stopped()?(this.get_first_in_team().set_running(!1),!1):this.visible()?this.get_body().run_watched(a,b,f,this):this.get_body().run_unwatched(a,b,f,this)};a.drop_from_data_transfer=function(a,b){var f;a.is_top_level&&a.is_top_level()?
(f=a.get_backside_widgets().slice(),setTimeout(function(){f.forEach(function(a){this.picked_up(a,void 0,!0);this.time_of_last_step-=1E3;this.dropped_on(a,b.get_backside());this.time_of_last_step-=1E3}.bind(this))}.bind(this))):this.data_transfer=a};a.picked_up=function(a,b,f){var m,e;if(this!==a&&!(a.is_top_level()||b&&b.view.backside))return a.get_infinite_stack&&a.get_infinite_stack()?this.current_action_name="pick up a copy of":this.current_action_name="pick up",f?(e=a,b=a.copy({fresh_copy:!0}),
b=g.path.get_path_to_resource(b)):b=g.path.get_path_to(a,this),b&&(f=Date.now(),m={time:f-this.time_of_last_step},this.time_of_last_step=f,m=g.robot_action.create(b,this.current_action_name,m),this.add_step(m,e)),a.last_action=this.current_action_name,this.current_action_name=void 0,this.set_thing_in_hand(a),m};a.dropped_on=function(a,b){var f,m,e,w,r;if(this!==a&&(!this.get_parent_of_frontside()||this.get_parent_of_frontside().get_widget()!==a)){this.data_transfer&&(this.picked_up(this.data_transfer,
void 0,!0),this.data_transfer=void 0,this.time_of_last_step-=1E3);this.current_action_name="drop it on";if(f=g.path.get_path_to(b,this))b.is_backside()?(e=$(b.get_element()),m=e.offset(),w=e.width(),r=e.height(),e=$(a.get_frontside_element()).offset(),w=(e.left-m.left)/w,m=(e.top-m.top)/r,w=Math.max(0,Math.min(1,w)),m=Math.max(0,Math.min(1,m)),m={left_offset_fraction:w,top_offset_fraction:m}):m={},e=Date.now(),m.time=e-this.time_of_last_step,this.time_of_last_step=e,f=g.robot_action.create(f,this.current_action_name,
m),this.add_step(f);a.last_action=this.current_action_name+" "+b.get_type_name();this.current_action_name=void 0;this.set_thing_in_hand(void 0)}};a.dropped_on_text_area=function(a,b,f){m(a,"drop it on the text area of",this,f);a.last_action="drop it on the text area of "+b.get_type_name();this.set_thing_in_hand(void 0)};a.copied=function(a,b,f){f=f?"pick up a copy of":"copy";m(a,f,this,void 0,b);b.last_action=f};a.removed=function(a){var b;this.get_parent_of_frontside()&&(b=this.get_parent_of_frontside().get_widget());
m(a,"remove",this);a.last_action="remove";b===a||a===this?(this.add_to_top_level_backside(this.copy()),this.training_finished()):this.add_newly_created_widget_if_new(a)};a.edited=function(a,b){m(a,"edit",this,b)};a.erased_widget=function(a){m(a,"change whether erased",this)};a.resized_widget=function(a,b,f,g,e){b===g&&f===e||m(a,"change size of",this,{x_factor:g/b,y_factor:e/f})};a.started_training_another=function(a){m(a,"start training",this)};a.finished_training_another=function(a){m(a,"stop training",
this)};a.trained=function(a,b){m(a,"train",this,{step:b})};a.backside_opened=function(a){m(a,"open the backside",this)};a.backside_closed=function(a){m(a,"close the backside",this)};a.button_clicked=function(a,b){m(b.get_widget(),"click the button of",this,{button_selector:a})};a.created_widget=function(a,b,f){this.add_newly_created_widget(a);this.add_to_top_level_backside(a,!1);this.add_step(g.robot_action.create(g.path.get_path_to_resource(a.copy()),"add a new widget to the work space",{button_selector:f,
path_to_source:g.path.get_path_to(b,this)}))};a.get_newly_created_widgets=function(){return this.get_body().get_newly_created_widgets()};a.remove_from_container=function(a,b){var f=b.get_index_of&&a.get_parent_of_frontside()&&b.get_index_of(a),g=function(){b.removed_from_container(a,!1,!0,f,!1)};this.animate_consequences_of_actions()?this.add_watched_step_end_listeners(g):g();this.add_newly_created_widget_if_new(a)};a.add_step=function(a,b){this.get_body().add_step(a,b);this.update_title();"train"!==
a.get_action_name()&&"start training"!==a.get_action_name()&&this.robot_training_this_robot()&&this.robot_training_this_robot().trained(this,a)};a.get_context=function(){var a=this.get_frontside_element(),b=$(a).parent(),a=g.UTILITIES.widget_from_jquery(b);return!a&&(b=g.UTILITIES.widget_from_jquery(b.closest(".toontalk-backside-of-robot")))?b.get_context():a};a.update_display=function(){var a=this.get_frontside(!0);this.get_backside();var b=this.get_thing_in_hand(),f,m;g.debugging&&(this._debug_string=
this.to_debug_string());f=a.get_element();b&&(m=b.get_frontside_element());!m&&this.carrying_tool&&(m=document.createElement("div"),$(m).addClass(this.carrying_tool));g.UTILITIES.give_tooltip(f,this.get_title());$(f).addClass("toontalk-robot");$(f).children(".toontalk-side, .toontalk-held-by-robot").remove();m&&f.appendChild(m);this.match_status&&(this.match_status.is_widget?$(f).addClass("toontalk-side-animating toontalk-robot-not-matched"):$(f).removeClass("toontalk-robot-not-matched"));f.setAttribute("toontalk_name",
this.get_name());g.UTILITIES.set_timeout(function(){var a,d,g,h,v;m&&(v={position:"absolute"},$(m).addClass("toontalk-held-by-robot"),a=$(m).width(),$(m).height(),g=$(f).width(),h=$(f).height(),b&&0===a&&(a=b.get_default_width?b.get_default_width():2*g,d=b.get_default_height?b.get_default_height():h/2,v.width=a,v.height=d),v.left=(g-a)/2,v.top=h/4,$(m).css(v),b&&b.render())})};a.add_newly_created_widget=function(a){return this.get_body().add_newly_created_widget(a)};a.add_newly_created_widget_if_new=
function(a){if(a!==this.get_context()&&this!==a)return this.get_body().add_newly_created_widget_if_new(a)};a.is_newly_created=function(a){return this.get_body().is_newly_created(a)};a.get_recently_created_widget=function(){var a=this.get_body().get_newly_created_widgets();return a[a.length-1]};a.get_title=function(){var a=this.get_description();if(a)return a="I'm "+a,0>a.lastIndexOf(".")&&(a+="."),a+"\n"+this.toString();a=this.get_frontside_element();return $(a).is(".toontalk-top-level-resource")?
"Drag this robot to a work area.":this.toString()};a.toString=function(a){var b,f,m,e,w,r,h,v,c;if(a&&"conditions"===a.role)return"any robot";b=this.get_frontside_conditions();if(!b)return"an untrained robot";a||(a={});c=a.person;if(a&&a.resource){if(this.get_description())return'"'+this.get_description()+'"';a.person="third"}f=this.get_backside_conditions();e=this.get_body();r=w="";h=this.get_next_robot();b.is_top_level()?v="When the workspace's green flag "+g.UTILITIES.encode_HTML_for_title("<span class='toontalk-green-flag-icon'></span>")+
" is pressed":(b=g.UTILITIES.add_a_or_an(b.get_full_description({role:"conditions"})),v="When working on something that matches "+b);f&&(Object.keys(f).forEach(function(a){var b=f[a];b&&(v+=" and\nif on the back is "+g.UTILITIES.add_a_or_an(a)+" that matches "+g.UTILITIES.add_a_or_an(b.get_full_description({role:"conditions"})));m=!0}),m&&(v+="\n"));if(this.being_trained){if(e.is_empty())return"I'm ready to be trained. Show me what to do and then click on my 'Stop training' button.";w="is being trained.\n";
r="\n..."}e=w+v+(a&&"third"===a.person?" he will ":" I will ")+(this.get_run_once()?"":"repeatedly ")+"\n"+(e.toString({robot:this})||"do nothing")+r;if(a&&a.resource)return a.person=c,e.replace(/\n/g," ");this.match_status&&(this.match_status.is_widget?e="I'm not running because the "+this.match_status+" in my conditions (highlighted in red) doesn't match the corresponding widget. Perhaps editing my conditions will help.\n"+e:"matched"!==this.match_status&&(e="I'm waiting for something to be delivered to the nest that matches the "+
this.match_status[0][1]+" in my conditions (highlighted in yellow).\n"+e));h&&(e+="\nIf it doesn't match then the next robot will try to run.\n"+h.toString());return e};a.get_type_name=function(a){return a?"robots":"robot"};a.maintain_proportional_dimensions=function(){return!0};a.matching_resource=function(a){return a.is_robot()&&!this.get_frontside_conditions()&&!a.get_frontside_conditions()&&this.get_body().is_empty()&&a.get_body().is_empty()};a.get_top_level_context_description=function(a){var b=
this.get_frontside_conditions().get_type_name();return"top-level"===b?a&&"third"===a.person?"his workspace":"my workspace":a&&"third"===a.person?"the "+b+" he's working on":"the "+b+" I'm working on"};a.get_help_URL=function(){return"docs/manual/robots.html"};a.get_json=function(a){var b=this.get_frontside_conditions(),f=this.get_backside_conditions(),m,e,w;b&&(m=b.is_top_level()?{type:"top_level"}:g.UTILITIES.get_json(b,a));f&&g.UTILITIES.available_types.forEach(function(b){f[b]&&(e||(e={}),e[b]=
g.UTILITIES.get_json(f[b],a))});this.get_next_robot()&&(w=g.UTILITIES.get_json(this.get_next_robot(),a));return{type:"robot",frontside_conditions:m,backside_conditions:e,body:this.get_body().get_json(a),run_once:this.get_run_once(),next_robot:w,name:this.get_name(),speed:this.get_watched_speed()}};g.creators_from_json.robot=function(a,b){var f,m,e;a.thing_in_hand&&(m=g.UTILITIES.create_from_json(a.thing_in_hand,b));a.next_robot&&(f=g.UTILITIES.create_from_json(a.next_robot,b));a.backside_conditions&&
(e={},g.UTILITIES.available_types.forEach(function(f){var m=g.UTILITIES.create_from_json(a.backside_conditions[f],b);m&&(e[f]=m)}));return g.robot.create(g.UTILITIES.create_from_json(a.frontside_conditions||a.bubble,b),e,g.UTILITIES.create_from_json(a.body,b),a.description,m,a.run_once,f,a.name,a.speed)};a.find_conditions_path=function(a,b,f){var m=b.get_frontside_conditions(),e=m===a?"entire_condition":m.get_path_to&&m.get_path_to(a,f),m=g.path.get_path_to(b,f),w,r;e||(w=b.get_backside_conditions(),
g.UTILITIES.available_types.some(function(b){w[b]&&(e=w[b].get_path_to(a,f))&&(r=b)}));if(e)return g.robot.create_conditions_path(e,m,r);g.UTILITIES.report_internal_error("Robot has widget in its conditions but unable to construct the path.")};a.create_conditions_path=function(a,b,f){return{dereference_path:function(m,e,w){m=g.path.dereference_path(b,m,e,w);m=f?m.get_backside_conditions()[f]:m.get_frontside_conditions();return"entire_condition"===a?m:g.path.dereference_path(a,m,e,w)},toString:function(){var m=
"entire_condition"===a?"the ":g.path.toString(a)+" of the ";return f?m+f+" backside condition of "+g.path.toString(b):m+" front side condition of "+g.path.toString(b)},get_json:function(){return{type:"path_to_robot_conditions",backside_conditions_type:f,path_to_robot:b.get_json(),path_within_conditions:"entire_condition"===a?"entire_condition":a.get_json()}}}};g.creators_from_json.path_to_robot_conditions=function(a){var b=g.UTILITIES.create_from_json(a.path_to_robot),f="entire_condition"===a.path_within_conditions?
a.path_within_conditions:g.UTILITIES.create_from_json(a.path_within_conditions);return g.robot.create_conditions_path(f,b,a.backside_conditions_type)};return a}(window.TOONTALK);window.TOONTALK.robot_backside=function(g){var m=function(a,d,k,f){a=g.UTILITIES.create_text_element(a);var m=d.get_frontside_element(!0),e=document.createElement("div");$(m).addClass("toontalk-conditions-contents "+f);g.UTILITIES.set_timeout(function(){$(m).parent().addClass("toontalk-conditions-contents-container");$(m).css({left:"inherit",
width:"inherit",height:"inherit"});d.render()});k.match_status&&(k.match_status.is_widget?$(k.match_status.get_frontside_element()).addClass("toontalk-conditions-not-matched"):"matched"!==k.match_status&&k.match_status.forEach(function(a){$(a[1].get_frontside_element()).addClass("toontalk-conditions-waiting")}));e.appendChild(m);k=g.UTILITIES.create_horizontal_table(a,e);$(k).addClass("toontalk-conditions-panel");return k},a=function(a,d){var k=d.get_frontside_conditions(),f=d.get_backside_conditions(),
p=d.visible(),e,w;k&&(k.is_top_level()?0>a.firstChild.textContent.indexOf("This robot always runs when the green flag")&&a.insertBefore(g.UTILITIES.create_text_element("This robot always runs when the green flag <span class='toontalk-green-flag-icon'></span> is clicked."),a.firstChild):0===$(a).find(".toontalk-frontside-conditions-area").length&&a.insertBefore(m("Runs only if the widget matches: ",k,d,"toontalk-frontside-conditions-area"),a.firstChild),k.set_visible(p),k.rerender());f&&Object.keys(f).forEach(function(k){if(e=
f[k])w="toontalk-backside-"+k+"-conditions-area",0===$(a).find("."+w).length&&(k="bird"===k?g.UTILITIES.create_text_element("And there is a bird on the back."):m("Runs only if the "+k+" on the backside matches: ",e,d,w),a.insertBefore(k,a.firstChild.nextSibling),e.set_visible(p),e.rerender())})};return{create:function(b){var d=g.backside.create(b),k=d.get_element(),f=function(a){return a?"Check this if you want the robot to start over again after finishing what he was trained to do.":"Uncheck this if you want the robot to stop after finishing what he was trained to do."},
m=g.UTILITIES.create_check_box(!b.get_run_once(),"toontalk-run-once-check-box","When finished start again",f(b.get_run_once())),e="normal;original;double;half;very fast;very slow".split(";"),w=[1,void 0,2,.5,10,.25],r=function(a){a=e.indexOf(a);return w[a]},h=g.UTILITIES.create_select_menu("robot_speed",e,"toontalk-select-function","  What speed should I run at? ","Click to select the speed I'll run when watched.","The normal speed for each step;The original delay between steps when I was trained;Double the normal speed;Half the normal speed;Ten times normal speed;One-fourth of normal speed".split(";")),
v=g.UTILITIES.create_drop_area(window.TOONTALK.robot.empty_drop_area_instructions),c=b.get_next_robot(),t=g.backside.create_advanced_settings_button(d,b),x=d.update_display.bind(d),A=function(a,c){setTimeout(function(){var d=a.get_frontside_element(b.visible()),e,f;a.get_default_width&&(e=a.get_default_width(),f=a.get_default_height(),$(d).css({left:"",top:"",width:e,height:f}));c.appendChild(d)})};v.data("drop_area_owner",b);$(m.button).click(function(a){var c=m.button.checked;b.set_run_once(!c);
g.UTILITIES.give_tooltip(m.container,f(!c));b.robot_in_training()&&b.robot_in_training().edited(b,{setter_name:"set_run_once",argument_1:!c,toString:"change to "+(c?"run again":"run once")+" of the robot",button_selector:".toontalk-run-once-check-box"});a.stopPropagation()});h.menu.value=function(a){a=a?w.indexOf(a):1;return e[a]}(b.get_watched_speed());h.menu.addEventListener("change",function(a){b.set_watched_speed(r(a.target.value))});c&&A(c,v.get(0));v.get(0).addEventListener("drop",function(a){a=
g.UTILITIES.get_dragee();(a=g.UTILITIES.widget_from_jquery(a))&&a.is_robot()&&(a.get_body().is_empty()?(a=a.open_backside(),$(a.get_element()).find(".toontalk-train-backside-button").click()):(A(a,v.get(0)),b.set_next_robot(a)))});d.update_display=function(){var a=b.get_frontside_element();a&&g.UTILITIES.give_tooltip(a,b.get_title());x()};k.appendChild(this.create_train_button(d,b));k.appendChild(t);$(m.container).addClass("toontalk-advanced-setting");$(h.container).addClass("toontalk-advanced-setting");
v.addClass("toontalk-advanced-setting");k.appendChild(m.container);k.appendChild(h.container);k.appendChild(v.get(0));a(k,b);d.add_advanced_settings();return d},create_train_button:function(b,d){var k=b.get_element();$(k);var f=$("<button>Train</button>").button();f.addClass("toontalk-train-backside-button");var m=!1;b.change_label_and_title_of_train_button=function(b){b?(f.button("option","label","Stop training "+d.get_name()),g.UTILITIES.give_tooltip(f.get(0),"Click to stop training this robot.")):
d.get_body().is_empty()?(f.button("option","label","Train"),g.UTILITIES.give_tooltip(f.get(0),"Click to start training this robot.")):(f.button("option","label","Re-train "+d.get_name()),g.UTILITIES.give_tooltip(f.get(0),"Click to start training this robot all over again."));$(k).is(":visible")&&a(k,d)};b.change_label_and_title_of_train_button(m);f.click(function(a){m=!m;b.change_label_and_title_of_train_button(m);m?(d.get_body().reset_steps(),d.robot_started_training(d),d.training_started()):d.training_finished();
a.stopPropagation()});return f.get(0)}}}(window.TOONTALK);window.TOONTALK.robot.empty_drop_area_instructions="Drop a robot here who will try to run when I can't."})();(function(){var g=function(a){return"rotate"===a||"skewX"===a||"skewY"===a||"transform-origin-x"===a||"transform-origin-y"===a},m=function(a){return"transform-origin-x"===a||"transform-origin-y"===a?"https://developer.mozilla.org/en-US/docs/Web/CSS/transform-origin#"+a:g(a)?"https://developer.mozilla.org/en-US/docs/Web/CSS/transform#"+a:"http://www.w3.org/community/webed/wiki/CSS/Properties/"+a};window.TOONTALK.element=function(a){var b=["left","top","width","height"],d=Object.create(a.widget),k=
function(a,b){var d,g;if(!a)return 0;"number"===typeof a&&(g=a);0===a.length&&(g=0);if("undefined"===typeof g&&(d=a.substring(a.length-1),0<="0123456789x".indexOf(d)&&(g=parseFloat(a),isNaN(g))))return;d=g;0<=["rotate","skewX","skewY"].indexOf(b)&&(d%=360,0>d&&(d+=360));return d};d.create=function(b,k,e,m,r){var h=Object.create(d),v=a.UTILITIES.generate_unique_id(),c=h.drag_started,t={},x={},A,D,E,R,H,L,J,K,C,F,P,l;k||(k=[]);m&&(A="string"===typeof m?new Audio(m):m);h.is_element=function(){return!0};
h.get_HTML=function(){return E};h.get_guid=function(){return v};h.get_text=function(){var a=this.get_frontside_element().textContent;""===a&&(this.update_display(),a=this.get_frontside_element().textContent);return""===a?this.get_HTML():a};h.set_HTML=function(a){var b=this.get_frontside_element(),c=function(a){for(var b=0;;){b=a.indexOf("<a ",b);if(0>b)break;b+=3;a=a.substring(0,b)+"target='_blank' "+a.substring(b)}return a}.bind(this);if(!b||E===a)return!1;E=c(a);$(b).children(":not(.ui-resizable-handle)").remove();
this.is_plain_text_element()?b.innerHTML=E.replace(/ /g,"&nbsp;"):b.innerHTML=E;R&&(this.compute_original_dimensions(!0),this.rerender());return!0};h.set_HTML_from_sub_classes=h.set_HTML;h.set_text=function(a){var b=this.get_frontside_element(),c=function(b){$(b).contents().each(function(){this.nodeType==Node.TEXT_NODE?(this.textContent=a,a=""):c(this,a)})};if(!b||a===b.textContent)return!1;if($(b).is(".toontalk-plain-text-element"))return this.set_HTML(a);c(b);return this.set_HTML(b.innerHTML)};
h.get_style_attributes=function(){return k};h.set_style_attributes=function(a){k=a};h.get_attribute_widgets_in_backside_table=function(){return t};h.get_original_copies=function(){return x};h.get_pending_css=function(){return C};h.get_transform_css=function(){return F};h.add_to_css=function(a,b){g(a)?(F||(F={}),F[a]=b):(C||(C={}),C[a]=b)};h.apply_css=function(){var b="",c,d,e;if((C||F)&&(c=this.get_frontside_element())&&!$(c).is(".toontalk-not-observable"))if($(c).is(":visible")){C?(C.width&&(J=C.width),
C.height&&(K=C.height)):C={};F&&("number"===typeof F.rotate&&(b+="rotate("+F.rotate+"deg)"),"number"===typeof F.skewX&&(b+="skewX("+F.skewX+"deg)"),"number"===typeof F.skewY&&(b+="skewY("+F.skewY+"deg)"),"number"===typeof F["transform-origin-x"]||"number"===typeof F["transform-origin-y"])&&(C["transform-origin"]=(F["transform-origin-x"]||0)+" "+(F["transform-origin-y"]||0));if(C.left||C.top)C.left&&(d=$(this.get_parent_of_frontside().get_element()),e=d.width(),C.left=(C.left%e+e)%e),C.top&&(d||(d=
$(this.get_parent_of_frontside().get_element())),d=d.height(),C.top=(C.top%d+d)%d);J||K?(l&&l.css({width:H,height:L}),$(c).css({width:"",height:""}),a.UTILITIES.run_when_dimensions_known(c,function(d){a.UTILITIES.scale_element(c,J,K,H,L,b,C,d);C=void 0})):(a.UTILITIES.add_transform_to_css(b,"",C,0>c.parentElement.className.indexOf("toontalk-box-hole")),$(c).css(C),C=void 0)}else a.UTILITIES.set_timeout(function(){this.apply_css()}.bind(this),100)};h.on_update_display=function(a){P?P.push(a):P=[a]};
h.fire_on_update_display_handlers=function(){P&&a.UTILITIES.set_timeout(function(){P.forEach(function(a,b){a()||P.splice(b,1)})})};h.get_image_element=function(){return l};h.set_image_element=function(a,b){l=$(a).find("img");0===l.length?l=void 0:($(b).width(l.width()),$(b).height(l.height()))};h.get_additional_classes=function(){return r};h.set_additional_classes=function(a){r=a};h.set_sound_effect=function(a){A=a};h.get_sound_effect=function(){return A};h.get_source_URL=function(){return D};h.set_source_URL=
function(a){if(D!==a)return D=a,this.refresh(),!0};h=h.add_standard_widget_functionality(h);h.drag_started=function(a,b){this.drag_x_offset=a.view.drag_x_offset;this.drag_y_offset=a.view.drag_y_offset;c.call(this,a,b)};h.update_display=function(){var b=this.get_frontside_element();this.get_backside();var c=function(a){return this.get_image_element()?"image":$(a).is(".toontalk-plain-text-element")?"text":"element"}.bind(this);if(!this.being_dragged)if(this.get_erased()){var d;d=$(b).parent(".toontalk-backside").is("*")?
c="":c="100%";this.save_dimensions();$(b).removeClass().empty().addClass("toontalk-erased-element toontalk-side").css({width:c,height:d,transform:""});$(b).parent(".toontalk-conditions-contents-container").is("*")?a.UTILITIES.give_tooltip(b,"This is an element that has been erased. It will match any element."):a.UTILITIES.give_tooltip(b,"This is an erased element. It will replace its HTML with the HTML of the element you drop on it.")}else $(b).is(".toontalk-erased-element")&&($(b).removeClass("toontalk-erased-element"),
this.restore_dimensions()),this.initialize_element(),a.UTILITIES.on_a_nest_in_a_box(b)&&(this.set_attribute("width",$(b).closest(".toontalk-box-hole").width(),!1),this.set_attribute("height",$(b).closest(".toontalk-box-hole").height(),!1)),"undefined"===typeof H&&b.parentElement&&this.compute_original_dimensions(),this.apply_css(),this.fire_on_update_display_handlers(),a.UTILITIES.give_tooltip(b,"Click to see the backside where you can place robots or change the style of this "+c(b)+".")};h.initialize_element=
function(){var a=this.get_frontside_element();$(a).children(".ui-resizable-handle");var b;R||(E=this.get_HTML(),b=this.is_plain_text_element(),a.innerHTML=b?E.replace(/ /g,"&nbsp;"):E,$(a).addClass("toontalk-element-frontside"),b&&((b=this.get_additional_classes())&&$(a).addClass(b),$(a).addClass("ui-widget toontalk-plain-text-element")),R=!0)};h.is_plain_text_element=function(){var a=this.get_HTML();return a&&"<"!==a[0]&&">"!==a[a.length-1]};h.compute_original_dimensions=function(b){a.UTILITIES.original_dimensions(this,
function(a,b){var c=this.get_parent_of_frontside();H=a;L=b;c&&c.get_box?c.get_box().rerender():this.rerender()}.bind(this),b)};h.get_attribute_from_current_css=function(a){var b,c;if("width"===a&&(J||H))return J||H;if("height"===a&&(K||L))return K||L;b=this.get_frontside_element();c=b.style[a];""===c&&(c=$(b).css(a));return c?"number"===typeof c?c:c.replace("px",""):0};h.get_original_width=function(){return H};h.get_original_height=function(){return L};h.increment_width=function(a){this.set_attribute("width",
(J||H)+a)};h.increment_height=function(a){this.set_attribute("height",(K||L)+a)};h.set_HTML(b.toString());h.set_description(e);a.debugging&&(h._debug_id=a.UTILITIES.generate_unique_id(),h._debug_string=h.to_debug_string());return h};d.copy=function(a){var b=this.get_style_attributes(),e=d.create(this.get_HTML(),b.slice(),this.get_description(),this.get_sound_effect());e.set_source_URL(this.get_source_URL());a&&(a.elements_copied||(a.elements_copied={}),a.elements_copied[this.get_guid()]=e);b.forEach(function(a){e.set_attribute(a,
this.get_attribute(a))}.bind(this));return this.add_to_copy(e,a)};d.match=function(a){return this.get_erased&&this.get_erased()?a.match_with_any_element?a.match_with_any_element():this:a.match_with_another_element_widget?a.match_with_another_element_widget(this):this};d.match_with_any_element=function(){return"matched"};d.match_with_another_element_widget=function(a){var b;if(this.get_HTML()===a.get_HTML())return"matched";b=a.get_text();return""!==b&&b===this.get_text()?"matched":a};d.compare_with=
function(a){if(a.compare_with_other_element)return a.compare_with_other_element(this)};d.compare_with_other_element=function(a){a=a.get_HTML().localeCompare(this.get_HTML());return 0>a?-1:0<a?1:a};d.widget_dropped_on_me=function(a,b,d,g){if(this.get_erased()&&a.get_HTML)return this.set_HTML(a.get_HTML()),this.set_erased(!1),a.remove(),!0;console.log("Dropping widgets on un-erased elements does nothing (but may someday)")};d.create_backside=function(){return a.element_backside.create(this)};d.get_attribute_from_pending_css=
function(a){var b=this.get_pending_css();if(b&&b[a]||(b=this.get_transform_css())&&b[a])return b[a]};d.get_attribute=function(a){var b=this.get_attribute_from_pending_css(a);return"undefined"!==typeof b?b:this.get_attribute_from_current_css(a)};d.set_attribute=function(a,b,d,g){var m,h;if(!this.get_frontside(!0).get_element())return!1;m=this.get_attribute_from_pending_css(a);if(m===b||"undefined"===typeof m&&(m=this.get_attribute_from_current_css(a),m===b))return!1;h=k(b,a);if("number"===typeof h){if(m==
h)return!1;b=h}d&&this.robot_in_training()&&this.robot_in_training().edited(this,{setter_name:"set_attribute",argument_1:a,argument_2:b,toString:"change the '"+a+"' style to "+b+" of",button_selector:".toontalk-element-"+a+"-attribute-input"});this.add_to_css(a,b);g&&(b=this.get_style_attributes(),0>b.indexOf(a)&&b.push(a));this.rerender();return!0};d.dropped_on_style_attribute=function(a,b,d,g){var k,h,m;if(a){k=a.toString();if(a.is_number()){h=this.get_attribute(b);if("number"===typeof h)m=h;else if("auto"===
h)switch(b){case "left":m=$(this.get_frontside_element()).offset().left;break;case "top":m=$(this.get_frontside_element()).offset().top;break;default:m=0}else m=parseFloat(h);h=a.to_float();switch(k.substring(0,1)){case "-":k=m-h;break;case "*":k=m*h;break;case "/":k=m/h;break;case "^":k=Math.pow(m,h);break;default:k=m+h}this.set_attribute(b,k,!1);(d||g&&g.visible())&&this.get_backside().render()}a.get_infinite_stack()||a.remove();d&&this.robot_in_training()&&this.robot_in_training().dropped_on(a,
this.create_attribute_widget(b))}};d.get_attribute_widget_in_backside_table=function(a,b){var d=this.get_attribute_widgets_in_backside_table()[a];d||b||(d=this.create_attribute_widget(a),this.get_attribute_widgets_in_backside_table()[a]=d);return d};d.create_attribute_widget=function(d){var g=".toontalk-element-"+d+"-attribute-input",e=this.get_backside_element(),k=this.get_attribute(d),r=this,h=function(b,c){var d=c.toString,e=c.equals;D=c.update_display;c.element_widget=this;c.attribute=b;c.get_type_name=
function(a){return a?"element attributes":"element attribute"};c.toString=function(){return d.call(this)+" ("+this.attribute+" of this.element_widget)"};c.get_custom_title_prefix=function(){return"I'm the '"+this.attribute+"' attribute of "+this.element_widget+".\nDrop a number on me or edit my back side to change my value. My back side has an info button to learn more."};c.equals=function(a){return b===a.attribute?this.equals(a.element_widget):e.call(this,a)};c.update_display=function(){var a;this.get_erased()||
(a=this.get_attribute_owner().get_attribute(this.attribute),A(a));D.call(this)};c.copy=function(a){var c;if(a){if(a.just_value)return x(a);a.elements_copied&&(c=a.elements_copied[r.get_guid()])}return this.add_to_copy((c||r).create_attribute_widget(b),a)};c.get_json=function(c){return{type:"attribute_widget",attribute_name:b,element:a.UTILITIES.get_json(r,c)}};c.get_original_attribute_widget=function(){return r.get_original_copies()[b][0]};c.get_attribute_owner=function(){var a=function(b){if(b=b.get_parent_of_frontside())return b.is_backside()?
b:a(b.get_widget())},b=this.get_original_attribute_widget();if(b!==this)return b.get_attribute_owner();var c,b=a(this);if(!b||!b.get_widget().is_element())return r;b=b.get_widget();for(c=b.get_parent_of_backside();c&&c.get_widget().is_element();)b=c.get_widget(),c=b.get_parent_of_backside();return b};c.get_help_URL=function(){return m(b)}}.bind(this),v=function(b,c){var d=a.number.create(0,1);h(b,d);d.set_value_from_decimal(c);d.set_format("decimal");d.set_value=function(a){var c=r.get_original_copies()[b];
a=bigrat.toDecimal(a);var d,e;this.get_attribute_owner().set_attribute(this.attribute,a)&&(e=bigrat.fromDecimal(a),c.forEach(function(a,b){d=a.set_value_from_sub_classes(e,!0)}));return d};d.is_attribute_widget=function(){return!0};return d}.bind(this),c=function(b,c){var d=a.element.create(c);h(b,d);d.set_HTML=function(a){var c=r.get_original_copies()[b],d;this.get_attribute_owner().set_attribute(this.attribute,a)&&c.forEach(function(b,c){d=b.set_HTML_from_sub_classes(a)});return d};d.set_additional_classes("toontalk-string-attribute-widget");
return d}.bind(this),t;t=0<=["background-color","color"].indexOf(d)?"string":"number";var x,A,D,E;e&&(g=$(e).find(g),0<g.length&&(g.get(0).toontalk_widget=this));if("number"===t){if(E=v(d,k),A=E.set_value_from_decimal.bind(E),x=a.number.copy.bind(E),0<=b.indexOf(d)&&(this.on_update_display(function(){E.rerender();return!0}),"left"===d||"top"===d))v=function(a){var b=E.get_attribute_owner(),c;a.currentTarget.toontalk_widget===b&&(c=$(b.get_frontside_element()).closest(".toontalk-top-level-backside").offset(),
c||(console.log("Unable to find top-level backside of an element for its position. Perhaps is 'visible' but not attached."),c={left:0,top:0}),a="left"===d?a.pageX-c.left-b.drag_x_offset:a.pageY-c.top-b.drag_y_offset,E.set_value_from_decimal(a),D.call(E))}.bind(this),k=this.get_frontside_element(),k.addEventListener("drag",v)}else if("string"===t)E=c(d,k),A=E.set_HTML.bind(E),x=a.element.copy.bind(E);else{a.UTILITIES.report_internal_error("Unrecognized attribute type: "+t+" for "+d);return}(k=this.get_original_copies()[d])?
k.push(E):this.get_original_copies()[d]=[E];return E};a.creators_from_json.attribute_widget=function(b,d){return a.UTILITIES.create_from_json(b.element,d).create_attribute_widget(b.attribute_name)};a.creators_from_json.attribute_number=a.creators_from_json.attribute_widget;d.on_backside_hidden=function(){this.get_style_attributes().forEach(function(a){(a=this.get_attribute_widget_in_backside_table(a,!0))&&a.set_visible(!1)}.bind(this))};d.toString=function(a){if(a&&("conditions"===a.role||a.plain_text))a=
'"'+this.get_text()+'"';else{a=this.get_HTML();var b;1<a.length&&"<"===a.charAt(0)?(b=a.indexOf(" "),a=a.substring(0,b+1)+"style='width: 50px; height: 30px;'"+a.substring(b)):a='"'+a+'"'}return"the element "+a};d.get_type_name=function(a){return a?"elements":"element"};d.get_help_URL=function(){return"docs/manual/elements.html"};d.get_json=function(b){var d=this.get_style_attributes(),e=[],g=a.UTILITIES.remove_z_index(this.get_HTML()),k=encodeURIComponent(g);0===g.indexOf("<img src='data:image/")?
(b.shared_html||(b.shared_html=[]),g=b.shared_html.indexOf(k),0>g&&(g=b.shared_html.push(k)-1),b={shared_html_index:g}):b=k;d.forEach(function(a){e.push(a)});return{type:"element",html:b,attributes:e,attribute_values:e.map(this.get_attribute.bind(this)),additional_classes:this.get_additional_classes(),sound_effect:this.get_sound_effect()&&this.get_sound_effect().src,source_URL:this.get_source_URL()}};a.creators_from_json.element=function(a,b){var e=decodeURIComponent("string"===typeof a.html?a.html:
b.shared_html[a.html.shared_html_index]),g=d.create(e,a.attributes,a.description,a.sound_effect),m;m=b&&b.event?["left","top"]:[];a.attribute_values.forEach(function(b,d){var c=a.attributes[d];0>m.indexOf(c)&&g.add_to_css(c,k(b)||b)});a.additional_classes&&g.set_additional_classes(a.additional_classes);a.source_URL&&(g.set_source_URL(a.source_URL),g.refresh());return g};d.create_attribute_path=function(b,d){var e=a.path.get_path_to(b.element_widget,d);return this.extend_attribute_path(e,b.attribute)};
d.refresh=function(){this.get_source_URL()&&a.UTILITIES.create_widget_from_URL(this.get_source_URL(),function(a){a&&this.set_HTML(a.get_HTML())}.bind(this))};d.extend_attribute_path=function(a,b){return{dereference_path:function(d,g,k){return a.dereference_path(g||d,void 0,k).get_attribute_widget_in_backside_table(b)},toString:function(){return"the '"+b+"' property of "+a},get_json:function(){return{type:"path_to_style_attribute",attribute:b,element_widget_path:a.get_json()}}}};a.creators_from_json.path_to_style_attribute=
function(b){var g=a.UTILITIES.create_from_json(b.element_widget_path);return d.extend_attribute_path(g,b.attribute)};d.set_size_attributes=function(b,d,e){e?(this.add_to_css("width",b),this.add_to_css("height",d)):(this.set_attribute("width",b),this.set_attribute("height",d));a.UTILITIES.set_timeout(function(){this.rerender()}.bind(this))};d.set_location_attributes=function(a,b){this.set_attribute("left",a);this.set_attribute("top",b)};d.receive_HTML_from_dropped=function(a){a=a.get_text&&a.get_text();
if(this.set_HTML(a))return this.get_text()};d.receive_URL_from_dropped=function(a){a=a.get_text();if(this.set_source_URL(a))return this.get_source_URL()};d.add_style_attribute=function(a){var b=this.get_style_attributes();0>b.indexOf(a)&&(b.push(a),"left"===a?(a=this.get_frontside_element(),$(a).on("drag",function(a){var b=this.get_backside_element(),d=this.get_frontside_element();b&&d&&$(b).find(".toontalk-element-left-attribute-input").val(a.originalEvent.clientX)})):"top"===a&&(a=this.get_frontside_element(),
$(a).on("drag",function(a){var b=this.get_backside_element(),d=this.get_frontside_element();b&&d&&$(b).find(".toontalk-element-top-attribute-input").val(a.originalEvent.clientY)})));return!0};d.remove_style_attribute=function(a){var b=this.get_style_attributes();a=b.indexOf(a);0<=a&&(b.splice(a,1),update_style_attribute_chooser(attributes_chooser,this,attribute_table));return!0};return d}(window.TOONTALK);window.TOONTALK.element_backside=function(a){var b=function(b,g,e){var k=function(b,f,c){var g=
0<=c.get_style_attributes().indexOf(b),k=a.UTILITIES.create_check_box(g,"toontalk-style-attribute-check-box",b+"&nbsp;","Click to add or remove the '"+b+"' style attribute from my backside."),p="toontalk-style-attribute-check-box-for-"+b,g=a.UTILITIES.create_anchor_element("i",m(b)),r=document.createElement("li");$(g).addClass("toontalk-help-button notranslate toontalk-attribute-help-button");$(g).css({color:"white"});g.translate=!1;g.lang="en";k.container.appendChild(g);$(k.button).addClass(p);k.button.addEventListener("click",
function(a){k.button.checked?c.add_style_attribute(b):c.remove_style_attribute(b);d(e,c,c.get_backside());c.robot_in_training()&&c.robot_in_training().edited(c,{setter_name:k.button.checked?"add_style_attribute":"remove_style_attribute",argument_1:b,toString:(k.button.checked?"add":"remove")+" a widget for the "+b+" attribute of",button_selector:"."+p})});r.appendChild(k.container);f.appendChild(r)},r=function(a,b,c){var d,e;"string"===typeof a?k(a,b,c):a.label?(d=document.createElement("h3"),d.textContent=
a.label,e=document.createElement("ul"),b.appendChild(d),b.appendChild(e),r(a.sub_menus,e,c)):a.forEach(function(a){r(a,b,c)})};$(b).is(".ui-accordion")&&$(b).accordion("destroy");$(b).empty();r([{label:"Geometry attributes",sub_menus:"left top width height z-index background-position".split(" ")},{label:"Color attributes",sub_menus:["background-color","color","opacity"]},{label:"Font attributes",sub_menus:["font-size","font-weight"]},{label:"Visibility",sub_menus:["display","visibility"]},{label:"Transformations",
sub_menus:["rotate","skewX","skewY","transform-origin-x","transform-origin-y"]}],b,g);$(b).accordion({active:0,heightStyle:"content"});return b},d=function(b,d,e){if(e.visible()){var g=d.get_style_attributes();d.get_frontside_element();$(b).empty();g.forEach(function(g){d.get_attribute(g);var h=document.createElement("tr"),k=document.createElement("td"),c=d.get_attribute_widget_in_backside_table(g),m=c.get_frontside_element();c.set_parent_of_frontside(e,!1,!0);c.set_infinite_stack(!0);b.appendChild(h);
h.appendChild(k);k.appendChild(a.UTILITIES.create_text_element(g));k=document.createElement("td");h.appendChild(k);c.set_visible(!0);$(m).addClass("toontalk-element-attribute");k.appendChild(m);c.render()})}},g=function(b,d){var e=$("<button>Add or remove my style attributes</button>").button();e.addClass("toontalk-show-attributes-chooser-button");e.click(function(g){$(b).is(":visible")?($(b).hide(),e.button("option","label","Add or remove my style attributes"),a.UTILITIES.give_tooltip(e.get(0),"Click to add widgets for my style attributes.")):
($(b).show(),e.button("option","label","Hide my style attributes list"),a.UTILITIES.give_tooltip(e.get(0),"Click to hide my list of attributes that can be added or removed."));d.robot_in_training()&&d.robot_in_training().button_clicked(".toontalk-show-attributes-chooser-button",d)});a.UTILITIES.give_tooltip(e.get(0),"Click to add widgets for my style attributes.");return e.get(0)};return{create:function(f){var m=a.backside.create(f),e=m.get_element();f.get_HTML();var w=document.createElement("table"),
r=document.createElement("div"),h=g(r,f),v=a.backside.create_advanced_settings_button(m,f),c=a.UTILITIES.get_current_url_boolean_parameter("elementHTML",!1)?"get_HTML":"get_text",t=m.update_display.bind(m),x,A,D,E;f.initialize_element();x=f[c]().trim();0<x.length&&!f.get_image_element()&&(D=function(b){(b=a.UTILITIES.input_area_drop_handler(b,f.receive_HTML_from_dropped.bind(f),f))&&f.robot_in_training()&&f.robot_in_training().dropped_on_text_area(b,f,{area_selector:".toontalk-html-input",setter:"receive_HTML_from_dropped",
toString:"for the element's text"})},A=a.UTILITIES.create_text_area(x,"toontalk-html-input","","Type here to edit the text.",D),x=function(a){a=A.button.value.trim().replace(/\xA0/g," ");f.get_frontside_element();f.set_HTML(a)&&f.robot_in_training()&&f.robot_in_training().edited(f,{setter_name:"set_HTML",argument_1:a,toString:'change the text to "'+a+'"',button_selector:".toontalk-html-input"})},$(A.container).css({width:"100%"}),$(A.button).css({width:"100%"}),A.button.addEventListener("change",
x),A.button.addEventListener("mouseout",x),e.appendChild(A.container),f.get_source_URL()&&(D=function(b){var c=a.UTILITIES.input_area_drop_handler(b,f.receive_URL_from_dropped.bind(f),f);c&&f.robot_in_training()&&f.robot_in_training().dropped_on_text_area(c,f,{area_selector:".toontalk-URL-input",setter:"receive_URL_from_dropped",toString:"for the URL source of the text"});b.stopPropagation()},x=function(a){a=E.button.value.trim().replace(/\xA0/g," ");f.get_frontside_element();f.set_source_URL(a)&&
f.robot_in_training()&&f.robot_in_training().edited(f,{setter_name:"set_source_URL",argument_1:a,toString:'change the source URL to "'+a+'"',button_selector:".toontalk-URL-input"})},E=a.UTILITIES.create_text_input(f.get_source_URL(),"toontalk-URL-input","","Edit the URL where this text comes from.",void 0,void 0,D),E.button.addEventListener("change",x),E.button.addEventListener("mouseout",x),e.appendChild(E.container)));m.get_attributes_chooser=function(){return r};f.get_sound_effect()?(x=$("<button>Play sound</button>").button(),
x.addClass("toontalk-play-sound-effect-button"),x.click(function(a){f.get_sound_effect().play();f.robot_in_training()&&f.robot_in_training().button_clicked(".toontalk-play-sound-effect-button",f)}),e.appendChild(x.get(0))):$(f.get_frontside_element()).find("video").is("*")&&(x=$("<button>Play video</button>").button(),x.addClass("toontalk-play-video-button"),x.click(function(a){$(f.get_frontside_element()).find("video").get(0).play();f.robot_in_training()&&f.robot_in_training().button_clicked(".toontalk-play-video-button",
f)}),e.appendChild(x.get(0)));b(r,f,w);d(w,f,m);e.appendChild(r);e.appendChild(h);e.appendChild(w);e.appendChild(v);$(r).hide();$(r).addClass("toontalk-attributes-chooser");m.update_display=function(){A&&$(A.button).val(f[c]());d(w,f,m);$(r).is(":visible")&&b(r,f,w);t()};$(e).find(".toontalk-hide-backside-button").click(function(a){$(r).hide()});m.add_advanced_settings();return m}}}(window.TOONTALK)})();window.TOONTALK.sensor=function(g){var m=Object.create(g.widget),a=function(a,d){"element"===a.get_type_name()&&(a.set_attribute("font-size",.5*$(d.get_frontside_element(!0)).height(),!1,!0),a.set_additional_classes("toontalk-string-value-from-sensor"),d.visible()&&a.rerender())};m.create=function(b,d,k,f,p,e,w){var r=g.nest.create(k,f,"sensor",void 0,void 0,w||"sensor"),h=r.get_json,v=r.update_display,c=r.copy,t=function(b){var c=b[d],e=r.visible(),f=$(r.get_frontside_element()).closest(".toontalk-top-level-backside"),
h;if("keyCode"===d){if(16===c)return;c=String.fromCharCode(c);b.shiftKey||(c=c.toLowerCase())}switch(typeof c){case "number":h=g.number.create(Math.round(c),1);break;case "string":h=g.element.create(c,void 0,void 0,void 0,"toontalk-string-value-from-sensor");a(h,r);break;case "boolean":h=g.element.create(c.toString(),void 0,void 0,void 0,"toontalk-string-value-from-sensor");a(h,r);break;case "undefined":g.UTILITIES.report_internal_error("No "+d+" in sensor "+m);return}e?(b=g.bird.create(),r.add_to_top_level_backside(b),
b.animate_delivery_to(h,r,r,f.width()/2,f.height())):r.add_to_contents(h)}.bind(this);r.copy=function(a){var f;if(a&&a.just_value&&this.has_contents())return c.call(this,a);f=a?g.sensor.create(b,d,k,void 0,a.copying_resource||p,e,this.get_name()):g.sensor.create(b,d,k,void 0,p,e,this.get_name());return r.add_to_copy(f,a)};r.get_json=function(a){var c=h.call(this,a);c.type="sensor";c.event_name=b;c.attribute=d;c.active=p;c.sensor_of=e&&g.UTILITIES.get_json(e,a);return c};r.update_display=function(){var a=
$(this.get_frontside_element());v.call(this);p||a.is(".toontalk-top-level-resource")?(a.addClass("toontalk-sensor-nest"),a.removeClass("toontalk-sensor-inactive-nest")):(a.addClass("toontalk-sensor-inactive-nest"),a.removeClass("toontalk-sensor-nest"));a.removeClass("toontalk-empty-nest")};r.get_type_name=function(a){return a?"sensors":"sensor"};r.get_help_URL=function(){return"docs/manual/sensors.html"};r.toString=function(){return"a sensor that receives the '"+d+"' attribute of "+b+" events"};r.get_active=
function(){return p};r.get_class_name_with_color=function(a){return a};r.set_active=function(a,c){if(p!==a||c)a?e?e.get_frontside_element().addEventListener(b,t):window.addEventListener(b,t):e?e.get_frontside_element().removeEventListener(b,t):window.removeEventListener(b,t),p=a};r.set_active(p,!0);r.create_backside=function(){return g.sensor_backside.create(this)};r.get_event_name=function(){return b};r.set_event_name=function(a){var c=p;b&&p&&this.set_active(!1);b=a;c&&this.set_active(!0)};r.get_attribute=
function(){return d};r.set_attribute=function(a){d=a};r.match=function(a){return this};r.set_sensor_of=function(a){e=a};r.get_custom_title_prefix=function(){var a="When a '"+b+"' event occurs my bird will bring me the '"+d+"' attribute of the event.";p?this.get_backside()||(a+=" On my back you can change which kind of events and attributes I receive."):a+=" But I'm deactivated and can't receive anything until the 'Listening to events' check box on my back is ticked.";return a};return r};g.creators_from_json.sensor=
function(b,d){var k=g.UTILITIES.create_array_from_json(b.contents,d),f=g.sensor.create(b.event_name,b.attribute,b.description,k,!1,void 0,b.name);b.sensor_of?g.UTILITIES.set_timeout(function(){f.set_sensor_of(g.UTILITIES.create_from_json(b.sensor_of,d));f.set_active(b.active)}):f.set_active(b.active);0<k.length&&setTimeout(function(){k.forEach(function(b){a(b.get_widget(),f)})},500);return f};return m}(window.TOONTALK);
window.TOONTALK.sensor_backside=function(g){return{create:function(m){var a=g.UTILITIES.create_text_input(m.get_event_name(),"toontalk-sensor-event-name-input","Event name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;","Type here the event name.","https://developer.mozilla.org/en-US/docs/Web/Events/"+m.get_event_name()),b=g.UTILITIES.create_text_input(m.get_attribute(),"toontalk-sensor-event-attribute-input","Event attribute","Type here the event attribute name.","https://developer.mozilla.org/en/docs/Web/API/Event"),
d=g.UTILITIES.create_check_box(m.get_active(),"toontalk-sensor-active-check-box","Listening to events","Check the box if you want to make this sensor active."),k=g.nest_backside.create(m),f=k.get_element(),p=$(f).find(".toontalk-settings-backside-button").get(0);a.button.addEventListener("change",function(){m.set_event_name(a.button.value.trim())});b.button.addEventListener("change",function(){m.set_attribute(b.button.value.trim())});$(d.button).click(function(a){var b=d.button.checked;m.set_active(b);
m.robot_in_training()&&m.robot_in_training().edited(robot,{setter_name:"set_active",argument_1:b,toString:"change to "+(b?"active":"inactive")+" of the "+m,button_selector:".toontalk-sensor-active-check-box"});m.render();a.stopPropagation()});f.insertBefore(a.container,p);f.insertBefore(b.container,p);f.insertBefore(d.container,p);return k}}}(window.TOONTALK);window.TOONTALK.tool=function(g){document.addEventListener("mousemove",function(m){g.tool.pageX=m.pageX;g.tool.pageY=m.pageY});return{add_listeners:function(m,a){var b,d,k,f,p,e=function(){var c=m.getBoundingClientRect();a.set_held&&a.set_held(!0);f=c.height;event.preventDefault();$(m).addClass("toontalk-tool-held");b=$(m).offset();document.addEventListener("mousemove",r);document.addEventListener("touchmove",r);document.addEventListener("mouseup",h);document.addEventListener("touchend",h);g.logging&&
0===g.logging.indexOf("touch")&&(g.debugging+="\nmouse_down at "+Date.now());k=d=0;$(".ui-tooltip").each(function(){$(this).hide()})},w=function(b){var f=m.getBoundingClientRect();a.held&&a.held()||e();d=g.UTILITIES.get_mouse_or_first_touch_event_attribute("clientX",b)-f.left;k=g.UTILITIES.get_mouse_or_first_touch_event_attribute("clientY",b)-f.top},r=function(a){var b=g.UTILITIES.find_widget_on_page(a,m,d,k-f/2),e,h,r;a.preventDefault();$(".ui-tooltip").each(function(){$(this).hide()});h=v(a);r=
g.UTILITIES.get_mouse_or_first_touch_event_attribute("pageX",a)-h.deltaX-d;a=g.UTILITIES.get_mouse_or_first_touch_event_attribute("pageY",a)-h.deltaY-k;m.style.left=r+"px";m.style.top=a+"px";g.logging&&0===g.logging.indexOf("touch")&&(g.debugging+="\nmouse_move at "+Date.now()+" now at "+m.style.left+", "+m.style.top);if(b&&b.is_top_level())p&&(g.UTILITIES.remove_highlight(),p=void 0);else{if(b&&(e=b.get_frontside_element(),e===p))return;p=e;g.UTILITIES.highlight_element(p)}},h=function(c){var e=
g.UTILITIES.find_widget_on_page(c,m,d,k-f/2),v;c.preventDefault();a.set_held&&a.set_held(!1);p&&g.UTILITIES.remove_highlight();e&&e.top_level_widget&&(v=e.top_level_widget(),a.apply_tool(e,c),v.backup_all());!e&&a.nothing_under_tool&&a.nothing_under_tool();$(m).removeClass("toontalk-tool-held");$(m).addClass("toontalk-tool-returning");g.UTILITIES.add_one_shot_event_handler(m,"transitionend",1E3,function(){$(m).removeClass("toontalk-tool-returning")});g.UTILITIES.set_timeout(function(){m.style.left=
b.left+"px";m.style.top=b.top+"px"});document.removeEventListener("mousemove",r);document.removeEventListener("touchmove",r);document.removeEventListener("mouseup",h);document.removeEventListener("touchend",h);g.logging&&0===g.logging.indexOf("touch")&&(g.debugging+="\nmouse_up at "+Date.now(),alert(g.debugging),g.debugging="touch")},v=function(a){var b=0,d=0;20>a.clientX?b=-20:a.clientX+20>window.innerWidth&&(b=20);20>a.clientY?d=-20:a.clientY+20>window.innerHeight&&(d=20);window.scrollBy(b,d);return{deltaX:b,
deltaY:d}};m.addEventListener("mousedown",w);m.addEventListener("touchstart",w);return e}}}(window.TOONTALK);window.TOONTALK.vacuum=function(g){var m=Object.create(null),a={suck:"I'm a vacuum. Drag me over the thing you want to remove.\nType 'e' to switch to erasing, type 'r' to swich to restoring, or 'a' for removing all.\nOr click to switch modes.",erase:"I'm a vacuum. Drag me over the thing you want to erase (or un-erase).\nType 's' to switch to sucking, type 'r' to switch to restoring, or 'a' for removing all.\nOr click to switch modes.",restore:"Drag me over the work area. Each time you release me I'll restore a widget.\nType 's' to switch to sucking, type 'e' to swich to erasing, or 'a' for removing all.\nOr click to switch modes.",
suck_all:"Drag me over the work area and click. Everything will be removed.\nType 'r' to switch to restoring, type 'e' to switch to erasing, or type 's' to switch to sucking.\nOr click to switch modes."},b={suck:"toontalk-vacuum-s",erase:"toontalk-vacuum-e",restore:"toontalk-vacuum-r",suck_all:"toontalk-vacuum-a"},d={suck:"erase",erase:"restore",restore:"suck_all",suck_all:"suck"},k=!1,f;m.create=function(){var p,e,w,r=[],h=function(a){w!==a&&(w=a,$(p).removeClass(e),e=b[w],$(p).addClass(e),v())},
v=function(){"restore"===w&&0===r.length?g.UTILITIES.give_tooltip(p,"I'm empty.\nType 's' to switch to sucking, or type 'e' to switch to erasing, or 'a' to remove all."):g.UTILITIES.give_tooltip(p,a[w])};document.addEventListener("keyup",function(a){var b=String.fromCharCode(a.keyCode);a.altKey&&(p||(m.the_vacuum.get_element(),$(p).css({left:g.tool.pageX,top:g.tool.pageY}),document.body.appendChild(p)),f());m.the_vacuum.held()&&("s"===b||"S"===b?h("suck"):"e"===b||"E"===b?h("erase"):"r"===b||"R"===
b?h("restore"):"a"===b||"A"===b?h("suck_all"):g.sounds&&g.sounds.event_ignored.play(),a.preventDefault(),a.stopPropagation())});document.addEventListener("keydown",function(a){m.the_vacuum.held()&&(a.preventDefault(),a.stopPropagation())});g.vacuum.the_vacuum={apply_tool:function(a,b){var d=a.get_widget(),e=function(a){var c;a.is_backside()?a.hide_backside():(b&&d.robot_in_training()&&d.robot_in_training().removed(a),a===d.robot_in_training()?(a.training_finished(),a.set_run_once(!0)):(d.is_bird()&&
g.sounds&&g.sounds.bird_fly.pause(),c=a.copy(),c.save_dimensions_of(a),r.push(c),a.set_running&&a.set_running(!1),a.remove(b)))},f,h;"suck"===w?a.remove&&"top-level"!==a.get_type_name()&&(e(a),g.sounds&&g.sounds.vacuum_suck.play()):"erase"===w||"restore"===w&&a.get_erased&&a.get_erased()?"top-level"!==a.get_type_name()&&(f=!a.get_erased(),g.sounds&&(f?g.sounds.vacuum_suck.play():g.sounds.vacuum_spit.play()),a.set_erased(f,!0),b&&d.robot_in_training()&&d.robot_in_training().erased_widget(a,f)):"restore"===
w?0<r.length&&(f=r.pop(),f.restore_dimensions(),h=a.add_to_top_level_backside(f,!0),f=$(p).offset(),f.left-=$(h).width(),g.UTILITIES.set_absolute_position($(h),f),g.sounds&&g.sounds.vacuum_spit.play()):"suck_all"===w&&(f=a.top_level_widget(),f=f.get_backside_widgets().slice(),0<f.length&&g.sounds&&(g.sounds.vacuum_suck.play(),g.sounds.bird_fly.pause()),f.forEach(function(a){d!==d.robot_in_training()&&e(a)}))},nothing_under_tool:function(){h(d[w])},get_element:function(){p||(p=document.createElement("div"),
$(p).addClass("toontalk-vacuum"),f=g.tool.add_listeners(p,this),h("suck"),v());return p},held:function(){return k},set_held:function(a){k=a}};return g.vacuum.the_vacuum};g.creators_from_json.vacuum=function(a,b){var d=g.vacuum.create();a.mode&&g.UTILITIES.set_timeout(function(){d.set_mode(a.mode)});return d};return m}(window.TOONTALK);window.TOONTALK.wand=function(g){var m=Object.create(null);m.create=function(){var a;return{apply_tool:function(a){"top-level"!==a.get_type_name()&&(g.sounds&&g.sounds.magic.play(),a.add_copy_to_container())},get_element:function(){a||(a=document.createElement("div"),$(a).addClass("toontalk-wand"),g.UTILITIES.give_tooltip(a,"I'm a magic wand. Drag me over the thing you want me to copy."),g.tool.add_listeners(a,this));return a}}};g.creators_from_json.wand=function(){return g.wand.create()};return m}(window.TOONTALK);window.TOONTALK.SETTINGS=function(g){var m=[],a=function(a,f,p){var e=[],w=g.UTILITIES.create_local_files_table(),r=function(d,e){var c=function(a){a||e.newPanel.appendChild(g.UTILITIES.create_text_element("Error connecting to cloud"))},f=e.newPanel.is(".dataTable");$(".dataTables_info").hide();$(".dataTables_wrapper").hide();e.newPanel.is(".toontalk-programs-in-cloud-table")?f?($("#tab-1_info").show(),$("#tab-1_wrapper").show()):b(e.newPanel,"program",a,p,c):e.newPanel.is(".toontalk-pages-in-cloud-table")?
f?($("#tab-2_info").show(),$("#tab-2_wrapper").show()):b(e.newPanel,"page",a,p,c):($("#tab-0_info").show(),$("#tab-0_wrapper").show())};e[0]="Programs stored in browser";m[0]=w;f?(e[1]="Programs in cloud",m[1]=g.UTILITIES.create_file_data_table("toontalk-programs-in-cloud-table"),e[2]="Published pages",m[2]=g.UTILITIES.create_file_data_table("toontalk-pages-in-cloud-table"),f=g.UTILITIES.create_tabs(e,m),p.appendChild(f),$(f).on("tabsactivate",r)):p.appendChild(g.UTILITIES.create_tabs(e,m));$(w).on("draw.dt",
function(){d(a,w,!1,p)})},b=function(a,b,m,e,w){g.google_drive.get_toontalk_files(!1,b,function(r){var h;"string"===typeof r?h=r:r.error&&(h=r.error.message);h?"Need to authorize"===h||"Login Required"===h?g.google_drive.authorize(w):(console.log(h),console.log("Google drive status: "+g.google_drive.get_status()),w(null)):(h="program"===b&&"toontalk-file-load-button toontalk-file-load-button-without-click-handler",g.UTILITIES.become_file_data_table(a,r.items,!0,h),a.on("draw.dt",function(){d(m,a.get(0),
!0,e)}),w(a.get(0)))})},d=function(a,b,d,e){$(b).find(".toontalk-file-load-button-without-click-handler").click(function(b){var f=function(){$(e).remove()},h=function(){a.set_setting("program_name",b.target.textContent);a.load(d,f)}.bind(this);a.save(!0,void 0,h)}).removeClass("toontalk-file-load-button-without-click-handler")};return{open:function(b){var d=document.createElement("div"),m=b.get_backside_element(),e=b.get_setting("program_name"),w=g.UTILITIES.create_text_input(e,"toontalk-program-name-input",
"Current program name:","Edit this to change the name of your program","docs/manual/settings.html"),r=g.UTILITIES.create_close_button(function(){$(d).remove()},"Click to close the settings panel."),h=g.UTILITIES.create_text_element("How should your program be saved?"),v=g.UTILITIES.create_check_box(b.get_setting("auto_save_to_google_drive"),"toontalk-save-setting","Save automatically to my Google Drive",'Check this if you want your programs automatically saved to a "ToonTalk Programs" folder in your Google Drive.'),
c=g.UTILITIES.create_check_box(b.get_setting("auto_save_to_local_storage"),"toontalk-save-setting","Save automatically to this browser's local storage","Check this if you want your programs automatically saved in this browser's local storage."),t=g.UTILITIES.create_button("Save to Google Drive now","toontalk-save-button","Click to save your program now to your Google Drive account.",function(){b.save(!0,{google_drive:!0})}),x=g.UTILITIES.create_button("Save to browser's storage now","toontalk-save-button",
"Click to save your program now to this browser's local storage.",function(){b.save(!0,{local_storage:!0})}),A=g.UTILITIES.create_button("Login to Google","toontalk-google-login-button","Click to log in to Google to authorize use of your Google Drive.",function(){g.google_drive.authorize(function(){$(A).remove()})}),D=g.UTILITIES.create_button("Publish","toontalk-publish-button","Click to publish your program by generating a Google Drive URL.",function(){g.UTILITIES.display_message("Creating your web page...");
b.publish(R,E.button.checked)}),E=g.UTILITIES.create_check_box(b.get_setting("publish_as_workspace"),"toontalk-publish-setting","As a workspace","Check this if you want to publish the workspace and its widgets. Uncheck it you wish to publish just the widgets."),R=function(a,c){var d=document.createElement("span"),e=g.google_drive.google_drive_url(a.id);g.TRANSLATION_ENABLED&&(e=g.UTILITIES.add_URL_parameter(e,"translate","1"));d.innerHTML="Published: <a href='"+e+"' target='_blank'>"+b.get_setting("program_name")+
"</a>";g.UTILITIES.display_message("Your web page is ready for you to edit. Just click on the link.");$(w.container).children("tr").append(g.UTILITIES.create_table_entry(d))},H=document.createElement("div"),L=g.google_drive&&"undefined"!==typeof gapi?g.google_drive.get_status():"Google Drive API not loaded",J=!0,K=g.UTILITIES.create_vertical_table(D,E.container);$(d).addClass("toontalk-settings-panel").css({width:$(m).width()+29,height:$(m).height()+50,left:-2,top:-25,"z-index":g.UTILITIES.next_z_index()});
d.appendChild(r);w.button.addEventListener("change",function(){var a=w.button.value.trim();e!==a&&b.save(!0,void 0,function(){e=a;b.set_setting("program_name",a);b.load(!0,function(){setTimeout(function(){$(d).css({"z-index":g.UTILITIES.next_z_index()})},500)},function(){b.save(!0,void 0,function(){$(".toontalk-settings-panel").remove();g.UTILITIES.display_message("Your program was copied and the new copy's name is '"+b.get_setting("program_name")+"'.")})})})});v.button.addEventListener("click",function(a){b.save(!0,
{auto_save_to_google_drive:c.button.checked,gooogle_drive:!0});b.set_setting("auto_save_to_google_drive",v.button.checked);v.button.checked?$(t).hide():$(t).show()});c.button.addEventListener("click",function(a){b.save(!0,{auto_save_to_local_storage:c.button.checked,local_storage:!0});b.set_setting("auto_save_to_local_storage",c.button.checked);c.button.checked?$(x).hide():$(x).show()});E.button.addEventListener("click",function(a){b.set_setting("publish_as_workspace",E.button.checked)});d.appendChild(H);
$(h).css({"font-weight":"bold","font-size":24,color:"navy"});H.appendChild(h);H.appendChild(w.container);H.appendChild(v.container);H.appendChild(c.container);v.container.appendChild(g.UTILITIES.create_space());v.container.appendChild(t);b.get_setting("auto_save_to_google_drive")&&$(t).hide();c.container.appendChild(g.UTILITIES.create_space());c.container.appendChild(x);b.get_setting("auto_save_to_local_storage")&&$(x).hide();"Need to authorize"===L?(v.container.appendChild(g.UTILITIES.create_space()),
v.container.appendChild(A)):"Authorized"!==L&&"Ready"!==L&&"Authorized but not yet ready"!==L&&(J=!1,b.set_setting("google_drive_unavailable",!0),setTimeout(function(){v.button.disabled=!0;$(D).button("option","disabled",!0);$(t).button("option","disabled",!0);g.UTILITIES.give_tooltip(v.container,"Inactivated because attempt to connect to Google Drive returned: "+L);D.title=v.container.title;t.title=v.container.title},1));$(w.container).children("tr").append(g.UTILITIES.create_table_entry(K));a(b,
J,d);m.appendChild(d)}}}(window.TOONTALK);window.TOONTALK.DEFAULT_SETTINGS={program_name:"My first program",auto_save_to_google_drive:!0,auto_save_to_local_storage:!0};window.TOONTALK.DISPLAY_UPDATES=function(g){var m=[];return{pending_update:function(a){0<=m.indexOf(a)||m.push(a)},update_display:function(){var a,b;0!==m.length&&(a=m,b=function(a,g){$(a).children().each(function(a,d){$(d).css({"z-index":g+1});b(d,g+1)})},m=[],a.forEach(function(a){var k=a.get_frontside_element&&a.get_frontside_element(),f,m,e;a.update_display();a.get_backside&&(m=a.get_backside())&&m.update_display();setTimeout(function(){g.UTILITIES.use_custom_tooltip(k)});f=$(k).parent().closest(".toontalk-side");
f.is("*")&&0===f.find(".toontalk-side-animating, .toontalk-side-appearing").length&&(m=g.UTILITIES.get_style_numeric_property(k,"z-index"),e=g.UTILITIES.get_style_numeric_property(f.get(0),"z-index"),e||(e=g.UTILITIES.next_z_index(),f.css({"z-index":e})),!m||f.is(".toontalk-top-level-backside")?(m=g.UTILITIES.next_z_index(),$(k).css({"z-index":m})):m>=e&&(m=e+1,$(k).css({"z-index":m})),b(k,m));k&&!$(k).is(".toontalk-top-level-resource, .toontalk-bird, .toontalk-nest, .toontalk-box-hole, .toontalk-plain-text-element, .toontalk-conditions-contents, .toontalk-robot, .toontalk-widget, .toontalk-held-by-robot")&&
g.UTILITIES.set_timeout(function(){f.is(".toontalk-box-hole")?$(k).is(".ui-resizable")&&$(k).resizable("destroy"):$(k).is(".ui-resizable")||g.UTILITIES.make_resizable($(k),a)})}))},run_cycle_is_over:function(){this.update_display()}}}(window.TOONTALK);window.TOONTALK.actions=function(g){g.creators_from_json.body=function(m,a){var b=g.actions.create();a.body=b;b.initialise_steps(g.UTILITIES.create_array_from_json(m.steps,a));return b};return{create:function(m){var a=Object.create(this),b=[];m||(m=[]);a.copy=function(){return g.actions.create(g.UTILITIES.copy_array(m))};a.get_steps=function(){return m};a.initialise_steps=function(a){m=a};a.is_empty=function(){return 0===m.length};a.reset_steps=function(){m=[];this.reset_newly_created_widgets()};
a.reset_newly_created_widgets=function(){b=[]};a.add_step=function(a,b){m.push(a);b&&this.add_newly_created_widget_if_new(b)};a.add_newly_created_widget_if_new=function(a){0<=b.indexOf(a)||this.add_newly_created_widget(a)};a.add_newly_created_widget=function(a){g.debugging&&0<=b.indexOf(a)?console.log("add_newly_created_widget called with not new widget."):(b.push(a),g.logging&&0<=g.logging.indexOf("newly-created")&&console.log("Added "+a.to_debug_string()+" to list of newly_created_widgets. Length is "+
b.length))};a.is_newly_created=function(a){return 0<=b.indexOf(a)};a.get_newly_created_widgets=function(){return b};a.get_path_to=function(a,k){var f,m;b.some(function(b,w){if(b===a)return f=g.newly_created_widgets_path.create(w),!0;if(b.get_path_to&&(m=b.get_path_to(a,k)))return f=g.newly_created_widgets_path.create(w),f.next=m,!0});return f};a.dereference_path=function(a){g.debugging&&!b[a]&&g.UTILITIES.report_internal_error("Expected to find the "+g.UTILITIES.ordinal(a)+" newly created widget.");
return b[a]};return a},run_unwatched:function(m,a,b,d,k){var f=this.get_steps();g.logging&&0<=g.logging.indexOf("run")&&console.log(d.to_debug_string()+" running unwatched");k||(k=0);d.run_next_step=function(){if(k<f.length){var p=f[k];k++;g.logging&&0<=g.logging.indexOf("event")&&console.log(p.get_action_name()+" (unwatched)");p.run_unwatched(m,a,d)}else d.set_running_or_in_run_queue(!1),d.run_body_finished_listeners(m,a,b),d.get_run_once()?d.get_first_in_team().set_running(!1):d.get_first_in_team().run(m,
a,b)};d.run_next_step()},run_watched:function(m,a,b,d){var k=this.get_steps(),f=d.get_frontside_element(),p,e,w=f.parentElement,r=function(){var c=d.visible()&&0!==d.get_maximum_step_duration()&&d.get_first_in_team()===d,e=function(){c&&(w.appendChild(f),d.set_animating(!1));d.get_run_once()?d.get_first_in_team().set_running(!1):d.stopped()||d.get_first_in_team().run(m,a,b);d.get_first_in_team()===d&&g.UTILITIES.set_absolute_position($(f),v);d.rerender()};c?g.UTILITIES.animate_to_absolute_position(f,
v,e,d&&d.transform_animation_speed(g.UTILITIES.default_animation_speed)):(d.set_animating(!1),e(),m.add_backside_widget(d),$(d.get_frontside_element()).remove())},h=0,v=$(f).offset(),c=$(f).position(),t=$(f).width(),x=$(f).height(),A=$(f).closest(".toontalk-backside"),D=$(f).closest(".toontalk-top-level-backside").offset(),E=m.get_backside();g.logging&&0<=g.logging.indexOf("run")&&console.log(d.to_debug_string()+" running watched");d.get_parent_of_frontside()||(e=d.get_previous_robot(),e.open_backside(),
e.get_backside().set_advanced_settings_showing(!0),(p=f.parentElement)||(p=$(e.get_backside_element()).find(".toontalk-drop-area").get(0)),m.get_backside_element().appendChild(f),m.add_backside_widget(d),d.update_display(),d.add_body_finished_listener(function(){p&&p.appendChild(f);m.remove_backside_widget(d);d.set_visible(!0);$(f).css({left:"",top:""})}));0===t&&($(f).css({width:"",height:""}),t=$(f).width(),x=$(f).height());D||(console.log("Unable to find top-level backside. Perhaps is 'visible' but not attached."),
D={left:0,top:0});0<A.length&&(e=A.get(0).getBoundingClientRect(),v.left<e.left-D.left||v.top<e.top-D.top||v.left+t>e.right+D.left||v.top+x>e.bottom+D.top)&&(v=A.offset(),v.left+=A.width()/2,v.top+=A.height()-x);d.start_position=c;d.run_next_step=function(){E&&(E.visible()||$(E.get_element()).is(":visible"))?setTimeout(function(){d.run_watched_step_end_listeners();if(h<k.length){var b=k[h];h++;g.logging&&0<=g.logging.indexOf("event")&&console.log(b.get_action_name()+" (watched)");b.run_watched(m,
a,d);d.get_thing_in_hand()&&(d.get_thing_in_hand().save_dimensions(),d.render())}else d.set_running_or_in_run_queue(!1),r(),d.run_body_finished_listeners()},d.transform_step_duration(50)):(d.set_running_or_in_run_queue(!1),d.set_animating(!1),$(f).css({width:"",height:""}),f.style.left=c.left+"px",f.style.top=c.top+"px",w.appendChild(f),this.run_unwatched(m,a,b,d,h))}.bind(this);d.set_animating(!0,v);d.run_next_step();return!0},toString:function(g){for(var a="",b=this.get_steps().map(function(a){return a&&
a.toString(g)});""===b[b.length-1];)b.pop();b.forEach(function(d,g){d&&(a+=d,a=g===b.length-2?a+" and \n":g<b.length-2?a+", \n":a+".")});return a},get_json:function(m){return{type:"body",steps:g.UTILITIES.get_json_of_array(this.get_steps(),m)}}}}(window.TOONTALK);
window.TOONTALK.newly_created_widgets_path=function(g){g.creators_from_json.newly_created_widgets_path=function(m){return g.newly_created_widgets_path.create(m.index)};return{create:function(m){return{dereference_path:function(a,b,d){a=d.get_body().dereference_path(m);if(this.next)return g.path.dereference_path(this.next,a,b,d);this.removing_widget&&(b=a.get_parent_of_frontside())&&b.removed_from_container&&d.remove_from_container(a,b);return a},toString:function(){return"the "+g.UTILITIES.ordinal(m)+
" new widget"},get_json:function(){return{type:"newly_created_widgets_path",index:m}}}}}}(window.TOONTALK);window.TOONTALK.robot_action=function(g){var m={copy:function(a,b,c,d){d.add_newly_created_widget(a.copy());return!0},"pick up":function(a,b,c,d){d.set_thing_in_hand(a);return!0},"pick up a copy of":function(a,b,c,d){a=a.copy();d.add_newly_created_widget(a);d.set_thing_in_hand(a);return!0},"drop it on":function(a,b,c,d,e){if(a)if(b=d.get_thing_in_hand()){if(b.drop_on)return g.debugging&&b===a&&g.UTILITIES.report_internal_error("Dropping something on itself! "+a),b.drop_on(a,!1,void 0,d),d.set_thing_in_hand(void 0),
a.rerender(),b.robot_waiting_before_next_step===d?(e&&e.running_watched||(b.robot_waiting_before_next_step=void 0),!1):!0;g.UTILITIES.report_internal_error("Thing in robot's hand ("+b+") doesn't handle 'drop_on'. Robot that "+d)}else g.UTILITIES.report_internal_error("The robot that '"+d.toString()+"' is executing drop_on but has nothing in its hand.");else g.UTILITIES.report_internal_error("The robot that '"+d.toString()+"' is executing drop_on but doesn't know where to drop what its holding")},
"drop it on the text area of":function(a,b,c,d,e){if(a){if(b=d.get_thing_in_hand())return d.set_thing_in_hand(void 0),a[e.setter](b),!0;g.UTILITIES.report_internal_error("The robot that '"+d.toString()+"' is executing dropped_on_text_area but has nothing in its hand.")}else g.UTILITIES.report_internal_error("The robot that '"+d.toString()+"' is executing dropped_on_text_area but doesn't know where to drop what its holding")},remove:function(a,b,c,d){a.remove();a===d&&d.set_stopped(!0);return!0},"change whether erased":function(a,
b,c,d,e){if(a.set_erased)return a.set_erased(!a.get_erased()),!0;g.UTILITIES.display_message("Robot is unable to erase "+a)},edit:function(a,b,c,d,e){if(a[e.setter_name])return e.argument_2?a[e.setter_name].call(a,e.argument_1,e.argument_2,a.visible()):a[e.setter_name].call(a,e.argument_1,a.visible()),!0;g.UTILITIES.report_internal_error(a+" cannot be edited.")},"change size of":function(a,b,c,d,e){return!0},"add to the top-level backside":function(a,b,c,d,e){d.visible()||(e=a.get_frontside_element(!0),
c=$(b.get_frontside_element()).position(),b=$(b.get_frontside_element()).closest(".toontalk-top-level-backside").get(0)||$(e).closest(".toontalk-top-level-backside").get(0),$(e).css({left:c.left,top:c.top}),b.appendChild(e),b.toontalk_widget.add_backside_widget(a),a.animate_to_element(b,void 0,d.transform_animation_speed(g.UTILITIES.default_animation_speed)));return!0},"add a new widget to the work space":function(a,b,c,d,e){b.is_top_level()?(b=d.add_to_top_level_backside(a),d=$(d.get_frontside_element()).offset(),
a.update_display(),g.UTILITIES.set_position_relative_to_top_level_backside($(b),d,!0)):a.drop_on(b.get_backside(),!1,void 0,d,!0);return!0},"start training":function(a,b,c,d,e){a.training_started(d);return!0},"stop training":function(a,b,c,d,e){a.training_finished();return!0},train:function(a,b,c,d,e){a.add_step(e.step)},"open the backside":function(){return!0},"close the backside":function(){return!0},"click the button of":function(){return!0}},a=function(a,b,c,d){var e=b.get_thing_in_hand(),f=b.get_frontside_element(),
g=a.get_element(),k=$(g).width(),m=$(g).height(),p,r,w,K,C,F;d&&d.left_offset_fraction?(b.original_animation_left_offset||(b.original_animation_left_offset=[]),b.original_animation_top_offset||(b.original_animation_top_offset=[]),w=d.left_offset_fraction*k,K=d.top_offset_fraction*m,e&&(C=e.get_element(),$(C).is(":visible")&&(F=$(C).offset(),f=$(f).offset(),w-=F.left-f.left,K-=F.top-f.top)),e&&0<=b.original_animation_left_offset.indexOf(w)&&0<=b.original_animation_top_offset.indexOf(K)?(w=b.animation_left_offset+
b.last_thing_in_hand_width,K=b.animation_top_offset,w>=k&&(w=0,K+=b.max_thing_in_hand_height,K>=m&&(K=0)),b.last_thing_in_hand_width=$(C).width(),"undefined"===typeof b.max_thing_in_hand_height&&(b.max_thing_in_hand_height=0),b.max_thing_in_hand_height=Math.max(b.max_thing_in_hand_height,$(C).height())):(b.original_animation_left_offset.push(w),b.original_animation_top_offset.push(K),b.last_thing_in_hand_width=$(C).width(),b.max_thing_in_hand_height=$(C).height()),g.animation_left_offset=w,g.animation_top_offset=
K,b.animation_left_offset=w,b.animation_top_offset=K):(p=k/2,r=m/2);b.animate_to_widget(a,c,b.transform_animation_speed(.25),p,r,!0,b.transform_original_step_duration(d&&d.time))},b=function(b,d,c,e){a(b,d,function(){b.open_backside(c);w(b,d)},e)},d=function(a,b){var c=a.get_backside_element(!0);return $(c).find(b).get(0)},k=function(a,b,c,e,f,k,m,p){var r=d(a,k);e.get_frontside_element();var H=r&&$(r).is(":visible"),L=function(){f(r);$(r).addClass("ui-state-active");if(".toontalk-select-function"===
k||".toontalk-box-size-input"===k)r.value=m.argument_1;setTimeout(function(){$(r).removeClass("ui-state-active");!H&&a.get_backside()&&e.add_body_finished_listener(function(){a.get_backside()&&a.get_backside().hide_backside()});e.run_next_step()},p)};b=function(){!$(r).is(":visible")&&J&&J.set_advanced_settings_showing(!0,J.get_element());e.animate_to_element(r,L,e.transform_animation_speed(g.UTILITIES.default_animation_speed/2),0,0,!0)};var J;!H&&a.open_backside&&e.animate_consequences_of_actions()?
(a.open_backside(b),w(a,e)):b()},f=function(a,b,c,d,e,f,k){k=$("."+k).get(0);var m=function(){p(a,b,c,d,e,f)};k&&d.animate_consequences_of_actions()?d.animate_to_element(k,m,d.transform_animation_speed(g.UTILITIES.default_animation_speed),0,0,!0):m()},p=function(a,b,c,d,e,f){d.get_frontside_element();b=function(){d.carrying_tool=void 0;d.update_display();e();d.run_next_step()};d.animate_consequences_of_actions()?(d.carrying_tool=f,d.update_display(),d.animate_to_element(a.get_frontside_element(),
b,d.transform_animation_speed(g.UTILITIES.default_animation_speed/2),0,0,!0)):(e(),d.run_next_step())},e=function(a,b,c,d,e){var g=a.get_parent_of_frontside();f(a,b,c,d,function(){e();g&&"top-level"!==g.get_widget().get_type_name()&&g.update_display&&g.update_display();a.render()},"toontalk-vacuum-ready-small","toontalk-vacuum")},w=function(a,b){b.add_body_finished_listener(function(){a.get_backside()&&a.get_backside().hide_backside()})},r={copy:function(a,b,c,d,e){f(a,b,c,d,function(){e();a.add_copy_to_container(d.get_recently_created_widget())},
"toontalk-wand-small","toontalk-wand")},"pick up":function(b,d,c,e,f,k){d=b.get_frontside_element();c=function(){f();e.animate_consequences_of_actions()&&e.update_display();e.run_next_step()};"empty hole"===b.get_type_name()?g.UTILITIES.report_internal_error("Robot trying to pick up an empty hole."):b.save_dimensions()&&e.animate_consequences_of_actions()?(d.offsetWidth&&$(d).css({width:d.offsetWidth+"px",height:d.offsetHeight+"px"}),a(b,e,c,k)):c()},"pick up a copy of":function(b,d,c,e,f,k){a(b,
e,function(){var a;f();e.animate_consequences_of_actions()&&(a=e.get_recently_created_widget(),a.set_visible(!0),g.UTILITIES.copy_frontside_dimensions(b,a),e.update_display());e.run_next_step()},k)},"drop it on":function(d,e,c,f,k,m){var p=f.get_thing_in_hand(),r;p?(g.debugging&&p===d&&g.UTILITIES.report_internal_error("Dropping something on itself!"),r=$(p.get_frontside_element()),e=function(){var a=r.offset(),b;r.removeClass("toontalk-held-by-robot");k();p.drop_on&&(f.animate_consequences_of_actions()&&
(r.is(":visible")||(b=$(f.get_frontside_element()).closest(".toontalk-top-level-backside"),b.append(r.get(0))),g.UTILITIES.set_absolute_position(r,a),p.restore_dimensions()),p.robot_waiting_before_next_step!==f&&(f.set_thing_in_hand(void 0),f.run_next_step()),f.rerender())},d.is_backside()&&!$(d.get_element()).is(":visible")?b(d.get_widget(),f,e,m):a(d,f,e,m)):(g.UTILITIES.report_internal_error("Expected the robot to be holding something."),console.log("The robot is "+f),a(d,f,k,m))},"drop it on the text area of":function(d,
e,c,f,k,m){var p=f.get_thing_in_hand(),r,w,H,L;p?(r=$(p.get_frontside_element()),w=function(){r.offset();var a;r.removeClass("toontalk-held-by-robot");k();p.remove();a=d.get_parent_of_frontside().get_widget();a.is_hole()&&(a=a.get_parent_of_frontside());a.is_top_level()?d.render():a.render();f.set_thing_in_hand(void 0);f.run_next_step()},H=function(){return $(d.get_backside_element()).find(m.area_selector).get(0)},f.rerender(),$(d.get_backside_element()).is(":visible")?(L=H(),f.animate_to_element(L,
w,f.transform_animation_speed(g.UTILITIES.default_animation_speed/2),0,0,!0)):b(d,f,function(){L=H();f.animate_to_element(L,w,f.transform_animation_speed(g.UTILITIES.default_animation_speed/2),0,0,!0)},m)):(g.UTILITIES.report_internal_error("Expected the robot to be holding something."),console.log("The robot is "+f),a(d,f,k,m))},remove:e,"change whether erased":e,edit:function(a,b,c,d,e,f){k(a,b,c,d,function(){a.get_backside()&&a.get_backside().update_display();e()},f.button_selector,f,1E3)},"change size of":function(a,
b,c,d,e,f){var k=a.get_frontside_element();d.animate_to_element(k,function(){var b=$(k).width(),c=$(k).height(),b=b*f.x_factor,c=c*f.y_factor,g=d.transform_step_duration(1E3);$(k).addClass("toontalk-animating-element");k.style.transitionDuration=g+"ms";k.style.width=b+"px";k.style.height=c+"px";setTimeout(function(){e();a.render();d.run_next_step()},g)},d.transform_animation_speed(g.UTILITIES.default_animation_speed),0,0,!0)},"add to the top-level backside":function(a,b,c,d,e){e();d.run_next_step()},
"add a new widget to the work space":function(a,b,c,d,e,f){f&&f.button_selector?(a=g.path.dereference_path(f.path_to_source,b,c,d),k(a,b,c,d,e,f.button_selector,f,3E3)):(e(),d.run_next_step())},"start training":function(a,b,c,d,e){b=a.open_backside();a=a.get_frontside_element();e();b&&$(b.get_element()).find(".toontalk-train-backside-button").click();$(a).addClass("toontalk-robot-animating toontalk-robot-being-trained-by-robot");a.toontalk_followed_by={element:d.get_frontside_element(),left_offset:30,
top_offset:-20};a.toontalk_return_to=$(a).offset();d.run_next_step()},"stop training":function(a,b,c,d,e,f){var m=a.get_frontside_element();k(a,b,c,d,function(){var b=function(){m.toontalk_return_to=void 0;a.get_backside().change_label_and_title_of_train_button(!1);$(m).removeClass("toontalk-robot-animating toontalk-robot-being-trained-by-robot");m.toontalk_followed_by=void 0;setTimeout(e,1500)};m.toontalk_return_to?g.UTILITIES.animate_to_absolute_position(m,m.toontalk_return_to,b,d.transform_animation_speed(g.UTILITIES.default_animation_speed)):
b()},".toontalk-train-backside-button",f,1E3)},train:function(a,b,c,d,e,f){b=function(){e();d.run_next_step()};(f=f.step.run_watched)?(a.run_next_step=b,f(a.get_parent_of_frontside().get_widget(),c,a)):b()},"open the backside":function(a,b,c,d,e){a.open_backside(function(){e();d.run_next_step()});w(a,d)},"close the backside":function(a,b,c,d,e,f){b=d.transform_original_step_duration(f&&f.time);setTimeout(function(){$(a.get_backside_element()).children(".toontalk-close-button").click();e();d.run_next_step()},
b)},"click the button of":function(a,b,c,d,e,f){k(a,b,c,d,function(a){$(a).click();e()},f.button_selector)}};g.creators_from_json.robot_action=function(a,b){return a.additional_info?g.robot_action.create(g.path.create_from_json(a.path,b),a.action_name,g.UTILITIES.create_keys_from_json(a.additional_info,b)):g.robot_action.create(g.path.create_from_json(a.path,b),a.action_name)};return{create:function(a,b,c){var d=Object.create(this),e=m[b],f=r[b];if(f)return a||g.UTILITIES.report_internal_error("path undefined in "+
b+" action"),e||g.UTILITIES.report_internal_error("no run_function for "+b),d.get_action_name=function(){return b},d.get_additional_info=function(){return c},d.run_unwatched=function(b,d,f){var k=g.path.dereference_path(a,b,d,f);if(!k)return g.UTILITIES.report_internal_error("Unable to dereference path: "+g.path.toString(a)+" in context: "+b.toString()),!1;g.logging&&0<=g.logging.indexOf("event")&&(k.wait_until_this_nest_receives_something?console.log("   wait_until_this_nest_receives_something "+
k.wait_until_this_nest_receives_something.to_debug_string()+"("+g.path.toString(a)+") by unwatched "+f.to_debug_string()):console.log("   "+k.to_debug_string()+" ("+g.path.toString(a)+" "+k.to_debug_string()+" by unwatched "+f.to_debug_string()));k.wait_until_this_nest_receives_something?k.wait_until_this_nest_receives_something.run_when_non_empty(function(){this.run_unwatched(b,d,f)}.bind(this),f):e(k,b,d,f,c)&&f.run_next_step()},d.run_watched=function(b,d,k){var m=g.path.dereference_path(a,b,d,
k),p=function(){c||(c={});c.running_watched=!0;e(m,b,d,k,c)};m?(g.logging&&0<=g.logging.indexOf("event")&&console.log("   "+m+" ("+g.path.toString(a)+" "+m.to_debug_string()+" by watched "+k.to_debug_string()+(k.animate_consequences_of_actions()?"":" finishing instantly")),m.wait_until_this_nest_receives_something?(m.wait_until_this_nest_receives_something.run_when_non_empty(function(){k.set_waiting(!1);this.run_watched(b,d,k)}.bind(this),k),k.set_waiting(!0)):(m.set_visible(!0),f(m,b,d,k,p,c))):
g.UTILITIES.report_internal_error("Unable to dereference the path: "+g.path.toString(a)+" in context: "+b.toString())},d.toString=function(d){var e="",f="",k=b,m;if("open the backside"===b||"close the backside"===b)return"";if("click the button of"===b)switch(c.button_selector){case ".toontalk-green-flag":k="click the green flag "+g.UTILITIES.encode_HTML_for_title("<span class='toontalk-green-flag-icon'></span>")+" of";break;case ".toontalk-stop-sign":k="click the stop sign "+g.UTILITIES.encode_HTML_for_title("<span class='toontalk-stop-sign-icon'></span>")+
" of";break;case ".toontalk-play-sound-effect-button":k="click the 'Play Sound' button of";break;case ".toontalk-settings-backside-button":k="open the advanced settings of";break;case ".toontalk-show-attributes-chooser-button":k="click the button to add or remove attributes of ";break;default:k="click a button of"}if("add a new widget to the work space"===b)return b.replace("a new widget",g.path.toString(a));if("add to the top-level backside"===b)return"";d||(d={});m=g.path.toString(a,d);if("edit"===
b||"drop it on the text area of"===b)e=" ("+c.toString+")";else if("train"===b){e=c.step.toString({person:"third"});if(""===e)return e;e=" to "+e;f="- ";d&&d.robot_being_trained_description&&(m=d.robot_being_trained_description)}else"start training"===b?d&&(d.robot_being_trained_description="it"):"stop training"===b&&(m=d.robot_being_trained_description,d.robot_being_trained_description=void 0);if(0<="pick up;edit;remove;copy;change whether erased;pick up a copy of;drop it on the text area of".split(";").indexOf(b)){if(0<=
m.indexOf("hole of"))return f+k+" what is in "+m+e;if(0===m.indexOf("a When"))return m=m.substring(3),m=g.UTILITIES.remove_encoded_HTML(m),m=g.UTILITIES.elide(m,80,1),"."===m[m.length-1]&&(m=m.substring(0,m.length-1)),f+k+" a robot who w"+m+e+"\n"}return f+k+" "+m+e},d.get_json=function(d){return{type:"robot_action",action_name:b,path:g.path.get_json(a,d),additional_info:c&&g.UTILITIES.get_json_of_keys(c,["running_watched"])}},d;g.UTILITIES.report_internal_error("No watched function for "+b)}}}(window.TOONTALK);window.TOONTALK.queue=function(g){return{create:function(){var m=Object.create(this);m.to_run=g.UTILITIES.create_queue();return m},enqueue:function(g){if(!g.robot.running_or_in_run_queue())return g.robot.set_running_or_in_run_queue(!0),this.to_run.enqueue(g)},maximum_run:50,paused:!1,run:function(){for(var m,a=Date.now()+this.maximum_run;!(this.to_run.isEmpty()||this.paused||Date.now()>=a);)m=this.to_run.dequeue(),m.robot.run_actions(m.context,m.top_level_context,m.queue);g.DISPLAY_UPDATES.run_cycle_is_over();
g.UTILITIES.set_timeout(function(){this.run()}.bind(this),this.to_run.isEmpty()?this.maximum_run:0)}}}(window.TOONTALK);window.TOONTALK.path=function(g){var m;g.creators_from_json["path.to_entire_context"]=function(){return g.path.to_entire_context()};g.creators_from_json["path.to_widget_on_nest"]=function(){return g.path.to_widget_on_nest()};g.creators_from_json["path.top_level_backside"]=function(){return g.path.top_level_backside};g.creators_from_json["path.to_backside_widget_of_context"]=function(a){return g.path.get_path_to_backside_widget_of_context(a.type_name)};g.creators_from_json["path.to_resource"]=function(a,
b){return g.path.get_path_to_resource(g.UTILITIES.create_from_json(a.resource,b))};return{get_path_to:function(a,b){var d=function(a,b){var d=b.get_context(),e=b.get_body(),m,r,h;a.is_backside()&&(h=!0,a=a.get_widget());if(d===a)return m=g.path.to_entire_context(),m.is_backside=h,m;r=a.get_type_name();if("top-level"===r)return g.path.top_level_backside;if(m=e.get_path_to(a,b))return m.is_backside=h,m;if("element attribute"===r&&a.get_original_attribute_widget()===a)return m=g.element.create_attribute_path(a,
b),m.is_backside=h,m;if(g.debugging&&!d)g.UTILITIES.report_internal_error("No context to compute the path");else{if(d.get_path_to&&(e=d.get_path_to(a,b)))return e.is_backside=h,m=g.path.to_entire_context(),m.next=e,m;d.backside_widgets.some(function(d){d=d.get_widget();var c;if(d===a||d.top_contents_is&&d.top_contents_is(a))return m=g.path.get_path_to_backside_widget_of_context(d.get_type_name()),m.is_backside=h,b.add_to_backside_conditions(d),!0;if(d.get_path_to&&(c=d.get_path_to(a,b)))return c.is_backside=
h,m=g.path.get_path_to_backside_widget_of_context(d.get_type_name()),m.next=c,b.add_to_backside_conditions(d),!0});if(m)return m.is_backside=h,m;if(d=a.ancestor_of_type("robot"))return g.robot.find_conditions_path(a,d,b);m=g.path.get_path_to_resource(a.copy());m.is_backside=h;return m}}(a,b);d&&a.dereference_contents&&(g.path.path_end(d).not_to_be_dereferenced=!0);!d||"pick up"!==b.current_action_name&&"remove"!==b.current_action_name||(g.path.path_end(d).removing_widget=!0);return d},path_end:function(a){for(;a.next;)a=
a.next;return a},dereference_path:function(a,b,d,g){var f;a?a.dereference_path?f=a.dereference_path(b,d,g):b.dereference_path&&(f=b.dereference_path(a,d,g)):f=b;return f&&a&&a.is_backside?f.get_backside(!0):f},continue_dereferencing_path:function(a,b,d,g){return a.next?b.dereference_contents&&!a.next.not_to_be_dereferenced?(b=b.dereference_contents(a.next,d,g))&&a.is_backside?b.get_backside(!0):b:(b=b.dereference_path(a.next,d,g))&&a.next.is_backside?b.get_backside(!0):b:b.dereference_contents&&!a.not_to_be_dereferenced?
(b=b.dereference_contents(a,d,g))&&a.is_backside?b.get_backside(!0):b:b},toString:function(a,b){var d="",k;a.is_backside&&(d="the backside of ");b||(b={});k=b.resource;b.resource=!0;a.next?(g.path.toString(a.next,b),d=d+g.path.toString(a.next,b).trim()+" of "+a.toString(b)):d+=a.toString(b);b.resource=k;return d},get_json:function(a,b){var d;if(!a.get_json)return a;d=a.get_json(b);a.is_widget&&a.add_to_json(d,b);a.next&&(d.next_path=g.path.get_json(a.next,b));a.removing_widget&&(d.removing_widget=
!0);a.not_to_be_dereferenced&&(d.not_to_be_dereferenced=!0);a.is_backside&&(d.is_backside=!0);return d},to_entire_context:function(a){return{dereference_path:function(a,d,k){return g.path.continue_dereferencing_path(this,a,d,k)},toString:function(a){return a&&a.robot?a.robot.get_top_level_context_description(a):a&&"third"===a.person?"what he's working on":"what I'm working on"},get_json:function(){return{type:"path.to_entire_context"}}}},to_widget_on_nest:function(){return{dereference_path:function(a,
b,d){return g.path.continue_dereferencing_path(this,a,b,d)},toString:function(){return"what is on the nest"},get_json:function(){return{type:"path.to_widget_on_nest"}}}},get_path_to_resource:function(a){a=a.get_widget();return{dereference_path:function(b,d,k){b=a.copy({copying_resource:!0});var f,m,e;k.add_newly_created_widget(b);k.visible()&&(f=g.UTILITIES.find_resource_equal_to_widget(a))&&(b.save_dimensions_of(g.UTILITIES.widget_of_element(f)),e=b.get_frontside_element(),m=$(f).position(),g.UTILITIES.set_timeout(function(){$(e).css({left:m.left,
top:m.top,width:$(f).width(),height:$(f).height()})}));return b},toString:function(b){return g.UTILITIES.add_a_or_an(a.toString(b))},get_json:function(){return{type:"path.to_resource",resource:g.path.get_json(a,g.UTILITIES.fresh_json_history())}}}},get_path_to_backside_widget_of_context:function(a){return{dereference_path:function(b,d,k){var f;b.backside_widgets.some(function(b){if(b.get_widget().is_of_type(a)&&!k.is_newly_created(b.get_widget()))return f=b.get_widget(),!0});if(f)return g.path.continue_dereferencing_path(this,
f,d,k)},toString:function(){var b="the "+a+" on the back of what I'm working on";return this.removing_widget?"what is on "+b:b},get_json:function(){return{type:"path.to_backside_widget_of_context",type_name:a}}}},create_from_json:function(a,b){var d=g.UTILITIES.create_from_json(a,b);a.next_path&&(d.next=this.create_from_json(a.next_path,b));a.removing_widget&&(d.removing_widget=!0);a.not_to_be_dereferenced&&(d.not_to_be_dereferenced=!0);a.is_backside&&(d.is_backside=!0);return d},top_level_backside:{dereference_path:function(a,
b,d){if(a=a.ancestor_of_type("top-level"))return a;m||(m=g.widget.create_top_level_widget());return m},toString:function(){return"the top-level backside"},get_json:function(){return{type:"path.top_level_backside"}}}}}(window.TOONTALK);window.TOONTALK.publish=function(g){var m=function(a,b,d){var g='<!DOCTYPE html>\n<html>\n<head>\n<link rel="stylesheet" media="all" href="https://toontalk.github.io/ToonTalk/toontalk.css">\n<link href="https://dl.dropboxusercontent.com/u/51973316/ToonTalk/libraries/froala-wysiwyg-editor/css/font-awesome.min.css" rel="stylesheet" type="text/css" />\n<link href="https://dl.dropboxusercontent.com/u/51973316/ToonTalk/libraries/froala-wysiwyg-editor/css/froala_editor.min.css" rel="stylesheet" type="text/css" />\n<script src="https://toontalk.github.io/ToonTalk/compile/toontalk.js">\x3c/script>\n<script src="https://toontalk.github.io/ToonTalk/libraries/jquery-ui-1.11.2.custom/jquery-ui.min.js">\x3c/script>\n<script src="https://dl.dropboxusercontent.com/u/51973316/ToonTalk/libraries/froala-wysiwyg-editor/js/froala_editor.min.js">\x3c/script>\n<script src="https://dl.dropboxusercontent.com/u/51973316/ToonTalk/libraries/froala-wysiwyg-editor/js/plugins/block_styles.min.js">\x3c/script>\n<script src="https://dl.dropboxusercontent.com/u/51973316/ToonTalk/libraries/froala-wysiwyg-editor/js/plugins/colors.min.js">\x3c/script>\n<script src="https://dl.dropboxusercontent.com/u/51973316/ToonTalk/libraries/froala-wysiwyg-editor/js/plugins/font_family.min.js">\x3c/script>\n<script src="https://dl.dropboxusercontent.com/u/51973316/ToonTalk/libraries/froala-wysiwyg-editor/js/plugins/font_size.min.js">\x3c/script>\n<script src="https://dl.dropboxusercontent.com/u/51973316/ToonTalk/libraries/froala-wysiwyg-editor/js/plugins/lists.min.js">\x3c/script>\n<script src="https://dl.dropboxusercontent.com/u/51973316/ToonTalk/libraries/froala-wysiwyg-editor/js/plugins/tables.min.js">\x3c/script>\n<script src="https://dl.dropboxusercontent.com/u/51973316/ToonTalk/libraries/froala-wysiwyg-editor/js/plugins/video.min.js">\x3c/script>\n<title>\n'+
a+'</title>\n<link rel="shortcut icon" href="favicon.ico" />\n</head>\n<body>\n';b.forEach(function(a,b){g+='<div class="toontalk-edit" name="content">\n'+a+"\n</div>\n";d[b]&&(g+=d[b])});return g+='<script src="https://toontalk.github.io/ToonTalk/support/published_support.js">\x3c/script>\n</body>\n</html>\n'};return{publish_widget:function(a,b,d,k){var f=g.google_drive.get_status(),p=["Edit this. Select text for formatting.","And edit this."],e=function(b){(b=b&&b.items&&0<b.items.length&&b.items[0])?
k(b,h):(b=m(a,p,h),g.google_drive.upload_file(w,"html",b,k))},w,r,h;"Ready"===f?(w=b.get_setting("program_name"),d?(r=g.UTILITIES.get_json_top_level(b),b.set_setting("program_name",w+" (published version)"),h=[g.UTILITIES.toontalk_json_div(r,b)],b.set_setting("program_name",w)):(b=b.get_backside_widgets(),h=[],b.forEach(function(a,b){a.visible()&&(r=g.UTILITIES.get_json_top_level(a),h.push(g.UTILITIES.toontalk_json_div(r,a.get_widget())),1<b&&(p[b]=p[1]))}),p.push(p[1])),g.google_drive.get_toontalk_files(g.google_drive.full_file_name(w,
"page"),"page",e)):(console.log("Unable to publish to Google Drive because: "+f),k(null))},republish:function(a){g.google_drive.insert_or_update_file(void 0,a.file_id,"page",m(a.title,a.editable_contents,a.widgets_json),function(){console.log("Published page '"+a.title+"' updated.")})}}}(window.TOONTALK);function handle_client_load(){window.TOONTALK.google_drive.handle_client_load()}
window.TOONTALK.google_drive=function(g){var m=g.GOOGLE_DRIVE_CLIENT_ID||"148386604750-704q35l4gcffpj2nn3p4ivcopl81nm27.apps.googleusercontent.com",a=g.ORIGIN_FOR_GOOGLE_DRIVE||"toontalk.github.io",b="Need to authorize",d,k;return{handle_client_load:function(d){0>window.location.href.indexOf(a)?(b="Connections to Google Drive are configured for the following domain only: "+a+".\nIf you are hosting ToonTalk elsewhere you need to set TOONTALK.GOOGLE_DRIVE_CLIENT_ID and TOONTALK.ORIGIN_FOR_GOOGLE_DRIVE",d&&
d(b)):setTimeout(function(){g.google_drive.check_authorization(d)})},check_authorization:function(a){b="Awaiting authorization";gapi.auth.authorize({client_id:m,scope:"https://www.googleapis.com/auth/drive",immediate:!0},function(b){g.google_drive.handle_authorization_result(b,a)})},handle_authorization_result:function(a,d){a&&!a.error?(b="Authorized but not yet ready",gapi.client.load("drive","v2",function(){g.google_drive.get_folder_ids(function(){b="Ready"})}),d&&d()):(b="Need to authorize",d&&
d(b))},authorize:function(a){gapi.auth.authorize({client_id:m,scope:"https://www.googleapis.com/auth/drive",immediate:!1},function(b){g.google_drive.handle_authorization_result(b,a)})},get_folder_ids:function(a){g.google_drive.get_folder_id(!0,function(b){d=b;g.google_drive.get_folder_id(!1,function(b){k=b;a()})})},get_folder_id:function(a,b){var e=a?"ToonTalk Programs":"ToonTalk Pages",m=function(d){var h=function(a){a&&a.id?b(a.id):console.error("Failure to create folder '"+e+"'. Response was "+
a)};(d=d&&d.items&&0<d.items.length&&d.items[0].id)?b(d):a?g.google_drive.create_folder("ToonTalk Programs",!1,h):g.google_drive.create_folder("ToonTalk Pages",!0,h)};a&&d?b(d):!a&&k?b(k):g.google_drive.fetch_folder_id(e,m)},get_status:function(){return b},connection_to_google_drive_possible:function(){return 0!==b.indexOf("Connections to Google Drive are configured for the following domain only: ")},list_files:function(a,b){gapi.client.request({path:"/drive/v2/files",method:"GET",params:a}).execute(b)},
fetch_folder_id:function(a,b){g.google_drive.list_files({q:"mimeType = 'application/vnd.google-apps.folder' and title ='"+a+"' and trashed = false"},b)},get_toontalk_files:function(a,b,d){"undefined"===typeof gapi?d("Google Drive API not available."):(b="properties has {key='ToonTalkType' and value='"+b+"' and visibility='PUBLIC'} and trashed = false",a&&(b+=" and title='"+a+"'"),g.google_drive.list_files({q:b},d))},get_toontalk_program_file:function(a,b){g.google_drive.list_files({q:"'"+d+"' in parents and trashed = false and title='"+
a+"'"},function(a){a&&a.items&&0<a.items.length?b(a.items[0]):b(null)})},upload_file:function(a,b,d,k){var m="json"===b?"program":"page",h=a+"."+b;g.google_drive.get_toontalk_files(h,m,function(a){gapi.client.load("drive","v2",function(){var b=a&&a.items&&0<a.items.length&&a.items[0].id;k||(k=function(a){a.error&&(console.log("Google drive status: "+g.google_drive.get_status()),"Login Required"!==a.error.message&&console.log(a.error.message));console.log("File "+a.title+" ("+a.id+") "+(b?"updated":
"created"))});b?g.google_drive.insert_or_update_file(void 0,b,m,d,k):g.google_drive.insert_or_update_file(h,void 0,m,d,k)})})},full_file_name:function(a,b){return a+"."+("program"===b?"json":"html")},insert_or_update_file:function(a,b,e,m,r){var h={title:a,mimeType:"text/html"};h.parents=[{kind:"drive#fileLink",id:"program"===e?d:k}];m="\r\n---------314159265358979323846\r\nContent-Type: application/json\r\n\r\n"+JSON.stringify(h)+"\r\n---------314159265358979323846\r\nContent-Type: text/html\r\n\r\n"+
m+"\r\n---------314159265358979323846--";a?(a="/upload/drive/v2/files",h="POST"):(a="/upload/drive/v2/files/"+b,h="PUT");gapi.client.request({path:a,method:h,params:{uploadType:"multipart"},headers:{"Content-Type":'multipart/mixed; boundary="-------314159265358979323846"'},body:m}).execute(function(a){b||g.google_drive.insert_property(a.id,"ToonTalkType",e,"PUBLIC");r&&r(a)})},create_folder:function(a,b,d){gapi.client.drive.files.insert({resource:{title:a,mimeType:"application/vnd.google-apps.folder"}}).execute(b?
function(a){gapi.client.drive.permissions.insert({fileId:a.id,resource:{value:"",type:"anyone",role:"reader"}}).execute(function(b){d(a)})}:d)},download_file:function(a,b){if(a.downloadUrl){var d=gapi.auth.getToken().access_token,g=new XMLHttpRequest;g.open("GET",a.downloadUrl);g.setRequestHeader("Authorization","Bearer "+d);g.onload=function(){b(g.responseText)};g.onerror=function(){b(null)};g.send()}else b(null)},google_drive_url:function(a){return"https://googledrive.com/host/"+a+"/"},insert_property:function(a,
b,d,g){gapi.client.drive.properties.insert({fileId:a,resource:{key:b,value:d,visibility:g}}).execute(function(a){})}}}(window.TOONTALK);function googleTranslateElementInit(){new google.translate.TranslateElement({pageLanguage:"en",layout:google.translate.TranslateElement.InlineLayout.SIMPLE},"google_translate_element")}
window.TOONTALK.UTILITIES=function(g){var m={},a,b=100,d=(new Date).getTime(),k,f=function(a){var b=a.indexOf("<div style='display:none;'>{"),b=0>b?a.indexOf("{"):b+27,c=a.lastIndexOf("}");if(!(0>b||0>c))return a.substring(b,c+1)},p=function(b,c){var d=$(c).closest(".toontalk-side"),e=m.get_mouse_or_first_touch_event_attribute("clientX",b),f=m.get_mouse_or_first_touch_event_attribute("clientY",b),g,h,k;$(".ui-tooltip").remove();$(".ui-tooltip").removeClass("toontalk-side-animating");b.dataTransfer&&
b.dataTransfer.getData("text")&&0<b.dataTransfer.getData("text").length||(a=d||$(c),h=m.widget_from_jquery(a),h||(h=m.widget_of_element(c),m.report_internal_error("Possible bug that "+a+" doesn't have a known owner."),a=$(c)),!h.save_dimensions||h.get_parent_of_frontside()&&!h.get_parent_of_frontside().get_widget().is_top_level()||h.save_dimensions(),h.being_dragged=!0,g=a.get(0).getBoundingClientRect(),k=a.is(".toontalk-top-level-resource"),h.get_json&&(d=m.get_json_top_level(h),d.view.drag_x_offset=
e-g.left,d.view.drag_y_offset=f-g.top,!d.view.frontside_width&&a.parent().is(".toontalk-backside")&&(d.view.frontside_width=a.width(),d.view.frontside_height=a.height()),a.is(".toontalk-backside")&&(d.view.backside=!0),a.data("json",d),b.dataTransfer&&(e=m.toontalk_json_div(d,h),b.dataTransfer.effectAllowed=k?"copy":"move",b.dataTransfer.setData("text",e),m.is_internet_explorer()||b.dataTransfer.setData("text/html",e)),h.drag_started(d,k)),a.addClass("toontalk-being-dragged"),b.stopPropagation())},
e=function(b){a||(a=$(b.target).closest(".toontalk-side"));m.widget_from_jquery(a).being_dragged=void 0;if(a.is(".toontalk-frontside"))if(a.parent().is(".toontalk-backside")){var c=a.data("json");c&&a.css({width:c.view.frontside_width,height:c.view.frontside_height})}else a.parent().is(".toontalk-top-level-resource, .toontalk-drop-area, .toontalk-json")||a.is(".toontalk-carried-by-bird, .toontalk-element-attribute, .toontalk-function-bird-documentation-bird")||m.has_animating_image(a.get(0))||a.css({width:"100%",
height:"100%"});R();b.stopPropagation()},w=function(b){if(a)return m.widget_from_jquery(a);b=m.data_transfer_json_object(b);return m.create_from_json(b)},r=function(b,d){var e=m.data_transfer_json_object(b),f,h,k,p,r,v,w,A,C,D;!e&&a&&(e=a.data("json"));a&&a.data("json","");f=a;R();if(f||e||b.dataTransfer.files||J(b)){if($(b.target).is(".toontalk-drop-area-instructions"))k=$(b.target).parent();else if($(b.target).is(".toontalk-element-attribute-input")){if(k=$(b.target).closest(".toontalk-side"),p=
m.widget_from_jquery(k)){h=f?m.widget_from_jquery(f):m.create_from_json(e);m.restore_resource(f,h);p.dropped_on_style_attribute(h,b.target.name,b);b.stopPropagation();return}}else if($(b.target).is(".toontalk-drop-area"))k=$(b.target);else{if(e&&$(b.currentTarget).is(".froala-element")){w=e;k=m.create_from_json(w);p=document.createElement("div");w=w.view.backside?k.get_backside_element(!0):k.get_frontside_element(!0);e=$(d).closest(".toontalk-edit");f=g.published_support.create_editable_text();h=
b.target;$(p).addClass("toontalk-json toontalk-top-level-resource toontalk-top-level-resource-container");$(w).addClass("toontalk-top-level-resource").css({position:"relative"});w.toontalk_widget=k;p.toontalk_widget=k;p.appendChild(w);for($(p).insertAfter(e);h.nextSibling;)$(f).children(".froala-element").get(0).appendChild(h.nextSibling);$(f).insertAfter(p);k.update_display();return}k=$(b.target).closest(".toontalk-side")}if(0!==k.length&&!k.is(".toontalk-top-level-resource")){w=k.offset();m.remove_highlight();
p=m.widget_from_jquery(k);if(f&&0<f.length&&!(p&&p.get_infinite_stack&&p.get_infinite_stack())&&(f.get(0)===k.get(0)||jQuery.contains(f.get(0),k.get(0)))){if(f.is(".toontalk-top-level-backside"))return;k.hide();h=m.get_mouse_or_first_touch_event_attribute("pageX",b);r=m.get_mouse_or_first_touch_event_attribute("pageY",b);h=document.elementFromPoint(h-window.pageXOffset,r-window.pageYOffset);k.show();h&&(k=$(h).closest(".toontalk-side"),w=k.offset(),p=m.widget_from_jquery(k))}e&&e.view&&e.view.drag_x_offset?
(r=e.view.drag_x_offset,v=e.view.drag_y_offset):v=r=0;if(f&&0<f.length){if(!(p&&p.get_infinite_stack&&p.get_infinite_stack()||f.get(0)!==k.get(0)&&!jQuery.contains(f.get(0),k.get(0)))){f.css({left:f.get(0).offsetLeft+(b.layerX-r),top:f.get(0).offsetTop+(b.layerY-v)});b.stopPropagation();return}A=f.is(".toontalk-backside");h=m.widget_from_jquery(f);f.parent().is(".toontalk-drop-area")?(f.removeClass("toontalk-widget-in-drop_area"),f.parent().data("drop_area_owner").set_next_robot(void 0)):(C=f.parents(".toontalk-side:first"),
(D=m.widget_from_jquery(C))?!A&&h.get_infinite_stack&&h.get_infinite_stack()?(C=h.saved_width,D=h.saved_height,h=h.copy(),h.saved_width=C,h.saved_height=D,C=f.width(),D=f.height(),f=$(h.get_frontside_element(!0)),k.is(".toontalk-backside")&&f.css({width:e.view.frontside_width||C,height:e.view.frontside_height||D})):D.removed_from_container&&(C.is(".toontalk-backside")?D.remove_backside_widget(h,A,!0):(D.removed_from_container(h,A,b,void 0,!0),h.restore_dimensions&&!D.is_empty_hole()&&h.restore_dimensions())):
m.restore_resource(f,h),h.robot_in_training()&&h.robot_in_training().add_newly_created_widget_if_new(h))}else{if(0<b.dataTransfer.files.length){for(e=0;e<b.dataTransfer.files.length;e++)t(b.dataTransfer.files[e],k,p,w,b);b.stopPropagation();return}if(J(b)){x(b.dataTransfer.getData("text/uri-list"),k,p,w,b);b.stopPropagation();return}h=m.create_from_json(e,{event:b});if(!h){e?m.report_internal_error("Unable to construct a ToonTalk widget from the JSON."):g.debugging&&console.log("No data transfer in drop.");
b.stopPropagation();return}h.robot_in_training()&&h.robot_in_training().drop_from_data_transfer(h);(A=e.view.backside)?(f=$(h.get_backside_element()),f.css({width:e.view.backside_width,height:e.view.backside_height,"background-color":e.view.background_color,"border-width":e.view.border_width}),h.apply_backside_geometry()):f=$(h.get_frontside_element())}h!==p&&c(k,f,h,p,w,b,e,r,v,A)}}else b.dataTransfer?m.report_internal_error("Drop failed since unable to parse as JSON."):m.report_internal_error("Drop failed since there is no event.dataTransfer"),
b.stopPropagation()},h=function(a,b){a.addEventListener("drop",function(a){var c=w(a);m.restore_resource(m.get_dragee(),c);b(a)})},v=function(a,b){var c;c=$(b).closest(".toontalk-side");var d=m.get_dragee();c=!c.is("*")||c.is(".toontalk-top-level-backside")||c.closest(".toontalk-top-level-resource").is("*")||c.is(".toontalk-being-dragged")||d&&H(c.get(0),d.get(0))?void 0:c;if(c)return m.highlight_element(c.get(0),a),c.get(0)},c=function(a,b,c,d,e,f,g,h,k,p){var r=m.get_mouse_or_first_touch_event_attribute("pageX",
f),t=m.get_mouse_or_first_touch_event_attribute("pageY",f),v,w,x,A,C,D;c.set_visible(!0);if(a.is(".toontalk-backside")){if(c.is_top_level()){v=g.semantic.backside_widgets;w=g.shared_widgets;x=a.get(0);(f=d.robot_in_training())&&f.drop_from_data_transfer(c,d);f=c.get_backside_widgets().slice();f.forEach(function(a,b){var e=a.get_widget(),l,f,g,h,k,q,p;c.remove_backside_widget(e,a.is_backside());l=0<=v[b].widget.shared_widget_index?w[v[b].widget.shared_widget_index].view:v[b].widget.view;a.is_backside()?
(f=e.get_backside_element(!0),g=l.backside_left,h=l.backside_top,k=l.backside_width,q=l.backside_height):(f=e.get_frontside_element(!0),g=l.frontside_left,h=l.frontside_top,k=l.frontside_width,q=l.frontside_height);d.add_backside_widget(e,a.is_backside());x.appendChild(f);p=$(f).position();D={left:p.left+g,top:p.top+h,width:k,height:q};m.constrain_css_to_fit_inside(x,D);$(f).css(D);a.is_backside()&&(e.backside_geometry=l.backside_geometry,e.apply_backside_geometry())}.bind(this));return}c?d.get_backside().widget_dropped_on_me(c,
p,f):m.report_internal_error("No source_widget");"undefined"===typeof h&&c.is_element()&&(k=h=0,setTimeout(function(){var a=c.get_HTML(),d=b.width(),e=b.height();0<=a.indexOf("data:image")?(a=Math.min(80,d)/2,d=90,90>e&&(d-=(90-e)/2)):(a=Math.min(60,d/2),d=Math.min(30,e/2));b.css({left:A-a,top:C-d})},50));A=r-(e.left+(h||0));C=t-(e.top+(k||0));b.css({left:A,top:C});g&&g.semantic.running&&!m.get_dragee()&&c.set_running(!0)}else if(a.is(".toontalk-drop-area"))b.addClass("toontalk-widget-in-drop_area"),
a.append(b.get(0)),b.is(".toontalk-robot")&&a.data("drop_area_owner").set_next_robot(m.widget_from_jquery(b));else{if(b.is(".toontalk-backside-of-top-level"))return;if(d||f.changedTouches){x=a.closest(".toontalk-top-level-backside").get(0);!x&&f.changedTouches&&(e=document.elementFromPoint(r-window.pageXOffset,t-window.pageYOffset),(x=$(e).is(".toontalk-top-level-backside")?e:$(e).closest(".toontalk-top-level-backside").get(0))||(x=$(".toontalk-top-level-backside").get(0)),d=m.widget_of_element(x).get_backside());
if(!x)return;x.appendChild(b.get(0));e=$(x).offset();b.css({left:r-(e.left+h),top:t-(e.top+k)});c.drop_on&&c.drop_on(d,p,f)||d.widget_dropped_on_me&&d.widget_dropped_on_me(c,p,f)||(a=a.closest(".toontalk-top-level-backside"),0<a.length&&(d=m.widget_from_jquery(a))&&d.get_backside().widget_dropped_on_me(c,p,f))}else{m.report_internal_error("target widget missing");return}}m.remove_highlight()},t=function(a,b,d,e,h){var k=new FileReader,p=0===a.type.indexOf("image"),r=0===a.type.indexOf("audio"),t=
0===a.type.indexOf("video"),v,w,x;k.onloadend=function(){if(p)v=g.element.create("<img src='"+k.result+"' alt='"+a.name+"'/>");else if(r)v=g.element.create(a.name+" sound"),v.set_sound_effect(new Audio(k.result));else if(t)v=g.element.create("<video src='"+k.result+"' alt='"+a.name+"'/>");else{if(w=f(k.result))try{x=JSON.parse(w),v=m.create_from_json(x)}catch(A){}v||(v=g.element.create(k.result))}v&&v.robot_in_training()&&v.robot_in_training().drop_from_data_transfer(v,d);c(b,$(v.get_frontside_element(!0)),
v,d,e,h,x)};p||r||t?k.readAsDataURL(a):k.readAsText(a)},x=function(a,b,d,e,f){var g=function(a,b,d,e,l){m.create_widget_from_URL(a,function(a){a&&(a&&a.robot_in_training()&&a.robot_in_training().drop_from_data_transfer(a,d),c(b,$(a.get_frontside_element(!0)),a,d,e,l))})};a.split(/\r?\n/).forEach(function(a){"#"!==a[0]&&g(a,b,d,e,f)})},A=function(a,b){var c=$("<div class='"+a+"'>");m.run_when_dimensions_known(c.get(0),function(){var a=c.width(),d=c.height();b.get_default_width=function(){return a};
b.get_default_height=function(){return d}})},D=function(a){var b=m.get_path_to_toontalk_folder()+"sounds/",c=function(c){c=new Audio(b+c);c.volume=a;return c};g.sounds={hatching:c("SPARROW.WAV"),bird_fly:c("PIGEON.WAV"),bammer_hammer:c("POP.WAV"),vacuum_spit:c("SPIT.WAV"),vacuum_suck:c("DUSTBUST.WAV"),drop:c("BOOK_DROP.WAV"),magic:c("MAGIC.WAV"),fall_inside:c("FALL_INSIDE.WAV"),event_ignored:c("PLOP.WAV")};g.sounds.bird_fly.loop=!0},E=function(a){var b=document.createElement("script");b.src=a;document.body.appendChild(b)},
R=function(){a&&(a.removeClass("toontalk-being-dragged"),m.set_timeout(function(){a=void 0}))},H=function(a,b){if(a===b)return!0;if(a.parentNode)return H(a.parentNode,b)},L=function(a,b){var c=0,d=a.indexOf("decodeURIComponent"),e="",f,g;if(0>d)return a;for(;0<=d;){f=d+18;g=a.indexOf("decodeURIComponent",f);if(0>g)return m.report_internal_error("Expected title to have an even number of occurrences of decodeURIComponent"),a;e+=a.substring(c,d)+b(a.substring(f,g));c=g+18;d=a.indexOf("decodeURIComponent",
c)}return e+=a.substring(c)},J=function(a){return(a=a.dataTransfer&&a.dataTransfer.getData("text/uri-list"))&&0<a.length&&0>a.indexOf("data:")},K=[],C=[],F,P;window.addEventListener("message",function(a){"zero-timeout-message"===a.data&&a.source===window?(a.stopPropagation(),0<K.length&&K.shift()()):a.data.editable_contents&&g.publish.republish(a.data)},!1);$(document).ready(function(){var a;g.debugging=m.get_current_url_parameter("debugging");g.logging=m.get_current_url_parameter("log");a=m.get_current_url_numeric_parameter("volume",
10);0<a&&D(a/100);m.process_json_elements();$(document).click(function(a){$(".toontalk-top-level-resource-container").each(function(a,b){var c=b.toontalk_widget;c&&c.set_running&&c.set_running(!1)})});g.QUEUE=window.TOONTALK.queue.create();g.QUEUE.run();window.addEventListener("beforeunload",function(a){try{m.backup_all_top_level_widgets(!0)}catch(b){console.log(b)}});g.TRANSLATION_ENABLED=m.get_current_url_boolean_parameter("translate",!1);g.TRANSLATION_ENABLED?($("a").each(function(a,b){b.href=
m.add_URL_parameter(b.href,"translate","1")}),$("#google_translate_element").is("*")||(a=document.createElement("div"),a.id="google_translate_element",document.body.insertBefore(a,document.body.firstChild)),document.head.appendChild($('<meta name="google-translate-customization" content="7e20c0dc38d147d6-a2c819007bfac9d1-gc84ee27cc12fd5d1-1b"></meta>')[0]),E("https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit")):$("#google_translate_element").remove();g.vacuum.the_vacuum||
g.vacuum.create();m.add_test_all_button();A("toontalk-robot",g.robot);A("toontalk-empty-nest",g.nest);A("toontalk-bird-static",g.bird)});m.available_types="number box element robot nest sensor top-level".split(" ");m.create_from_json=function(a,b,c){var d=function(a,b,c){(b.shared_widgets[c]=a)&&a.finish_create_from_json_continuation&&(a.finish_create_from_json_continuation(),a.finish_create_from_json_continuation=void 0);return a},e,f,h,k;if(a){b||(b={});b.guid_to_nest_table||(b.guid_to_nest_table=
{});a.shared_widgets&&(b.json_of_shared_widgets=a.shared_widgets,b.shared_widgets=[]);a.shared_html&&(b.shared_html=a.shared_html);if(a.widget)return(e=m.create_from_json(a.widget,b))&&a.is_backside?e.get_backside(!0):e;if(b&&b.shared_widgets&&0<=a.shared_widget_index){if(c=b.shared_widgets[a.shared_widget_index])return c;c=b.json_of_shared_widgets[a.shared_widget_index];e=m.create_from_json(c,b,!0);return d(e,b,a.shared_widget_index)}(h=a.semantic)||(h=a);a=a.view;if(0<=h.shared_widget_index){if(!b.json_of_shared_widgets){m.report_internal_error("JSON refers to shared widgets but they can't be found. Sorry.");
return}e=m.create_from_json(b.json_of_shared_widgets[h.shared_widget_index],b,!0);return d(e,b,h.shared_widget_index)}if(g.creators_from_json[h.type]){b||(b={});a?b.json_view=a:a=b.json_view;try{e=g.creators_from_json[h.type](h,b)}catch(p){m.report_internal_error("Unable to recreate a "+h.type+". Error is "+p)}if(e&&e.get_backside){h.erased&&(g.widget.erasable(e),e.set_erased(h.erased));h.infinite_stack&&e.set_infinite_stack(h.infinite_stack);if(a&&a.frontside_width&&(f=a.backside?e.get_backside(!0).get_element():
e.get_frontside_element(),e.ok_to_set_dimensions()))if(k={width:a.frontside_width,height:a.frontside_height},"element"===h.type)e.on_update_display(function(){$(f).css(k)});else $(f).css(k);a&&a.saved_width&&(e.saved_width=a.saved_width,e.saved_height=a.saved_height);a&&a.backside_geometry&&(e.backside_geometry=a.backside_geometry);h.backside_widgets&&(c?e.finish_create_from_json_continuation=function(){this.add_backside_widgets_from_json(e,h.backside_widgets,b)}.bind(this):this.add_backside_widgets_from_json(e,
h.backside_widgets,b))}return e}m.report_internal_error("JSON type '"+h.type+"' not supported. Perhaps a JavaScript file implementing it is missing.")}};m.add_backside_widgets_from_json=function(a,b,c){var d;b&&(d=this.create_array_from_json(b,c),a.set_backside_widget_sides(d,b.map(function(a){return 0<=a.widget.shared_widget_index?c.json_of_shared_widgets[a.widget.shared_widget_index].view:a.widget.view})))};m.create_array_from_json=function(a,b){var c=[];a.forEach(function(a,d){c[d]=a?m.create_from_json(a,
b):a});return c};m.get_json_of_array=function(a,b){var c=[];a.forEach(function(a,d){try{a.is_backside&&a.is_backside()?c[d]={widget:m.get_json(a.get_widget(),b),is_backside:!0}:c[d]=a.get_type_name?{widget:m.get_json(a,b)}:a.get_json(b)}catch(e){m.report_internal_error("Error trying to save "+a)}});return c};m.fresh_json_history=function(){return{widgets_encountered:[],shared_widgets:[],json_of_widgets_encountered:[]}};m.get_json_top_level=function(a){var b=this.fresh_json_history(),c=m.get_json(a,
b);0<b.shared_widgets.length&&(c.shared_widgets=b.shared_widgets.map(function(d,e){var f=function(a){a=b.widgets_encountered.indexOf(a);return b.json_of_widgets_encountered[a]},g=function(a){return f(b.shared_widgets[a])},h=f(d);a===d?(h={semantic:h.semantic,view:h.view,version:h.version},c.semantic={shared_widget_index:e}):m.tree_replace_once(c.semantic,h,{shared_widget_index:e},g,m.generate_unique_id());return h}));c.shared_html=b.shared_html;return c};m.get_json=function(a,b){var c,d,e;g.debugging&&
!b&&m.report_internal_error("no json_history");c=b.shared_widgets.indexOf(a);if(0<=c)return{shared_widget_index:c};c=b.widgets_encountered.indexOf(a);if(0<=c)return c=m.insert_ancestors_last(a,b.shared_widgets),{shared_widget_index:c};c=b.widgets_encountered.push(a)-1;e=a.is_backside();a=a.get_widget();d=a.get_json(b);d=a.add_to_json(d,b);d.view.backside=e;b.json_of_widgets_encountered[c]=d;a.add_backside_widgets_to_json&&a.add_backside_widgets_to_json(d,b);return d};m.get_json_of_keys=function(a,
b){var c;b||(b=[]);Object.keys(a).forEach(function(d){0>b.indexOf(d)&&(c||(c={}),c[d]=a[d].get_json?{json:a[d].get_json()}:a[d])});return c};m.create_keys_from_json=function(a,b){var c={};Object.keys(a).forEach(function(d){c[d]=a[d].json?m.create_from_json(a[d].json,b):a[d]});return c};m.tree_replace_once=function(a,b,c,d,e){if(a.id_of_tree_replace_once_task!==e){a.id_of_tree_replace_once_task=e;var f;Object.keys(a).forEach(function(g){if(f=a[g]){if(f===b)return a[g]=c,!0;if("shared_widget_index"===
g){if(this.tree_replace_once(d(f),b,c,d,e))return!0}else if(!(0<=["string","number","function","undefined","boolean"].indexOf(typeof f))&&this.tree_replace_once(f,b,c,d,e))return!0}}.bind(this));return!1}};m.insert_ancestors_last=function(a,b){var c=-1;b.some(function(b,d){if(a.has_ancestor(b))return c=d,!0});0>c&&(c=b.length);b.splice(c,0,a);return c};m.toontalk_json_div=function(a,b){var c=a.view.backside,d=b.get_backside_widgets(),e=b.get_type_name(),f=b.toString();"top-level"===e?c?(a.semantic.settings=
void 0,e="a work area containing ",0===d.length?e="an empty work area":(e=1===d.length?e+"one thing: ":e+(d.length+" things: "),F=d.length,d.forEach(function(a){F--;e+=m.add_a_or_an(a.get_type_name());1===F?e+=", and ":1<F&&(e+=", ")}))):e="a top-level widget":(e=m.add_a_or_an(e),c&&(e="the back of "+e));f&&(c=f.indexOf("data:image/"),0<c&&(d=f.indexOf("alt=",c),0>d&&(d=f.indexOf(">",c)),f=f.substring(0,c+20)+" ... "+f.substring(d)));return"<div class='toontalk-json'>\nThis will be replaced by "+
e+".\n"+(f?f+"\n":"")+"<div style='display:none;'>"+JSON.stringify(a,m.clean_json,"  ")+"</div></div>"};m.elide=function(a,b,c){c=Math.round(b*c);if(a.length<=b)return a;c=Math.max(c,a.indexOf(" ",c));b=a.length-(b-c);b=Math.max(b,a.indexOf(" ",b)+1);return a.substring(0,c)+" ... "+a.substring(b,a.length)};m.clean_json=function(a,b){return"id_of_tree_replace_once_task"===a?void 0:b};m.create_widget_from_URL=function(a,b,c){var d=function(f){try{var h=this.getResponseHeader("content-type"),k;if(!h)return;
0===h.indexOf("audio")?(k=g.element.create(a),k.set_sound_effect(new Audio(a))):0===h.indexOf("image")?k=g.element.create("<img src='"+a+"'>"):0===h.indexOf("video")?k=g.element.create("<video src='"+a+" ' width='320' height='240'>"):0===h.indexOf("text")&&0>h.indexOf("text/html")?this.responseText&&(k=g.element.create(this.responseText),k.set_source_URL(a)):k=g.element.create("<div class='toontalk-iframe-container'><iframe src='"+a+"' width='480' height='320'></iframe></div>");k&&b(k)}catch(p){m.display_message("Error: "+
p+". When trying to fetch "+a),c&&c(p),b()}e.removeEventListener("readystatechange",d)},e=new XMLHttpRequest;e.addEventListener("readystatechange",d);e.addEventListener("error",c);e.open("GET",a,!0);e.send()};m.copy_widgets=function(a,b){var c=[],d;for(d=0;d<a.length;d++)c[d]=a[d]&&a[d].copy(b);return c};m.copy_widget_sides=function(a,b){return a.map(function(a){var c=a.get_widget().copy(b);return a.is_backside()?c.get_backside(!0):c})};m.copy_array=function(a){return a.slice()};m.generate_unique_id=
function(){d+=1;return"toontalk_id_"+d};m.get_style_property=function(a,b){if(a.currentStyle)return a.currentStyle[b];if(window.getComputedStyle)return document.defaultView.getComputedStyle(a,null).getPropertyValue(b)};m.get_style_numeric_property=function(a,b){var c=this.get_style_property(a,b),d;return"string"===typeof c?(d=c.indexOf("px"),0<=d&&(c=c.substring(0,d)),parseInt(c,10)):c};m.data_transfer_json_object=function(a){var b;if(a.dataTransfer&&!(0<a.dataTransfer.files.length||J(a))){try{b=
a.dataTransfer.getData("text/html")}catch(c){b=a.dataTransfer.getData("text")}if(!b||b.match(/[\u3400-\u9FBF]/))b=a.dataTransfer.getData("text");if(b){a=f(b);if(!a)return m.get_json_top_level(g.element.create(b));try{return JSON.parse(a)}catch(d){m.report_internal_error("Exception parsing "+a+"\n"+d.toString())}}}};m.drag_and_drop=function(a){var b;m.draggable(a);m.can_receive_drops(a);$(a).is(".toontalk-backside-of-top-level")||(b=$(a).is(".toontalk-top-level-resource")?0:500,m.enable_touch_events(a,
b))};m.draggable=function(a){$(a).attr("draggable",!0);a.addEventListener("dragstart",function(b){p(b,a)});a.addEventListener("dragend",function(b){e(b,a)})};m.can_receive_drops=function(a){var b;a.addEventListener("dragover",function(a){a.preventDefault();return!1});a.addEventListener("drop",function(b){b.preventDefault();r(b,a);b.stopPropagation()});a.addEventListener("dragenter",function(c){var d=v(c,a);d&&b!==d&&m.remove_highlight(b);b=d;c.stopPropagation()});a.addEventListener("dragleave",function(a){b&&
!m.inside_rectangle(a.clientX,a.clientY,b.getBoundingClientRect())&&(m.remove_highlight(b),b=void 0);a.stopPropagation()})};m.create_drop_area=function(a){var b=document.createElement("div"),c=$(b),d=document.createElement("div");d.innerHTML=a;$(d).addClass("toontalk-drop-area-instructions ui-widget");c.addClass("toontalk-drop-area");c.append(d);m.can_receive_drops(b);return c};m.process_json_elements=function(){$(".toontalk-json").each(function(a,b){var c=b.textContent,d,e,f,h;if(c)if(c=c.substring(c.indexOf("{"),
c.lastIndexOf("}")+1),d=JSON.parse(c),e=m.create_from_json(d)){b.textContent="";if(e.get_type_name)if(e.is_top_level()){if(!g.no_local_storage&&!m.get_current_url_boolean_parameter("reset",!1)){if(d.load_most_recent_program)try{(h=window.localStorage.getItem("toontalk-last-key"))&&(f=window.localStorage.getItem(h))}catch(k){c="Error reading previous state. Error message is "+k,m.is_internet_explorer()?console.error(c):m.display_message(c)}f&&(d=JSON.parse(f),e=m.create_from_json(d))}f=e.get_backside(!0);
f=f.get_element();$(b).replaceWith(f);$(f).css({width:d.view.backside_width,height:d.view.backside_height,"background-color":d.view.background_color,"border-width":d.view.border_width})}else $(b).addClass("toontalk-top-level-resource toontalk-top-level-resource-container"),f=e.get_frontside_element(),$(f).addClass("toontalk-top-level-resource").css({position:"relative"}),b.toontalk_widget=e,b.appendChild(f);else b.appendChild(e.get_element());e.set_active&&e.set_active(!1);e.set_visible&&e.set_visible(!0);
setTimeout(function(){e.update_display&&e.update_display();d.semantic.running&&e.set_running(!0)},1)}else m.report_internal_error("Could not recreate a widget from this JSON: "+c)})};m.set_absolute_position=function(a,b){for(var c=a.parent(),d=b.left,e=b.top,f;c.is("*")&&!c.is("html");)f=c.position(),d-=f.left,e-=f.top,c=c.parent();a.css({left:d,top:e,position:"absolute"});a.is(".toontalk-side-animating")&&(a.get(0).style.left=d+"px",a.get(0).style.top=e+"px")};m.set_position_relative_to_top_level_backside=
function(a,b,c){var d=a.closest(".toontalk-top-level-backside"),e=d.offset(),f,g;e||(console.log("Unable to find top-level backside. Perhaps is 'visible' but not attached."),e={left:0,top:0});f=b.left-e.left;b=b.top-e.top;c&&(c=a.width(),e=a.height(),g=d.width(),d=d.height(),f>g-c&&(f=g-c),0>f&&(f=0),b>d-e&&(b=d-e),0>b&&(b=0));a.css({left:f,top:b,position:"absolute"});a.is(".toontalk-side-animating")&&(a.get(0).style.left=f+"px",a.get(0).style.top=b+"px",m.add_one_shot_event_handler(a.get(0),"transitionend",
2E3,function(){a.removeClass("toontalk-side-animating");a.get(0).style.transitionDuration=""}))};m.restore_resource=function(a,b){var c,d;a&&a.is(".toontalk-top-level-resource")&&(c=b.copy({fresh_copy:!0}),d=c.get_frontside_element(),$(d).css({width:a.width(),height:a.height()}),a.parent().removeClass("toontalk-top-level-resource toontalk-top-level-resource-container"),a.removeClass("toontalk-top-level-resource toontalk-top-level-resource-container"),$(d).addClass("toontalk-top-level-resource toontalk-top-level-resource-container").css({position:"relative"}),
a.get(0).parentElement.appendChild(d),g.DISPLAY_UPDATES.pending_update(c),b.set_active&&(b.set_active(!0),c.set_active(!1)))};m.find_resource_equal_to_widget=function(a){var b;$(".toontalk-top-level-resource.toontalk-side").each(function(c,d){var e=m.widget_from_jquery($(d));if(e&&(a.equals&&a.equals(e)||a.matching_resource&&a.matching_resource(e)||"matched"===a.match(e))&&e.get_backside_widgets().length===a.get_backside_widgets().length)return b=d,!1});return b};m.set_position_is_absolute=function(a,
b){var c,d;b?(c=$(a).position(),d=c.left,c=c.top,$(a).css({left:d,top:c,position:"absolute"})):a.style.position="static"};m.ordinal=function(a){a++;switch(a){case 1:return"first";case 2:return"second";case 3:return"third";case 4:return"fourth";case 5:return"fifth";case 6:return"sixth";case 7:return"seventh";case 8:return"eighth";case 9:return"ninth";case 10:return"tenth";default:return 1===a%10?a+"st":2===a%10?a+"nd":3===a%10?a+"rd":a+"th"}};m.on_a_nest_in_a_box=function(a){return $(a).closest(".toontalk-nest").is("*")&&
$(a).closest(".toontalk-box").is("*")};m.give_tooltip=function(a,b){a.title=b;m.use_custom_tooltip(a)};m.use_custom_tooltip=function(a){var b=$(a),c;b.tooltip({position:{my:"center bottom-20",at:"center top",using:function(a,d){var e;0>a.top&&(a.top=0,e=b.offset(),e.left<$(window).width()/2?a.left=e.left+b.width()+10:(a.left=0,c=e.left-40));"bottom"===d.vertical?(b.is(".toontalk-robot")?a.top-=30:b.is(".toontalk-number")?a.top-=30:b.is(".toontalk-box")?a.top-=30:a.top-=20,10>a.left&&(a.left=10),10>
a.top&&(a.top=10)):a.top+=20;a.left=Math.max(a.left,window.scrollX);a.top=Math.max(a.top,window.scrollY);$(this).css(a)}},open:function(a,b){var d=b.tooltip.get(0).textContent.length,e=b.tooltip.get(0),f;e.innerHTML=L(b.tooltip.get(0).textContent.replace(/(\r\n|\n|\r)/g,"<br>"),decodeURIComponent);100<d&&(f=Math.min(800,c||$(window).width()-100),$(e).position(),b.tooltip.css({maxWidth:f}));P&&P.hide();P=b.tooltip;setTimeout(function(){b.tooltip.hide();P=void 0},d*(g.MAXIMUM_TOOLTIP_DURATION_PER_CHARACTER||
100))},close:function(){P=void 0}})};m.encode_HTML_for_title=function(a){return encodeURIComponent("decodeURIComponent"+a+"decodeURIComponent")};m.remove_encoded_HTML=function(a){return L(a,function(){return""})};m.add_one_shot_event_handler=function(a,b,c,d){var e=!1,f=function(c){e=!0;d&&d();a.removeEventListener(b,f)};a.addEventListener(b,f);setTimeout(function(){e||f()},c)};m.default_animation_speed=.5;m.animate_to_absolute_position=function(a,b,c,d,e,f){var g=$(a).offset(),h=$(a).position(),
k=m.distance(b,g);0===f?(m.set_absolute_position($(a),b),c&&c()):($(a).css({"z-index":m.next_z_index()}),f||(f=Math.round(k/(d||m.default_animation_speed))),$(a).addClass("toontalk-side-animating"),a.style.transitionDuration=f+"ms",k=h.left+(b.left-g.left),g=h.top+(b.top-g.top),a.style.left=k+"px",a.style.top=g+"px",a.toontalk_followed_by&&(b.left+=a.toontalk_followed_by.left_offset,b.top+=a.toontalk_followed_by.top_offset,m.animate_to_absolute_position(a.toontalk_followed_by.element,b,void 0,d,e)),
e?setTimeout(c,f):setTimeout(function(){$(a).removeClass("toontalk-side-animating");a.style.transitionDuration="";c&&c()},f))};m.distance=function(a,b){var c=a.left-b.left,d=a.top-b.top;return Math.sqrt(c*c+d*d)};m.highlight_element=function(a,b,c){var d;if(a){m.remove_highlight();if(!$(a).is(".toontalk-backside")&&(d=m.widget_of_element(a),!d||d.element_to_highlight&&b&&(a=d.element_to_highlight(b),!a)))return;$(a).is(".toontalk-highlight")||($(a).addClass("toontalk-highlight").css({"z-index":m.next_z_index()}),
c&&setTimeout(function(){m.remove_highlight()},c))}};m.remove_highlight=function(a){a?$(a).removeClass("toontalk-highlight"):$(".toontalk-highlight").removeClass("toontalk-highlight")};m.cursor_of_image=function(a){var b=a.lastIndexOf(".");return 0<=b?a.substring(0,b)+".32x32"+a.substring(b):a};m.inside_rectangle=function(a,b,c){return a>=c.left&&a<=c.right&&b>=c.top&&b<=c.bottom};m.constrain_css_to_fit_inside=function(a,b){var c=$(a).width();if(0!==c){var d=$(a).height();b.left=Math.min(Math.max(b.left,
0),c);b.top=Math.min(Math.max(b.top,0),d)}};m.next_z_index=function(){b++;return b};m.create_button=function(a,b,c,d){a=$("<button>"+a+"</button>").button();a.addClass(b).click(d);m.give_tooltip(a.get(0),c);return a.get(0)};m.create_close_button=function(a,b){var c=document.createElement("div"),d=document.createElement("div");$(c).addClass("toontalk-close-button");$(c).click(a);m.give_tooltip(c,b);d.innerHTML="&times;";c.appendChild(d);return c};m.check_radio_button=function(a){$(a.button).prop("checked",
!0);$(a.label).addClass("ui-state-active")};m.create_button_set=function(){var a=document.createElement("div"),b,c;for(b=0;b<arguments.length;b++)if(0<=arguments[b].length)for(c=0;c<arguments[b].length;c++)a.appendChild(arguments[b][c]);else a.appendChild(arguments[b]);$(a).buttonset();return a};m.create_alert_element=function(a){a=m.create_text_element(a);$(a).addClass("toontalk-alert-element");return a};m.create_text_element=function(a){var b=document.createElement("div");b.innerHTML=a;$(b).addClass("ui-widget");
return b};m.create_space=function(){var a=document.createElement("span");a.innerHTML="&nbsp;";$(a).addClass("ui-widget");return a};m.create_anchor_element=function(a,b){var c=document.createElement("a");c.innerHTML=a;g.TRANSLATION_ENABLED&&(b=m.add_URL_parameter(b,"translate","1"));c.href=b;c.target="_blank";return c};m.create_text_input=function(a,b,c,d,e,f,g){var k=document.createElement("input"),p;k.type="text";k.className=b;k.value=a;m.give_tooltip(k,d);f&&(k.type=f);c?(a=document.createElement("label"),
a.innerHTML=c,k.id=m.generate_unique_id(),a.htmlFor=k.id,e&&(p=m.create_anchor_element("i",e),$(p).addClass("toontalk-help-button notranslate"),p.translate=!1),c=m.create_horizontal_table(a,k,p),$(a).addClass("ui-widget")):c=k;$(k).button().addClass("toontalk-text-input").css({"background-color":"white"});k.addEventListener("touchstart",function(){$(k).select()});g&&h(k,g);m.use_custom_tooltip(k);return{container:c,button:k}};m.create_text_area=function(a,b,c,d,e,f){var g=document.createElement("textarea");
g.className=b;g.value=a;m.give_tooltip(g,d);a=document.createElement("label");a.innerHTML=c;g.id=m.generate_unique_id();a.htmlFor=g.id;c=m.create_horizontal_table(a,g);$(g).button().addClass("toontalk-text-area").css({background:"white"});g.addEventListener("touchstart",function(){$(g).select()});e&&h(g,e);$(a).addClass("ui-widget");m.use_custom_tooltip(g);return{container:c,button:g}};m.input_area_drop_handler=function(a,b,c){var d,e;a.preventDefault();(d=w(a))&&d!==c&&(e=b(d,a))&&($(a.currentTarget).trigger("change"),
a.currentTarget.value=e,d.remove(),a.stopPropagation());return"string"===typeof e&&d};m.create_radio_button=function(a,b,c,d,e){var f=document.createElement("div"),g=document.createElement("input"),h=document.createElement("label");g.type="radio";g.className=c;g.name=a;g.value=b;h.innerHTML=d;g.id=m.generate_unique_id();h.htmlFor=g.id;f.appendChild(g);f.appendChild(h);m.give_tooltip(f,e);$(g).button();m.use_custom_tooltip(g);return{container:f,button:g,label:h}};m.create_select_menu=function(a,b,
c,d,e,f){var g=document.createElement("div"),h=document.createElement("select"),k=document.createElement("label");h.className=c;h.name=a;h.id=m.generate_unique_id();k.innerHTML=d;k.htmlFor=h.id;g.appendChild(k);g.appendChild(h);m.give_tooltip(g,e);b.forEach(function(a,b){var c=document.createElement("option");c.value=a;c.innerHTML=a;f&&f[b]&&(m.give_tooltip(c,f[b]),m.use_custom_tooltip(c));h.appendChild(c)});$(h).addClass("ui-widget");$(k).addClass("ui-widget");m.use_custom_tooltip(h);return{container:g,
menu:h,label:k}};m.create_check_box=function(a,b,c,d){var e=document.createElement("div"),f=document.createElement("input"),g=document.createElement("label");f.type="checkbox";f.className=b;f.checked=a;g.innerHTML=c;f.id=m.generate_unique_id();g.htmlFor=f.id;$(g).addClass("ui-widget");e.appendChild(f);e.appendChild(g);m.give_tooltip(e,d);m.use_custom_tooltip(f);return{container:e,button:f,label:g}};m.create_horizontal_table=function(){var a=document.createElement("table"),b,c,d;c=document.createElement("tr");
a.appendChild(c);for(b=0;b<arguments.length;b++)arguments[b]&&(d=document.createElement("td"),c.appendChild(d),d.appendChild(arguments[b]));return a};m.create_vertical_table=function(){var a=document.createElement("table"),b,c;for(b=0;b<arguments.length;b++)arguments[b]&&(c=m.create_row(arguments[b]),a.appendChild(c));return a};m.create_row=function(){var a=document.createElement("tr"),b=document.createElement("td"),c;for(c=0;c<arguments.length;c++)a.appendChild(arguments[c]);b.appendChild(a);return a};
m.create_table_entry=function(a){var b=document.createElement("td");b.appendChild(a);return b};m.selected_radio_button=function(){var a;for(a=0;a<arguments.length;a++)if(arguments[a].checked)return arguments[a]};m.create_image=function(a,b){var c=document.createElement("img"),d;c.src=a;b&&$(c).addClass(b);0===a.indexOf("images/")&&(d=function(b){c.removeEventListener("error",d);c.src="http://toontalk.github.io/ToonTalk/"+a},c.addEventListener("error",d));return c};m.create_tabs=function(a,b){var c=
document.createElement("div"),d=document.createElement("ul"),e;if(a.length!==b.length)return console.error("UTILITIES.create_tabs called with different length lists."),c;a.forEach(function(a,c){var f=document.createElement("li"),g=document.createElement("a"),h;"string"===typeof a?(h=document.createElement("span"),h.innerHTML=a):h=a;e="tab-"+c;g.href="#"+e;g.appendChild(h);f.appendChild(g);d.appendChild(f);b[c].id=e});c.appendChild(d);b.forEach(function(a){c.appendChild(a)});$(c).tabs();return c};
m.create_file_data_table=function(a){var b=$('<table cellpadding="0" cellspacing="0" border="0"></table>');a&&b.addClass(a);return b.get(0)};m.become_file_data_table=function(a,b,c,d){$(a).DataTable({data:b,autoWidth:!1,order:[[1,"desc"]],columns:[{data:"title",title:"Name",render:function(a,b,e,f){a=c?a.substring(0,a.length-5):a;b=c?g.google_drive.google_drive_url(e.id):"Click to load this program.";if(d)return"<div class='"+d+"' title='"+b+"'id='"+e.id+"'>"+a+"</div>";g.TRANSLATION_ENABLED&&(b=
m.add_URL_parameter(b,"translate","1"));return"<a href='"+b+"'target='_blank' title='Click to open published page.'>"+a+"</a>"}},{data:"modifiedDate",title:"Modified",render:function(a,b,c,d){return(new Date(a)).toUTCString()}},{data:"createdDate",title:"Created",render:function(a,b,c,d){return(new Date(a)).toUTCString()}},{data:"fileSize",title:"Size"}]});$(a).addClass("toontalk-file-table")};m.get_local_files_data=function(){return m.get_all_locally_stored_program_names().map(function(a){var b=
m.get_local_storage_meta_data(a);if(b)return{title:a,modifiedDate:b.last_modified,createdDate:b.created,fileSize:b.file_size}})};m.create_local_files_table=function(){var a=m.get_local_files_data(),b=m.create_file_data_table();setTimeout(function(){m.become_file_data_table(b,a,!1,"toontalk-file-load-button toontalk-file-load-button-without-click-handler")});return b};m.get_dragee=function(){return a};m.add_URL_parameter=function(a,b,c){a=m.remove_URL_parameter(a,b);var d;d=0<=a.indexOf("?")?"&":"?";
return a+d+b+"="+c};m.remove_URL_parameter=function(a,b){var c=a.indexOf("&"+b+"="),d;0>c&&(c=a.indexOf("?"+b+"="));if(0>c)return a;d=a.indexOf("&",c+1);0>d&&(d=a.length);a=a.substring(0,c)+a.substring(d);"?"===a[a.length-1]&&(a=substring(0,a.length-1));return a};m.add_a_or_an=function(a,b){var c=a.charAt(0);if("'"===c||'"'===c)c=a.charAt(1);return 0===a.indexOf("the ")||0===a.indexOf("a ")||0===a.indexOf("an ")||0===a.indexOf("any ")||0===a.indexOf('"the ')||0===a.indexOf('"a ')||0===a.indexOf('"an ')||
0===a.indexOf('"any ')?a:0>"aeiou".indexOf(c)?b?"A "+a:"a "+a:b?"An "+a:"an "+a};m.lower_case_first_letter=function(a){return a.charAt(0).toLowerCase()+a.slice(1)};m.maximum_string_length=function(a,b){var c;if(a.length<=b)return a;c=a.substring(0,Math.round(.75*b));return c+" ... "+a.substring(a.length-(b-c.length))};m.backup_all_top_level_widgets=function(a){$(".toontalk-top-level-backside").each(function(b,c){m.widget_of_element(c).save(a)})};m.make_resizable=function(a,b){var c,d;a.resizable({start:function(a,
b){c=b.originalSize.width;d=b.originalSize.height},resize:function(e,f){a.is(".toontalk-element-frontside")&&(f.size.width!=c&&(b.increment_width(f.size.width-c),c=f.size.width),f.size.height!=d&&(b.increment_height(f.size.height-d),d=f.size.height));b.rerender()},stop:function(a,e){b.robot_in_training&&b.robot_in_training()&&b.robot_in_training().resized_widget(b,c,d,e.size.width,e.size.height)},handles:"n,e,s,w"})};m.match=function(a,b){var c=a.match(b);return c.is_widget&&b.matched_by?b.matched_by(a):
c};m.current_URL=function(){return window.location.pathname};m.absolute_file_path=function(a){var b=window.location.pathname,c=b.lastIndexOf("ToonTalk/");return 0>c?a:b.substring(0,c+9)+a};m.copy_side=function(a,b,c){b=a.get_widget().copy(b);c&&m.copy_frontside_dimensions(a.get_widget(),b);return a.is_backside()?b.get_backside():b};m.copy_frontside_dimensions=function(a,b){var c=a.get_widget().get_frontside_element(),d;c&&(d=b.get_frontside_element(!0))&&$(d).css({width:$(c).width(),height:$(c).height()})};
m.scale_to_fit=function(a,b,c,d){return $(b).is(".toontalk-backside")?m.scale_element(a,c,d,c,d):m.scale_element(a,$(b).width(),$(b).height(),c,d)};m.scale_element=function(a,b,c,d,e,f,g,h){var k,p;d||(d=$(a).width());e||(e=$(a).height());k=b?b/d:1;p=c?c/e:1;0===k&&(k=1);0===p&&(p=1);var r=!0;h=(h=h&&h!==document.body?h:a.parentElement)&&0>h.className.indexOf("toontalk-box-hole")&&0>a.className.indexOf("toontalk-scale");var t="";g||(g={});"number"===typeof g.left&&(g.left-=(d-b)/2,r=!1);"number"===
typeof g.left&&(g.top-=(e-c)/2,r=!1);r&&h&&(b&&(t+="translateX("+(b-d)/2+"px) "),c&&(t+="translateY("+(c-e)/2+"px) "));m.add_transform_to_css((f||"")+" scale("+k+", "+p+")",t,g,h);g.width=d;g.height=e;$(a).css(g);return{x_scale:k,y_scale:p}};m.add_transform_to_css=function(a,b,c,d){a&&(c||(c={}),c["transform-origin"]||(c["transform-origin"]=d?"center center":"left top"),m.set_css_transform(c,a+b))};m.set_css_transform=function(a,b){a["-webkit-transform"]=b;a["-moz-transform"]=b;a["-ms-transform"]=
b;a["o-transform"]=b;a.transform=b};m.run_when_dimensions_known=function(a,b,c){var d=a.parentElement,e=function(a){return a&&0>a.className.indexOf("toontalk-box-hole")},f;!c&&$(a).width()&&e(d)?setTimeout(function(){b(d)}):(f=function(c){setTimeout(function(){var g=$(a).width(),h=$(a).height();g&&h?e(a.parentElement)?(b(d),d?d.appendChild(a):a.parentElement===document.body&&$(a).remove(),$(a).removeClass("toontalk-not-observable")):m.run_when_dimensions_known(a,b,!0):setTimeout(function(){m.widget_of_element(a);
1E4>c&&f(2*c)},c)})},$(a).addClass("toontalk-not-observable"),document.body.appendChild(a),c&&$(a).css({width:"",height:"",transform:""}),f(1))};m.original_dimensions=function(a,b,c){var d=a.get_frontside_element();d.parentElement!==document.body&&m.run_when_dimensions_known(d,function(){b($(d).width(),$(d).height())},c)};m.relative_position=function(a,b){var c=$(a).offset(),d;b&&(d=$(b).offset(),c.left-=d.left,c.top-=d.top);return c};m.add_animation_class=function(a,b){$(a).css({width:"",height:""}).addClass(b)};
m.widget_from_jquery=function(a){if(0<a.length)return a.get(0).toontalk_widget};m.widget_of_element=function(a){return a.toontalk_widget};m.has_animating_image=function(a){a=$(a);return(a=a.css("animation")||a.css("webkit-animation")||a.css("moz-animation")||a.css("ms-animation")||a.css("o-animation"))&&0!==a.indexOf("none")};m.display_message_if_new=function(a){0>C.indexOf(a)&&(m.display_message(a),C.push(a))};m.display_message=function(a){var b=m.create_alert_element(a);$(".toontalk-alert-element").remove();
console.log(a);document.body.insertBefore(b,document.body.firstChild);setTimeout(function(){$(b).remove()},Math.max(2E3,a.length*(g.MAXIMUM_TOOLTIP_DURATION_PER_CHARACTER||100)))};m.display_tooltip=function(a){m.use_custom_tooltip(a.get(0));a.tooltip("open")};m.report_internal_error=function(a){console.log(a);console.trace();g.debugging&&m.display_message("Error: "+a)};m.get_current_url_boolean_parameter=function(a,b){return 0>window.location.href.indexOf(a+"=")?b:0<=window.location.href.indexOf(a+
"=1")?!0:!1};m.get_current_url_numeric_parameter=function(a,b){var c=m.get_current_url_parameter(a);if("undefined"===typeof c)return b;try{return parseInt(c,10)}catch(d){return 0}};m.get_current_url_parameter=function(a,b){var c=window.location.href.indexOf(a+"="),d;if(0>c)return b;c=c+a.length+1;d=window.location.href.indexOf("&",c);0>d&&(d=window.location.href.length);return window.location.href.substring(c,d)};m.get_path_to_toontalk_folder=function(){var a;if("string"===typeof k)return k;k="";
a=window.location.href.indexOf("/ToonTalk/");if(0>a)return k;for(a+=9;;){a=window.location.href.indexOf("/",a+1);if(0>a)return k;k+="../"}};m.is_browser_of_type=function(a){return 0<=window.navigator.userAgent.indexOf(a)};m.is_internet_explorer=function(){return m.is_browser_of_type("MSIE")||m.is_browser_of_type("Trident")};m.add_position=function(a,b){return{left:a.left+b.left,top:a.top+b.top}};m.subtract_position=function(a,b){return{left:a.left-b.left,top:a.top-b.top}};m.remove_z_index=function(a){if(0===
a.length||"<"!==a.charAt(0)||0>a.indexOf("z-index"))return a;a=$(a);a.attr("z-index","");return a.html()};m.add_test_all_button=function(){var a=$("#toontalk-test-all-button"),b;if(0!==a.length){a.button();b=a.get(0);b.innerHTML="Run all tests";var c=!1;a.click(function(a){c?($(".toontalk-stop-sign").each(function(){$(this).parent().is(".toontalk-top-level-backside")&&$(this).click()}),b.innerHTML="Run all tests"):($(".toontalk-green-flag").each(function(){$(this).parent().is(".toontalk-top-level-backside")&&
$(this).click()}),b.innerHTML="Stop all tests");c=!c})}};m.set_timeout=function(a,b){b?setTimeout(a,b):(K.push(a),window.postMessage("zero-timeout-message","*"))};m.get_first_property=function(a){return Object.keys(a)[0]};m.get_all_locally_stored_program_names=function(){var a=window.localStorage.getItem("toontalk-all-program-names");return a?JSON.parse(a):[]};m.set_all_locally_stored_program_names=function(a){window.localStorage.setItem("toontalk-all-program-names",JSON.stringify(a))};m.get_local_storage_meta_data=
function(a){a=m.local_storage_program_meta_data_key(a);var b;try{if(b=window.localStorage.getItem(a))return JSON.parse(b)}catch(c){}};m.local_storage_program_key=function(a){return"toontalk-json: "+a};m.local_storage_program_meta_data_key=function(a){return"toontalk-meta-data: "+a};m.enable_editor=function(a,b,c,d){(function(a,b){var c=function(a){a.data.editor_enabled_for&&a.data.editor_enabled_for===b&&(e=!0,window.removeEventListener("message",c))},d=function(a,b){e||setTimeout(function(){a();
d(a,b)},500)},e=!1;window.addEventListener("message",c);d(a,b)})(function(){a.postMessage({save_edits_to:window.location.href,file_id:c,widgets_json:d},"*")},c)};m.touch_available=function(){return"ontouchstart"in window||navigator.msMaxTouchPoints};m.enable_touch_events=function(a,b){var c=a,d=function(b){var d;b.stopPropagation();b.preventDefault();f?(f=!1,e(b,a),d=m.widget_of_element(a),g.logging&&0===g.logging.indexOf("touch")&&(g.debugging+="\ndrag ended"),d&&(r(b,a),g.logging&&0===g.logging.indexOf("touch")&&
(g.debugging+="\ndrop happened")),g.logging&&0===g.logging.indexOf("touch")&&(alert(g.debugging),g.debugging="touch")):h=!0;a=c},f=!1,h=!1,k=0,t=0,w;a.addEventListener("touchstart",function(c){g.logging&&0===g.logging.indexOf("touch")&&(g.debugging+="\ntouch start");c.preventDefault();"TEXTAREA"===c.srcElement.tagName||"INPUT"===c.srcElement.tagName||$(c.srcElement).is(".ui-resizable-handle")?g.logging&&0===g.logging.indexOf("touch")&&(g.debugging+="\ntouch start ignored due to tag name or class"):
(c.stopPropagation(),m.set_timeout(function(){var b=c.changedTouches[0],d,e,q;h?(h=!1,d=document.createEvent("MouseEvent"),d.initMouseEvent("click",!0,!0,window,1,b.screenX,b.screenY,b.clientX,b.clientY,!1,!1,!1,!1,0,null),b.target.dispatchEvent(d),g.logging&&0===g.logging.indexOf("touch")&&(g.debugging+="\ntouch end treated as click",alert(g.debugging),g.debugging="touch")):(f=!0,(d=m.widget_of_element(a))&&d.get_infinite_stack()?(e=d.copy(),d.add_copy_to_container(e,0,0),d.set_infinite_stack(!1),
e.set_infinite_stack(!0)):$(a).is(".toontalk-top-level-resource")&&(e=d.copy(),d.add_copy_to_container(e,0,0),q=$(a).offset(),a=e.get_frontside_element(!0)),q||(q=$(a).offset()),p(c,a),k=b.clientX-q.left,t=b.clientY-q.top,g.logging&&0===g.logging.indexOf("touch")&&(g.debugging+="\ndrag started"))},b))},!0);a.addEventListener("touchmove",function(b){var c;b.preventDefault();if(f){c=b.changedTouches[0];m.set_absolute_position($(a),{left:c.pageX-k,top:c.pageY-t});b=m.find_widget_on_page(c,a,0,0);if(w&&
w!==b){var d=w.get_frontside_element();m.remove_highlight(d);w=void 0}b&&(v(c,b.get_frontside_element()),w=b);g.logging&&0===g.logging.indexOf("touch")&&(g.debugging+="\ndragged to "+(c.pageX-k)+", "+(c.pageY-t))}else g.logging&&0===g.logging.indexOf("touch")&&(g.debugging+="\ntouch move ignored since drag_started not yet set. "+Date.now())},!0);a.addEventListener("touchend",d,!0);a.addEventListener("touchcancel",d,!0)};m.get_mouse_or_first_touch_event_attribute=function(a,b){return b.changedTouches?
b.changedTouches[0][a]:b[a]};m.find_widget_on_page=function(a,b,c,d){var e=m.get_mouse_or_first_touch_event_attribute("pageX",a);a=m.get_mouse_or_first_touch_event_attribute("pageY",a);var f;$(b).hide();c=document.elementFromPoint(e-(window.pageXOffset+c),a-(window.pageYOffset+d));for($(b).show();c&&!c.toontalk_widget&&(!$(c).is(".toontalk-backside")||$(c).is(".toontalk-top-level-backside"));)c=c.parentNode;c&&(f=c.toontalk_widget);if(f)return f&&f.get_contents&&f.get_contents()&&(f=f.get_contents()),
b=f.get_type_name(),f&&"empty hole"===b?f.get_parent_of_frontside():f};m.closest_top_level_backside=function(a,b){var c,d;$(".toontalk-top-level-backside").each(function(){var b=$(this).offset(),b=b.left+$(this).width()/2-a^2+(b.top+$(this).height()/2-a)^2;c?b<d&&(c=this,d=b):(c=this,d=b)});return m.widget_of_element(c)};m.create_queue=function(){var a=[],b=0;return{getLength:function(){return a.length-b},isEmpty:function(){return 0==a.length},enqueue:function(b){a.push(b)},dequeue:function(){var c;
if(0!=a.length)return c=a[b],2*++b>=a.length&&(a=a.slice(b),b=0),c},peek:function(){return 0<a.length?a[b]:void 0},does_any_item_satisfy:function(c){var d;for(d=b;d<a.length;d++)if(c(a[d]))return!0;return!1}}};return m}(window.TOONTALK);
