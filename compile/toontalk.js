'use strict';(function(c){var p;"undefined"===typeof exports?"function"===typeof define&&"object"===typeof define.amd&&define.amd?(p={},define(function(){return p})):p="undefined"!==typeof window?window:c:p=exports;(function(b){var a={greatest_common_divisor:function(a,b){if(1===b||1===a)return 1;for(var c;0!==b;){c=b;b=a%b;if(!isFinite(b))return 0;a=c}return a}};a.gcd=a.greatest_common_divisor;a.fromRandom=function(a){return Math.random()*(1<<a)>>>0};a.fromMillitime=function(){return+new Date};a.fromUnixtime=
function(){return.001*a.fromMillitime()|0};"undefined"!==typeof b&&(b.integer=a);(function(a){function b(a,q,e){if(e!==c)return a instanceof b?a:"undefined"===typeof a?d:b.parse(a);for(a=a||[];a.length&&!a[a.length-1];)--a.length;this._d=a;this._s=a.length?q||1:0}var c={};b._construct=function(a,q){return new b(a,q,c)};b.base=1E7;b.base_log10=7;var d=new b([],0,c);b.ZERO=d;var e=new b([1],1,c);b.ONE=e;var f=new b(e._d,-1,c);b.M_ONE=f;b._0=d;b._1=e;b.small=[d,e,new b([2],1,c),new b([3],1,c),new b([4],
1,c),new b([5],1,c),new b([6],1,c),new b([7],1,c),new b([8],1,c),new b([9],1,c),new b([10],1,c),new b([11],1,c),new b([12],1,c),new b([13],1,c),new b([14],1,c),new b([15],1,c),new b([16],1,c),new b([17],1,c),new b([18],1,c),new b([19],1,c),new b([20],1,c),new b([21],1,c),new b([22],1,c),new b([23],1,c),new b([24],1,c),new b([25],1,c),new b([26],1,c),new b([27],1,c),new b([28],1,c),new b([29],1,c),new b([30],1,c),new b([31],1,c),new b([32],1,c),new b([33],1,c),new b([34],1,c),new b([35],1,c),new b([36],
1,c)];b.digits="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");b.prototype.toString=function(a){a=+a||10;if(2>a||36<a)throw Error("illegal radix "+a+".");if(0===this._s)return"0";if(10===a){a=0>this._s?"-":"";a+=this._d[this._d.length-1].toString();for(var q=this._d.length-2;0<=q;q--){for(var c=this._d[q].toString();7>c.length;)c="0"+c;a+=c}return a}q=b.digits;a=b.small[a];for(var c=this._s,d=this.abs(),e=[],f;0!==d._s;)f=d.divRem(a),d=f[0],f=f[1],e.push(q[f.valueOf()]);return(0>c?"-":"")+e.reverse().join("")};
b.radixRegex=[/^$/,/^$/,/^[01]*$/,/^[012]*$/,/^[0-3]*$/,/^[0-4]*$/,/^[0-5]*$/,/^[0-6]*$/,/^[0-7]*$/,/^[0-8]*$/,/^[0-9]*$/,/^[0-9aA]*$/,/^[0-9abAB]*$/,/^[0-9abcABC]*$/,/^[0-9a-dA-D]*$/,/^[0-9a-eA-E]*$/,/^[0-9a-fA-F]*$/,/^[0-9a-gA-G]*$/,/^[0-9a-hA-H]*$/,/^[0-9a-iA-I]*$/,/^[0-9a-jA-J]*$/,/^[0-9a-kA-K]*$/,/^[0-9a-lA-L]*$/,/^[0-9a-mA-M]*$/,/^[0-9a-nA-N]*$/,/^[0-9a-oA-O]*$/,/^[0-9a-pA-P]*$/,/^[0-9a-qA-Q]*$/,/^[0-9a-rA-R]*$/,/^[0-9a-sA-S]*$/,/^[0-9a-tA-T]*$/,/^[0-9a-uA-U]*$/,/^[0-9a-vA-V]*$/,/^[0-9a-wA-W]*$/,
/^[0-9a-xA-X]*$/,/^[0-9a-yA-Y]*$/,/^[0-9a-zA-Z]*$/];b.parse=function(a,q){function e(a){a=a.replace(/\s*[*xX]\s*10\s*(\^|\*\*)\s*/,"e");return a.replace(/^([+\-])?(\d+)\.?(\d*)[eE]([+\-]?\d+)$/,function(a,b,q,h,c){c=+c;var d=0>c,B=q.length+c;a=(d?q:h).length;c=(c=Math.abs(c))>=a?c-a+d:0;a=Array(c+1).join("0");q+=h;return(b||"")+(d?q=a+q:q+=a).substr(0,B+=d?a.length:0)+(B<q.length?"."+q.substr(B):"")})}a=a.toString();if("undefined"===typeof q||10===+q)a=e(a);var f=RegExp("^([+\\-]?)("+("undefined"===
typeof q?"0[xcb]":16==q?"0x":8==q?"0c":2==q?"0b":"")+")?([0-9a-z]*)(?:\\.\\d*)?$","i").exec(a);if(f){var g=f[1]||"+",l=f[2]||"",f=f[3]||"";if("undefined"===typeof q)q="0x"===l||"0X"===l?16:"0c"===l||"0C"===l?8:"0b"===l||"0B"===l?2:10;else if(2>q||36<q)throw Error("Illegal radix "+q+".");q=+q;if(!b.radixRegex[q].test(f))throw Error("Bad digit for radix "+q);f=f.replace(/^0+/,"").split("");if(0===f.length)return d;g="-"===g?-1:1;if(10==q){for(l=[];7<=f.length;)l.push(parseInt(f.splice(f.length-b.base_log10,
b.base_log10).join(""),10));l.push(parseInt(f.join(""),10));return new b(l,g,c)}l=d;q=b.small[q];for(var k=b.small,n=0;n<f.length;n++)l=l.multiply(q).add(k[parseInt(f[n],36)]);return new b(l._d,g,c)}throw Error("Invalid BigInteger format: "+a);};b.prototype.add=function(a){if(0===this._s)return b(a);a=b(a);if(0===a._s)return this;if(this._s!==a._s)return a=a.negate(),this.subtract(a);var q=this._d;a=a._d;for(var d=q.length,e=a.length,f=Array(Math.max(d,e)+1),g=Math.min(d,e),l=0,k=0;k<g;k++)l=q[k]+
a[k]+l,f[k]=l%1E7,l=l/1E7|0;e>d&&(q=a,d=e);for(k=g;l&&k<d;k++)l=q[k]+l,f[k]=l%1E7,l=l/1E7|0;for(l&&(f[k]=l);k<d;k++)f[k]=q[k];return new b(f,this._s,c)};b.prototype.negate=function(){return new b(this._d,-this._s|0,c)};b.prototype.abs=function(){return 0>this._s?this.negate():this};b.prototype.subtract=function(a){if(0===this._s)return b(a).negate();a=b(a);if(0===a._s)return this;if(this._s!==a._s)return a=a.negate(),this.add(a);var q=this;0>this._s&&(q=new b(a._d,1,c),a=new b(this._d,1,c));var e=
q.compareAbs(a);if(0===e)return d;if(0>e){var f=a;a=q;q=f}q=q._d;a=a._d;var f=q.length,g=a.length,l=Array(f),k=0,n,t;for(n=0;n<g;n++)t=q[n]-k-a[n],0>t?(t+=1E7,k=1):k=0,l[n]=t;for(n=g;n<f;n++){t=q[n]-k;if(0>t)t+=1E7;else{l[n++]=t;break}l[n]=t}for(;n<f;n++)l[n]=q[n];return new b(l,e,c)};(function(){function a(q,h){for(var d=q._d,e=d.slice(),f=0;;){var l=(d[f]||0)+1;e[f]=l%1E7;if(9999999>=l)break;++f}return new b(e,h,c)}function q(a,h){for(var d=a._d,e=d.slice(),f=0;;){var l=(d[f]||0)-1;if(0>l)e[f]=
l+1E7;else{e[f]=l;break}++f}return new b(e,h,c)}b.prototype.next=function(){switch(this._s){case 0:return e;case -1:return q(this,-1);default:return a(this,1)}};b.prototype.prev=function(){switch(this._s){case 0:return f;case -1:return a(this,-1);default:return q(this,1)}}})();b.prototype.compareAbs=function(a){if(this===a)return 0;if(!(a instanceof b)){if(!isFinite(a))return isNaN(a)?a:-1;a=b(a)}if(0===this._s)return 0!==a._s?-1:0;if(0===a._s)return 1;var q=this._d.length,c=a._d.length;if(q<c)return-1;
if(q>c)return 1;c=this._d;a=a._d;for(--q;0<=q;q--)if(c[q]!==a[q])return c[q]<a[q]?-1:1;return 0};b.prototype.compare=function(a){if(this===a)return 0;a=b(a);return 0===this._s?-a._s:this._s===a._s?this.compareAbs(a)*this._s:this._s};b.prototype.isUnit=function(){return this===e||this===f||1===this._d.length&&1===this._d[0]};b.prototype.multiply=function(a){if(0===this._s)return d;a=b(a);if(0===a._s)return d;if(this.isUnit())return 0>this._s?a.negate():a;if(a.isUnit())return 0>a._s?this.negate():this;
if(this===a)return this.square();var q=this._d.length>=a._d.length,e=(q?this:a)._d,q=(q?a:this)._d,f=e.length,l=q.length,g=f+l,k=Array(g),n;for(n=0;n<g;n++)k[n]=0;for(n=0;n<l;n++){for(var g=0,t=q[n],A=f+n,r,p=n;p<A;p++)r=k[p]+t*e[p-n]+g,g=r/1E7|0,k[p]=r%1E7|0;g&&(r=k[p]+g,k[p]=r%1E7)}return new b(k,this._s*a._s,c)};b.prototype.multiplySingleDigit=function(a){if(0===a||0===this._s)return d;if(1===a)return this;var q;if(1===this._d.length)return q=this._d[0]*a,1E7<=q?new b([q%1E7|0,q/1E7|0],1,c):new b([q],
1,c);if(2===a)return this.add(this);if(this.isUnit())return new b([a],1,c);var e=this._d,f=e.length;q=f+1;for(var l=Array(q),g=0;g<q;g++)l[g]=0;for(var k=g=0;k<f;k++)q=a*e[k]+g,g=q/1E7|0,l[k]=q%1E7|0;g&&(l[k]=g);return new b(l,1,c)};b.prototype.square=function(){if(0===this._s)return d;if(this.isUnit())return e;var a=this._d,q=a.length,f=Array(q+q+1),g,l,k,n;for(n=0;n<q;n++)k=2*n,g=a[n]*a[n],l=g/1E7|0,f[k]=g%1E7,f[k+1]=l;for(n=0;n<q;n++){l=0;k=2*n+1;for(var t=n+1;t<q;t++,k++)g=a[t]*a[n]*2+f[k]+l,
l=g/1E7|0,f[k]=g%1E7;k=q+n;g=l+f[k];l=g/1E7|0;f[k]=g%1E7;f[k+1]+=l}return new b(f,1,c)};b.prototype.quotient=function(a){return this.divRem(a)[0]};b.prototype.divide=b.prototype.quotient;b.prototype.remainder=function(a){return this.divRem(a)[1]};b.prototype.divRem=function(a){a=b(a);if(0===a._s)throw Error("Divide by zero");if(0===this._s)return[d,d];if(1===a._d.length)return this.divRemSmall(a._s*a._d[0]);switch(this.compareAbs(a)){case 0:return[this._s===a._s?e:f,d];case -1:return[d,this]}var q=
this._s*a._s,g=a.abs(),l=this._d,k=l.length,n=[],t,r=new b([],0,c);for(r._s=1;k;)if(r._d.unshift(l[--k]),0>r.compareAbs(a))n.push(0);else{if(0===r._s)t=0;else{var p=r._d.length;t=g._d.length;p=1E7*r._d[p-1]+r._d[p-2];t=1E7*g._d[t-1]+g._d[t-2];r._d.length>g._d.length&&(p=1E7*(p+1));t=Math.ceil(p/t)}do{p=g.multiplySingleDigit(t);if(0>=p.compareAbs(r))break;t--}while(t);n.push(t);t&&(t=r.subtract(p),r._d=t._d.slice(),0===r._d.length&&(r._s=0))}return[new b(n.reverse(),q,c),new b(r._d,this._s,c)]};b.prototype.divRemSmall=
function(a){a=+a;if(0===a)throw Error("Divide by zero");var q=this._s*(0>a?-1:1);a=Math.abs(a);if(1>a||1E7<=a)throw Error("Argument out of range");if(0===this._s)return[d,d];if(1===a||-1===a)return[1===q?this.abs():new b(this._d,q,c),d];if(1===this._d.length){var e=new b([this._d[0]/a|0],1,c);a=new b([this._d[0]%a|0],1,c);0>q&&(e=e.negate());0>this._s&&(a=a.negate());return[e,a]}for(var f=this._d.slice(),e=Array(f.length),g=0,l=0,k=0,n;f.length;)g=1E7*g+f[f.length-1],g<a?(e[k++]=0,f.pop(),l=1E7*l+
g):(n=0===g?0:g/a|0,l=g-a*n,(e[k++]=n)?(f.pop(),g=l):f.pop());a=new b([l],1,c);0>this._s&&(a=a.negate());return[new b(e.reverse(),q,c),a]};b.prototype.isEven=function(){var a=this._d;return 0===this._s||0===a.length||0===a[0]%2};b.prototype.isOdd=function(){return!this.isEven()};b.prototype.sign=function(){return this._s};b.prototype.isPositive=function(){return 0<this._s};b.prototype.isNegative=function(){return 0>this._s};b.prototype.isZero=function(){return 0===this._s};b.prototype.exp10=function(a){a=
+a;if(0===a)return this;if(Math.abs(a)>Number(g))throw Error("exponent too large in BigInteger.exp10");if(0<a){for(var q=new b(this._d.slice(),this._s,c);7<=a;a-=7)q._d.unshift(0);if(0==a)return q;q._s=1;q=q.multiplySingleDigit(Math.pow(10,a));return 0>this._s?q.negate():q}if(-a>=7*this._d.length)return d;q=new b(this._d.slice(),this._s,c);for(a=-a;7<=a;a-=7)q._d.shift();return 0==a?q:q.divRemSmall(Math.pow(10,a))[0]};b.prototype.pow=function(a){if(this.isUnit())return 0<this._s?this:b(a).isOdd()?
this:this.negate();a=b(a);if(0===a._s)return e;if(0>a._s){if(0===this._s)throw Error("Divide by zero");return d}if(0===this._s)return d;if(a.isUnit())return this;if(0<a.compareAbs(g))throw Error("exponent too large in BigInteger.pow");for(var q=this,c=e,f=b.small[2];a.isPositive()&&(!a.isOdd()||(c=c.multiply(q),!a.isUnit()));)q=q.square(),a=a.quotient(f);return c};b.prototype.modPow=function(a,q){for(var c=e,d=this;a.isPositive();)a.isOdd()&&(c=c.multiply(d).remainder(q)),a=a.quotient(b.small[2]),
a.isPositive()&&(d=d.square().remainder(q));return c};b.prototype.log=function(){switch(this._s){case 0:return-Infinity;case -1:return NaN}var a=this._d.length;if(30>7*a)return Math.log(this.valueOf());var q=Math.ceil(30/7),d=this._d.slice(a-q);return Math.log((new b(d,1,c)).valueOf())+(a-q)*Math.log(1E7)};b.prototype.valueOf=function(){return parseInt(this.toString(),10)};b.prototype.toJSValue=function(){return parseInt(this.toString(),10)};var g=b(2147483647);b.MAX_EXP=g;(function(){function a(q){return function(a){return q.call(b(a))}}
function q(a){return function(q,c){return a.call(b(q),b(c))}}function c(a){return function(q,c,d){return a.call(b(q),b(c),b(d))}}(function(){var d,e,f="toJSValue isEven isOdd sign isZero isNegative abs isUnit square negate isPositive toString next prev log".split(" "),g="compare remainder divRem subtract add quotient divide multiply pow compareAbs".split(" "),l=["modPow"];for(d=0;d<f.length;d++)e=f[d],b[e]=a(b.prototype[e]);for(d=0;d<g.length;d++)e=g[d],b[e]=q(b.prototype[e]);for(d=0;d<l.length;d++)e=
l[d],b[e]=c(b.prototype[e]);b.exp10=function(a,q){return b(a).exp10(q)}})()})();a.BigInteger=b})("undefined"!==typeof b?b:this);var c={greatest_common_divisor:function(a,b){if(b.isUnit()||a.isUnit())return BigInteger.ONE;for(var c;!b.isZero();)c=b,b=a.remainder(b),a=c;return a},create:function(){return[0]},clone:function(a){for(var b=[],c=0,d=a.length;c<d;c++)b[c]=a[c];return b},copy:function(a,b){a=[];for(var c=0,d=b.length;c<d;c++)a[c]=b[c];return a},abs:function(a,b){a[0]=Math.abs(b[0]);return a},
str:function(a){return a[0].toString()},toInteger:function(a){return out[0]},fromInteger:function(a){return[parseInt(a)]}};c.ZERO=c.fromInteger(0);c.ONE=c.fromInteger(1);"undefined"!==typeof b&&(b.bigint=c);if(!g)var g=Array;if(!d)var d=Math.pow(2,56);if(!n)var n=16777216;var f={EPSILON:2E-16};f.MAX_LOOPS=n;f.create=function(){var a=new g(2);a[0]=0;a[1]=1;return a};f.clone=function(a){var b=new g(2);b[0]=a[0];b[1]=a[1];return b};f.fromValues=function(a,b){var c=new g(2);c[0]=a;c[1]=b;return f.normalize(c,
c)};f.copy=function(a,b){a[0]=b[0];a[1]=b[1];return a};f.set=function(a,b,c){a[0]=b;a[1]=c;return f.normalize(a,a)};f.abs=function(a,b){a[0]=Math.abs(b[0]);a[1]=b[1];return a};f.invert=function(a,b){var c=b[0];a[0]=b[1];a[1]=c;return a};f.reciprocal=f.invert;f.add=function(a,b,c){b[1]===c[1]?(a[0]=b[0]+c[0],a[1]=b[1]):(a[0]=b[0]*c[1]+c[0]*b[1],a[1]=b[1]*c[1]);return f.normalize(a,a)};f.subtract=function(a,b,c){b[1]===c[1]?(a[0]=b[0]-c[0],a[1]=b[1]):(a[0]=b[0]*c[1]-c[0]*b[1],a[1]=b[1]*c[1]);return f.normalize(a,
a)};f.sub=f.subtract;f.multiply=function(a,b,c){a[0]=b[0]*c[0];a[1]=b[1]*c[1];return f.normalize(a,a)};f.mul=f.multiply;f.mediant=function(a,b,c){a[0]=b[0]+c[0];a[1]=b[1]+c[1];return f.normalize(a,a)};f.divide=function(a,b,c){a[0]=b[0]*c[1];a[1]=b[1]*c[0];return f.normalize(a,a)};f.div=f.divide;f.equals=function(a,b){return 0===a[0]&&0===b[0]||0===a[1]&&0===b[1]?!0:a[0]===b[0]&&a[1]===b[1]};f.approximates=function(a,b){if(f.equals(a,b))return!0;var c=f.create();f.sub(c,a,b);f.abs(c,c);return f.isLessThan(c,
f.INFINITESIMAL)};f.isGreaterThan=function(a,b){return f.equals(a,b)?!1:a[0]*b[1]>b[0]*a[1]};f.isLessThan=function(a,b){return f.equals(a,b)?!1:a[0]*b[1]<b[0]*a[1]};f.isNegative=function(a){return 0>a[0]};f.min=function(a,b,c){f.isLessThan(b,c)?(a[0]=b[0],a[1]=b[1]):(a[0]=c[0],a[1]=c[1]);return a};f.max=function(a,b,c){f.isGreaterThan(b,c)?(a[0]=b[0],a[1]=b[1]):(a[0]=c[0],a[1]=c[1]);return a};f.scalar_multiply=function(a,b,c){a[0]=b[0]*c;a[1]=b[1];return f.normalize(a,a)};f.scalar_divide=function(a,
b,c){a[0]=b[0];a[1]=b[1]*c;return f.normalize(a,a)};f.normalize=function(b,c){if(isNaN(c[0])||isNaN(c[1])||0===c[0]&&0===c[1])return b[0]=0,b[1]=0,b;if(0===c[0])return b[0]=0,b[1]=1,b;if(0===c[1])return b[0]=1,b[1]=0,b;if(c[0]===c[1])return b[0]=1,b[1]=1,b;0<c[1]?(b[0]=c[0],b[1]=c[1]):(b[0]=-c[0],b[1]=-c[1]);var d=a.greatest_common_divisor(Math.abs(b[0]),b[1]);1<d&&(b[0]/=d,b[1]/=d);return b};f.opposite=function(a,b){a[0]=-b[0];a[1]=b[1];return a};f.negative=f.opposite;f.neg=f.opposite;f.power=function(a,
b,c){2===c?(a[0]=b[0]*b[0],a[1]=b[1]*b[1]):0<c?(a[0]=Math.pow(b[0],c),a[1]=Math.pow(b[1],c)):0>c?(c=Math.abs(c),a[0]=Math.pow(b[1],c),a[1]=Math.pow(b[0],c)):f.copy(a,f.ONE);return f.normalize(a,a)};f.pow=f.power;f.sqrt=function(a,b){return f.nthRoot(a,b,2)};f.nthRoot=function(a,b,c){if(f.equals(b,f.ZERO))return f.copy(a,f.ZERO);if(f.equals(b,f.ONE))return f.copy(a,f.ONE);if(f.equals(b,f.INFINITY))return f.copy(a,f.INFINITY);if(f.equals(b,f.INFINULL))return f.copy(a,f.INFINULL);var d=f.isNegative(b);
d&&(b[0]=-b[0]);a=f.copy(a,f.ONE);for(var e=[1,0,0,1],g=f.clone(f.ONE),l=f.MAX_LOOPS;!f.approximates(b,g)&&l--;)f.isLessThan(b,g)?(e[0]+=e[1],e[2]+=e[3]):(e[1]+=e[0],e[3]+=e[2]),a[0]=e[0]+e[1],a[1]=e[2]+e[3],f.pow(g,a,c);d&&(b[0]=-b[0],1===c%2&&f.neg(a,a));return a};f.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]};f.str=function(a){return 1===a[1]?a[0].toString():a[0]+"/"+a[1]};f.toDecimal=function(a){return a[0]/a[1]};f.dec=f.toDecimal;f.toInteger=function(a){return Math.round(f.toDecimal(a))};f.round=
f.toInteger;f.floor=function(a){return Math.floor(f.toDecimal(a))};f.ceil=function(a){return Math.ceil(f.toDecimal(a))};f.fromInteger_copy=function(a,b){a[0]=parseInt(b);a[1]=1;return a};f.fromInteger=function(a){return f.fromInteger_copy(f.create(),a)};f.fromIntegerInverse_copy=function(a,b){a[0]=1;a[1]=parseInt(b);0>a[1]&&(a[0]=-a[0],a[1]=-a[1]);return a};f.fromIntegerInverse=function(a){return f.fromIntegerInverse_copy(f.create(),a)};f.fromDecimal=function(a){return f.fromDecimal_copy(f.create(),
a)};f.fromDecimal_copy=function(a,b){b=parseFloat(b);if(isNaN(b))return f.copy(a,f.INFINULL);if(Infinity===b)return f.copy(a,f.INFINITY);if(Math.abs(b)<f.EPSILON)return f.copy(a,f.ZERO);if(Math.abs(b-1)<f.EPSILON)return f.copy(a,f.ONE);if(Math.abs(b%1)<f.EPSILON)return f.fromInteger_copy(a,b);if(Math.abs(1/b%1)<f.EPSILON)return f.fromIntegerInverse_copy(a,Math.round(1/b));f.copy(a,f.ONE);for(var c=[1,0,0,1],d=b,e=1,g=f.MAX_LOOPS;g--&&Math.abs(b-f.toDecimal(a))>f.EPSILON;)e=Math.floor(d),a[0]=e*c[0]+
c[2],a[1]=e*c[1]+c[3],d=1/(d-e),c[2]=c[0],c[3]=c[1],c[0]=a[0],c[1]=a[1];return a};f.fromRandom=function(a){a[0]=0xfffffffffffff*Math.random()<<0;a[1]=Math.abs(0xfffffffffffff*Math.random()<<0);return f.normalize(a,a)};f.sin=function(a,b){if(0===b[1])return f.copy(a,f.ZERO);f.scalar_multiply(a,b,2);var c=f.create();f.pow(c,b,2);f.add(c,c,f.ONE);f.divide(a,a,c);return a};f.cos=function(a,b){if(0===b[1])return f.neg(a,f.ONE);var c=f.create();f.pow(c,b,2);f.sub(a,f.ONE,c);var d=f.create();f.add(d,f.ONE,
c);f.divide(a,a,d);return a};f.tan=function(a,b){f.scalar_multiply(a,b,2);var c=f.create();f.pow(c,b,2);f.scalar_multiply(c,c,2);f.add(a,a,c);f.pow(c,b,4);f.sub(c,f.ONE,c);f.divide(a,a,c);return a};f.toEgyptian=function(a){a=f.clone(a);f.abs(a,a);var b=f.floor(a);b&&f.sub(a,a,f.fromInteger(b));if(!a[0])return b.toString();b||(b="");for(var c=1,d=f.create();1!==a[0];)c++,d=f.fromValues(1,c),f.isGreaterThan(a,d)&&(b&&(b+=" + "),b+=f.str(d),f.sub(a,a,d));return a?b?b+" + "+f.str(a):f.str(a):b?b:"0"};
f.toBabylonian=function(a){var b="",c=f.toDecimal(a);a=parseInt(c);for(var c=c-a,d=0,e=0;0<a;)(d=a%60)&&(b=d+" * 60^"+e+(b?" + ":"")+b),a=(a-d)/60,e++;for(e=-1;0<c;)c*=60,d=parseInt(c+1E-13),c-=d,-1E-13>c||(d&&(b+=(b?" + ":"")+d+" * 60^"+e),e--);return b?b:"0"};f.traceSternBrocot=function(a){var b="";if(f.equals(a,f.ZERO)||f.equals(a,f.ONE)||f.equals(a,f.INFINITY)||f.equals(a,f.INFINULL))return b;if(f.equals(a,f.ZERO))return f.copy(out,f.ZERO);if(f.equals(a,f.ONE))return f.copy(out,f.ONE);if(f.equals(a,
f.INFINITY))return f.copy(out,f.INFINITY);if(f.equals(a,f.INFINULL))return f.copy(out,f.INFINULL);a=f.clone(a);f.isNegative(a)&&(a[0]=-a[0]);for(var c=f.clone(f.ONE),d=[1,0,0,1],e=0,g=0,l=f.MAX_LOOPS;!f.approximates(a,c)&&l--;)f.isLessThan(a,c)?(d[0]+=d[1],d[2]+=d[3],g++,e&&(b+="R",1!==e&&(b+=e),e=0,b+=" ")):(d[1]+=d[0],d[3]+=d[2],e++,g&&(b+="L",1!==g&&(b+=g),g=0,b+=" ")),c[0]=d[0]+d[1],c[1]=d[2]+d[3];g?(b+="L",1!==g&&(b+=g)):e&&(b+="R",1!==e&&(b+=e));0>l&&(b+="...");return b};f.toContinuedFraction=
function(a,b){b="undefined"===typeof b?65536:parseInt(b);if(f.equals(a,f.ZERO))return[0];if(f.equals(a,f.ONE))return[1];if(f.equals(a,f.NEGONE))return[-1];if(f.equals(a,f.INFINITY))return[1,0];if(f.equals(a,f.INFINULL))return[0,0];var c=f.clone(a),d=f.isNegative(c);d&&(c[0]=-c[0]);for(var e=f.clone(f.ONE),g=[1,0,0,1],l=1,h=[0],k=h.length-1;!f.equals(c,e)&&b--;)f.isLessThan(c,e)?(-1===l?h[k]++:(l=-1,h.push(1),k++),g[0]+=g[1],g[2]+=g[3]):(1===l?h[k]++:(l=1,h.push(1),k++),g[1]+=g[0],g[3]+=g[2]),e[0]=
g[0]+g[1],e[1]=g[2]+g[3];0>b?h.push(0):h[k]++;if(d)for(var n in h)h[n]=-h[n];return h};f.fromContinuedFraction=function(a,b){f.fromInteger_copy(a,b[b.length-1]);for(var c=b.length-2;-1<c;c--)f.invert(a,a),f.add(a,f.fromInteger(b[c]),a);return a};f.dump=function(a){f.create();return"rat\t"+f.str(a)+"\n~\t"+f.toDecimal(a)+"\nCF:\t["+f.toContinuedFraction(a)+"]\n"};f.ZERO=f.fromInteger(0);f.ONE=f.fromInteger(1);f.NEGONE=f.fromInteger(-1);f.INFINITY=f.fromValues(1,0);f.INFINULL=f.fromValues(0,0);f.INFINITESIMAL=
f.clone([1,d]);f.PI=f.fromValues(1320192667429,420230377710);"undefined"!==typeof b&&(b.rat=f);if(!r)var r=new BigInteger("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF");if(!l)var l=1073741824;var e={EPSILON:2E-16};e.MAX_LOOPS=l;e.create=function(){var a=[];a[0]=BigInteger.ZERO;a[1]=BigInteger.ONE;return a};e.clone=function(a){var b=[];b[0]=a[0];b[1]=a[1];return b};e.fromValues=function(a,b){var c=[];c[0]=new BigInteger(a);c[1]=new BigInteger(b);return e.normalize(c,c)};e.copy=function(a,b){a[0]=b[0];a[1]=
b[1];return a};e.set=function(a,b,c){a[0]=b;a[1]=c;return e.normalize(a,a)};e.toRat=function(a,b){return f.set(a,b[0].toJSValue(),b[1].toJSValue())};e.fromRat=function(a,b){return e.set(a,BigInteger(b[0]),BigInteger(b[1]))};e.abs=function(a,b){a[0]=b[0].abs();a[1]=b[1];return a};e.invert=function(a,b){var c=b[0];a[0]=b[1];a[1]=c;return a};e.reciprocal=e.invert;e.add=function(a,b,c){0===b[1].compare(c[1])?(a[0]=b[0].add(c[0]),a[1]=b[1]):(a[0]=b[0].multiply(c[1]).add(c[0].multiply(b[1])),a[1]=b[1].multiply(c[1]));
return e.normalize(a,a)};e.subtract=function(a,b,c){0===b[1].compare(c[1])?(a[0]=b[0].subtract(c[0]),a[1]=b[1]):(a[0]=b[0].multiply(c[1]).subtract(c[0].multiply(b[1])),a[1]=b[1].multiply(c[1]));return e.normalize(a,a)};e.sub=e.subtract;e.multiply=function(a,b,c){a[0]=b[0].multiply(c[0]);a[1]=b[1].multiply(c[1]);return e.normalize(a,a)};e.mul=e.multiply;e.mediant=function(a,b,c){a[0]=b[0].add(c[0]);a[1]=b[1].add(c[1]);return e.normalize(a,a)};e.divide=function(a,b,c){a[0]=b[0].multiply(c[1]);a[1]=
b[1].multiply(c[0]);return e.normalize(a,a)};e.div=e.divide;e.equals=function(a,b){return a[0].isZero()&&b[0].isZero()||a[1].isZero()&&b[1].isZero()?!0:0===a[0].compare(b[0])&&0===a[1].compare(b[1])};e.approximates=function(a,b){if(e.equals(a,b))return!0;var c=e.create();e.sub(c,a,b);e.abs(c,c);return e.isLessThan(c,e.INFINITESIMAL)};e.isGreaterThan=function(a,b){return e.equals(a,b)?!1:0<a[0].multiply(b[1]).compare(b[0].multiply(a[1]))};e.isLessThan=function(a,b){return e.equals(a,b)?!1:0>a[0].multiply(b[1]).compare(b[0].multiply(a[1]))};
e.isNegative=function(a){return a[0].isNegative()};e.min=function(a,b,c){e.isLessThan(b,c)?(a[0]=b[0],a[1]=b[1]):(a[0]=c[0],a[1]=c[1]);return a};e.max=function(a,b,c){e.isGreaterThan(b,c)?(a[0]=b[0],a[1]=b[1]):(a[0]=c[0],a[1]=c[1]);return a};e.scalar_multiply=function(a,b,c){a[0]=b[0].multiply(c);a[1]=b[1];return e.normalize(a,a)};e.scalar_divide=function(a,b,c){a[0]=b[0];a[1]=b[1].multiply(c);return e.normalize(a,a)};e.normalize=function(a,b){if(b[0].isZero()||b[1].isZero())return b;if(0===b[0].compare(b[1]))return e.clone(e.ONE);
if(b[1].isNegative())a[0]=b[0].negate(),a[1]=b[1].negate();else if(a[0]=b[0],a[1]=b[1],a[1].isZero())return a;var d=c.greatest_common_divisor(a[0].abs(),a[1]);0<d.compare(BigInteger.ONE)&&(a[0]=a[0].quotient(d),a[1]=a[1].quotient(d));return a};e.opposite=function(a,b){a[0]=b[0].negate();a[1]=b[1];return a};e.negative=e.opposite;e.neg=e.opposite;e.power=function(a,b,c){2===c?(a[0]=b[0].square(),a[1]=b[1].square()):0<c?(a[0]=b[0].pow(c),a[1]=b[1].pow(c)):0>c?(c=Math.abs(c),a[0]=b[1].pow(c),a[1]=b[0].pow(c)):
e.copy(a,e.ONE);return a};e.pow=e.power;e.sqrt=function(a,b){return e.nthRoot(a,b,2)};e.nthRoot=function(a,b,c){if(e.equals(b,e.ZERO))return e.copy(a,e.ZERO);if(e.equals(b,e.ONE))return e.copy(a,e.ONE);if(e.equals(b,e.INFINITY))return e.copy(a,e.INFINITY);if(e.equals(b,e.INFINULL))return e.copy(a,e.INFINULL);var d=e.isNegative(b);d&&(b[0]=b[0].negate());e.copy(a,e.ONE);for(var f=[BigInteger(1),BigInteger(0),BigInteger(0),BigInteger(1)],g=e.clone(e.ONE),k=l;!e.approximates(b,g)&&k--;)e.isLessThan(b,
g)?(f[0]=f[0].add(f[1]),f[2]=f[2].add(f[3])):(f[1]=f[1].add(f[0]),f[3]=f[3].add(f[2])),a[0]=f[0].add(f[1]),a[1]=f[2].add(f[3]),e.pow(g,a,c);d&&(b[0]=b[0].negate(),1===c%2&&e.neg(a,a));return a};e.dot=function(a,b){return a[0].multiply(b[0]).add(a[1].multiply(b[1]))};e.str=function(a){return 0===a[1].compare(BigInteger.ONE)?a[0].toString():a[0].toString()+"/"+a[1].toString()};e.toDecimal=function(a){return a[0].toJSValue()/a[1].toJSValue()};e.dec=e.toDecimal;e.toInteger=function(a){return a[0].quotient(a[1]).toJSValue()};
e.round=e.toInteger;e.toBigInteger=function(a){return a[0].quotient(a[1])};e.floor=function(a){return Math.floor(e.toDecimal(a))};e.ceil=function(a){return Math.ceil(e.toDecimal(a))};e.fromInteger_copy=function(a,b){a[0]=BigInteger(b);a[1]=BigInteger.ONE;return a};e.fromInteger=function(a){return e.fromInteger_copy(e.create(),a)};e.fromIntegerInverse_copy=function(a,b){a[0]=BigInteger.ONE;a[1]=BigInteger(b);a[1].isNegative()&&(a[0]=a[0].negate(),a[1]=a[1].negate());return a};e.fromIntegerInverse=
function(a){return e.fromIntegerInverse_copy(e.create(),a)};e.fromDecimal=function(a){return e.fromDecimal_copy(e.create(),a)};e.fromDecimal_copy=function(a,b){b=parseFloat(b);if(isNaN(b))return e.copy(a,e.INFINULL);if(Infinity===b)return e.copy(a,e.INFINITY);if(Math.abs(b)<e.EPSILON)return e.copy(a,e.ZERO);if(Math.abs(b-1)<e.EPSILON)return e.copy(a,e.ONE);if(Math.abs(b%1)<e.EPSILON)return e.fromInteger_copy(a,b);if(Math.abs(1/b%1)<e.EPSILON)return e.fromIntegerInverse_copy(a,Math.round(1/b));e.copy(a,
e.ONE);for(var c=[BigInteger(1),BigInteger(0),BigInteger(0),BigInteger(1)],d=b,f=1,g=e.MAX_LOOPS;g--&&Math.abs(b-e.toDecimal(a))>e.EPSILON;)f=Math.floor(d),a[0]=BigInteger(f*c[0]+c[2]),a[1]=BigInteger(f*c[1]+c[3]),d=1/(d-f),c[2]=c[0],c[3]=c[1],c[0]=a[0],c[1]=a[1];return a};e.fromRandom=function(a){a[0]=BigInteger(0xfffffffffffff*Math.random()<<0);a[1]=BigInteger(Math.abs(0xfffffffffffff*Math.random()<<0));return e.normalize(a,a)};e.sin=function(a,b){if(b[1].isZero())return e.copy(a,e.ZERO);e.scalar_multiply(a,
b,2);var c=e.create();e.pow(c,b,2);e.add(c,c,e.ONE);e.divide(a,a,c);return a};e.cos=function(a,b){if(b[1].isZero())return e.neg(a,e.ONE);var c=e.create();e.pow(c,b,2);e.sub(a,e.ONE,c);var d=e.create();e.add(d,e.ONE,c);e.divide(a,a,d);return a};e.tan=function(a,b){e.scalar_multiply(a,b,2);var c=e.create();e.pow(c,b,2);e.scalar_multiply(c,c,2);e.add(a,a,c);e.pow(c,b,4);e.sub(c,e.ONE,c);e.divide(a,a,c);return a};e.toEgyptian=function(a){a=e.clone(a);e.abs(a,a);var b=e.floor(a);b&&e.sub(a,a,e.fromInteger(b));
if(!a[0])return b.toString();b||(b="");for(var c=1,d=e.create();1!==a[0];)c++,d=e.fromValues(1,c),e.isGreaterThan(a,d)&&(b&&(b+=" + "),b+=e.str(d),e.sub(a,a,d));return a?b?b+" + "+e.str(a):e.str(a):b?b:"0"};e.toBabylonian=function(a){var b="",c=e.toDecimal(a);a=parseInt(c);for(var c=c-a,d=0,f=0;0<a;)(d=a%60)&&(b=d+" * 60^"+f+(b?" + ":"")+b),a=(a-d)/60,f++;for(f=-1;0<c;)c*=60,d=parseInt(c+1E-13),c-=d,-1E-13>c||(d&&(b+=(b?" + ":"")+d+" * 60^"+f),f--);return b?b:"0"};e.traceSternBrocot=function(a){var b=
"";if(e.equals(a,e.ZERO)||e.equals(a,e.ONE)||e.equals(a,e.INFINITY)||e.equals(a,e.INFINULL))return b;a=e.clone(a);e.isNegative(a)&&(a[0]=a[0].negate());for(var c=e.clone(e.ONE),d=[BigInteger(1),BigInteger(0),BigInteger(0),BigInteger(1)],f=0,g=0,l=65536;!e.equals(a,c)&&l--;)e.isLessThan(a,c)?(d[0]=d[0].add(d[1]),d[2]=d[2].add(d[3]),g++,f&&(b+="R",1!==f&&(b+=f),f=0,b+=" ")):(d[1]=d[1].add(d[0]),d[3]=d[3].add(d[2]),f++,g&&(b+="L",1!==g&&(b+=g),g=0,b+=" ")),c[0]=d[0].add(d[1]),c[1]=d[2].add(d[3]);g?(b+=
"L",1!==g&&(b+=g)):f&&(b+="R",1!==f&&(b+=f));0>l&&(b+="...");return b};e.toContinuedFraction=function(a,b){b="undefined"===typeof b?65536:parseInt(b);if(e.equals(a,e.ZERO))return[0];if(e.equals(a,e.ONE))return[1];if(e.equals(a,e.NEGONE))return[-1];if(e.equals(a,e.INFINITY))return[1,0];if(e.equals(a,e.INFINULL))return[0,0];var c=e.clone(a),d=e.isNegative(c);d&&(c[0]=c[0].negate());for(var f=e.clone(e.ONE),g=[BigInteger(1),BigInteger(0),BigInteger(0),BigInteger(1)],l=1,h=[0],k=h.length-1;!e.equals(c,
f)&&b--;)e.isLessThan(c,f)?(-1===l?h[k]++:(l=-1,h.push(1),k++),g[0]=g[0].add(g[1]),g[2]=g[2].add(g[3])):(1===l?h[k]++:(l=1,h.push(1),k++),g[1]=g[1].add(g[0]),g[3]=g[3].add(g[2])),f[0]=g[0].add(g[1]),f[1]=g[2].add(g[3]);0>b?h.push(0):h[k]++;if(d)for(var n in h)h[n]=-h[n];return h};e.fromContinuedFraction=function(a,b){e.fromInteger_copy(a,b[b.length-1]);for(var c=b.length-2;-1<c;c--)e.invert(a,a),e.add(a,e.fromInteger(b[c]),a);return a};e.fromFactorial=function(a,b){if("undefined"!==typeof factorial.PREPARED[b])return e.fromInteger_copy(a,
factorial.PREPARED[b]);var c=factorial.PREPARED.length-1;for(e.fromInteger_copy(a,factorial.PREPARED[c]);c<b;)e.scalar_multiply(a,a,++c);return a};e.dump=function(a){return"bigrat\t"+e.str(a)+"\n~\t"+e.toDecimal(a)+"\nCF:\t["+e.toContinuedFraction(a)+"]\n"};e.ZERO=e.fromInteger(0);e.ONE=e.fromInteger(1);e.NEGONE=e.fromInteger(-1);e.INFINITY=e.fromValues(1,0);e.INFINULL=e.fromValues(0,0);e.INFINITESIMAL=e.clone([new BigInteger(1),r]);e.PI=e.fromValues("3141592653589793238462643383279502884197169399375105820974944592307816406286208998628034825342117067982148086513282306647093844609550582231725359408128481117450284102701938521105559644622948954930381964428810975665933446128475648233786783165271201909145648566923460348610454326648213393607260249141273724587",
"1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000");"undefined"!==typeof b&&(b.bigrat=e);var t=function(a,b){this.a=f.fromValues(parseInt(a),parseInt(b))};t.prototype.toString=function(){return f.str(this.a)};t.prototype.toContinuedFraction=function(a){return f.toContinuedFraction(this.a,
a)};t.prototype.invert=function(){return f.invert(this.a)};t.prototype.reciprocal=t.prototype.invert;t.prototype.add=function(a){var b=f.create();f.add(b,this.a,a.a);return new t(b[0],b[1])};t.prototype.plus=t.prototype.add;t.prototype.subtract=function(a){var b=f.create();f.sub(b,this.a,a.a);return new t(b[0],b[1])};t.prototype.sub=t.prototype.subtract;t.prototype.minus=t.prototype.subtract;t.prototype.multiply=function(a){var b=f.create();f.mul(b,this.a,a.a);return new t(b[0],b[1])};t.prototype.mul=
t.prototype.multiply;t.prototype.times=t.prototype.multiply;t.prototype.mediant=function(a){var b=f.create();f.mediant(b,this.a,a.a);return new t(b[0],b[1])};t.prototype.divide=function(a){var b=f.create();f.div(b,this.a,a.a);return new t(b[0],b[1])};t.prototype.div=t.prototype.divide;t.prototype.divided_by=t.prototype.divide;t.prototype.power=function(a){var b=f.create();f.pow(b,this.a,a);return new t(b[0],b[1])};t.prototype.pow=t.prototype.power;t.prototype.dump=function(){return f.dump(this.a)};
t.prototype.toRat=function(){return f.clone(this.a)};t.prototype.toDecimal=function(){return f.toDecimal(this.a)};t.fromRat=function(a){var b=new t;b.a[0]=a[0];b.a[1]=a[1];return b};t.fromInteger=function(a){return t.fromRat(f.fromInteger(a))};t.fromIntegerInverse=function(a){return t.fromRat(f.fromIntegerInverse(a))};t.fromDecimal=function(a){return t.fromRat(f.fromDecimal(a))};t.fromContinuedFraction=function(a){return t.fromRat(f.fromContinuedFraction(f.create(),a))};"undefined"!==typeof b&&(b.rational=
t)})(p)})(this);(function(c,p){"object"===typeof module&&"object"===typeof module.exports?module.exports=c.document?p(c,!0):function(b){if(!b.document)throw Error("jQuery requires a window with a document");return p(b)}:p(c)})("undefined"!==typeof window?window:this,function(c,p){function b(a){var b=a.length,c=m.type(a);return"function"===c||m.isWindow(a)?!1:1===a.nodeType&&b?!0:"array"===c||0===b||"number"===typeof b&&0<b&&b-1 in a}function a(a,b,c){if(m.isFunction(b))return m.grep(a,function(a,F){return!!b.call(a,
F,a)!==c});if(b.nodeType)return m.grep(a,function(a){return a===b!==c});if("string"===typeof b){if(zb.test(b))return m.filter(b,a,c);b=m.filter(b,a)}return m.grep(a,function(a){return 0<=sa.call(b,a)!==c})}function k(a,b){for(;(a=a[b])&&1!==a.nodeType;);return a}function g(a){var b=kb[a]={};m.each(a.match(ta)||[],function(a,c){b[c]=!0});return b}function d(){Q.removeEventListener("DOMContentLoaded",d,!1);c.removeEventListener("load",d,!1);m.ready()}function n(){Object.defineProperty(this.cache={},
0,{get:function(){return{}}});this.expando=m.expando+Math.random()}function f(a,b,c){if(void 0===c&&1===a.nodeType)if(c="data-"+b.replace(Oa,"-$1").toLowerCase(),c=a.getAttribute(c),"string"===typeof c){try{c="true"===c?!0:"false"===c?!1:"null"===c?null:+c+""===c?+c:Ab.test(c)?m.parseJSON(c):c}catch(d){}V.set(a,b,c)}else c=void 0;return c}function r(){return!0}function l(){return!1}function e(){try{return Q.activeElement}catch(a){}}function t(a,b){return m.nodeName(a,"table")&&m.nodeName(11!==b.nodeType?
b:b.firstChild,"tr")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function q(a){a.type=(null!==a.getAttribute("type"))+"/"+a.type;return a}function B(a){var b=$a.exec(a.type);b?a.type=b[1]:a.removeAttribute("type");return a}function x(a,b){for(var c=0,d=a.length;c<d;c++)N.set(a[c],"globalEval",!b||N.get(b[c],"globalEval"))}function G(a,b){var c,d,e,h;if(1===b.nodeType){if(N.hasData(a)&&(h=N.access(a),c=N.set(b,h),h=h.events))for(e in delete c.handle,
c.events={},h)for(c=0,d=h[e].length;c<d;c++)m.event.add(b,e,h[e][c]);V.hasData(a)&&(e=V.access(a),e=m.extend({},e),V.set(b,e))}}function A(a,b){var c=a.getElementsByTagName?a.getElementsByTagName(b||"*"):a.querySelectorAll?a.querySelectorAll(b||"*"):[];return void 0===b||b&&m.nodeName(a,b)?m.merge([a],c):c}function E(a,b){var d,e=m(b.createElement(a)).appendTo(b.body),h=c.getDefaultComputedStyle&&(d=c.getDefaultComputedStyle(e[0]))?d.display:m.css(e[0],"display");e.detach();return h}function I(a){var b=
Q,c=Pa[a];c||(c=E(a,b),"none"!==c&&c||(Qa=(Qa||m("<iframe frameborder='0' width='0' height='0'/>")).appendTo(b.documentElement),b=Qa[0].contentDocument,b.write(),b.close(),c=E(a,b),Qa.detach()),Pa[a]=c);return c}function h(a,b,c){var d,e,h=a.style;(c=c||Ra(a))&&(e=c.getPropertyValue(b)||c[b]);c&&(""!==e||m.contains(a.ownerDocument,a)||(e=m.style(a,b)),qa.test(e)&&Ga.test(b)&&(a=h.width,b=h.minWidth,d=h.maxWidth,h.minWidth=h.maxWidth=h.width=e,e=c.width,h.width=a,h.minWidth=b,h.maxWidth=d));return void 0!==
e?e+"":e}function C(a,b){return{get:function(){if(a())delete this.get;else return(this.get=b).apply(this,arguments)}}}function w(a,b){if(b in a)return b;for(var c=b[0].toUpperCase()+b.slice(1),d=b,e=ja.length;e--;)if(b=ja[e]+c,b in a)return b;return d}function z(a,b,c){return(a=pa.exec(b))?Math.max(0,a[1]-(c||0))+(a[2]||"px"):b}function y(a,b,c,d,e){b=c===(d?"border":"content")?4:"width"===b?1:0;for(var h=0;4>b;b+=2)"margin"===c&&(h+=m.css(a,c+za[b],!0,e)),d?("content"===c&&(h-=m.css(a,"padding"+
za[b],!0,e)),"margin"!==c&&(h-=m.css(a,"border"+za[b]+"Width",!0,e))):(h+=m.css(a,"padding"+za[b],!0,e),"padding"!==c&&(h+=m.css(a,"border"+za[b]+"Width",!0,e)));return h}function S(a,b,c){var d=!0,e="width"===b?a.offsetWidth:a.offsetHeight,f=Ra(a),g="border-box"===m.css(a,"boxSizing",!1,f);if(0>=e||null==e){e=h(a,b,f);if(0>e||null==e)e=a.style[b];if(qa.test(e))return e;d=g&&(X.boxSizingReliable()||e===a.style[b]);e=parseFloat(e)||0}return e+y(a,b,c||(g?"border":"content"),d,f)+"px"}function P(a,
b){for(var c,d,e,h=[],f=0,g=a.length;f<g;f++)d=a[f],d.style&&(h[f]=N.get(d,"olddisplay"),c=d.style.display,b?(h[f]||"none"!==c||(d.style.display=""),""===d.style.display&&Da(d)&&(h[f]=N.access(d,"olddisplay",I(d.nodeName)))):(e=Da(d),"none"===c&&e||N.set(d,"olddisplay",e?c:m.css(d,"display"))));for(f=0;f<g;f++)d=a[f],!d.style||b&&"none"!==d.style.display&&""!==d.style.display||(d.style.display=b?h[f]||"":"none");return a}function J(a,b,c,d,e){return new J.prototype.init(a,b,c,d,e)}function O(){setTimeout(function(){Ea=
void 0});return Ea=m.now()}function M(a,b){var c,d=0,e={height:a};for(b=b?1:0;4>d;d+=2-b)c=za[d],e["margin"+c]=e["padding"+c]=a;b&&(e.opacity=e.width=a);return e}function U(a,b,c){for(var d,e=(K[b]||[]).concat(K["*"]),h=0,f=e.length;h<f;h++)if(d=e[h].call(c,b,a))return d}function ca(a,b){var c,d,e,h,f;for(c in a)if(d=m.camelCase(c),e=b[d],h=a[c],m.isArray(h)&&(e=h[1],h=a[c]=h[0]),c!==d&&(a[d]=h,delete a[c]),(f=m.cssHooks[d])&&"expand"in f)for(c in h=f.expand(h),delete a[d],h)c in a||(a[c]=h[c],b[c]=
e);else b[d]=e}function fa(a,b,c){var d,e=0,h=T.length,f=m.Deferred().always(function(){delete g.elem}),g=function(){if(d)return!1;for(var b=Ea||O(),b=Math.max(0,l.startTime+l.duration-b),u=1-(b/l.duration||0),c=0,e=l.tweens.length;c<e;c++)l.tweens[c].run(u);f.notifyWith(a,[l,u,b]);if(1>u&&e)return b;f.resolveWith(a,[l]);return!1},l=f.promise({elem:a,props:m.extend({},b),opts:m.extend(!0,{specialEasing:{}},c),originalProperties:b,originalOptions:c,startTime:Ea||O(),duration:c.duration,tweens:[],createTween:function(b,
u){var c=m.Tween(a,l.opts,b,u,l.opts.specialEasing[b]||l.opts.easing);l.tweens.push(c);return c},stop:function(b){var u=0,c=b?l.tweens.length:0;if(d)return this;for(d=!0;u<c;u++)l.tweens[u].run(1);b?f.resolveWith(a,[l,b]):f.rejectWith(a,[l,b]);return this}});c=l.props;for(ca(c,l.opts.specialEasing);e<h;e++)if(b=T[e].call(l,a,c,l.opts))return b;m.map(c,U,l);m.isFunction(l.opts.start)&&l.opts.start.call(a,l);m.fx.timer(m.extend(g,{elem:a,anim:l,queue:l.opts.queue}));return l.progress(l.opts.progress).done(l.opts.done,
l.opts.complete).fail(l.opts.fail).always(l.opts.always)}function da(a){return function(b,c){"string"!==typeof b&&(c=b,b="*");var d,e=0,h=b.toLowerCase().match(ta)||[];if(m.isFunction(c))for(;d=h[e++];)"+"===d[0]?(d=d.slice(1)||"*",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c)}}function oa(a,b,c,d){function e(g){var l;h[g]=!0;m.each(a[g]||[],function(a,u){var F=u(b,c,d);if("string"===typeof F&&!f&&!h[F])return b.dataTypes.unshift(F),e(F),!1;if(f)return!(l=F)});return l}var h={},f=a===ab;return e(b.dataTypes[0])||
!h["*"]&&e("*")}function Z(a,b){var c,d,e=m.ajaxSettings.flatOptions||{};for(c in b)void 0!==b[c]&&((e[c]?a:d||(d={}))[c]=b[c]);d&&m.extend(!0,a,d);return a}function W(a,b,c,d){var e;if(m.isArray(b))m.each(b,function(b,e){c||La.test(a)?d(a,e):W(a+"["+("object"===typeof e?b:"")+"]",e,c,d)});else if(c||"object"!==m.type(b))d(a,b);else for(e in b)W(a+"["+e+"]",b[e],c,d)}function ba(a){return m.isWindow(a)?a:9===a.nodeType&&a.defaultView}var ka=[],Y=ka.slice,ua=ka.concat,va=ka.push,sa=ka.indexOf,Aa={},
Ba=Aa.toString,wa=Aa.hasOwnProperty,X={},Q=c.document,m=function(a,b){return new m.fn.init(a,b)},bb=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,Cb=/^-ms-/,lb=/-([\da-z])/gi,cb=function(a,b){return b.toUpperCase()};m.fn=m.prototype={jquery:"2.1.1",constructor:m,selector:"",length:0,toArray:function(){return Y.call(this)},get:function(a){return null!=a?0>a?this[a+this.length]:this[a]:Y.call(this)},pushStack:function(a){a=m.merge(this.constructor(),a);a.prevObject=this;a.context=this.context;return a},each:function(a,
b){return m.each(this,a,b)},map:function(a){return this.pushStack(m.map(this,function(b,c){return a.call(b,c,b)}))},slice:function(){return this.pushStack(Y.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var b=this.length;a=+a+(0>a?b:0);return this.pushStack(0<=a&&a<b?[this[a]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:va,sort:ka.sort,splice:ka.splice};m.extend=m.fn.extend=function(){var a,b,c,d,e,h=arguments[0]||
{},f=1,g=arguments.length,l=!1;"boolean"===typeof h&&(l=h,h=arguments[f]||{},f++);"object"===typeof h||m.isFunction(h)||(h={});f===g&&(h=this,f--);for(;f<g;f++)if(null!=(a=arguments[f]))for(b in a)c=h[b],d=a[b],h!==d&&(l&&d&&(m.isPlainObject(d)||(e=m.isArray(d)))?(e?(e=!1,c=c&&m.isArray(c)?c:[]):c=c&&m.isPlainObject(c)?c:{},h[b]=m.extend(l,c,d)):void 0!==d&&(h[b]=d));return h};m.extend({expando:"jQuery"+("2.1.1"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(a){throw Error(a);},noop:function(){},
isFunction:function(a){return"function"===m.type(a)},isArray:Array.isArray,isWindow:function(a){return null!=a&&a===a.window},isNumeric:function(a){return!m.isArray(a)&&0<=a-parseFloat(a)},isPlainObject:function(a){return"object"!==m.type(a)||a.nodeType||m.isWindow(a)||a.constructor&&!wa.call(a.constructor.prototype,"isPrototypeOf")?!1:!0},isEmptyObject:function(a){for(var b in a)return!1;return!0},type:function(a){return null==a?a+"":"object"===typeof a||"function"===typeof a?Aa[Ba.call(a)]||"object":
typeof a},globalEval:function(a){var b;b=eval;if(a=m.trim(a))1===a.indexOf("use strict")?(b=Q.createElement("script"),b.text=a,Q.head.appendChild(b).parentNode.removeChild(b)):b(a)},camelCase:function(a){return a.replace(Cb,"ms-").replace(lb,cb)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()},each:function(a,c,d){var e,h=0,f=a.length;e=b(a);if(d)if(e)for(;h<f&&(e=c.apply(a[h],d),!1!==e);h++);else for(h in a){if(e=c.apply(a[h],d),!1===e)break}else if(e)for(;h<
f&&(e=c.call(a[h],h,a[h]),!1!==e);h++);else for(h in a)if(e=c.call(a[h],h,a[h]),!1===e)break;return a},trim:function(a){return null==a?"":(a+"").replace(bb,"")},makeArray:function(a,c){var d=c||[];null!=a&&(b(Object(a))?m.merge(d,"string"===typeof a?[a]:a):va.call(d,a));return d},inArray:function(a,b,c){return null==b?-1:sa.call(b,a,c)},merge:function(a,b){for(var c=+b.length,d=0,e=a.length;d<c;d++)a[e++]=b[d];a.length=e;return a},grep:function(a,b,c){for(var d=[],e=0,h=a.length,f=!c;e<h;e++)c=!b(a[e],
e),c!==f&&d.push(a[e]);return d},map:function(a,c,d){var e,h=0,f=a.length,g=[];if(b(a))for(;h<f;h++)e=c(a[h],h,d),null!=e&&g.push(e);else for(h in a)e=c(a[h],h,d),null!=e&&g.push(e);return ua.apply([],g)},guid:1,proxy:function(a,b){var c,d;"string"===typeof b&&(c=a[b],b=a,a=c);if(m.isFunction(a))return d=Y.call(arguments,2),c=function(){return a.apply(b||this,d.concat(Y.call(arguments)))},c.guid=a.guid=a.guid||m.guid++,c},now:Date.now,support:X});m.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),
function(a,b){Aa["[object "+b+"]"]=b.toLowerCase()});var Ha=function(a){function b(a,c,d,v){var e,F,h,f,g;(c?c.ownerDocument||c:da)!==M&&E(c);c=c||M;d=d||[];if(!a||"string"!==typeof a)return d;if(1!==(f=c.nodeType)&&9!==f)return[];if(G&&!v){if(e=pa.exec(a))if(h=e[1])if(9===f)if((F=c.getElementById(h))&&F.parentNode){if(F.id===h)return d.push(F),d}else return d;else{if(c.ownerDocument&&(F=c.ownerDocument.getElementById(h))&&fa(c,F)&&F.id===h)return d.push(F),d}else{if(e[2])return ba.apply(d,c.getElementsByTagName(a)),
d;if((h=e[3])&&w.getElementsByClassName&&c.getElementsByClassName)return ba.apply(d,c.getElementsByClassName(h)),d}if(w.qsa&&(!I||!I.test(a))){F=e=D;h=c;g=9===f&&a;if(1===f&&"object"!==c.nodeName.toLowerCase()){f=p(a);(e=c.getAttribute("id"))?F=e.replace(qa,"\\$&"):c.setAttribute("id",F);F="[id='"+F+"'] ";for(h=f.length;h--;)f[h]=F+H(f[h]);h=ma.test(a)&&u(c.parentNode)||c;g=f.join(",")}if(g)try{return ba.apply(d,h.querySelectorAll(g)),d}catch(l){}finally{e||c.removeAttribute("id")}}}return x(a.replace(sa,
"$1"),c,d,v)}function c(){function a(c,u){b.push(c+" ")>t.cacheLength&&delete a[b.shift()];return a[c+" "]=u}var b=[];return a}function d(a){a[D]=!0;return a}function e(a){var b=M.createElement("div");try{return!!a(b)}catch(c){return!1}finally{b.parentNode&&b.parentNode.removeChild(b)}}function h(a,b){for(var c=a.split("|"),u=a.length;u--;)t.attrHandle[c[u]]=b}function f(a,b){var c=b&&a,u=c&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||-2147483648)-(~a.sourceIndex||-2147483648);if(u)return u;
if(c)for(;c=c.nextSibling;)if(c===b)return-1;return a?1:-1}function g(a){return function(b){return"input"===b.nodeName.toLowerCase()&&b.type===a}}function l(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}}function k(a){return d(function(b){b=+b;return d(function(c,u){for(var d,v=a([],c.length,b),e=v.length;e--;)c[d=v[e]]&&(c[d]=!(u[d]=c[d]))})})}function u(a){return a&&"undefined"!==typeof a.getElementsByTagName&&a}function v(){}function H(a){for(var b=
0,c=a.length,u="";b<c;b++)u+=a[b].value;return u}function L(a,b,c){var u=b.dir,d=c&&"parentNode"===u,v=oa++;return b.first?function(b,c,v){for(;b=b[u];)if(1===b.nodeType||d)return a(b,c,v)}:function(b,c,e){var F,h,f=[K,v];if(e)for(;b=b[u];){if((1===b.nodeType||d)&&a(b,c,e))return!0}else for(;b=b[u];)if(1===b.nodeType||d){h=b[D]||(b[D]={});if((F=h[u])&&F[0]===K&&F[1]===v)return f[2]=F[2];h[u]=f;if(f[2]=a(b,c,e))return!0}}}function m(a){return 1<a.length?function(b,c,u){for(var d=a.length;d--;)if(!a[d](b,
c,u))return!1;return!0}:a[0]}function n(a,b,c,u,d){for(var v,e=[],F=0,h=a.length,f=null!=b;F<h;F++)if(v=a[F])if(!c||c(v,u,d))e.push(v),f&&b.push(F);return e}function q(a,c,u,v,e,F){v&&!v[D]&&(v=q(v));e&&!e[D]&&(e=q(e,F));return d(function(d,F,h,f){var H,g,l=[],k=[],L=F.length,m;if(!(m=d)){m=c||"*";for(var q=h.nodeType?[h]:h,y=[],Fa=0,w=q.length;Fa<w;Fa++)b(m,q[Fa],y);m=y}m=!a||!d&&c?m:n(m,l,a,h,f);q=u?e||(d?a:L||v)?[]:F:m;u&&u(m,q,h,f);if(v)for(H=n(q,k),v(H,[],h,f),h=H.length;h--;)if(g=H[h])q[k[h]]=
!(m[k[h]]=g);if(d){if(e||a){if(e){H=[];for(h=q.length;h--;)(g=q[h])&&H.push(m[h]=g);e(null,q=[],H,f)}for(h=q.length;h--;)(g=q[h])&&-1<(H=e?R.call(d,g):l[h])&&(d[H]=!(F[H]=g))}}else q=n(q===F?q.splice(L,q.length):q),e?e(null,F,q,f):ba.apply(F,q)})}function y(a){var b,c,u,d=a.length,v=t.relative[a[0].type];c=v||t.relative[" "];for(var e=v?1:0,F=L(function(a){return a===b},c,!0),h=L(function(a){return-1<R.call(b,a)},c,!0),f=[function(a,c,u){return!v&&(u||c!==B)||((b=c).nodeType?F(a,c,u):h(a,c,u))}];e<
d;e++)if(c=t.relative[a[e].type])f=[L(m(f),c)];else{c=t.filter[a[e].type].apply(null,a[e].matches);if(c[D]){for(u=++e;u<d&&!t.relative[a[u].type];u++);return q(1<e&&m(f),1<e&&H(a.slice(0,e-1).concat({value:" "===a[e-2].type?"*":""})).replace(sa,"$1"),c,e<u&&y(a.slice(e,u)),u<d&&y(a=a.slice(u)),u<d&&H(a))}f.push(c)}return m(f)}function z(a,c){var u=0<c.length,v=0<a.length,e=function(d,e,F,h,f){var H,g,l,k=0,L="0",m=d&&[],q=[],y=B,Fa=d||v&&t.find.TAG("*",f),w=K+=null==y?1:Math.random()||.1,z=Fa.length;
for(f&&(B=e!==M&&e);L!==z&&null!=(H=Fa[L]);L++){if(v&&H){for(g=0;l=a[g++];)if(l(H,e,F)){h.push(H);break}f&&(K=w)}u&&((H=!l&&H)&&k--,d&&m.push(H))}k+=L;if(u&&L!==k){for(g=0;l=c[g++];)l(m,q,e,F);if(d){if(0<k)for(;L--;)m[L]||q[L]||(q[L]=X.call(h));q=n(q)}ba.apply(h,q);f&&!d&&0<q.length&&1<k+c.length&&b.uniqueSort(h)}f&&(K=w,B=y);return m};return u?d(e):e}var C,w,t,r,S,p,A,x,B,P,O,E,M,J,G,I,U,ca,fa,D="sizzle"+-new Date,da=a.document,K=0,oa=0,N=c(),Q=c(),Z=c(),W=function(a,b){a===b&&(O=!0);return 0},ka=
{}.hasOwnProperty,Y=[],X=Y.pop,va=Y.push,ba=Y.push,T=Y.slice,R=Y.indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(this[b]===a)return b;return-1},ua="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+".replace("w","w#"),V="\\[[\\x20\\t\\r\\n\\f]*((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)(?:[\\x20\\t\\r\\n\\f]*([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+ua+"))|)[\\x20\\t\\r\\n\\f]*\\]",wa=":((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+
V+")*)|.*)\\)|)",sa=/^[\x20\t\r\n\f]+|((?:^|[^\\])(?:\\.)*)[\x20\t\r\n\f]+$/g,aa=/^[\x20\t\r\n\f]*,[\x20\t\r\n\f]*/,bb=/^[\x20\t\r\n\f]*([>+~]|[\x20\t\r\n\f])[\x20\t\r\n\f]*/,ea=/=[\x20\t\r\n\f]*([^\]'"]*?)[\x20\t\r\n\f]*\]/g,ga=new RegExp(wa),la=new RegExp("^"+ua+"$"),Ba={ID:/^#((?:\\.|[\w-]|[^\x00-\xa0])+)/,CLASS:/^\.((?:\\.|[\w-]|[^\x00-\xa0])+)/,TAG:new RegExp("^("+"(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+".replace("w","w*")+")"),ATTR:new RegExp("^"+V),PSEUDO:new RegExp("^"+wa),CHILD:/^:(only|first|last|nth|nth-last)-(child|of-type)(?:\([\x20\t\r\n\f]*(even|odd|(([+-]|)(\d*)n|)[\x20\t\r\n\f]*(?:([+-]|)[\x20\t\r\n\f]*(\d+)|))[\x20\t\r\n\f]*\)|)/i,
bool:/^(?:checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)$/i,needsContext:/^[\x20\t\r\n\f]*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\([\x20\t\r\n\f]*((?:-\d)?\d*)[\x20\t\r\n\f]*\)|)(?=[^-]|$)/i},Aa=/^(?:input|select|textarea|button)$/i,na=/^h\d$/i,ja=/^[^{]+\{\s*\[native \w/,pa=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ma=/[+~]/,qa=/'|\\/g,ha=/\\([\da-f]{1,6}[\x20\t\r\n\f]?|([\x20\t\r\n\f])|.)/ig,ia=function(a,b,c){a="0x"+b-65536;
return a!==a||c?b:0>a?String.fromCharCode(a+65536):String.fromCharCode(a>>10|55296,a&1023|56320)};try{ba.apply(Y=T.call(da.childNodes),da.childNodes),Y[da.childNodes.length].nodeType}catch(ta){ba={apply:Y.length?function(a,b){va.apply(a,T.call(b))}:function(a,b){for(var c=a.length,u=0;a[c++]=b[u++];);a.length=c-1}}}w=b.support={};S=b.isXML=function(a){return(a=a&&(a.ownerDocument||a).documentElement)?"HTML"!==a.nodeName:!1};E=b.setDocument=function(a){var b=a?a.ownerDocument||a:da;a=b.defaultView;
if(b===M||9!==b.nodeType||!b.documentElement)return M;M=b;J=b.documentElement;G=!S(b);a&&a!==a.top&&(a.addEventListener?a.addEventListener("unload",function(){E()},!1):a.attachEvent&&a.attachEvent("onunload",function(){E()}));w.attributes=e(function(a){a.className="i";return!a.getAttribute("className")});w.getElementsByTagName=e(function(a){a.appendChild(b.createComment(""));return!a.getElementsByTagName("*").length});w.getElementsByClassName=ja.test(b.getElementsByClassName)&&e(function(a){a.innerHTML=
"<div class='a'></div><div class='a i'></div>";a.firstChild.className="i";return 2===a.getElementsByClassName("i").length});w.getById=e(function(a){J.appendChild(a).id=D;return!b.getElementsByName||!b.getElementsByName(D).length});w.getById?(t.find.ID=function(a,b){if("undefined"!==typeof b.getElementById&&G){var c=b.getElementById(a);return c&&c.parentNode?[c]:[]}},t.filter.ID=function(a){var b=a.replace(ha,ia);return function(a){return a.getAttribute("id")===b}}):(delete t.find.ID,t.filter.ID=function(a){var b=
a.replace(ha,ia);return function(a){return(a="undefined"!==typeof a.getAttributeNode&&a.getAttributeNode("id"))&&a.value===b}});t.find.TAG=w.getElementsByTagName?function(a,b){if("undefined"!==typeof b.getElementsByTagName)return b.getElementsByTagName(a)}:function(a,b){var c,u=[],d=0,v=b.getElementsByTagName(a);if("*"===a){for(;c=v[d++];)1===c.nodeType&&u.push(c);return u}return v};t.find.CLASS=w.getElementsByClassName&&function(a,b){if("undefined"!==typeof b.getElementsByClassName&&G)return b.getElementsByClassName(a)};
U=[];I=[];if(w.qsa=ja.test(b.querySelectorAll))e(function(a){a.innerHTML="<select msallowclip=''><option selected=''></option></select>";a.querySelectorAll("[msallowclip^='']").length&&I.push("[*^$]=[\\x20\\t\\r\\n\\f]*(?:''|\"\")");a.querySelectorAll("[selected]").length||I.push("\\[[\\x20\\t\\r\\n\\f]*(?:value|checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)");a.querySelectorAll(":checked").length||I.push(":checked")}),e(function(a){var c=
b.createElement("input");c.setAttribute("type","hidden");a.appendChild(c).setAttribute("name","D");a.querySelectorAll("[name=d]").length&&I.push("name[\\x20\\t\\r\\n\\f]*[*^$|!~]?=");a.querySelectorAll(":enabled").length||I.push(":enabled",":disabled");a.querySelectorAll("*,:x");I.push(",.*:")});(w.matchesSelector=ja.test(ca=J.matches||J.webkitMatchesSelector||J.mozMatchesSelector||J.oMatchesSelector||J.msMatchesSelector))&&e(function(a){w.disconnectedMatch=ca.call(a,"div");ca.call(a,"[s!='']:x");
U.push("!=",wa)});I=I.length&&new RegExp(I.join("|"));U=U.length&&new RegExp(U.join("|"));fa=(a=ja.test(J.compareDocumentPosition))||ja.test(J.contains)?function(a,b){var c=9===a.nodeType?a.documentElement:a,u=b&&b.parentNode;return a===u||!!(u&&1===u.nodeType&&(c.contains?c.contains(u):a.compareDocumentPosition&&a.compareDocumentPosition(u)&16))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1};W=a?function(a,c){if(a===c)return O=!0,0;var u=!a.compareDocumentPosition-!c.compareDocumentPosition;
if(u)return u;u=(a.ownerDocument||a)===(c.ownerDocument||c)?a.compareDocumentPosition(c):1;return u&1||!w.sortDetached&&c.compareDocumentPosition(a)===u?a===b||a.ownerDocument===da&&fa(da,a)?-1:c===b||c.ownerDocument===da&&fa(da,c)?1:P?R.call(P,a)-R.call(P,c):0:u&4?-1:1}:function(a,c){if(a===c)return O=!0,0;var u,d=0;u=a.parentNode;var v=c.parentNode,e=[a],F=[c];if(!u||!v)return a===b?-1:c===b?1:u?-1:v?1:P?R.call(P,a)-R.call(P,c):0;if(u===v)return f(a,c);for(u=a;u=u.parentNode;)e.unshift(u);for(u=
c;u=u.parentNode;)F.unshift(u);for(;e[d]===F[d];)d++;return d?f(e[d],F[d]):e[d]===da?-1:F[d]===da?1:0};return b};b.matches=function(a,c){return b(a,null,null,c)};b.matchesSelector=function(a,c){(a.ownerDocument||a)!==M&&E(a);c=c.replace(ea,"='$1']");if(!(!w.matchesSelector||!G||U&&U.test(c)||I&&I.test(c)))try{var u=ca.call(a,c);if(u||w.disconnectedMatch||a.document&&11!==a.document.nodeType)return u}catch(d){}return 0<b(c,M,null,[a]).length};b.contains=function(a,b){(a.ownerDocument||a)!==M&&E(a);
return fa(a,b)};b.attr=function(a,b){(a.ownerDocument||a)!==M&&E(a);var c=t.attrHandle[b.toLowerCase()],c=c&&ka.call(t.attrHandle,b.toLowerCase())?c(a,b,!G):void 0;return void 0!==c?c:w.attributes||!G?a.getAttribute(b):(c=a.getAttributeNode(b))&&c.specified?c.value:null};b.error=function(a){throw Error("Syntax error, unrecognized expression: "+a);};b.uniqueSort=function(a){var b,c=[],u=0,d=0;O=!w.detectDuplicates;P=!w.sortStable&&a.slice(0);a.sort(W);if(O){for(;b=a[d++];)b===a[d]&&(u=c.push(d));for(;u--;)a.splice(c[u],
1)}P=null;return a};r=b.getText=function(a){var b,c="",u=0;b=a.nodeType;if(!b)for(;b=a[u++];)c+=r(b);else if(1===b||9===b||11===b){if("string"===typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=r(a)}else if(3===b||4===b)return a.nodeValue;return c};t=b.selectors={cacheLength:50,createPseudo:d,match:Ba,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){a[1]=
a[1].replace(ha,ia);a[3]=(a[3]||a[4]||a[5]||"").replace(ha,ia);"~="===a[2]&&(a[3]=" "+a[3]+" ");return a.slice(0,4)},CHILD:function(a){a[1]=a[1].toLowerCase();"nth"===a[1].slice(0,3)?(a[3]||b.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&b.error(a[0]);return a},PSEUDO:function(a){var b,c=!a[6]&&a[2];if(Ba.CHILD.test(a[0]))return null;a[3]?a[2]=a[4]||a[5]||"":c&&ga.test(c)&&(b=p(c,!0))&&(b=c.indexOf(")",c.length-b)-c.length)&&(a[0]=a[0].slice(0,
b),a[2]=c.slice(0,b));return a.slice(0,3)}},filter:{TAG:function(a){var b=a.replace(ha,ia).toLowerCase();return"*"===a?function(){return!0}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b}},CLASS:function(a){var b=N[a+" "];return b||(b=new RegExp("(^|[\\x20\\t\\r\\n\\f])"+a+"([\\x20\\t\\r\\n\\f]|$)"))&&N(a,function(a){return b.test("string"===typeof a.className&&a.className||"undefined"!==typeof a.getAttribute&&a.getAttribute("class")||"")})},ATTR:function(a,c,u){return function(d){d=
b.attr(d,a);if(null==d)return"!="===c;if(!c)return!0;d+="";return"="===c?d===u:"!="===c?d!==u:"^="===c?u&&0===d.indexOf(u):"*="===c?u&&-1<d.indexOf(u):"$="===c?u&&d.slice(-u.length)===u:"~="===c?-1<(" "+d+" ").indexOf(u):"|="===c?d===u||d.slice(0,u.length+1)===u+"-":!1}},CHILD:function(a,b,c,u,d){var v="nth"!==a.slice(0,3),e="last"!==a.slice(-4),F="of-type"===b;return 1===u&&0===d?function(a){return!!a.parentNode}:function(b,c,h){var f,H,g,l,k;c=v!==e?"nextSibling":"previousSibling";var L=b.parentNode,
m=F&&b.nodeName.toLowerCase();h=!h&&!F;if(L){if(v){for(;c;){for(H=b;H=H[c];)if(F?H.nodeName.toLowerCase()===m:1===H.nodeType)return!1;k=c="only"===a&&!k&&"nextSibling"}return!0}k=[e?L.firstChild:L.lastChild];if(e&&h)for(h=L[D]||(L[D]={}),f=h[a]||[],l=f[0]===K&&f[1],g=f[0]===K&&f[2],H=l&&L.childNodes[l];H=++l&&H&&H[c]||(g=l=0)||k.pop();){if(1===H.nodeType&&++g&&H===b){h[a]=[K,l,g];break}}else if(h&&(f=(b[D]||(b[D]={}))[a])&&f[0]===K)g=f[1];else for(;(H=++l&&H&&H[c]||(g=l=0)||k.pop())&&((F?H.nodeName.toLowerCase()!==
m:1!==H.nodeType)||!++g||(h&&((H[D]||(H[D]={}))[a]=[K,g]),H!==b)););g-=d;return g===u||0===g%u&&0<=g/u}}},PSEUDO:function(a,c){var u,v=t.pseudos[a]||t.setFilters[a.toLowerCase()]||b.error("unsupported pseudo: "+a);return v[D]?v(c):1<v.length?(u=[a,a,"",c],t.setFilters.hasOwnProperty(a.toLowerCase())?d(function(a,b){for(var u,d=v(a,c),e=d.length;e--;)u=R.call(a,d[e]),a[u]=!(b[u]=d[e])}):function(a){return v(a,0,u)}):v}},pseudos:{not:d(function(a){var b=[],c=[],u=A(a.replace(sa,"$1"));return u[D]?d(function(a,
b,c,d){d=u(a,null,d,[]);for(var v=a.length;v--;)if(c=d[v])a[v]=!(b[v]=c)}):function(a,d,v){b[0]=a;u(b,null,v,c);return!c.pop()}}),has:d(function(a){return function(c){return 0<b(a,c).length}}),contains:d(function(a){return function(b){return-1<(b.textContent||b.innerText||r(b)).indexOf(a)}}),lang:d(function(a){la.test(a||"")||b.error("unsupported lang: "+a);a=a.replace(ha,ia).toLowerCase();return function(b){var c;do if(c=G?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang"))return c=c.toLowerCase(),
c===a||0===c.indexOf(a+"-");while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(b){var c=a.location&&a.location.hash;return c&&c.slice(1)===b.id},root:function(a){return a===J},focus:function(a){return a===M.activeElement&&(!M.hasFocus||M.hasFocus())&&!!(a.type||a.href||~a.tabIndex)},enabled:function(a){return!1===a.disabled},disabled:function(a){return!0===a.disabled},checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){a.parentNode&&
a.parentNode.selectedIndex;return!0===a.selected},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if(6>a.nodeType)return!1;return!0},parent:function(a){return!t.pseudos.empty(a)},header:function(a){return na.test(a.nodeName)},input:function(a){return Aa.test(a.nodeName)},button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},text:function(a){var b;return"input"===a.nodeName.toLowerCase()&&"text"===a.type&&(null==(b=a.getAttribute("type"))||"text"===
b.toLowerCase())},first:k(function(){return[0]}),last:k(function(a,b){return[b-1]}),eq:k(function(a,b,c){return[0>c?c+b:c]}),even:k(function(a,b){for(var c=0;c<b;c+=2)a.push(c);return a}),odd:k(function(a,b){for(var c=1;c<b;c+=2)a.push(c);return a}),lt:k(function(a,b,c){for(b=0>c?c+b:c;0<=--b;)a.push(b);return a}),gt:k(function(a,b,c){for(c=0>c?c+b:c;++c<b;)a.push(c);return a})}};t.pseudos.nth=t.pseudos.eq;for(C in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})t.pseudos[C]=g(C);for(C in{submit:!0,
reset:!0})t.pseudos[C]=l(C);v.prototype=t.filters=t.pseudos;t.setFilters=new v;p=b.tokenize=function(a,c){var u,d,v,e,F,h,f;if(F=Q[a+" "])return c?0:F.slice(0);F=a;h=[];for(f=t.preFilter;F;){if(!u||(d=aa.exec(F)))d&&(F=F.slice(d[0].length)||F),h.push(v=[]);u=!1;if(d=bb.exec(F))u=d.shift(),v.push({value:u,type:d[0].replace(sa," ")}),F=F.slice(u.length);for(e in t.filter)!(d=Ba[e].exec(F))||f[e]&&!(d=f[e](d))||(u=d.shift(),v.push({value:u,type:e,matches:d}),F=F.slice(u.length));if(!u)break}return c?
F.length:F?b.error(a):Q(a,h).slice(0)};A=b.compile=function(a,b){var c,u=[],d=[],v=Z[a+" "];if(!v){b||(b=p(a));for(c=b.length;c--;)v=y(b[c]),v[D]?u.push(v):d.push(v);v=Z(a,z(d,u));v.selector=a}return v};x=b.select=function(a,b,c,d){var v,e,F,h,f="function"===typeof a&&a,g=!d&&p(a=f.selector||a);c=c||[];if(1===g.length){e=g[0]=g[0].slice(0);if(2<e.length&&"ID"===(F=e[0]).type&&w.getById&&9===b.nodeType&&G&&t.relative[e[1].type]){b=(t.find.ID(F.matches[0].replace(ha,ia),b)||[])[0];if(!b)return c;f&&
(b=b.parentNode);a=a.slice(e.shift().value.length)}for(v=Ba.needsContext.test(a)?0:e.length;v--;){F=e[v];if(t.relative[h=F.type])break;if(h=t.find[h])if(d=h(F.matches[0].replace(ha,ia),ma.test(e[0].type)&&u(b.parentNode)||b)){e.splice(v,1);a=d.length&&H(e);if(!a)return ba.apply(c,d),c;break}}}(f||A(a,g))(d,b,!G,c,ma.test(a)&&u(b.parentNode)||b);return c};w.sortStable=D.split("").sort(W).join("")===D;w.detectDuplicates=!!O;E();w.sortDetached=e(function(a){return a.compareDocumentPosition(M.createElement("div"))&
1});e(function(a){a.innerHTML="<a href='#'></a>";return"#"===a.firstChild.getAttribute("href")})||h("type|href|height|width",function(a,b,c){if(!c)return a.getAttribute(b,"type"===b.toLowerCase()?1:2)});w.attributes&&e(function(a){a.innerHTML="<input/>";a.firstChild.setAttribute("value","");return""===a.firstChild.getAttribute("value")})||h("value",function(a,b,c){if(!c&&"input"===a.nodeName.toLowerCase())return a.defaultValue});e(function(a){return null==a.getAttribute("disabled")})||h("checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",
function(a,b,c){var u;if(!c)return!0===a[b]?b.toLowerCase():(u=a.getAttributeNode(b))&&u.specified?u.value:null});return b}(c);m.find=Ha;m.expr=Ha.selectors;m.expr[":"]=m.expr.pseudos;m.unique=Ha.uniqueSort;m.text=Ha.getText;m.isXMLDoc=Ha.isXML;m.contains=Ha.contains;var mb=m.expr.match.needsContext,nb=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,zb=/^.[^:#\[\.,]*$/;m.filter=function(a,b,c){var d=b[0];c&&(a=":not("+a+")");return 1===b.length&&1===d.nodeType?m.find.matchesSelector(d,a)?[d]:[]:m.find.matches(a,m.grep(b,
function(a){return 1===a.nodeType}))};m.fn.extend({find:function(a){var b,c=this.length,d=[],e=this;if("string"!==typeof a)return this.pushStack(m(a).filter(function(){for(b=0;b<c;b++)if(m.contains(e[b],this))return!0}));for(b=0;b<c;b++)m.find(a,e[b],d);d=this.pushStack(1<c?m.unique(d):d);d.selector=this.selector?this.selector+" "+a:a;return d},filter:function(b){return this.pushStack(a(this,b||[],!1))},not:function(b){return this.pushStack(a(this,b||[],!0))},is:function(b){return!!a(this,"string"===
typeof b&&mb.test(b)?m(b):b||[],!1).length}});var Sa,Eb=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/;(m.fn.init=function(a,b){var c;if(!a)return this;if("string"===typeof a){c="<"===a[0]&&">"===a[a.length-1]&&3<=a.length?[null,a,null]:Eb.exec(a);if(!c||!c[1]&&b)return!b||b.jquery?(b||Sa).find(a):this.constructor(b).find(a);if(c[1]){if(b=b instanceof m?b[0]:b,m.merge(this,m.parseHTML(c[1],b&&b.nodeType?b.ownerDocument||b:Q,!0)),nb.test(c[1])&&m.isPlainObject(b))for(c in b)if(m.isFunction(this[c]))this[c](b[c]);
else this.attr(c,b[c])}else(c=Q.getElementById(c[2]))&&c.parentNode&&(this.length=1,this[0]=c),this.context=Q,this.selector=a;return this}if(a.nodeType)return this.context=this[0]=a,this.length=1,this;if(m.isFunction(a))return"undefined"!==typeof Sa.ready?Sa.ready(a):a(m);void 0!==a.selector&&(this.selector=a.selector,this.context=a.context);return m.makeArray(a,this)}).prototype=m.fn;Sa=m(Q);var Ta=/^(?:parents|prev(?:Until|All))/,db={children:!0,contents:!0,next:!0,prev:!0};m.extend({dir:function(a,
b,c){for(var d=[],e=void 0!==c;(a=a[b])&&9!==a.nodeType;)if(1===a.nodeType){if(e&&m(a).is(c))break;d.push(a)}return d},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c}});m.fn.extend({has:function(a){var b=m(a,this),c=b.length;return this.filter(function(){for(var a=0;a<c;a++)if(m.contains(this,b[a]))return!0})},closest:function(a,b){for(var c,d=0,e=this.length,h=[],f=mb.test(a)||"string"!==typeof a?m(a,b||this.context):0;d<e;d++)for(c=this[d];c&&c!==
b;c=c.parentNode)if(11>c.nodeType&&(f?-1<f.index(c):1===c.nodeType&&m.find.matchesSelector(c,a))){h.push(c);break}return this.pushStack(1<h.length?m.unique(h):h)},index:function(a){return a?"string"===typeof a?sa.call(m(a),this[0]):sa.call(this,a.jquery?a[0]:a):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(a,b){return this.pushStack(m.unique(m.merge(this.get(),m(a,b))))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}});m.each({parent:function(a){return(a=
a.parentNode)&&11!==a.nodeType?a:null},parents:function(a){return m.dir(a,"parentNode")},parentsUntil:function(a,b,c){return m.dir(a,"parentNode",c)},next:function(a){return k(a,"nextSibling")},prev:function(a){return k(a,"previousSibling")},nextAll:function(a){return m.dir(a,"nextSibling")},prevAll:function(a){return m.dir(a,"previousSibling")},nextUntil:function(a,b,c){return m.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return m.dir(a,"previousSibling",c)},siblings:function(a){return m.sibling((a.parentNode||
{}).firstChild,a)},children:function(a){return m.sibling(a.firstChild)},contents:function(a){return a.contentDocument||m.merge([],a.childNodes)}},function(a,b){m.fn[a]=function(c,d){var e=m.map(this,b,c);"Until"!==a.slice(-5)&&(d=c);d&&"string"===typeof d&&(e=m.filter(d,e));1<this.length&&(db[a]||m.unique(e),Ta.test(a)&&e.reverse());return this.pushStack(e)}});var ta=/\S+/g,kb={};m.Callbacks=function(a){a="string"===typeof a?kb[a]||g(a):m.extend({},a);var b,c,d,e,h,f,l=[],k=!a.once&&[],n=function(v){b=
a.memory&&v;c=!0;f=e||0;e=0;h=l.length;for(d=!0;l&&f<h;f++)if(!1===l[f].apply(v[0],v[1])&&a.stopOnFalse){b=!1;break}d=!1;l&&(k?k.length&&n(k.shift()):b?l=[]:u.disable())},u={add:function(){if(l){var c=l.length;(function L(b){m.each(b,function(b,c){var d=m.type(c);"function"===d?a.unique&&u.has(c)||l.push(c):c&&c.length&&"string"!==d&&L(c)})})(arguments);d?h=l.length:b&&(e=c,n(b))}return this},remove:function(){l&&m.each(arguments,function(a,b){for(var c;-1<(c=m.inArray(b,l,c));)l.splice(c,1),d&&(c<=
h&&h--,c<=f&&f--)});return this},has:function(a){return a?-1<m.inArray(a,l):!(!l||!l.length)},empty:function(){l=[];h=0;return this},disable:function(){l=k=b=void 0;return this},disabled:function(){return!l},lock:function(){k=void 0;b||u.disable();return this},locked:function(){return!k},fireWith:function(a,b){!l||c&&!k||(b=b||[],b=[a,b.slice?b.slice():b],d?k.push(b):n(b));return this},fire:function(){u.fireWith(this,arguments);return this},fired:function(){return!!c}};return u};m.extend({Deferred:function(a){var b=
[["resolve","done",m.Callbacks("once memory"),"resolved"],["reject","fail",m.Callbacks("once memory"),"rejected"],["notify","progress",m.Callbacks("memory")]],c="pending",d={state:function(){return c},always:function(){e.done(arguments).fail(arguments);return this},then:function(){var a=arguments;return m.Deferred(function(c){m.each(b,function(b,h){var f=m.isFunction(a[b])&&a[b];e[h[1]](function(){var a=f&&f.apply(this,arguments);if(a&&m.isFunction(a.promise))a.promise().done(c.resolve).fail(c.reject).progress(c.notify);
else c[h[0]+"With"](this===d?c.promise():this,f?[a]:arguments)})});a=null}).promise()},promise:function(a){return null!=a?m.extend(a,d):d}},e={};d.pipe=d.then;m.each(b,function(a,h){var f=h[2],F=h[3];d[h[1]]=f.add;F&&f.add(function(){c=F},b[a^1][2].disable,b[2][2].lock);e[h[0]]=function(){e[h[0]+"With"](this===e?d:this,arguments);return this};e[h[0]+"With"]=f.fireWith});d.promise(e);a&&a.call(e,e);return e},when:function(a){var b=0,c=Y.call(arguments),d=c.length,e=1!==d||a&&m.isFunction(a.promise)?
d:0,h=1===e?a:m.Deferred(),f=function(a,b,c){return function(d){b[a]=this;c[a]=1<arguments.length?Y.call(arguments):d;c===g?h.notifyWith(b,c):--e||h.resolveWith(b,c)}},g,l,k;if(1<d)for(g=Array(d),l=Array(d),k=Array(d);b<d;b++)c[b]&&m.isFunction(c[b].promise)?c[b].promise().done(f(b,k,c)).fail(h.reject).progress(f(b,l,g)):--e;e||h.resolveWith(k,c);return h.promise()}});var Ua;m.fn.ready=function(a){m.ready.promise().done(a);return this};m.extend({isReady:!1,readyWait:1,holdReady:function(a){a?m.readyWait++:
m.ready(!0)},ready:function(a){(!0===a?--m.readyWait:m.isReady)||(m.isReady=!0,!0!==a&&0<--m.readyWait||(Ua.resolveWith(Q,[m]),m.fn.triggerHandler&&(m(Q).triggerHandler("ready"),m(Q).off("ready"))))}});m.ready.promise=function(a){Ua||(Ua=m.Deferred(),"complete"===Q.readyState?setTimeout(m.ready):(Q.addEventListener("DOMContentLoaded",d,!1),c.addEventListener("load",d,!1)));return Ua.promise(a)};m.ready.promise();var ya=m.access=function(a,b,c,d,e,h,f){var g=0,l=a.length,k=null==c;if("object"===m.type(c))for(g in e=
!0,c)m.access(a,b,g,c[g],!0,h,f);else if(void 0!==d&&(e=!0,m.isFunction(d)||(f=!0),k&&(f?(b.call(a,d),b=null):(k=b,b=function(a,b,c){return k.call(m(a),c)})),b))for(;g<l;g++)b(a[g],c,f?d:d.call(a[g],g,b(a[g],c)));return e?a:k?b.call(a):l?b(a[0],c):h};m.acceptData=function(a){return 1===a.nodeType||9===a.nodeType||!+a.nodeType};n.uid=1;n.accepts=m.acceptData;n.prototype={key:function(a){if(!n.accepts(a))return 0;var b={},c=a[this.expando];if(!c){c=n.uid++;try{b[this.expando]={value:c},Object.defineProperties(a,
b)}catch(d){b[this.expando]=c,m.extend(a,b)}}this.cache[c]||(this.cache[c]={});return c},set:function(a,b,c){var d;a=this.key(a);var e=this.cache[a];if("string"===typeof b)e[b]=c;else if(m.isEmptyObject(e))m.extend(this.cache[a],b);else for(d in b)e[d]=b[d];return e},get:function(a,b){var c=this.cache[this.key(a)];return void 0===b?c:c[b]},access:function(a,b,c){if(void 0===b||b&&"string"===typeof b&&void 0===c)return c=this.get(a,b),void 0!==c?c:this.get(a,m.camelCase(b));this.set(a,b,c);return void 0!==
c?c:b},remove:function(a,b){var c,d;c=this.key(a);var e=this.cache[c];if(void 0===b)this.cache[c]={};else for(m.isArray(b)?d=b.concat(b.map(m.camelCase)):(c=m.camelCase(b),b in e?d=[b,c]:(d=c,d=d in e?[d]:d.match(ta)||[])),c=d.length;c--;)delete e[d[c]]},hasData:function(a){return!m.isEmptyObject(this.cache[a[this.expando]]||{})},discard:function(a){a[this.expando]&&delete this.cache[a[this.expando]]}};var N=new n,V=new n,Ab=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Oa=/([A-Z])/g;m.extend({hasData:function(a){return V.hasData(a)||
N.hasData(a)},data:function(a,b,c){return V.access(a,b,c)},removeData:function(a,b){V.remove(a,b)},_data:function(a,b,c){return N.access(a,b,c)},_removeData:function(a,b){N.remove(a,b)}});m.fn.extend({data:function(a,b){var c,d,e,h=this[0],g=h&&h.attributes;if(void 0===a){if(this.length&&(e=V.get(h),1===h.nodeType&&!N.get(h,"hasDataAttrs"))){for(c=g.length;c--;)g[c]&&(d=g[c].name,0===d.indexOf("data-")&&(d=m.camelCase(d.slice(5)),f(h,d,e[d])));N.set(h,"hasDataAttrs",!0)}return e}return"object"===
typeof a?this.each(function(){V.set(this,a)}):ya(this,function(b){var c,d=m.camelCase(a);if(h&&void 0===b){c=V.get(h,a);if(void 0!==c)return c;c=V.get(h,d);if(void 0!==c)return c;c=f(h,d,void 0);if(void 0!==c)return c}else this.each(function(){var c=V.get(this,d);V.set(this,d,b);-1!==a.indexOf("-")&&void 0!==c&&V.set(this,a,b)})},null,b,1<arguments.length,null,!0)},removeData:function(a){return this.each(function(){V.remove(this,a)})}});m.extend({queue:function(a,b,c){var d;if(a)return b=(b||"fx")+
"queue",d=N.get(a,b),c&&(!d||m.isArray(c)?d=N.access(a,b,m.makeArray(c)):d.push(c)),d||[]},dequeue:function(a,b){b=b||"fx";var c=m.queue(a,b),d=c.length,e=c.shift(),h=m._queueHooks(a,b),f=function(){m.dequeue(a,b)};"inprogress"===e&&(e=c.shift(),d--);e&&("fx"===b&&c.unshift("inprogress"),delete h.stop,e.call(a,f,h));!d&&h&&h.empty.fire()},_queueHooks:function(a,b){var c=b+"queueHooks";return N.get(a,c)||N.access(a,c,{empty:m.Callbacks("once memory").add(function(){N.remove(a,[b+"queue",c])})})}});
m.fn.extend({queue:function(a,b){var c=2;"string"!==typeof a&&(b=a,a="fx",c--);return arguments.length<c?m.queue(this[0],a):void 0===b?this:this.each(function(){var c=m.queue(this,a,b);m._queueHooks(this,a);"fx"===a&&"inprogress"!==c[0]&&m.dequeue(this,a)})},dequeue:function(a){return this.each(function(){m.dequeue(this,a)})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,b){var c,d=1,e=m.Deferred(),h=this,f=this.length,g=function(){--d||e.resolveWith(h,[h])};"string"!==
typeof a&&(b=a,a=void 0);for(a=a||"fx";f--;)(c=N.get(h[f],a+"queueHooks"))&&c.empty&&(d++,c.empty.add(g));g();return e.promise(b)}});var ha=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,za=["Top","Right","Bottom","Left"],Da=function(a,b){a=b||a;return"none"===m.css(a,"display")||!m.contains(a.ownerDocument,a)},ob=/^(?:checkbox|radio)$/i;(function(){var a=Q.createDocumentFragment().appendChild(Q.createElement("div")),b=Q.createElement("input");b.setAttribute("type","radio");b.setAttribute("checked",
"checked");b.setAttribute("name","t");a.appendChild(b);X.checkClone=a.cloneNode(!0).cloneNode(!0).lastChild.checked;a.innerHTML="<textarea>x</textarea>";X.noCloneChecked=!!a.cloneNode(!0).lastChild.defaultValue})();X.focusinBubbles="onfocusin"in c;var Fb=/^key/,Gb=/^(?:mouse|pointer|contextmenu)|click/,pb=/^(?:focusinfocus|focusoutblur)$/,R=/^([^.]*)(?:\.(.+)|)$/;m.event={global:{},add:function(a,b,c,d,e){var h,f,g,l,k,u,v,H,L;if(k=N.get(a))for(c.handler&&(h=c,c=h.handler,e=h.selector),c.guid||(c.guid=
m.guid++),(l=k.events)||(l=k.events={}),(f=k.handle)||(f=k.handle=function(b){return"undefined"!==typeof m&&m.event.triggered!==b.type?m.event.dispatch.apply(a,arguments):void 0}),b=(b||"").match(ta)||[""],k=b.length;k--;)g=R.exec(b[k])||[],H=u=g[1],L=(g[2]||"").split(".").sort(),H&&(g=m.event.special[H]||{},H=(e?g.delegateType:g.bindType)||H,g=m.event.special[H]||{},u=m.extend({type:H,origType:u,data:d,handler:c,guid:c.guid,selector:e,needsContext:e&&m.expr.match.needsContext.test(e),namespace:L.join(".")},
h),(v=l[H])||(v=l[H]=[],v.delegateCount=0,g.setup&&!1!==g.setup.call(a,d,L,f)||a.addEventListener&&a.addEventListener(H,f,!1)),g.add&&(g.add.call(a,u),u.handler.guid||(u.handler.guid=c.guid)),e?v.splice(v.delegateCount++,0,u):v.push(u),m.event.global[H]=!0)},remove:function(a,b,c,d,e){var h,f,g,l,k,u,v,H,L,n,q,y=N.hasData(a)&&N.get(a);if(y&&(l=y.events)){b=(b||"").match(ta)||[""];for(k=b.length;k--;)if(g=R.exec(b[k])||[],L=q=g[1],n=(g[2]||"").split(".").sort(),L){v=m.event.special[L]||{};L=(d?v.delegateType:
v.bindType)||L;H=l[L]||[];g=g[2]&&new RegExp("(^|\\.)"+n.join("\\.(?:.*\\.|)")+"(\\.|$)");for(f=h=H.length;h--;)u=H[h],!e&&q!==u.origType||c&&c.guid!==u.guid||g&&!g.test(u.namespace)||d&&d!==u.selector&&("**"!==d||!u.selector)||(H.splice(h,1),u.selector&&H.delegateCount--,v.remove&&v.remove.call(a,u));f&&!H.length&&(v.teardown&&!1!==v.teardown.call(a,n,y.handle)||m.removeEvent(a,L,y.handle),delete l[L])}else for(L in l)m.event.remove(a,L+b[k],c,d,!0);m.isEmptyObject(l)&&(delete y.handle,N.remove(a,
"events"))}},trigger:function(a,b,d,e){var h,f,g,l,k,n,u=[d||Q],v=wa.call(a,"type")?a.type:a;n=wa.call(a,"namespace")?a.namespace.split("."):[];f=h=d=d||Q;if(3!==d.nodeType&&8!==d.nodeType&&!pb.test(v+m.event.triggered)&&(0<=v.indexOf(".")&&(n=v.split("."),v=n.shift(),n.sort()),l=0>v.indexOf(":")&&"on"+v,a=a[m.expando]?a:new m.Event(v,"object"===typeof a&&a),a.isTrigger=e?2:3,a.namespace=n.join("."),a.namespace_re=a.namespace?new RegExp("(^|\\.)"+n.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,a.result=void 0,
a.target||(a.target=d),b=null==b?[a]:m.makeArray(b,[a]),n=m.event.special[v]||{},e||!n.trigger||!1!==n.trigger.apply(d,b))){if(!e&&!n.noBubble&&!m.isWindow(d)){g=n.delegateType||v;pb.test(g+v)||(f=f.parentNode);for(;f;f=f.parentNode)u.push(f),h=f;h===(d.ownerDocument||Q)&&u.push(h.defaultView||h.parentWindow||c)}for(h=0;(f=u[h++])&&!a.isPropagationStopped();)a.type=1<h?g:n.bindType||v,(k=(N.get(f,"events")||{})[a.type]&&N.get(f,"handle"))&&k.apply(f,b),(k=l&&f[l])&&k.apply&&m.acceptData(f)&&(a.result=
k.apply(f,b),!1===a.result&&a.preventDefault());a.type=v;e||a.isDefaultPrevented()||n._default&&!1!==n._default.apply(u.pop(),b)||!m.acceptData(d)||!l||!m.isFunction(d[v])||m.isWindow(d)||((h=d[l])&&(d[l]=null),m.event.triggered=v,d[v](),m.event.triggered=void 0,h&&(d[l]=h));return a.result}},dispatch:function(a){a=m.event.fix(a);var b,c,d,e,h=[],f=Y.call(arguments);b=(N.get(this,"events")||{})[a.type]||[];var g=m.event.special[a.type]||{};f[0]=a;a.delegateTarget=this;if(!g.preDispatch||!1!==g.preDispatch.call(this,
a)){h=m.event.handlers.call(this,a,b);for(b=0;(e=h[b++])&&!a.isPropagationStopped();)for(a.currentTarget=e.elem,c=0;(d=e.handlers[c++])&&!a.isImmediatePropagationStopped();)if(!a.namespace_re||a.namespace_re.test(d.namespace))a.handleObj=d,a.data=d.data,d=((m.event.special[d.origType]||{}).handle||d.handler).apply(e.elem,f),void 0!==d&&!1===(a.result=d)&&(a.preventDefault(),a.stopPropagation());g.postDispatch&&g.postDispatch.call(this,a);return a.result}},handlers:function(a,b){var c,d,e,h,f=[],g=
b.delegateCount,l=a.target;if(g&&l.nodeType&&(!a.button||"click"!==a.type))for(;l!==this;l=l.parentNode||this)if(!0!==l.disabled||"click"!==a.type){d=[];for(c=0;c<g;c++)h=b[c],e=h.selector+" ",void 0===d[e]&&(d[e]=h.needsContext?0<=m(e,this).index(l):m.find(e,this,null,[l]).length),d[e]&&d.push(h);d.length&&f.push({elem:l,handlers:d})}g<b.length&&f.push({elem:this,handlers:b.slice(g)});return f},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),
fixHooks:{},keyHooks:{props:["char","charCode","key","keyCode"],filter:function(a,b){null==a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode);return a}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,b){var c,d,e=b.button;null==a.pageX&&null!=b.clientX&&(c=a.target.ownerDocument||Q,d=c.documentElement,c=c.body,a.pageX=b.clientX+(d&&d.scrollLeft||c&&c.scrollLeft||0)-(d&&d.clientLeft||c&&c.clientLeft||0),a.pageY=
b.clientY+(d&&d.scrollTop||c&&c.scrollTop||0)-(d&&d.clientTop||c&&c.clientTop||0));a.which||void 0===e||(a.which=e&1?1:e&2?3:e&4?2:0);return a}},fix:function(a){if(a[m.expando])return a;var b,c,d;b=a.type;var e=a,h=this.fixHooks[b];h||(this.fixHooks[b]=h=Gb.test(b)?this.mouseHooks:Fb.test(b)?this.keyHooks:{});d=h.props?this.props.concat(h.props):this.props;a=new m.Event(e);for(b=d.length;b--;)c=d[b],a[c]=e[c];a.target||(a.target=Q);3===a.target.nodeType&&(a.target=a.target.parentNode);return h.filter?
h.filter(a,e):a},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==e()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===e()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&m.nodeName(this,"input"))return this.click(),!1},_default:function(a){return m.nodeName(a.target,"a")}},beforeunload:{postDispatch:function(a){void 0!==a.result&&a.originalEvent&&(a.originalEvent.returnValue=
a.result)}}},simulate:function(a,b,c,d){a=m.extend(new m.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?m.event.trigger(a,null,b):m.event.dispatch.call(b,a);a.isDefaultPrevented()&&c.preventDefault()}};m.removeEvent=function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)};m.Event=function(a,b){if(!(this instanceof m.Event))return new m.Event(a,b);a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&!1===a.returnValue?
r:l):this.type=a;b&&m.extend(this,b);this.timeStamp=a&&a.timeStamp||m.now();this[m.expando]=!0};m.Event.prototype={isDefaultPrevented:l,isPropagationStopped:l,isImmediatePropagationStopped:l,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=r;a&&a.preventDefault&&a.preventDefault()},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=r;a&&a.stopPropagation&&a.stopPropagation()},stopImmediatePropagation:function(){var a=this.originalEvent;this.isImmediatePropagationStopped=
r;a&&a.stopImmediatePropagation&&a.stopImmediatePropagation();this.stopPropagation()}};m.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(a,b){m.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=a.relatedTarget,e=a.handleObj;if(!d||d!==this&&!m.contains(this,d))a.type=e.origType,c=e.handler.apply(this,arguments),a.type=b;return c}}});X.focusinBubbles||m.each({focus:"focusin",blur:"focusout"},function(a,b){var c=
function(a){m.event.simulate(b,a.target,m.event.fix(a),!0)};m.event.special[b]={setup:function(){var d=this.ownerDocument||this,e=N.access(d,b);e||d.addEventListener(a,c,!0);N.access(d,b,(e||0)+1)},teardown:function(){var d=this.ownerDocument||this,e=N.access(d,b)-1;e?N.access(d,b,e):(d.removeEventListener(a,c,!0),N.remove(d,b))}}});m.fn.extend({on:function(a,b,c,d,e){var h,f;if("object"===typeof a){"string"!==typeof b&&(c=c||b,b=void 0);for(f in a)this.on(f,b,c,a[f],e);return this}null==c&&null==
d?(d=b,c=b=void 0):null==d&&("string"===typeof b?(d=c,c=void 0):(d=c,c=b,b=void 0));if(!1===d)d=l;else if(!d)return this;1===e&&(h=d,d=function(a){m().off(a);return h.apply(this,arguments)},d.guid=h.guid||(h.guid=m.guid++));return this.each(function(){m.event.add(this,a,d,c,b)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,b,c){var d;if(a&&a.preventDefault&&a.handleObj)return d=a.handleObj,m(a.delegateTarget).off(d.namespace?d.origType+"."+d.namespace:d.origType,d.selector,d.handler),
this;if("object"===typeof a){for(d in a)this.off(d,b,a[d]);return this}if(!1===b||"function"===typeof b)c=b,b=void 0;!1===c&&(c=l);return this.each(function(){m.event.remove(this,a,c,b)})},trigger:function(a,b){return this.each(function(){m.event.trigger(a,b,this)})},triggerHandler:function(a,b){var c=this[0];if(c)return m.event.trigger(a,b,c,!0)}});var qb=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Ia=/<([\w:]+)/,Hb=/<|&#?\w+;/,Ib=/<(?:script|style|link)/i,rb=/checked\s*(?:[^=]|=\s*.checked.)/i,
eb=/^$|\/(?:java|ecma)script/i,$a=/^true\/(.*)/,Jb=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,ma={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};ma.optgroup=ma.option;ma.tbody=ma.tfoot=ma.colgroup=ma.caption=ma.thead;ma.th=ma.td;m.extend({clone:function(a,b,c){var d,e,h,f,g=a.cloneNode(!0),l=m.contains(a.ownerDocument,
a);if(!(X.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||m.isXMLDoc(a)))for(f=A(g),h=A(a),d=0,e=h.length;d<e;d++){var k=h[d],u=f[d],v=u.nodeName.toLowerCase();if("input"===v&&ob.test(k.type))u.checked=k.checked;else if("input"===v||"textarea"===v)u.defaultValue=k.defaultValue}if(b)if(c)for(h=h||A(a),f=f||A(g),d=0,e=h.length;d<e;d++)G(h[d],f[d]);else G(a,g);f=A(g,"script");0<f.length&&x(f,!l&&A(a,"script"));return g},buildFragment:function(a,b,c,d){for(var e,h,f,g=b.createDocumentFragment(),l=[],
k=0,u=a.length;k<u;k++)if((e=a[k])||0===e)if("object"===m.type(e))m.merge(l,e.nodeType?[e]:e);else if(Hb.test(e)){h=h||g.appendChild(b.createElement("div"));f=(Ia.exec(e)||["",""])[1].toLowerCase();f=ma[f]||ma._default;h.innerHTML=f[1]+e.replace(qb,"<$1></$2>")+f[2];for(f=f[0];f--;)h=h.lastChild;m.merge(l,h.childNodes);h=g.firstChild;h.textContent=""}else l.push(b.createTextNode(e));g.textContent="";for(k=0;e=l[k++];)if(!d||-1===m.inArray(e,d))if(a=m.contains(e.ownerDocument,e),h=A(g.appendChild(e),
"script"),a&&x(h),c)for(f=0;e=h[f++];)eb.test(e.type||"")&&c.push(e);return g},cleanData:function(a){for(var b,c,d,e,h=m.event.special,f=0;void 0!==(c=a[f]);f++){if(m.acceptData(c)&&(e=c[N.expando])&&(b=N.cache[e])){if(b.events)for(d in b.events)h[d]?m.event.remove(c,d):m.removeEvent(c,d,b.handle);N.cache[e]&&delete N.cache[e]}delete V.cache[c[V.expando]]}}});m.fn.extend({text:function(a){return ya(this,function(a){return void 0===a?m.text(this):this.empty().each(function(){if(1===this.nodeType||
11===this.nodeType||9===this.nodeType)this.textContent=a})},null,a,arguments.length)},append:function(){return this.domManip(arguments,function(a){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||t(this,a).appendChild(a)})},prepend:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=t(this,a);b.insertBefore(a,b.firstChild)}})},before:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,
this)})},after:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)})},remove:function(a,b){for(var c,d=a?m.filter(a,this):this,e=0;null!=(c=d[e]);e++)b||1!==c.nodeType||m.cleanData(A(c)),c.parentNode&&(b&&m.contains(c.ownerDocument,c)&&x(A(c,"script")),c.parentNode.removeChild(c));return this},empty:function(){for(var a,b=0;null!=(a=this[b]);b++)1===a.nodeType&&(m.cleanData(A(a,!1)),a.textContent="");return this},clone:function(a,
b){a=null==a?!1:a;b=null==b?a:b;return this.map(function(){return m.clone(this,a,b)})},html:function(a){return ya(this,function(a){var b=this[0]||{},c=0,d=this.length;if(void 0===a&&1===b.nodeType)return b.innerHTML;if("string"===typeof a&&!Ib.test(a)&&!ma[(Ia.exec(a)||["",""])[1].toLowerCase()]){a=a.replace(qb,"<$1></$2>");try{for(;c<d;c++)b=this[c]||{},1===b.nodeType&&(m.cleanData(A(b,!1)),b.innerHTML=a);b=0}catch(e){}}b&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(){var a=
arguments[0];this.domManip(arguments,function(b){a=this.parentNode;m.cleanData(A(this));a&&a.replaceChild(b,this)});return a&&(a.length||a.nodeType)?this:this.remove()},detach:function(a){return this.remove(a,!0)},domManip:function(a,b){a=ua.apply([],a);var c,d,e,h,f=0,g=this.length,l=this,k=g-1,u=a[0],v=m.isFunction(u);if(v||1<g&&"string"===typeof u&&!X.checkClone&&rb.test(u))return this.each(function(c){var d=l.eq(c);v&&(a[0]=u.call(this,c,d.html()));d.domManip(a,b)});if(g&&(c=m.buildFragment(a,
this[0].ownerDocument,!1,this),d=c.firstChild,1===c.childNodes.length&&(c=d),d)){d=m.map(A(c,"script"),q);for(e=d.length;f<g;f++)h=c,f!==k&&(h=m.clone(h,!0,!0),e&&m.merge(d,A(h,"script"))),b.call(this[f],h,f);if(e)for(c=d[d.length-1].ownerDocument,m.map(d,B),f=0;f<e;f++)h=d[f],eb.test(h.type||"")&&!N.access(h,"globalEval")&&m.contains(c,h)&&(h.src?m._evalUrl&&m._evalUrl(h.src):m.globalEval(h.textContent.replace(Jb,"")))}return this}});m.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",
insertAfter:"after",replaceAll:"replaceWith"},function(a,b){m.fn[a]=function(a){for(var c=[],d=m(a),e=d.length-1,h=0;h<=e;h++)a=h===e?this:this.clone(!0),m(d[h])[b](a),va.apply(c,a.get());return this.pushStack(c)}});var Qa,Pa={},Ga=/^margin/,qa=new RegExp("^("+ha+")(?!px)[a-z%]+$","i"),Ra=function(a){return a.ownerDocument.defaultView.getComputedStyle(a,null)};(function(){function a(){f.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute";
f.innerHTML="";e.appendChild(h);var g=c.getComputedStyle(f,null);b="1%"!==g.top;d="4px"===g.width;e.removeChild(h)}var b,d,e=Q.documentElement,h=Q.createElement("div"),f=Q.createElement("div");f.style&&(f.style.backgroundClip="content-box",f.cloneNode(!0).style.backgroundClip="",X.clearCloneStyle="content-box"===f.style.backgroundClip,h.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",h.appendChild(f),c.getComputedStyle&&m.extend(X,{pixelPosition:function(){a();
return b},boxSizingReliable:function(){null==d&&a();return d},reliableMarginRight:function(){var a;a=f.appendChild(Q.createElement("div"));a.style.cssText=f.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0";a.style.marginRight=a.style.width="0";f.style.width="1px";e.appendChild(h);a=!parseFloat(c.getComputedStyle(a,null).marginRight);e.removeChild(h);return a}}))})();m.swap=function(a,b,c,d){var e,h={};for(e in b)h[e]=
a.style[e],a.style[e]=b[e];c=c.apply(a,d||[]);for(e in b)a.style[e]=h[e];return c};var sb=/^(none|table(?!-c[ea]).+)/,pa=new RegExp("^("+ha+")(.*)$","i"),ea=new RegExp("^([+-])=("+ha+")","i"),tb={position:"absolute",visibility:"hidden",display:"block"},fb={letterSpacing:"0",fontWeight:"400"},ja=["Webkit","O","Moz","ms"];m.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=h(a,"opacity");return""===c?"1":c}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,
opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(a,b,c,d){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var e,h,f,g=m.camelCase(b),l=a.style;b=m.cssProps[g]||(m.cssProps[g]=w(l,g));f=m.cssHooks[b]||m.cssHooks[g];if(void 0!==c)h=typeof c,"string"===h&&(e=ea.exec(c))&&(c=(e[1]+1)*e[2]+parseFloat(m.css(a,b)),h="number"),null!=c&&c===c&&("number"!==h||m.cssNumber[g]||(c+="px"),X.clearCloneStyle||""!==c||0!==b.indexOf("background")||(l[b]="inherit"),
f&&"set"in f&&void 0===(c=f.set(a,c,d))||(l[b]=c));else return f&&"get"in f&&void 0!==(e=f.get(a,!1,d))?e:l[b]}},css:function(a,b,c,d){var e,f;f=m.camelCase(b);b=m.cssProps[f]||(m.cssProps[f]=w(a.style,f));(f=m.cssHooks[b]||m.cssHooks[f])&&"get"in f&&(e=f.get(a,!0,c));void 0===e&&(e=h(a,b,d));"normal"===e&&b in fb&&(e=fb[b]);return""===c||c?(a=parseFloat(e),!0===c||m.isNumeric(a)?a||0:e):e}});m.each(["height","width"],function(a,b){m.cssHooks[b]={get:function(a,c,d){if(c)return sb.test(m.css(a,"display"))&&
0===a.offsetWidth?m.swap(a,tb,function(){return S(a,b,d)}):S(a,b,d)},set:function(a,c,d){var e=d&&Ra(a);return z(a,c,d?y(a,b,d,"border-box"===m.css(a,"boxSizing",!1,e),e):0)}}});m.cssHooks.marginRight=C(X.reliableMarginRight,function(a,b){if(b)return m.swap(a,{display:"inline-block"},h,[a,"marginRight"])});m.each({margin:"",padding:"",border:"Width"},function(a,b){m.cssHooks[a+b]={expand:function(c){var d=0,e={};for(c="string"===typeof c?c.split(" "):[c];4>d;d++)e[a+za[d]+b]=c[d]||c[d-2]||c[0];return e}};
Ga.test(a)||(m.cssHooks[a+b].set=z)});m.fn.extend({css:function(a,b){return ya(this,function(a,b,c){var d,e={},h=0;if(m.isArray(b)){c=Ra(a);for(d=b.length;h<d;h++)e[b[h]]=m.css(a,b[h],!1,c);return e}return void 0!==c?m.style(a,b,c):m.css(a,b)},a,b,1<arguments.length)},show:function(){return P(this,!0)},hide:function(){return P(this)},toggle:function(a){return"boolean"===typeof a?a?this.show():this.hide():this.each(function(){Da(this)?m(this).show():m(this).hide()})}});m.Tween=J;J.prototype={constructor:J,
init:function(a,b,c,d,e,h){this.elem=a;this.prop=c;this.easing=e||"swing";this.options=b;this.start=this.now=this.cur();this.end=d;this.unit=h||(m.cssNumber[c]?"":"px")},cur:function(){var a=J.propHooks[this.prop];return a&&a.get?a.get(this):J.propHooks._default.get(this)},run:function(a){var b,c=J.propHooks[this.prop];this.pos=this.options.duration?b=m.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):b=a;this.now=(this.end-this.start)*b+this.start;this.options.step&&this.options.step.call(this.elem,
this.now,this);c&&c.set?c.set(this):J.propHooks._default.set(this);return this}};J.prototype.init.prototype=J.prototype;J.propHooks={_default:{get:function(a){return null==a.elem[a.prop]||a.elem.style&&null!=a.elem.style[a.prop]?(a=m.css(a.elem,a.prop,""))&&"auto"!==a?a:0:a.elem[a.prop]},set:function(a){if(m.fx.step[a.prop])m.fx.step[a.prop](a);else a.elem.style&&(null!=a.elem.style[m.cssProps[a.prop]]||m.cssHooks[a.prop])?m.style(a.elem,a.prop,a.now+a.unit):a.elem[a.prop]=a.now}}};J.propHooks.scrollTop=
J.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}};m.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2}};m.fx=J.prototype.init;m.fx.step={};var Ea,Va,Kb=/^(?:toggle|show|hide)$/,D=new RegExp("^(?:([+-])=|)("+ha+")([a-z%]*)$","i"),la=/queueHooks$/,T=[function(a,b,c){var d,e,h,f,g,l,k=this,u={},v=a.style,H=a.nodeType&&Da(a),L=N.get(a,"fxshow");c.queue||(f=m._queueHooks(a,"fx"),null==f.unqueued&&(f.unqueued=0,g=f.empty.fire,
f.empty.fire=function(){f.unqueued||g()}),f.unqueued++,k.always(function(){k.always(function(){f.unqueued--;m.queue(a,"fx").length||f.empty.fire()})}));1===a.nodeType&&("height"in b||"width"in b)&&(c.overflow=[v.overflow,v.overflowX,v.overflowY],l=m.css(a,"display"),e="none"===l?N.get(a,"olddisplay")||I(a.nodeName):l,"inline"===e&&"none"===m.css(a,"float")&&(v.display="inline-block"));c.overflow&&(v.overflow="hidden",k.always(function(){v.overflow=c.overflow[0];v.overflowX=c.overflow[1];v.overflowY=
c.overflow[2]}));for(d in b)if(e=b[d],Kb.exec(e)){delete b[d];h=h||"toggle"===e;if(e===(H?"hide":"show"))if("show"===e&&L&&void 0!==L[d])H=!0;else continue;u[d]=L&&L[d]||m.style(a,d)}else l=void 0;if(m.isEmptyObject(u))"inline"===("none"===l?I(a.nodeName):l)&&(v.display=l);else for(d in L?"hidden"in L&&(H=L.hidden):L=N.access(a,"fxshow",{}),h&&(L.hidden=!H),H?m(a).show():k.done(function(){m(a).hide()}),k.done(function(){var b;N.remove(a,"fxshow");for(b in u)m.style(a,b,u[b])}),u)b=U(H?L[d]:0,d,k),
d in L||(L[d]=b.start,H&&(b.end=b.start,b.start="width"===d||"height"===d?1:0))}],K={"*":[function(a,b){var c=this.createTween(a,b),d=c.cur(),e=D.exec(b),h=e&&e[3]||(m.cssNumber[a]?"":"px"),f=(m.cssNumber[a]||"px"!==h&&+d)&&D.exec(m.css(c.elem,a)),g=1,l=20;if(f&&f[3]!==h){h=h||f[3];e=e||[];f=+d||1;do g=g||".5",f/=g,m.style(c.elem,a,f+h);while(g!==(g=c.cur()/d)&&1!==g&&--l)}e&&(f=c.start=+f||+d||0,c.unit=h,c.end=e[1]?f+(e[1]+1)*e[2]:+e[2]);return c}]};m.Animation=m.extend(fa,{tweener:function(a,b){m.isFunction(a)?
(b=a,a=["*"]):a=a.split(" ");for(var c,d=0,e=a.length;d<e;d++)c=a[d],K[c]=K[c]||[],K[c].unshift(b)},prefilter:function(a,b){b?T.unshift(a):T.push(a)}});m.speed=function(a,b,c){var d=a&&"object"===typeof a?m.extend({},a):{complete:c||!c&&b||m.isFunction(a)&&a,duration:a,easing:c&&b||b&&!m.isFunction(b)&&b};d.duration=m.fx.off?0:"number"===typeof d.duration?d.duration:d.duration in m.fx.speeds?m.fx.speeds[d.duration]:m.fx.speeds._default;if(null==d.queue||!0===d.queue)d.queue="fx";d.old=d.complete;
d.complete=function(){m.isFunction(d.old)&&d.old.call(this);d.queue&&m.dequeue(this,d.queue)};return d};m.fn.extend({fadeTo:function(a,b,c,d){return this.filter(Da).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=m.isEmptyObject(a),h=m.speed(b,c,d);b=function(){var b=fa(this,m.extend({},a),h);(e||N.get(this,"finish"))&&b.stop(!0)};b.finish=b;return e||!1===h.queue?this.each(b):this.queue(h.queue,b)},stop:function(a,b,c){var d=function(a){var b=a.stop;delete a.stop;
b(c)};"string"!==typeof a&&(c=b,b=a,a=void 0);b&&!1!==a&&this.queue(a||"fx",[]);return this.each(function(){var b=!0,e=null!=a&&a+"queueHooks",h=m.timers,f=N.get(this);if(e)f[e]&&f[e].stop&&d(f[e]);else for(e in f)f[e]&&f[e].stop&&la.test(e)&&d(f[e]);for(e=h.length;e--;)h[e].elem!==this||null!=a&&h[e].queue!==a||(h[e].anim.stop(c),b=!1,h.splice(e,1));!b&&c||m.dequeue(this,a)})},finish:function(a){!1!==a&&(a=a||"fx");return this.each(function(){var b,c=N.get(this),d=c[a+"queue"];b=c[a+"queueHooks"];
var e=m.timers,h=d?d.length:0;c.finish=!0;m.queue(this,a,[]);b&&b.stop&&b.stop.call(this,!0);for(b=e.length;b--;)e[b].elem===this&&e[b].queue===a&&(e[b].anim.stop(!0),e.splice(b,1));for(b=0;b<h;b++)d[b]&&d[b].finish&&d[b].finish.call(this);delete c.finish})}});m.each(["toggle","show","hide"],function(a,b){var c=m.fn[b];m.fn[b]=function(a,d,e){return null==a||"boolean"===typeof a?c.apply(this,arguments):this.animate(M(b,!0),a,d,e)}});m.each({slideDown:M("show"),slideUp:M("hide"),slideToggle:M("toggle"),
fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){m.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}});m.timers=[];m.fx.tick=function(){var a,b=0,c=m.timers;for(Ea=m.now();b<c.length;b++)a=c[b],a()||c[b]!==a||c.splice(b--,1);c.length||m.fx.stop();Ea=void 0};m.fx.timer=function(a){m.timers.push(a);a()?m.fx.start():m.timers.pop()};m.fx.interval=13;m.fx.start=function(){Va||(Va=setInterval(m.fx.tick,m.fx.interval))};m.fx.stop=function(){clearInterval(Va);
Va=null};m.fx.speeds={slow:600,fast:200,_default:400};m.fn.delay=function(a,b){a=m.fx?m.fx.speeds[a]||a:a;return this.queue(b||"fx",function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})};(function(){var a=Q.createElement("input"),b=Q.createElement("select"),c=b.appendChild(Q.createElement("option"));a.type="checkbox";X.checkOn=""!==a.value;X.optSelected=c.selected;b.disabled=!0;X.optDisabled=!c.disabled;a=Q.createElement("input");a.value="t";a.type="radio";X.radioValue="t"===a.value})();
var aa,Ja=m.expr.attrHandle;m.fn.extend({attr:function(a,b){return ya(this,m.attr,a,b,1<arguments.length)},removeAttr:function(a){return this.each(function(){m.removeAttr(this,a)})}});m.extend({attr:function(a,b,c){var d,e,h=a.nodeType;if(a&&3!==h&&8!==h&&2!==h){if("undefined"===typeof a.getAttribute)return m.prop(a,b,c);1===h&&m.isXMLDoc(a)||(b=b.toLowerCase(),d=m.attrHooks[b]||(m.expr.match.bool.test(b)?aa:void 0));if(void 0!==c)if(null===c)m.removeAttr(a,b);else{if(d&&"set"in d&&void 0!==(e=d.set(a,
c,b)))return e;a.setAttribute(b,c+"");return c}else{if(d&&"get"in d&&null!==(e=d.get(a,b)))return e;e=m.find.attr(a,b);return null==e?void 0:e}}},removeAttr:function(a,b){var c,d,e=0,h=b&&b.match(ta);if(h&&1===a.nodeType)for(;c=h[e++];)d=m.propFix[c]||c,m.expr.match.bool.test(c)&&(a[d]=!1),a.removeAttribute(c)},attrHooks:{type:{set:function(a,b){if(!X.radioValue&&"radio"===b&&m.nodeName(a,"input")){var c=a.value;a.setAttribute("type",b);c&&(a.value=c);return b}}}}});aa={set:function(a,b,c){!1===b?
m.removeAttr(a,c):a.setAttribute(c,c);return c}};m.each(m.expr.match.bool.source.match(/\w+/g),function(a,b){var c=Ja[b]||m.find.attr;Ja[b]=function(a,b,d){var e,h;d||(h=Ja[b],Ja[b]=e,e=null!=c(a,b,d)?b.toLowerCase():null,Ja[b]=h);return e}});var Lb=/^(?:input|select|textarea|button)$/i;m.fn.extend({prop:function(a,b){return ya(this,m.prop,a,b,1<arguments.length)},removeProp:function(a){return this.each(function(){delete this[m.propFix[a]||a]})}});m.extend({propFix:{"for":"htmlFor","class":"className"},
prop:function(a,b,c){var d,e,h;h=a.nodeType;if(a&&3!==h&&8!==h&&2!==h){if(h=1!==h||!m.isXMLDoc(a))b=m.propFix[b]||b,e=m.propHooks[b];return void 0!==c?e&&"set"in e&&void 0!==(d=e.set(a,c,b))?d:a[b]=c:e&&"get"in e&&null!==(d=e.get(a,b))?d:a[b]}},propHooks:{tabIndex:{get:function(a){return a.hasAttribute("tabindex")||Lb.test(a.nodeName)||a.href?a.tabIndex:-1}}}});X.optSelected||(m.propHooks.selected={get:function(a){(a=a.parentNode)&&a.parentNode&&a.parentNode.selectedIndex;return null}});m.each("tabIndex readOnly maxLength cellSpacing cellPadding rowSpan colSpan useMap frameBorder contentEditable".split(" "),
function(){m.propFix[this.toLowerCase()]=this});var Ma=/[\t\r\n\f]/g;m.fn.extend({addClass:function(a){var b,c,d,e,h;b="string"===typeof a&&a;var f=0,g=this.length;if(m.isFunction(a))return this.each(function(b){m(this).addClass(a.call(this,b,this.className))});if(b)for(b=(a||"").match(ta)||[];f<g;f++)if(c=this[f],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(Ma," "):" ")){for(h=0;e=b[h++];)0>d.indexOf(" "+e+" ")&&(d+=e+" ");d=m.trim(d);c.className!==d&&(c.className=d)}return this},
removeClass:function(a){var b,c,d,e,h;b=0===arguments.length||"string"===typeof a&&a;var f=0,g=this.length;if(m.isFunction(a))return this.each(function(b){m(this).removeClass(a.call(this,b,this.className))});if(b)for(b=(a||"").match(ta)||[];f<g;f++)if(c=this[f],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(Ma," "):"")){for(h=0;e=b[h++];)for(;0<=d.indexOf(" "+e+" ");)d=d.replace(" "+e+" "," ");d=a?m.trim(d):"";c.className!==d&&(c.className=d)}return this},toggleClass:function(a,b){var c=
typeof a;return"boolean"===typeof b&&"string"===c?b?this.addClass(a):this.removeClass(a):m.isFunction(a)?this.each(function(c){m(this).toggleClass(a.call(this,c,this.className,b),b)}):this.each(function(){if("string"===c)for(var b,d=0,e=m(this),h=a.match(ta)||[];b=h[d++];)e.hasClass(b)?e.removeClass(b):e.addClass(b);else if("undefined"===c||"boolean"===c)this.className&&N.set(this,"__className__",this.className),this.className=this.className||!1===a?"":N.get(this,"__className__")||""})},hasClass:function(a){a=
" "+a+" ";for(var b=0,c=this.length;b<c;b++)if(1===this[b].nodeType&&0<=(" "+this[b].className+" ").replace(Ma," ").indexOf(a))return!0;return!1}});var Qb=/\r/g;m.fn.extend({val:function(a){var b,c,d,e=this[0];if(arguments.length)return d=m.isFunction(a),this.each(function(c){1===this.nodeType&&(c=d?a.call(this,c,m(this).val()):a,null==c?c="":"number"===typeof c?c+="":m.isArray(c)&&(c=m.map(c,function(a){return null==a?"":a+""})),b=m.valHooks[this.type]||m.valHooks[this.nodeName.toLowerCase()],b&&
"set"in b&&void 0!==b.set(this,c,"value")||(this.value=c))});if(e){if((b=m.valHooks[e.type]||m.valHooks[e.nodeName.toLowerCase()])&&"get"in b&&void 0!==(c=b.get(e,"value")))return c;c=e.value;return"string"===typeof c?c.replace(Qb,""):null==c?"":c}}});m.extend({valHooks:{option:{get:function(a){var b=m.find.attr(a,"value");return null!=b?b:m.trim(m.text(a))}},select:{get:function(a){for(var b,c=a.options,d=a.selectedIndex,e=(a="select-one"===a.type||0>d)?null:[],h=a?d+1:c.length,f=0>d?h:a?d:0;f<h;f++)if(b=
c[f],!(!b.selected&&f!==d||(X.optDisabled?b.disabled:null!==b.getAttribute("disabled"))||b.parentNode.disabled&&m.nodeName(b.parentNode,"optgroup"))){b=m(b).val();if(a)return b;e.push(b)}return e},set:function(a,b){for(var c,d,e=a.options,h=m.makeArray(b),f=e.length;f--;)if(d=e[f],d.selected=0<=m.inArray(d.value,h))c=!0;c||(a.selectedIndex=-1);return h}}}});m.each(["radio","checkbox"],function(){m.valHooks[this]={set:function(a,b){if(m.isArray(b))return a.checked=0<=m.inArray(m(a).val(),b)}};X.checkOn||
(m.valHooks[this].get=function(a){return null===a.getAttribute("value")?"on":a.value})});m.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){m.fn[b]=function(a,c){return 0<arguments.length?this.on(b,null,a,c):this.trigger(b)}});m.fn.extend({hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)},bind:function(a,
b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,"**"):this.off(b,a||"**",c)}});var ub=m.now(),vb=/\?/;m.parseJSON=function(a){return JSON.parse(a+"")};m.parseXML=function(a){var b,c;if(!a||"string"!==typeof a)return null;try{c=new DOMParser,b=c.parseFromString(a,"text/xml")}catch(d){b=void 0}b&&!b.getElementsByTagName("parsererror").length||m.error("Invalid XML: "+
a);return b};var Ca,na,Mb=/#.*$/,wb=/([?&])_=[^&]*/,xb=/^(.*?):[ \t]*([^\r\n]*)$/mg,Nb=/^(?:GET|HEAD)$/,xa=/^\/\//,Na=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,Ka={},ab={},gb="*/".concat("*");try{na=location.href}catch(ia){na=Q.createElement("a"),na.href="",na=na.href}Ca=Na.exec(na.toLowerCase())||[];m.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:na,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Ca[1]),global:!0,processData:!0,async:!0,
contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":gb,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":m.parseJSON,"text xml":m.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,b){return b?Z(Z(a,m.ajaxSettings),b):Z(m.ajaxSettings,
a)},ajaxPrefilter:da(Ka),ajaxTransport:da(ab),ajax:function(a,b){function c(a,b,u,f){var l,w,z,t;t=b;if(2!==C){C=2;g&&clearTimeout(g);d=void 0;h=f||"";r.readyState=0<a?4:0;f=200<=a&&300>a||304===a;if(u){z=v;for(var S=r,p,A,x,ra,B=z.contents,P=z.dataTypes;"*"===P[0];)P.shift(),void 0===p&&(p=z.mimeType||S.getResponseHeader("Content-Type"));if(p)for(A in B)if(B[A]&&B[A].test(p)){P.unshift(A);break}if(P[0]in u)x=P[0];else{for(A in u){if(!P[0]||z.converters[A+" "+P[0]]){x=A;break}ra||(ra=A)}x=x||ra}x?
(x!==P[0]&&P.unshift(x),z=u[x]):z=void 0}a:{u=v;p=z;A=r;x=f;var Db,O,M,S={},B=u.dataTypes.slice();if(B[1])for(O in u.converters)S[O.toLowerCase()]=u.converters[O];for(ra=B.shift();ra;)if(u.responseFields[ra]&&(A[u.responseFields[ra]]=p),!M&&x&&u.dataFilter&&(p=u.dataFilter(p,u.dataType)),M=ra,ra=B.shift())if("*"===ra)ra=M;else if("*"!==M&&M!==ra){O=S[M+" "+ra]||S["* "+ra];if(!O)for(Db in S)if(z=Db.split(" "),z[1]===ra&&(O=S[M+" "+z[0]]||S["* "+z[0]])){!0===O?O=S[Db]:!0!==S[Db]&&(ra=z[0],B.unshift(z[1]));
break}if(!0!==O)if(O&&u["throws"])p=O(p);else try{p=O(p)}catch(E){z={state:"parsererror",error:O?E:"No conversion from "+M+" to "+ra};break a}}z={state:"success",data:p}}if(f)v.ifModified&&((t=r.getResponseHeader("Last-Modified"))&&(m.lastModified[e]=t),(t=r.getResponseHeader("etag"))&&(m.etag[e]=t)),204===a||"HEAD"===v.type?t="nocontent":304===a?t="notmodified":(t=z.state,l=z.data,w=z.error,f=!w);else if(w=t,a||!t)t="error",0>a&&(a=0);r.status=a;r.statusText=(b||t)+"";f?n.resolveWith(H,[l,t,r]):
n.rejectWith(H,[r,t,w]);r.statusCode(y);y=void 0;k&&L.trigger(f?"ajaxSuccess":"ajaxError",[r,v,f?l:w]);q.fireWith(H,[r,t]);k&&(L.trigger("ajaxComplete",[r,v]),--m.active||m.event.trigger("ajaxStop"))}}"object"===typeof a&&(b=a,a=void 0);b=b||{};var d,e,h,f,g,l,k,u,v=m.ajaxSetup({},b),H=v.context||v,L=v.context&&(H.nodeType||H.jquery)?m(H):m.event,n=m.Deferred(),q=m.Callbacks("once memory"),y=v.statusCode||{},w={},z={},C=0,t="canceled",r={readyState:0,getResponseHeader:function(a){var b;if(2===C){if(!f)for(f=
{};b=xb.exec(h);)f[b[1].toLowerCase()]=b[2];b=f[a.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return 2===C?h:null},setRequestHeader:function(a,b){var c=a.toLowerCase();C||(a=z[c]=z[c]||a,w[a]=b);return this},overrideMimeType:function(a){C||(v.mimeType=a);return this},statusCode:function(a){var b;if(a)if(2>C)for(b in a)y[b]=[y[b],a[b]];else r.always(a[r.status]);return this},abort:function(a){a=a||t;d&&d.abort(a);c(0,a);return this}};n.promise(r).complete=q.add;r.success=
r.done;r.error=r.fail;v.url=((a||v.url||na)+"").replace(Mb,"").replace(xa,Ca[1]+"//");v.type=b.method||b.type||v.method||v.type;v.dataTypes=m.trim(v.dataType||"*").toLowerCase().match(ta)||[""];null==v.crossDomain&&(l=Na.exec(v.url.toLowerCase()),v.crossDomain=!(!l||l[1]===Ca[1]&&l[2]===Ca[2]&&(l[3]||("http:"===l[1]?"80":"443"))===(Ca[3]||("http:"===Ca[1]?"80":"443"))));v.data&&v.processData&&"string"!==typeof v.data&&(v.data=m.param(v.data,v.traditional));oa(Ka,v,b,r);if(2===C)return r;(k=v.global)&&
0===m.active++&&m.event.trigger("ajaxStart");v.type=v.type.toUpperCase();v.hasContent=!Nb.test(v.type);e=v.url;v.hasContent||(v.data&&(e=v.url+=(vb.test(e)?"&":"?")+v.data,delete v.data),!1===v.cache&&(v.url=wb.test(e)?e.replace(wb,"$1_="+ub++):e+(vb.test(e)?"&":"?")+"_="+ub++));v.ifModified&&(m.lastModified[e]&&r.setRequestHeader("If-Modified-Since",m.lastModified[e]),m.etag[e]&&r.setRequestHeader("If-None-Match",m.etag[e]));(v.data&&v.hasContent&&!1!==v.contentType||b.contentType)&&r.setRequestHeader("Content-Type",
v.contentType);r.setRequestHeader("Accept",v.dataTypes[0]&&v.accepts[v.dataTypes[0]]?v.accepts[v.dataTypes[0]]+("*"!==v.dataTypes[0]?", "+gb+"; q=0.01":""):v.accepts["*"]);for(u in v.headers)r.setRequestHeader(u,v.headers[u]);if(v.beforeSend&&(!1===v.beforeSend.call(H,r,v)||2===C))return r.abort();t="abort";for(u in{success:1,error:1,complete:1})r[u](v[u]);if(d=oa(ab,v,b,r)){r.readyState=1;k&&L.trigger("ajaxSend",[r,v]);v.async&&0<v.timeout&&(g=setTimeout(function(){r.abort("timeout")},v.timeout));
try{C=1,d.send(w,c)}catch(S){if(2>C)c(-1,S);else throw S;}}else c(-1,"No Transport");return r},getJSON:function(a,b,c){return m.get(a,b,c,"json")},getScript:function(a,b){return m.get(a,void 0,b,"script")}});m.each(["get","post"],function(a,b){m[b]=function(a,c,d,e){m.isFunction(c)&&(e=e||d,d=c,c=void 0);return m.ajax({url:a,type:b,dataType:e,data:c,success:d})}});m.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(a,b){m.fn[b]=function(a){return this.on(b,
a)}});m._evalUrl=function(a){return m.ajax({url:a,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})};m.fn.extend({wrapAll:function(a){var b;if(m.isFunction(a))return this.each(function(b){m(this).wrapAll(a.call(this,b))});this[0]&&(b=m(a,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){for(var a=this;a.firstElementChild;)a=a.firstElementChild;return a}).append(this));return this},wrapInner:function(a){return m.isFunction(a)?this.each(function(b){m(this).wrapInner(a.call(this,
b))}):this.each(function(){var b=m(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=m.isFunction(a);return this.each(function(c){m(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){m.nodeName(this,"body")||m(this).replaceWith(this.childNodes)}).end()}});m.expr.filters.hidden=function(a){return 0>=a.offsetWidth&&0>=a.offsetHeight};m.expr.filters.visible=function(a){return!m.expr.filters.hidden(a)};var Wa=/%20/g,La=/\[\]$/,Xa=
/\r?\n/g,Rb=/^(?:submit|button|image|reset|file)$/i,Sb=/^(?:input|select|textarea|keygen)/i;m.param=function(a,b){var c,d=[],e=function(a,b){b=m.isFunction(b)?b():null==b?"":b;d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};void 0===b&&(b=m.ajaxSettings&&m.ajaxSettings.traditional);if(m.isArray(a)||a.jquery&&!m.isPlainObject(a))m.each(a,function(){e(this.name,this.value)});else for(c in a)W(c,a[c],b,e);return d.join("&").replace(Wa,"+")};m.fn.extend({serialize:function(){return m.param(this.serializeArray())},
serializeArray:function(){return this.map(function(){var a=m.prop(this,"elements");return a?m.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!m(this).is(":disabled")&&Sb.test(this.nodeName)&&!Rb.test(a)&&(this.checked||!ob.test(a))}).map(function(a,b){var c=m(this).val();return null==c?null:m.isArray(c)?m.map(c,function(a){return{name:b.name,value:a.replace(Xa,"\r\n")}}):{name:b.name,value:c.replace(Xa,"\r\n")}}).get()}});m.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(a){}};
var Ob=0,ga={},Tb={0:200,1223:204},Ya=m.ajaxSettings.xhr();if(c.ActiveXObject)m(c).on("unload",function(){for(var a in ga)ga[a]()});X.cors=!!Ya&&"withCredentials"in Ya;X.ajax=Ya=!!Ya;m.ajaxTransport(function(a){var b;if(X.cors||Ya&&!a.crossDomain)return{send:function(c,d){var e,h=a.xhr(),f=++Ob;h.open(a.type,a.url,a.async,a.username,a.password);if(a.xhrFields)for(e in a.xhrFields)h[e]=a.xhrFields[e];a.mimeType&&h.overrideMimeType&&h.overrideMimeType(a.mimeType);a.crossDomain||c["X-Requested-With"]||
(c["X-Requested-With"]="XMLHttpRequest");for(e in c)h.setRequestHeader(e,c[e]);b=function(a){return function(){b&&(delete ga[f],b=h.onload=h.onerror=null,"abort"===a?h.abort():"error"===a?d(h.status,h.statusText):d(Tb[h.status]||h.status,h.statusText,"string"===typeof h.responseText?{text:h.responseText}:void 0,h.getAllResponseHeaders()))}};h.onload=b();h.onerror=b("error");b=ga[f]=b("abort");try{h.send(a.hasContent&&a.data||null)}catch(g){if(b)throw g;}},abort:function(){b&&b()}}});m.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},
contents:{script:/(?:java|ecma)script/},converters:{"text script":function(a){m.globalEval(a);return a}}});m.ajaxPrefilter("script",function(a){void 0===a.cache&&(a.cache=!1);a.crossDomain&&(a.type="GET")});m.ajaxTransport("script",function(a){if(a.crossDomain){var b,c;return{send:function(d,e){b=m("<script>").prop({async:!0,charset:a.scriptCharset,src:a.url}).on("load error",c=function(a){b.remove();c=null;a&&e("error"===a.type?404:200,a.type)});Q.head.appendChild(b[0])},abort:function(){c&&c()}}}});
var yb=[],Za=/(=)\?(?=&|$)|\?\?/;m.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=yb.pop()||m.expando+"_"+ub++;this[a]=!0;return a}});m.ajaxPrefilter("json jsonp",function(a,b,d){var e,h,f,g=!1!==a.jsonp&&(Za.test(a.url)?"url":"string"===typeof a.data&&!(a.contentType||"").indexOf("application/x-www-form-urlencoded")&&Za.test(a.data)&&"data");if(g||"jsonp"===a.dataTypes[0])return e=a.jsonpCallback=m.isFunction(a.jsonpCallback)?a.jsonpCallback():a.jsonpCallback,g?a[g]=a[g].replace(Za,"$1"+
e):!1!==a.jsonp&&(a.url+=(vb.test(a.url)?"&":"?")+a.jsonp+"="+e),a.converters["script json"]=function(){f||m.error(e+" was not called");return f[0]},a.dataTypes[0]="json",h=c[e],c[e]=function(){f=arguments},d.always(function(){c[e]=h;a[e]&&(a.jsonpCallback=b.jsonpCallback,yb.push(e));f&&m.isFunction(h)&&h(f[0]);f=h=void 0}),"script"});m.parseHTML=function(a,b,c){if(!a||"string"!==typeof a)return null;"boolean"===typeof b&&(c=b,b=!1);b=b||Q;var d=nb.exec(a);c=!c&&[];if(d)return[b.createElement(d[1])];
d=m.buildFragment([a],b,c);c&&c.length&&m(c).remove();return m.merge([],d.childNodes)};var hb=m.fn.load;m.fn.load=function(a,b,c){if("string"!==typeof a&&hb)return hb.apply(this,arguments);var d,e,h,f=this,g=a.indexOf(" ");0<=g&&(d=m.trim(a.slice(g)),a=a.slice(0,g));m.isFunction(b)?(c=b,b=void 0):b&&"object"===typeof b&&(e="POST");0<f.length&&m.ajax({url:a,type:e,dataType:"html",data:b}).done(function(a){h=arguments;f.html(d?m("<div>").append(m.parseHTML(a)).find(d):a)}).complete(c&&function(a,b){f.each(c,
h||[a.responseText,b,a])});return this};m.expr.filters.animated=function(a){return m.grep(m.timers,function(b){return a===b.elem}).length};var ib=c.document.documentElement;m.offset={setOffset:function(a,b,c){var d,e,h,f=m.css(a,"position"),g=m(a),l={};"static"===f&&(a.style.position="relative");h=g.offset();e=m.css(a,"top");d=m.css(a,"left");("absolute"===f||"fixed"===f)&&-1<(e+d).indexOf("auto")?(d=g.position(),e=d.top,d=d.left):(e=parseFloat(e)||0,d=parseFloat(d)||0);m.isFunction(b)&&(b=b.call(a,
c,h));null!=b.top&&(l.top=b.top-h.top+e);null!=b.left&&(l.left=b.left-h.left+d);"using"in b?b.using.call(a,l):g.css(l)}};m.fn.extend({offset:function(a){if(arguments.length)return void 0===a?this:this.each(function(b){m.offset.setOffset(this,a,b)});var b,c;c=this[0];var d={top:0,left:0},e=c&&c.ownerDocument;if(e){b=e.documentElement;if(!m.contains(b,c))return d;"undefined"!==typeof c.getBoundingClientRect&&(d=c.getBoundingClientRect());c=ba(e);return{top:d.top+c.pageYOffset-b.clientTop,left:d.left+
c.pageXOffset-b.clientLeft}}},position:function(){if(this[0]){var a,b,c=this[0],d={top:0,left:0};"fixed"===m.css(c,"position")?b=c.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),m.nodeName(a[0],"html")||(d=a.offset()),d.top+=m.css(a[0],"borderTopWidth",!0),d.left+=m.css(a[0],"borderLeftWidth",!0));return{top:b.top-d.top-m.css(c,"marginTop",!0),left:b.left-d.left-m.css(c,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent||ib;a&&!m.nodeName(a,
"html")&&"static"===m.css(a,"position");)a=a.offsetParent;return a||ib})}});m.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,b){var d="pageYOffset"===b;m.fn[a]=function(e){return ya(this,function(a,e,h){var f=ba(a);if(void 0===h)return f?f[b]:a[e];f?f.scrollTo(d?c.pageXOffset:h,d?h:c.pageYOffset):a[e]=h},a,e,arguments.length,null)}});m.each(["top","left"],function(a,b){m.cssHooks[b]=C(X.pixelPosition,function(a,c){if(c)return c=h(a,b),qa.test(c)?m(a).position()[b]+"px":c})});m.each({Height:"height",
Width:"width"},function(a,b){m.each({padding:"inner"+a,content:b,"":"outer"+a},function(c,d){m.fn[d]=function(d,e){var h=arguments.length&&(c||"boolean"!==typeof d),f=c||(!0===d||!0===e?"margin":"border");return ya(this,function(b,c,d){return m.isWindow(b)?b.document.documentElement["client"+a]:9===b.nodeType?(c=b.documentElement,Math.max(b.body["scroll"+a],c["scroll"+a],b.body["offset"+a],c["offset"+a],c["client"+a])):void 0===d?m.css(b,c,f):m.style(b,c,d,f)},b,h?d:void 0,h,null)}})});m.fn.size=
function(){return this.length};m.fn.andSelf=m.fn.addBack;"function"===typeof define&&define.amd&&define("jquery",[],function(){return m});var jb=c.jQuery,Ub=c.$;m.noConflict=function(a){c.$===m&&(c.$=Ub);a&&c.jQuery===m&&(c.jQuery=jb);return m};"undefined"===typeof p&&(c.jQuery=c.$=m);return m});/*
   Copyright 2008-2014 SpryMedia Ltd.

 This source file is free software, available under the following license:
   MIT license - http://datatables.net/license

 This source file is distributed in the hope that it will be useful, but
 WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY
 or FITNESS FOR A PARTICULAR PURPOSE. See the license files for details.

 For details please refer to: http://www.datatables.net
*/
(function(c,p,b){(function(a){"function"===typeof define&&define.amd?define("datatables",["jquery"],a):"object"===typeof exports?a(require("jquery")):jQuery&&!jQuery.fn.dataTable&&a(jQuery)})(function(a){function k(b){var c,d,e={};a.each(b,function(a,h){(c=a.match(/^([^A-Z]+?)([A-Z])/))&&-1!=="a aa ai ao as b fn i m o s ".indexOf(c[1]+" ")&&(d=a.replace(c[0],c[2].toLowerCase()),e[d]=a,"o"===c[1]&&k(b[a]))});b._hungarianMap=e}function g(c,d,e){c._hungarianMap||k(c);var h;a.each(d,function(f,l){h=c._hungarianMap[f];
h===b||!e&&d[h]!==b||("o"===h.charAt(0)?(d[h]||(d[h]={}),a.extend(!0,d[h],d[f]),g(c[h],d[h],e)):d[h]=d[f])})}function d(a){var b=D.defaults.oLanguage,c=a.sZeroRecords;!a.sEmptyTable&&c&&"No data available in table"===b.sEmptyTable&&qa(a,a,"sZeroRecords","sEmptyTable");!a.sLoadingRecords&&c&&"Loading..."===b.sLoadingRecords&&qa(a,a,"sZeroRecords","sLoadingRecords");a.sInfoThousands&&(a.sThousands=a.sInfoThousands);(a=a.sDecimal)&&Va(a)}function n(a){ia(a,"ordering","bSort");ia(a,"orderMulti","bSortMulti");
ia(a,"orderClasses","bSortClasses");ia(a,"orderCellsTop","bSortCellsTop");ia(a,"order","aaSorting");ia(a,"orderFixed","aaSortingFixed");ia(a,"paging","bPaginate");ia(a,"pagingType","sPaginationType");ia(a,"pageLength","iDisplayLength");ia(a,"searching","bFilter");if(a=a.aoSearchCols)for(var b=0,c=a.length;b<c;b++)a[b]&&g(D.models.oSearch,a[b])}function f(a){ia(a,"orderable","bSortable");ia(a,"orderData","aDataSort");ia(a,"orderSequence","asSorting");ia(a,"orderDataType","sortDataType")}function r(b){b=
b.oBrowser;var c=a("<div/>").css({position:"absolute",top:0,left:0,height:1,width:1,overflow:"hidden"}).append(a("<div/>").css({position:"absolute",top:1,left:1,width:100,overflow:"scroll"}).append(a('<div class="test"/>').css({width:"100%",height:10}))).appendTo("body"),d=c.find(".test");b.bScrollOversize=100===d[0].offsetWidth;b.bScrollbarLeft=1!==d.offset().left;c.remove()}function l(a,c,d,e,h,f){var g,l=!1;d!==b&&(g=d,l=!0);for(;e!==h;)a.hasOwnProperty(e)&&(g=l?c(g,a[e],e,a):a[e],l=!0,e+=f);return g}
function e(b,c){var d=D.defaults.column,e=b.aoColumns.length,d=a.extend({},D.models.oColumn,d,{nTh:c?c:p.createElement("th"),sTitle:d.sTitle?d.sTitle:c?c.innerHTML:"",aDataSort:d.aDataSort?d.aDataSort:[e],mData:d.mData?d.mData:e,idx:e});b.aoColumns.push(d);d=b.aoPreSearchCols;d[e]=a.extend({},D.models.oSearch,d[e]);t(b,e,null)}function t(c,d,e){d=c.aoColumns[d];var h=c.oClasses,l=a(d.nTh);if(!d.sWidthOrig){d.sWidthOrig=l.attr("width")||null;var k=(l.attr("style")||"").match(/width:\s*(\d+[pxem%]+)/);
k&&(d.sWidthOrig=k[1])}e!==b&&null!==e&&(f(e),g(D.defaults.column,e),e.mDataProp===b||e.mData||(e.mData=e.mDataProp),e.sType&&(d._sManualType=e.sType),e.className&&!e.sClass&&(e.sClass=e.className),a.extend(d,e),qa(d,e,"sWidth","sWidthOrig"),"number"===typeof e.iDataSort&&(d.aDataSort=[e.iDataSort]),qa(d,e,"aDataSort"));var n=d.mData,m=S(n),q=d.mRender?S(d.mRender):null;e=function(a){return"string"===typeof a&&-1!==a.indexOf("@")};d._bAttrSrc=a.isPlainObject(n)&&(e(n.sort)||e(n.type)||e(n.filter));
d.fnGetData=function(a,c,d){var e=m(a,c,b,d);return q&&c?q(e,c,a,d):e};d.fnSetData=function(a,b,c){return P(n)(a,b,c)};"number"!==typeof n&&(c._rowReadObject=!0);c.oFeatures.bSort||(d.bSortable=!1,l.addClass(h.sSortableNone));c=-1!==a.inArray("asc",d.asSorting);e=-1!==a.inArray("desc",d.asSorting);d.bSortable&&(c||e)?c&&!e?(d.sSortingClass=h.sSortableAsc,d.sSortingClassJUI=h.sSortJUIAscAllowed):!c&&e?(d.sSortingClass=h.sSortableDesc,d.sSortingClassJUI=h.sSortJUIDescAllowed):(d.sSortingClass=h.sSortable,
d.sSortingClassJUI=h.sSortJUI):(d.sSortingClass=h.sSortableNone,d.sSortingClassJUI="")}function q(a){if(!1!==a.oFeatures.bAutoWidth){var b=a.aoColumns;za(a);for(var c=0,d=b.length;c<d;c++)b[c].nTh.style.width=b[c].sWidth}b=a.oScroll;""===b.sY&&""===b.sX||Oa(a);ea(a,null,"column-sizing",[a])}function B(a,b){var c=A(a,"bVisible");return"number"===typeof c[b]?c[b]:null}function x(b,c){var d=A(b,"bVisible"),d=a.inArray(c,d);return-1!==d?d:null}function G(a){return A(a,"bVisible").length}function A(b,
c){var d=[];a.map(b.aoColumns,function(a,b){a[c]&&d.push(b)});return d}function E(a){var c=a.aoColumns,d=a.aoData,e=D.ext.type.detect,h,f,g,l,k,n,m,q,y;h=0;for(f=c.length;h<f;h++)if(m=c[h],y=[],!m.sType&&m._sManualType)m.sType=m._sManualType;else if(!m.sType){g=0;for(l=e.length;g<l;g++){k=0;for(n=d.length;k<n;k++){y[k]===b&&(y[k]=w(a,k,h,"type"));q=e[g](y[k],a);if(!q&&g!==e.length-1)break;if("html"===q)break}if(q){m.sType=q;break}}m.sType||(m.sType="string")}}function I(c,d,h,f){var g,l,k,n,m,q,y=
c.aoColumns;if(d)for(g=d.length-1;0<=g;g--){q=d[g];var w=q.targets!==b?q.targets:q.aTargets;a.isArray(w)||(w=[w]);l=0;for(k=w.length;l<k;l++)if("number"===typeof w[l]&&0<=w[l]){for(;y.length<=w[l];)e(c);f(w[l],q)}else if("number"===typeof w[l]&&0>w[l])f(y.length+w[l],q);else if("string"===typeof w[l])for(n=0,m=y.length;n<m;n++)("_all"==w[l]||a(y[n].nTh).hasClass(w[l]))&&f(n,q)}if(h)for(g=0,c=h.length;g<c;g++)f(g,h[g])}function h(b,c,d,e){var h=b.aoData.length,f=a.extend(!0,{},D.models.oRow,{src:d?
"dom":"data"});f._aData=c;b.aoData.push(f);c=b.aoColumns;for(var f=0,g=c.length;f<g;f++)d&&z(b,h,f,w(b,h,f)),c[f].sType=null;b.aiDisplayMaster.push(h);!d&&b.oFeatures.bDeferRender||fa(b,h,d,e);return h}function C(b,c){var d;c instanceof a||(c=a(c));return c.map(function(a,c){d=ca(b,c);return h(b,d.data,c,d.cells)})}function w(a,c,d,e){var h=a.iDraw,f=a.aoColumns[d],g=a.aoData[c]._aData,l=f.sDefaultContent;d=f.fnGetData(g,e,{settings:a,row:c,col:d});if(d===b)return a.iDrawError!=h&&null===l&&(Ga(a,
0,"Requested unknown parameter "+("function"==typeof f.mData?"{function}":"'"+f.mData+"'")+" for row "+c,4),a.iDrawError=h),l;if((d===g||null===d)&&null!==l)d=l;else if("function"===typeof d)return d.call(g);return null===d&&"display"==e?"":d}function z(a,b,c,d){a.aoColumns[c].fnSetData(a.aoData[b]._aData,d,{settings:a,row:b,col:c})}function y(b){return a.map(b.match(/(\\.|[^\.])+/g),function(a){return a.replace(/\\./g,".")})}function S(c){if(a.isPlainObject(c)){var d={};a.each(c,function(a,b){b&&
(d[a]=S(b))});return function(a,c,e,u){var h=d[c]||d._;return h!==b?h(a,c,e,u):a}}if(null===c)return function(a){return a};if("function"===typeof c)return function(a,b,d,e){return c(a,b,d,e)};if("string"!==typeof c||-1===c.indexOf(".")&&-1===c.indexOf("[")&&-1===c.indexOf("("))return function(a,b){return a[c]};var e=function(a,c,d){var u,h;if(""!==d){h=y(d);for(var f=0,g=h.length;f<g;f++){d=h[f].match(Wa);u=h[f].match(La);if(d){h[f]=h[f].replace(Wa,"");""!==h[f]&&(a=a[h[f]]);u=[];h.splice(0,f+1);
h=h.join(".");f=0;for(g=a.length;f<g;f++)u.push(e(a[f],c,h));a=d[0].substring(1,d[0].length-1);a=""===a?u:u.join(a);break}else if(u){h[f]=h[f].replace(La,"");a=a[h[f]]();continue}if(null===a||a[h[f]]===b)return b;a=a[h[f]]}}return a};return function(a,b){return e(a,b,c)}}function P(c){if(a.isPlainObject(c))return P(c._);if(null===c)return function(){};if("function"===typeof c)return function(a,b,d){c(a,"set",b,d)};if("string"!==typeof c||-1===c.indexOf(".")&&-1===c.indexOf("[")&&-1===c.indexOf("("))return function(a,
b){a[c]=b};var d=function(a,c,e){e=y(e);var u;u=e[e.length-1];for(var h,f,g=0,l=e.length-1;g<l;g++){h=e[g].match(Wa);f=e[g].match(La);if(h){e[g]=e[g].replace(Wa,"");a[e[g]]=[];u=e.slice();u.splice(0,g+1);h=u.join(".");f=0;for(l=c.length;f<l;f++)u={},d(u,c[f],h),a[e[g]].push(u);return}f&&(e[g]=e[g].replace(La,""),a=a[e[g]](c));if(null===a[e[g]]||a[e[g]]===b)a[e[g]]={};a=a[e[g]]}if(u.match(La))a[u.replace(La,"")](c);else a[u.replace(Wa,"")]=c};return function(a,b){return d(a,b,c)}}function J(a){return xa(a.aoData,
"_aData")}function O(a){a.aoData.length=0;a.aiDisplayMaster.length=0;a.aiDisplay.length=0}function M(a,c,d){for(var e=-1,h=0,f=a.length;h<f;h++)a[h]==c?e=h:a[h]>c&&a[h]--; -1!=e&&d===b&&a.splice(e,1)}function U(a,c,d,e){var h=a.aoData[c],f,g=function(b,d){for(;b.childNodes.length;)b.removeChild(b.firstChild);b.innerHTML=w(a,c,d,"display")};if("dom"!==d&&(d&&"auto"!==d||"dom"!==h.src)){var l=h.anCells;if(l)if(e!==b)g(l[e],e);else for(d=0,f=l.length;d<f;d++)g(l[d],d)}else h._aData=ca(a,h,e,e===b?b:
h._aData).data;h._aSortData=null;h._aFilterData=null;g=a.aoColumns;if(e!==b)g[e].sType=null;else{d=0;for(f=g.length;d<f;d++)g[d].sType=null;da(h)}}function ca(c,d,e,h){var f=[],g=d.firstChild,l,k=0,n,m=c.aoColumns,q=c._rowReadObject;h=h||q?{}:[];var y=function(a,b){if("string"===typeof a){var c=a.indexOf("@");-1!==c&&(c=a.substring(c+1),P(a)(h,b.getAttribute(c)))}};c=function(c){if(e===b||e===k)l=m[k],n=a.trim(c.innerHTML),l&&l._bAttrSrc?(P(l.mData._)(h,n),y(l.mData.sort,c),y(l.mData.type,c),y(l.mData.filter,
c)):q?(l._setter||(l._setter=P(l.mData)),l._setter(h,n)):h[k]=n;k++};if(g)for(;g;){d=g.nodeName.toUpperCase();if("TD"==d||"TH"==d)c(g),f.push(g);g=g.nextSibling}else for(f=d.anCells,g=0,d=f.length;g<d;g++)c(f[g]);return{data:h,cells:f}}function fa(a,b,c,d){var e=a.aoData[b],h=e._aData,f=[],g,l,k,n,m;if(null===e.nTr){g=c||p.createElement("tr");e.nTr=g;e.anCells=f;g._DT_RowIndex=b;da(e);n=0;for(m=a.aoColumns.length;n<m;n++){k=a.aoColumns[n];l=c?d[n]:p.createElement(k.sCellType);f.push(l);if(!c||k.mRender||
k.mData!==n)l.innerHTML=w(a,b,n,"display");k.sClass&&(l.className+=" "+k.sClass);k.bVisible&&!c?g.appendChild(l):!k.bVisible&&c&&l.parentNode.removeChild(l);k.fnCreatedCell&&k.fnCreatedCell.call(a.oInstance,l,w(a,b,n),h,b,n)}ea(a,"aoRowCreatedCallback",null,[g,h,b])}e.nTr.setAttribute("role","row")}function da(b){var c=b.nTr,d=b._aData;if(c){d.DT_RowId&&(c.id=d.DT_RowId);if(d.DT_RowClass){var e=d.DT_RowClass.split(" ");b.__rowc=b.__rowc?gb(b.__rowc.concat(e)):e;a(c).removeClass(b.__rowc.join(" ")).addClass(d.DT_RowClass)}d.DT_RowData&&
a(c).data(d.DT_RowData)}}function oa(b){var c,d,e,h,f,g=b.nTHead,l=b.nTFoot,k=0===a("th, td",g).length,n=b.oClasses,m=b.aoColumns;k&&(h=a("<tr/>").appendTo(g));c=0;for(d=m.length;c<d;c++)f=m[c],e=a(f.nTh).addClass(f.sClass),k&&e.appendTo(h),b.oFeatures.bSort&&(e.addClass(f.sSortingClass),!1!==f.bSortable&&(e.attr("tabindex",b.iTabIndex).attr("aria-controls",b.sTableId),eb(b,f.nTh,c))),f.sTitle!=e.html()&&e.html(f.sTitle),fb(b,"header")(b,e,f,n);k&&Y(b.aoHeader,g);a(g).find(">tr").attr("role","row");
a(g).find(">tr>th, >tr>td").addClass(n.sHeaderTH);a(l).find(">tr>th, >tr>td").addClass(n.sFooterTH);if(null!==l)for(b=b.aoFooter[0],c=0,d=b.length;c<d;c++)f=m[c],f.nTf=b[c].cell,f.sClass&&a(f.nTf).addClass(f.sClass)}function Z(c,d,e){var h,f,g,l=[],k=[],n=c.aoColumns.length,m;if(d){e===b&&(e=!1);h=0;for(f=d.length;h<f;h++){l[h]=d[h].slice();l[h].nTr=d[h].nTr;for(g=n-1;0<=g;g--)c.aoColumns[g].bVisible||e||l[h].splice(g,1);k.push([])}h=0;for(f=l.length;h<f;h++){if(c=l[h].nTr)for(;g=c.firstChild;)c.removeChild(g);
g=0;for(d=l[h].length;g<d;g++)if(m=n=1,k[h][g]===b){c.appendChild(l[h][g].cell);for(k[h][g]=1;l[h+n]!==b&&l[h][g].cell==l[h+n][g].cell;)k[h+n][g]=1,n++;for(;l[h][g+m]!==b&&l[h][g].cell==l[h][g+m].cell;){for(e=0;e<n;e++)k[h+e][g+m]=1;m++}a(l[h][g].cell).attr("rowspan",n).attr("colspan",m)}}}}function W(c){var d=ea(c,"aoPreDrawCallback","preDraw",[c]);if(-1!==a.inArray(!1,d))V(c,!1);else{var d=[],e=0,h=c.asStripeClasses,f=h.length,g=c.oLanguage,l=c.iInitDisplayStart,k="ssp"==ja(c),n=c.aiDisplay;c.bDrawing=
!0;l!==b&&-1!==l&&(c._iDisplayStart=k?l:l>=c.fnRecordsDisplay()?0:l,c.iInitDisplayStart=-1);var l=c._iDisplayStart,m=c.fnDisplayEnd();if(c.bDeferLoading)c.bDeferLoading=!1,c.iDraw++,V(c,!1);else if(!k)c.iDraw++;else if(!c.bDestroying&&!sa(c))return;if(0!==n.length)for(g=k?c.aoData.length:m,k=k?0:l;k<g;k++){var q=n[k],y=c.aoData[q];null===y.nTr&&fa(c,q);q=y.nTr;if(0!==f){var w=h[e%f];y._sRowStripe!=w&&(a(q).removeClass(y._sRowStripe).addClass(w),y._sRowStripe=w)}ea(c,"aoRowCallback",null,[q,y._aData,
e,k]);d.push(q);e++}else e=g.sZeroRecords,1==c.iDraw&&"ajax"==ja(c)?e=g.sLoadingRecords:g.sEmptyTable&&0===c.fnRecordsTotal()&&(e=g.sEmptyTable),d[0]=a("<tr/>",{"class":f?h[0]:""}).append(a("<td />",{valign:"top",colSpan:G(c),"class":c.oClasses.sRowEmpty}).html(e))[0];ea(c,"aoHeaderCallback","header",[a(c.nTHead).children("tr")[0],J(c),l,m,n]);ea(c,"aoFooterCallback","footer",[a(c.nTFoot).children("tr")[0],J(c),l,m,n]);h=a(c.nTBody);h.children().detach();h.append(a(d));ea(c,"aoDrawCallback","draw",
[c]);c.bSorted=!1;c.bFiltered=!1;c.bDrawing=!1}}function ba(a,b){var c=a.oFeatures,d=c.bFilter;c.bSort&&Hb(a);d?Q(a,a.oPreviousSearch):a.aiDisplay=a.aiDisplayMaster.slice();!0!==b&&(a._iDisplayStart=0);a._drawHold=b;W(a);a._drawHold=!1}function ka(b){var c=b.oClasses,d=a(b.nTable),d=a("<div/>").insertBefore(d),e=b.oFeatures,h=a("<div/>",{id:b.sTableId+"_wrapper","class":c.sWrapper+(b.nTFoot?"":" "+c.sNoFooter)});b.nHolding=d[0];b.nTableWrapper=h[0];b.nTableReinsertBefore=b.nTable.nextSibling;for(var f=
b.sDom.split(""),g,l,k,n,m,q,y=0;y<f.length;y++){g=null;l=f[y];if("<"==l){k=a("<div/>")[0];n=f[y+1];if("'"==n||'"'==n){m="";for(q=2;f[y+q]!=n;)m+=f[y+q],q++;"H"==m?m=c.sJUIHeader:"F"==m&&(m=c.sJUIFooter);-1!=m.indexOf(".")?(n=m.split("."),k.id=n[0].substr(1,n[0].length-1),k.className=n[1]):"#"==m.charAt(0)?k.id=m.substr(1,m.length-1):k.className=m;y+=q}h.append(k);h=a(k)}else if(">"==l)h=h.parent();else if("l"==l&&e.bPaginate&&e.bLengthChange)g=kb(b);else if("f"==l&&e.bFilter)g=X(b);else if("r"==
l&&e.bProcessing)g=N(b);else if("t"==l)g=Ab(b);else if("i"==l&&e.bInfo)g=zb(b);else if("p"==l&&e.bPaginate)g=Ua(b);else if(0!==D.ext.feature.length)for(k=D.ext.feature,q=0,n=k.length;q<n;q++)if(l==k[q].cFeature){g=k[q].fnInit(b);break}g&&(k=b.aanFeatures,k[l]||(k[l]=[]),k[l].push(g),h.append(g))}d.replaceWith(h)}function Y(b,c){var d=a(c).children("tr"),e,h,f,g,l,k,n,m,q,y;b.splice(0,b.length);f=0;for(k=d.length;f<k;f++)b.push([]);f=0;for(k=d.length;f<k;f++)for(e=d[f],h=e.firstChild;h;){if("TD"==
h.nodeName.toUpperCase()||"TH"==h.nodeName.toUpperCase()){m=1*h.getAttribute("colspan");q=1*h.getAttribute("rowspan");m=m&&0!==m&&1!==m?m:1;q=q&&0!==q&&1!==q?q:1;g=0;for(l=b[f];l[g];)g++;n=g;y=1===m?!0:!1;for(l=0;l<m;l++)for(g=0;g<q;g++)b[f+g][n+l]={cell:h,unique:y},b[f+g].nTr=e}h=h.nextSibling}}function ua(a,b,c){var d=[];c||(c=a.aoHeader,b&&(c=[],Y(c,b)));b=0;for(var e=c.length;b<e;b++)for(var h=0,f=c[b].length;h<f;h++)!c[b][h].unique||d[h]&&a.bSortCellsTop||(d[h]=c[b][h].cell);return d}function va(b,
c,d){ea(b,"aoServerParams","serverParams",[c]);if(c&&a.isArray(c)){var e={},h=/(.*?)\[\]$/;a.each(c,function(a,b){var c=b.name.match(h);c?(c=c[0],e[c]||(e[c]=[]),e[c].push(b.value)):e[b.name]=b.value});c=e}var f,g=b.ajax,l=b.oInstance;if(a.isPlainObject(g)&&g.data){f=g.data;var k=a.isFunction(f)?f(c):f;c=a.isFunction(f)&&k?k:a.extend(!0,c,k);delete g.data}k={data:c,success:function(a){var c=a.error||a.sError;c&&b.oApi._fnLog(b,0,c);b.json=a;ea(b,null,"xhr",[b,a]);d(a)},dataType:"json",cache:!1,type:b.sServerMethod,
error:function(a,c,d){d=b.oApi._fnLog;"parsererror"==c?d(b,0,"Invalid JSON response",1):4===a.readyState&&d(b,0,"Ajax error",7);V(b,!1)}};b.oAjaxData=c;ea(b,null,"preXhr",[b,c]);b.fnServerData?b.fnServerData.call(l,b.sAjaxSource,a.map(c,function(a,b){return{name:b,value:a}}),d,b):b.sAjaxSource||"string"===typeof g?b.jqXHR=a.ajax(a.extend(k,{url:g||b.sAjaxSource})):a.isFunction(g)?b.jqXHR=g.call(l,c,d,b):(b.jqXHR=a.ajax(a.extend(k,g)),g.data=f)}function sa(a){return a.bAjaxDataGet?(a.iDraw++,V(a,!0),
va(a,Aa(a),function(b){Ba(a,b)}),!1):!0}function Aa(b){var c=b.aoColumns,d=c.length,e=b.oFeatures,h=b.oPreviousSearch,f=b.aoPreSearchCols,g,l=[],k,n,m,q=Ia(b);g=b._iDisplayStart;k=!1!==e.bPaginate?b._iDisplayLength:-1;var y=function(a,b){l.push({name:a,value:b})};y("sEcho",b.iDraw);y("iColumns",d);y("sColumns",xa(c,"sName").join(","));y("iDisplayStart",g);y("iDisplayLength",k);var w={draw:b.iDraw,columns:[],order:[],start:g,length:k,search:{value:h.sSearch,regex:h.bRegex}};for(g=0;g<d;g++)n=c[g],
m=f[g],k="function"==typeof n.mData?"function":n.mData,w.columns.push({data:k,name:n.sName,searchable:n.bSearchable,orderable:n.bSortable,search:{value:m.sSearch,regex:m.bRegex}}),y("mDataProp_"+g,k),e.bFilter&&(y("sSearch_"+g,m.sSearch),y("bRegex_"+g,m.bRegex),y("bSearchable_"+g,n.bSearchable)),e.bSort&&y("bSortable_"+g,n.bSortable);e.bFilter&&(y("sSearch",h.sSearch),y("bRegex",h.bRegex));e.bSort&&(a.each(q,function(a,b){w.order.push({column:b.col,dir:b.dir});y("iSortCol_"+a,b.col);y("sSortDir_"+
a,b.dir)}),y("iSortingCols",q.length));c=D.ext.legacy.ajax;return null===c?b.sAjaxSource?l:w:c?l:w}function Ba(a,c){var d=function(a,d){return c[a]!==b?c[a]:c[d]},e=d("sEcho","draw"),f=d("iTotalRecords","recordsTotal"),d=d("iTotalDisplayRecords","recordsFiltered");if(e){if(1*e<a.iDraw)return;a.iDraw=1*e}O(a);a._iRecordsTotal=parseInt(f,10);a._iRecordsDisplay=parseInt(d,10);e=wa(a,c);f=0;for(d=e.length;f<d;f++)h(a,e[f]);a.aiDisplay=a.aiDisplayMaster.slice();a.bAjaxDataGet=!1;W(a);a._bInitComplete||
db(a,c);a.bAjaxDataGet=!0;V(a,!1)}function wa(c,d){var e=a.isPlainObject(c.ajax)&&c.ajax.dataSrc!==b?c.ajax.dataSrc:c.sAjaxDataProp;return"data"===e?d.aaData||d[e]:""!==e?S(e)(d):d}function X(b){var c=b.oClasses,d=b.sTableId,e=b.oLanguage,h=b.oPreviousSearch,f=b.aanFeatures,g='<input type="search" class="'+c.sFilterInput+'"/>',l=e.sSearch,l=l.match(/_INPUT_/)?l.replace("_INPUT_",g):l+g,c=a("<div/>",{id:f.f?null:d+"_filter","class":c.sFilter}).append(a("<label/>").append(l)),f=function(){var a=this.value?
this.value:"";a!=h.sSearch&&(Q(b,{sSearch:a,bRegex:h.bRegex,bSmart:h.bSmart,bCaseInsensitive:h.bCaseInsensitive}),b._iDisplayStart=0,W(b))},g=null!==b.searchDelay?b.searchDelay:"ssp"===ja(b)?400:0,k=a("input",c).val(h.sSearch).attr("placeholder",e.sSearchPlaceholder).bind("keyup.DT search.DT input.DT paste.DT cut.DT",g?Da(f,g):f).bind("keypress.DT",function(a){if(13==a.keyCode)return!1}).attr("aria-controls",d);a(b.nTable).on("search.dt.DT",function(a,c){if(b===c)try{k[0]!==p.activeElement&&k.val(h.sSearch)}catch(d){}});
return c[0]}function Q(a,c,d){var e=a.oPreviousSearch,h=a.aoPreSearchCols,f=function(a){e.sSearch=a.sSearch;e.bRegex=a.bRegex;e.bSmart=a.bSmart;e.bCaseInsensitive=a.bCaseInsensitive},g=function(a){return a.bEscapeRegex!==b?!a.bEscapeRegex:a.bRegex};E(a);if("ssp"!=ja(a)){Cb(a,c.sSearch,d,g(c),c.bSmart,c.bCaseInsensitive);f(c);for(c=0;c<h.length;c++)bb(a,h[c].sSearch,c,g(h[c]),h[c].bSmart,h[c].bCaseInsensitive);m(a)}else f(c);a.bFiltered=!0;ea(a,null,"search",[a])}function m(a){for(var b=D.ext.search,
c=a.aiDisplay,d,e,h=0,f=b.length;h<f;h++){for(var g=[],l=0,k=c.length;l<k;l++)e=c[l],d=a.aoData[e],b[h](a,d._aFilterData,e,d._aData,l)&&g.push(e);c.length=0;c.push.apply(c,g)}}function bb(a,b,c,d,e,h){if(""!==b){var f=a.aiDisplay;d=lb(b,d,e,h);for(e=f.length-1;0<=e;e--)b=a.aoData[f[e]]._aFilterData[c],d.test(b)||f.splice(e,1)}}function Cb(a,b,c,d,e,h){d=lb(b,d,e,h);e=a.oPreviousSearch.sSearch;h=a.aiDisplayMaster;var f;0!==D.ext.search.length&&(c=!0);f=Ha(a);if(0>=b.length)a.aiDisplay=h.slice();else{if(f||
c||e.length>b.length||0!==b.indexOf(e)||a.bSorted)a.aiDisplay=h.slice();b=a.aiDisplay;for(c=b.length-1;0<=c;c--)d.test(a.aoData[b[c]]._sFilterRow)||b.splice(c,1)}}function lb(b,c,d,e){b=c?b:cb(b);d&&(b="^(?=.*?"+a.map(b.match(/"[^"]+"|[^ ]+/g)||"",function(a){if('"'===a.charAt(0)){var b=a.match(/^"(.*)"$/);a=b?b[1]:a}return a.replace('"',"")}).join(")(?=.*?")+").*$");return new RegExp(b,e?"i":"")}function cb(a){return a.replace(vb,"\\$1")}function Ha(a){var b=a.aoColumns,c,d,e,h,f,g,l,k,n=D.ext.type.search;
c=!1;d=0;for(h=a.aoData.length;d<h;d++)if(k=a.aoData[d],!k._aFilterData){g=[];e=0;for(f=b.length;e<f;e++)c=b[e],c.bSearchable?(l=w(a,d,e,"filter"),n[c.sType]&&(l=n[c.sType](l)),null===l&&(l=""),"string"!==typeof l&&l.toString&&(l=l.toString())):l="",l.indexOf&&-1!==l.indexOf("&")&&(Xa.innerHTML=l,l=Rb?Xa.textContent:Xa.innerText),l.replace&&(l=l.replace(/[\r\n]/g,"")),g.push(l);k._aFilterData=g;k._sFilterRow=g.join("  ");c=!0}return c}function mb(a){return{search:a.sSearch,smart:a.bSmart,regex:a.bRegex,
caseInsensitive:a.bCaseInsensitive}}function nb(a){return{sSearch:a.search,bSmart:a.smart,bRegex:a.regex,bCaseInsensitive:a.caseInsensitive}}function zb(b){var c=b.sTableId,d=b.aanFeatures.i,e=a("<div/>",{"class":b.oClasses.sInfo,id:d?null:c+"_info"});d||(b.aoDrawCallback.push({fn:Sa,sName:"information"}),e.attr("role","status").attr("aria-live","polite"),a(b.nTable).attr("aria-describedby",c+"_info"));return e[0]}function Sa(b){var c=b.aanFeatures.i;if(0!==c.length){var d=b.oLanguage,e=b._iDisplayStart+
1,h=b.fnDisplayEnd(),f=b.fnRecordsTotal(),g=b.fnRecordsDisplay(),l=g?d.sInfo:d.sInfoEmpty;g!==f&&(l+=" "+d.sInfoFiltered);l+=d.sInfoPostFix;l=Eb(b,l);d=d.fnInfoCallback;null!==d&&(l=d.call(b.oInstance,b,e,h,f,g,l));a(c).html(l)}}function Eb(a,b){var c=a.fnFormatNumber,d=a._iDisplayStart+1,e=a._iDisplayLength,h=a.fnRecordsDisplay(),f=-1===e;return b.replace(/_START_/g,c.call(a,d)).replace(/_END_/g,c.call(a,a.fnDisplayEnd())).replace(/_MAX_/g,c.call(a,a.fnRecordsTotal())).replace(/_TOTAL_/g,c.call(a,
h)).replace(/_PAGE_/g,c.call(a,f?1:Math.ceil(d/e))).replace(/_PAGES_/g,c.call(a,f?1:Math.ceil(h/e)))}function Ta(a){var b,c,d=a.iInitDisplayStart,e=a.aoColumns,f;c=a.oFeatures;if(a.bInitialised){ka(a);oa(a);Z(a,a.aoHeader);Z(a,a.aoFooter);V(a,!0);c.bAutoWidth&&za(a);b=0;for(c=e.length;b<c;b++)f=e[b],f.sWidth&&(f.nTh.style.width=R(f.sWidth));ba(a);e=ja(a);"ssp"!=e&&("ajax"==e?va(a,[],function(c){var e=wa(a,c);for(b=0;b<e.length;b++)h(a,e[b]);a.iInitDisplayStart=d;ba(a);V(a,!1);db(a,c)},a):(V(a,!1),
db(a)))}else setTimeout(function(){Ta(a)},200)}function db(a,b){a._bInitComplete=!0;b&&q(a);ea(a,"aoInitComplete","init",[a,b])}function ta(a,b){var c=parseInt(b,10);a._iDisplayLength=c;tb(a);ea(a,null,"length",[a,c])}function kb(b){for(var c=b.oClasses,d=b.sTableId,e=b.aLengthMenu,h=a.isArray(e[0]),f=h?e[0]:e,e=h?e[1]:e,h=a("<select/>",{name:d+"_length","aria-controls":d,"class":c.sLengthSelect}),g=0,l=f.length;g<l;g++)h[0][g]=new Option(e[g],f[g]);var k=a("<div><label/></div>").addClass(c.sLength);
b.aanFeatures.l||(k[0].id=d+"_length");k.children().append(b.oLanguage.sLengthMenu.replace("_MENU_",h[0].outerHTML));a("select",k).val(b._iDisplayLength).bind("change.DT",function(c){ta(b,a(this).val());W(b)});a(b.nTable).bind("length.dt.DT",function(c,d,e){b===d&&a("select",k).val(e)});return k[0]}function Ua(b){var c=b.sPaginationType,d=D.ext.pager[c],e="function"===typeof d,h=function(a){W(a)},c=a("<div/>").addClass(b.oClasses.sPaging+c)[0],f=b.aanFeatures;e||d.fnInit(b,c,h);f.p||(c.id=b.sTableId+
"_paginate",b.aoDrawCallback.push({fn:function(a){if(e){var b=a._iDisplayStart,c=a._iDisplayLength,g=a.fnRecordsDisplay(),l=-1===c,b=l?0:Math.ceil(b/c),c=l?1:Math.ceil(g/c),g=d(b,c),u,l=0;for(u=f.p.length;l<u;l++)fb(a,"pageButton")(a,f.p[l],l,g,b,c)}else d.fnUpdate(a,h)},sName:"pagination"}));return c}function ya(a,b,c){var d=a._iDisplayStart,e=a._iDisplayLength,h=a.fnRecordsDisplay();0===h||-1===e?d=0:"number"===typeof b?(d=b*e,d>h&&(d=0)):"first"==b?d=0:"previous"==b?(d=0<=e?d-e:0,0>d&&(d=0)):"next"==
b?d+e<h&&(d+=e):"last"==b?d=Math.floor((h-1)/e)*e:Ga(a,0,"Unknown paging action: "+b,5);b=a._iDisplayStart!==d;a._iDisplayStart=d;b&&(ea(a,null,"page",[a]),c&&W(a));return b}function N(b){return a("<div/>",{id:b.aanFeatures.r?null:b.sTableId+"_processing","class":b.oClasses.sProcessing}).html(b.oLanguage.sProcessing).insertBefore(b.nTable)[0]}function V(b,c){b.oFeatures.bProcessing&&a(b.aanFeatures.r).css("display",c?"block":"none");ea(b,null,"processing",[b,c])}function Ab(b){var c=a(b.nTable);c.attr("role",
"grid");var d=b.oScroll;if(""===d.sX&&""===d.sY)return b.nTable;var e=d.sX,h=d.sY,f=b.oClasses,g=c.children("caption"),l=g.length?g[0]._captionSide:null,k=a(c[0].cloneNode(!1)),n=a(c[0].cloneNode(!1)),m=c.children("tfoot");d.sX&&"100%"===c.attr("width")&&c.removeAttr("width");m.length||(m=null);d=a("<div/>",{"class":f.sScrollWrapper}).append(a("<div/>",{"class":f.sScrollHead}).css({overflow:"hidden",position:"relative",border:0,width:e?e?R(e):null:"100%"}).append(a("<div/>",{"class":f.sScrollHeadInner}).css({"box-sizing":"content-box",
width:d.sXInner||"100%"}).append(k.removeAttr("id").css("margin-left",0).append("top"===l?g:null).append(c.children("thead"))))).append(a("<div/>",{"class":f.sScrollBody}).css({overflow:"auto",height:h?R(h):null,width:e?R(e):null}).append(c));m&&d.append(a("<div/>",{"class":f.sScrollFoot}).css({overflow:"hidden",border:0,width:e?e?R(e):null:"100%"}).append(a("<div/>",{"class":f.sScrollFootInner}).append(n.removeAttr("id").css("margin-left",0).append("bottom"===l?g:null).append(c.children("tfoot")))));
var c=d.children(),q=c[0],f=c[1],y=m?c[2]:null;e&&a(f).scroll(function(a){a=this.scrollLeft;q.scrollLeft=a;m&&(y.scrollLeft=a)});b.nScrollHead=q;b.nScrollBody=f;b.nScrollFoot=y;b.aoDrawCallback.push({fn:Oa,sName:"scrolling"});return d[0]}function Oa(b){var c=b.oScroll,d=c.sX,e=c.sXInner,h=c.sY,f=c.iBarWidth,g=a(b.nScrollHead),l=g[0].style,k=g.children("div"),n=k[0].style,m=k.children("table"),k=b.nScrollBody,q=a(k),y=k.style,w=a(b.nScrollFoot).children("div"),z=w.children("table"),C=a(b.nTHead),t=
a(b.nTable),r=t[0],S=r.style,p=b.nTFoot?a(b.nTFoot):null,A=b.oBrowser,x=A.bScrollOversize,P,O,M,E,J,G=[],I=[],U=[],ca,fa=function(a){a=a.style;a.paddingTop="0";a.paddingBottom="0";a.borderTopWidth="0";a.borderBottomWidth="0";a.height=0};t.children("thead, tfoot").remove();J=C.clone().prependTo(t);P=C.find("tr");M=J.find("tr");J.find("th, td").removeAttr("tabindex");p&&(E=p.clone().prependTo(t),O=p.find("tr"),E=E.find("tr"));d||(y.width="100%",g[0].style.width="100%");a.each(ua(b,J),function(a,c){ca=
B(b,a);c.style.width=b.aoColumns[ca].sWidth});p&&ha(function(a){a.style.width=""},E);c.bCollapse&&""!==h&&(y.height=q[0].offsetHeight+C[0].offsetHeight+"px");g=t.outerWidth();""===d?(S.width="100%",x&&(t.find("tbody").height()>k.offsetHeight||"scroll"==q.css("overflow-y"))&&(S.width=R(t.outerWidth()-f))):""!==e?S.width=R(e):g==q.width()&&q.height()<t.height()?(S.width=R(g-f),t.outerWidth()>g-f&&(S.width=R(g))):S.width=R(g);g=t.outerWidth();ha(fa,M);ha(function(b){U.push(b.innerHTML);G.push(R(a(b).css("width")))},
M);ha(function(a,b){a.style.width=G[b]},P);a(M).height(0);p&&(ha(fa,E),ha(function(b){I.push(R(a(b).css("width")))},E),ha(function(a,b){a.style.width=I[b]},O),a(E).height(0));ha(function(a,b){a.innerHTML='<div class="dataTables_sizing" style="height:0;overflow:hidden;">'+U[b]+"</div>";a.style.width=G[b]},M);p&&ha(function(a,b){a.innerHTML="";a.style.width=I[b]},E);t.outerWidth()<g?(O=k.scrollHeight>k.offsetHeight||"scroll"==q.css("overflow-y")?g+f:g,x&&(k.scrollHeight>k.offsetHeight||"scroll"==q.css("overflow-y"))&&
(S.width=R(O-f)),""!==d&&""===e||Ga(b,1,"Possible column misalignment",6)):O="100%";y.width=R(O);l.width=R(O);p&&(b.nScrollFoot.style.width=R(O));!h&&x&&(y.height=R(r.offsetHeight+f));h&&c.bCollapse&&(y.height=R(h),c=d&&r.offsetWidth>k.offsetWidth?f:0,r.offsetHeight<k.offsetHeight&&(y.height=R(r.offsetHeight+c)));c=t.outerWidth();m[0].style.width=R(c);n.width=R(c);m=t.height()>k.clientHeight||"scroll"==q.css("overflow-y");A="padding"+(A.bScrollbarLeft?"Left":"Right");n[A]=m?f+"px":"0px";p&&(z[0].style.width=
R(c),w[0].style.width=R(c),w[0].style[A]=m?f+"px":"0px");q.scroll();!b.bSorted&&!b.bFiltered||b._drawHold||(k.scrollTop=0)}function ha(a,b,c){for(var d=0,e=0,h=b.length,f,g;e<h;){f=b[e].firstChild;for(g=c?c[e].firstChild:null;f;)1===f.nodeType&&(c?a(f,g,d):a(f,d),d++),f=f.nextSibling,g=c?g.nextSibling:null;e++}}function za(b){var d=b.nTable,e=b.aoColumns,h=b.oScroll,f=h.sY,g=h.sX,l=h.sXInner,k=e.length,h=A(b,"bVisible"),n=a("th",b.nTHead),m=d.getAttribute("width"),y=d.parentNode,w=!1,z,C;for(z=0;z<
h.length;z++)C=e[h[z]],null!==C.sWidth&&(C.sWidth=ob(C.sWidthOrig,y),w=!0);if(w||g||f||k!=G(b)||k!=n.length){k=a(d).clone().empty().css("visibility","hidden").removeAttr("id").append(a(b.nTHead).clone(!1)).append(a(b.nTFoot).clone(!1)).append(a("<tbody><tr/></tbody>"));k.find("tfoot th, tfoot td").css("width","");var t=k.find("tbody tr"),n=ua(b,k.find("thead")[0]);for(z=0;z<h.length;z++)C=e[h[z]],n[z].style.width=null!==C.sWidthOrig&&""!==C.sWidthOrig?R(C.sWidthOrig):"";if(b.aoData.length)for(z=0;z<
h.length;z++)w=h[z],C=e[w],a(Gb(b,w)).clone(!1).append(C.sContentPadding).appendTo(t);k.appendTo(y);g&&l?k.width(l):g?(k.css("width","auto"),k.width()<y.offsetWidth&&k.width(y.offsetWidth)):f?k.width(y.offsetWidth):m&&k.width(m);Fb(b,k[0]);if(g){for(z=l=0;z<h.length;z++)C=e[h[z]],f=a(n[z]).outerWidth(),l+=null===C.sWidthOrig?f:parseInt(C.sWidth,10)+f-a(n[z]).width();k.width(R(l));d.style.width=R(l)}for(z=0;z<h.length;z++)if(C=e[h[z]],f=a(n[z]).width())C.sWidth=R(f);d.style.width=R(k.css("width"));
k.remove()}else for(z=0;z<k;z++)e[z].sWidth=R(n.eq(z).width());m&&(d.style.width=R(m));!m&&!g||b._reszEvt||(a(c).bind("resize.DT-"+b.sInstance,Da(function(){q(b)})),b._reszEvt=!0)}function Da(a,c){var d=c!==b?c:200,e,h;return function(){var c=this,f=+new Date,g=arguments;e&&f<e+d?(clearTimeout(h),h=setTimeout(function(){e=b;a.apply(c,g)},d)):e?(e=f,a.apply(c,g)):e=f}}function ob(b,c){if(!b)return 0;var d=a("<div/>").css("width",R(b)).appendTo(c||p.body),e=d[0].offsetWidth;d.remove();return e}function Fb(b,
c){var d=b.oScroll;if(d.sX||d.sY)d=d.sX?0:d.iBarWidth,c.style.width=R(a(c).outerWidth()-d)}function Gb(b,c){var d=pb(b,c);if(0>d)return null;var e=b.aoData[d];return e.nTr?e.anCells[c]:a("<td/>").html(w(b,d,c,"display"))[0]}function pb(a,b){for(var c,d=-1,e=-1,h=0,f=a.aoData.length;h<f;h++)c=w(a,h,b,"display")+"",c=c.replace(Sb,""),c.length>d&&(d=c.length,e=h);return e}function R(a){return null===a?"0px":"number"==typeof a?0>a?"0px":a+"px":a.match(/\d$/)?a+"px":a}function qb(){if(!D.__scrollbarWidth){var b=
a("<p/>").css({width:"100%",height:200,padding:0})[0],c=a("<div/>").css({position:"absolute",top:0,left:0,width:200,height:150,padding:0,overflow:"hidden",visibility:"hidden"}).append(b).appendTo("body"),d=b.offsetWidth;c.css("overflow","scroll");b=b.offsetWidth;d===b&&(b=c[0].clientWidth);c.remove();D.__scrollbarWidth=d-b}return D.__scrollbarWidth}function Ia(c){var d,e,h=[],f=c.aoColumns,g,l,k,n;d=c.aaSortingFixed;e=a.isPlainObject(d);var m=[];g=function(b){b.length&&!a.isArray(b[0])?m.push(b):
m.push.apply(m,b)};a.isArray(d)&&g(d);e&&d.pre&&g(d.pre);g(c.aaSorting);e&&d.post&&g(d.post);for(c=0;c<m.length;c++)for(n=m[c][0],g=f[n].aDataSort,d=0,e=g.length;d<e;d++)l=g[d],k=f[l].sType||"string",m[c]._idx===b&&(m[c]._idx=a.inArray(m[c][1],f[l].asSorting)),h.push({src:n,col:l,dir:m[c][1],index:m[c]._idx,type:k,formatter:D.ext.type.order[k+"-pre"]});return h}function Hb(a){var b,c,d=[],e=D.ext.type.order,h=a.aoData,f=0,g,l=a.aiDisplayMaster,k;E(a);k=Ia(a);b=0;for(c=k.length;b<c;b++)g=k[b],g.formatter&&
f++,Jb(a,g.col);if("ssp"!=ja(a)&&0!==k.length){b=0;for(c=l.length;b<c;b++)d[l[b]]=b;f===k.length?l.sort(function(a,b){var c,e,f,g,l=k.length,u=h[a]._aSortData,n=h[b]._aSortData;for(f=0;f<l;f++)if(g=k[f],c=u[g.col],e=n[g.col],c=c<e?-1:c>e?1:0,0!==c)return"asc"===g.dir?c:-c;c=d[a];e=d[b];return c<e?-1:c>e?1:0}):l.sort(function(a,b){var c,f,g,l,u=k.length,n=h[a]._aSortData,m=h[b]._aSortData;for(g=0;g<u;g++)if(l=k[g],c=n[l.col],f=m[l.col],l=e[l.type+"-"+l.dir]||e["string-"+l.dir],c=l(c,f),0!==c)return c;
c=d[a];f=d[b];return c<f?-1:c>f?1:0})}a.bSorted=!0}function Ib(a){var b,c,d=a.aoColumns,e=Ia(a);a=a.oLanguage.oAria;for(var h=0,f=d.length;h<f;h++){c=d[h];var g=c.asSorting;b=c.sTitle.replace(/<.*?>/g,"");var l=c.nTh;l.removeAttribute("aria-sort");c.bSortable&&(0<e.length&&e[0].col==h?(l.setAttribute("aria-sort","asc"==e[0].dir?"ascending":"descending"),c=g[e[0].index+1]||g[0]):c=g[0],b+="asc"===c?a.sSortAscending:a.sSortDescending);l.setAttribute("aria-label",b)}}function rb(c,d,e,h){var f=c.aaSorting,
g=c.aoColumns[d].asSorting,l=function(c,d){var e=c._idx;e===b&&(e=a.inArray(c[1],g));return e+1<g.length?e+1:d?null:0};"number"===typeof f[0]&&(f=c.aaSorting=[f]);e&&c.oFeatures.bSortMulti?(e=a.inArray(d,xa(f,"0")),-1!==e?(d=l(f[e],!0),null===d?f.splice(e,1):(f[e][1]=g[d],f[e]._idx=d)):(f.push([d,g[0],0]),f[f.length-1]._idx=0)):f.length&&f[0][0]==d?(d=l(f[0]),f.length=1,f[0][1]=g[d],f[0]._idx=d):(f.length=0,f.push([d,g[0]]),f[0]._idx=0);ba(c);"function"==typeof h&&h(c)}function eb(a,b,c,d){var e=
a.aoColumns[c];sb(b,{},function(b){!1!==e.bSortable&&(a.oFeatures.bProcessing?(V(a,!0),setTimeout(function(){rb(a,c,b.shiftKey,d);"ssp"!==ja(a)&&V(a,!1)},0)):rb(a,c,b.shiftKey,d))})}function $a(b){var c=b.aLastSort,d=b.oClasses.sSortColumn,e=Ia(b),h=b.oFeatures,f,g;if(h.bSort&&h.bSortClasses){h=0;for(f=c.length;h<f;h++)g=c[h].src,a(xa(b.aoData,"anCells",g)).removeClass(d+(2>h?h+1:3));h=0;for(f=e.length;h<f;h++)g=e[h].src,a(xa(b.aoData,"anCells",g)).addClass(d+(2>h?h+1:3))}b.aLastSort=e}function Jb(a,
b){var c=a.aoColumns[b],d=D.ext.order[c.sSortDataType],e;d&&(e=d.call(a.oInstance,a,b,x(a,b)));for(var h,f=D.ext.type.order[c.sType+"-pre"],g=0,l=a.aoData.length;g<l;g++)if(c=a.aoData[g],c._aSortData||(c._aSortData=[]),!c._aSortData[b]||d)h=d?e[g]:w(a,g,b,"sort"),c._aSortData[b]=f?f(h):h}function ma(b){if(b.oFeatures.bStateSave&&!b.bDestroying){var c={time:+new Date,start:b._iDisplayStart,length:b._iDisplayLength,order:a.extend(!0,[],b.aaSorting),search:mb(b.oPreviousSearch),columns:a.map(b.aoColumns,
function(a,c){return{visible:a.bVisible,search:mb(b.aoPreSearchCols[c])}})};ea(b,"aoStateSaveParams","stateSaveParams",[b,c]);b.oSavedState=c;b.fnStateSaveCallback.call(b.oInstance,b,c)}}function Qa(b,c){var d,e,h=b.aoColumns;if(b.oFeatures.bStateSave){var f=b.fnStateLoadCallback.call(b.oInstance,b);if(f&&f.time&&(d=ea(b,"aoStateLoadParams","stateLoadParams",[b,f]),-1===a.inArray(!1,d)&&(d=b.iStateDuration,!(0<d&&f.time<+new Date-1E3*d)&&h.length===f.columns.length))){b.oLoadedState=a.extend(!0,{},
f);b._iDisplayStart=f.start;b.iInitDisplayStart=f.start;b._iDisplayLength=f.length;b.aaSorting=[];a.each(f.order,function(a,c){b.aaSorting.push(c[0]>=h.length?[0,c[1]]:c)});a.extend(b.oPreviousSearch,nb(f.search));d=0;for(e=f.columns.length;d<e;d++){var g=f.columns[d];h[d].bVisible=g.visible;a.extend(b.aoPreSearchCols[d],nb(g.search))}ea(b,"aoStateLoaded","stateLoaded",[b,f])}}}function Pa(b){var c=D.settings;b=a.inArray(b,xa(c,"nTable"));return-1!==b?c[b]:null}function Ga(a,b,d,e){d="DataTables warning: "+
(null!==a?"table id="+a.sTableId+" - ":"")+d;e&&(d+=". For more information about this error, please see http://datatables.net/tn/"+e);if(b)c.console&&console.log&&console.log(d);else if(a=D.ext,"alert"==(a.sErrMode||a.errMode))alert(d);else throw Error(d);}function qa(c,d,e,h){a.isArray(e)?a.each(e,function(b,e){a.isArray(e)?qa(c,d,e[0],e[1]):qa(c,d,e)}):(h===b&&(h=e),d[e]!==b&&(c[h]=d[e]))}function Ra(b,c,d){var e,h;for(h in c)c.hasOwnProperty(h)&&(e=c[h],a.isPlainObject(e)?(a.isPlainObject(b[h])||
(b[h]={}),a.extend(!0,b[h],e)):d&&"data"!==h&&"aaData"!==h&&a.isArray(e)?b[h]=e.slice():b[h]=e);return b}function sb(b,c,d){a(b).bind("click.DT",c,function(a){b.blur();d(a)}).bind("keypress.DT",c,function(a){13===a.which&&(a.preventDefault(),d(a))}).bind("selectstart.DT",function(){return!1})}function pa(a,b,c,d){c&&a[b].push({fn:c,sName:d})}function ea(b,c,d,e){var h=[];c&&(h=a.map(b[c].slice().reverse(),function(a,c){return a.fn.apply(b.oInstance,e)}));null!==d&&a(b.nTable).trigger(d+".dt",e);return h}
function tb(a){var b=a._iDisplayStart,c=a.fnDisplayEnd(),d=a._iDisplayLength;b>=c&&(b=c-d);b-=b%d;if(-1===d||0>b)b=0;a._iDisplayStart=b}function fb(b,c){var d=b.renderer,e=D.ext.renderer[c];return a.isPlainObject(d)&&d[c]?e[d[c]]||e._:"string"===typeof d?e[d]||e._:e._}function ja(a){return a.oFeatures.bServerSide?"ssp":a.ajax||a.sAjaxSource?"ajax":"dom"}function Ea(a,b){var c=[],c=Wb.numbers_length,d=Math.floor(c/2);b<=c?c=Ka(0,b):a<=d?(c=Ka(0,c-2),c.push("ellipsis"),c.push(b-1)):(a>=b-1-d?c=Ka(b-
(c-2),b):(c=Ka(a-1,a+2),c.push("ellipsis"),c.push(b-1)),c.splice(0,0,"ellipsis"),c.splice(0,0,0));c.DT_el="span";return c}function Va(b){a.each({num:function(a){return Bb(a,b)},"num-fmt":function(a){return Bb(a,b,Ca)},"html-num":function(a){return Bb(a,b,Ma)},"html-num-fmt":function(a){return Bb(a,b,Ma,Ca)}},function(a,c){la.type.order[a+b+"-pre"]=c;a.match(/^html\-/)&&(la.type.search[a+b]=la.type.search.html)})}function Kb(a){return function(){var b=[Pa(this[D.ext.iApiIndex])].concat(Array.prototype.slice.call(arguments));
return D.ext.internal[a].apply(this,b)}}var D,la,T,K,aa,Ja={},Lb=/[\r\n]/g,Ma=/<.*?>/g,Qb=/^[\w\+\-]/,ub=/[\w\+\-]$/,vb=/(\/|\.|\*|\+|\?|\||\(|\)|\[|\]|\{|\}|\\|\$|\^|\-)/g,Ca=/[',$\u00a3\u20ac\u00a5%\u2009\u202F]/g,na=function(a){return a&&!0!==a&&"-"!==a?!1:!0},Mb=function(a){var b=parseInt(a,10);return!isNaN(b)&&isFinite(a)?b:null},wb=function(a,b){Ja[b]||(Ja[b]=new RegExp(cb(b),"g"));return"string"===typeof a&&"."!==b?a.replace(/\./g,"").replace(Ja[b],"."):a},xb=function(a,b,c){var d="string"===
typeof a;b&&d&&(a=wb(a,b));c&&d&&(a=a.replace(Ca,""));return na(a)||!isNaN(parseFloat(a))&&isFinite(a)},Nb=function(a,b,c){return na(a)?!0:na(a)||"string"===typeof a?xb(a.replace(Ma,""),b,c)?!0:null:null},xa=function(a,c,d){var e=[],h=0,f=a.length;if(d!==b)for(;h<f;h++)a[h]&&a[h][c]&&e.push(a[h][c][d]);else for(;h<f;h++)a[h]&&e.push(a[h][c]);return e},Na=function(a,c,d,e){var h=[],f=0,g=c.length;if(e!==b)for(;f<g;f++)a[c[f]][d]&&h.push(a[c[f]][d][e]);else for(;f<g;f++)h.push(a[c[f]][d]);return h},
Ka=function(a,c){var d=[],e;c===b?(c=0,e=a):(e=c,c=a);for(var h=c;h<e;h++)d.push(h);return d},ab=function(a){for(var b=[],c=0,d=a.length;c<d;c++)a[c]&&b.push(a[c]);return b},gb=function(a){var b=[],c,d,e=a.length,h,f=0;d=0;a:for(;d<e;d++){c=a[d];for(h=0;h<f;h++)if(b[h]===c)continue a;b.push(c);f++}return b},ia=function(a,c,d){a[c]!==b&&(a[d]=a[c])},Wa=/\[.*?\]$/,La=/\(\)$/,Xa=a("<div>")[0],Rb=Xa.textContent!==b,Sb=/<.*?>/g;D=function(c){this.$=function(a,b){return this.api(!0).$(a,b)};this._=function(a,
b){return this.api(!0).rows(a,b).data()};this.api=function(a){return a?new T(Pa(this[la.iApiIndex])):new T(this)};this.fnAddData=function(c,d){var e=this.api(!0),h=a.isArray(c)&&(a.isArray(c[0])||a.isPlainObject(c[0]))?e.rows.add(c):e.row.add(c);(d===b||d)&&e.draw();return h.flatten().toArray()};this.fnAdjustColumnSizing=function(a){var c=this.api(!0).columns.adjust(),d=c.settings()[0],e=d.oScroll;a===b||a?c.draw(!1):""===e.sX&&""===e.sY||Oa(d)};this.fnClearTable=function(a){var c=this.api(!0).clear();
(a===b||a)&&c.draw()};this.fnClose=function(a){this.api(!0).row(a).child.hide()};this.fnDeleteRow=function(a,c,d){var e=this.api(!0);a=e.rows(a);var h=a.settings()[0],f=h.aoData[a[0][0]];a.remove();c&&c.call(this,h,f);(d===b||d)&&e.draw();return f};this.fnDestroy=function(a){this.api(!0).destroy(a)};this.fnDraw=function(a){this.api(!0).draw(!a)};this.fnFilter=function(a,c,d,e,h,f){h=this.api(!0);null===c||c===b?h.search(a,d,e,f):h.column(c).search(a,d,e,f);h.draw()};this.fnGetData=function(a,c){var d=
this.api(!0);if(a!==b){var e=a.nodeName?a.nodeName.toLowerCase():"";return c!==b||"td"==e||"th"==e?d.cell(a,c).data():d.row(a).data()||null}return d.data().toArray()};this.fnGetNodes=function(a){var c=this.api(!0);return a!==b?c.row(a).node():c.rows().nodes().flatten().toArray()};this.fnGetPosition=function(a){var b=this.api(!0),c=a.nodeName.toUpperCase();return"TR"==c?b.row(a).index():"TD"==c||"TH"==c?(a=b.cell(a).index(),[a.row,a.columnVisible,a.column]):null};this.fnIsOpen=function(a){return this.api(!0).row(a).child.isShown()};
this.fnOpen=function(a,b,c){return this.api(!0).row(a).child(b,c).show().child()[0]};this.fnPageChange=function(a,c){var d=this.api(!0).page(a);(c===b||c)&&d.draw(!1)};this.fnSetColumnVis=function(a,c,d){a=this.api(!0).column(a).visible(c);(d===b||d)&&a.columns.adjust().draw()};this.fnSettings=function(){return Pa(this[la.iApiIndex])};this.fnSort=function(a){this.api(!0).order(a).draw()};this.fnSortListener=function(a,b,c){this.api(!0).order.listener(a,b,c)};this.fnUpdate=function(a,c,d,e,h){var f=
this.api(!0);d===b||null===d?f.row(c).data(a):f.cell(c,d).data(a);(h===b||h)&&f.columns.adjust();(e===b||e)&&f.draw();return 0};this.fnVersionCheck=la.fnVersionCheck;var l=this,k=c===b,m=this.length;k&&(c={});this.oApi=this.internal=la.internal;for(var q in D.ext.internal)q&&(this[q]=Kb(q));this.each(function(){var q={},q=1<m?Ra(q,c,!0):c,y=0,w,z=this.getAttribute("id"),S=!1,p=D.defaults;if("table"!=this.nodeName.toLowerCase())Ga(null,0,"Non-table node initialisation ("+this.nodeName+")",2);else{n(p);
f(p.column);g(p,p,!0);g(p.column,p.column,!0);g(p,q);var A=D.settings,y=0;for(w=A.length;y<w;y++){if(A[y].nTable==this){w=q.bRetrieve!==b?q.bRetrieve:p.bRetrieve;if(k||w)return A[y].oInstance;if(q.bDestroy!==b?q.bDestroy:p.bDestroy){A[y].oInstance.fnDestroy();break}else{Ga(A[y],0,"Cannot reinitialise DataTable",3);return}}if(A[y].sTableId==this.id){A.splice(y,1);break}}if(null===z||""===z)this.id=z="DataTables_Table_"+D.ext._unique++;var x=a.extend(!0,{},D.models.oSettings,{nTable:this,oApi:l.internal,
oInit:q,sDestroyWidth:a(this)[0].style.width,sInstance:z,sTableId:z});A.push(x);x.oInstance=1===l.length?l:a(this).dataTable();n(q);q.oLanguage&&d(q.oLanguage);q.aLengthMenu&&!q.iDisplayLength&&(q.iDisplayLength=a.isArray(q.aLengthMenu[0])?q.aLengthMenu[0][0]:q.aLengthMenu[0]);q=Ra(a.extend(!0,{},p),q);qa(x.oFeatures,q,"bPaginate bLengthChange bFilter bSort bSortMulti bInfo bProcessing bAutoWidth bSortClasses bServerSide bDeferRender".split(" "));qa(x,q,["asStripeClasses","ajax","fnServerData","fnFormatNumber",
"sServerMethod","aaSorting","aaSortingFixed","aLengthMenu","sPaginationType","sAjaxSource","sAjaxDataProp","iStateDuration","sDom","bSortCellsTop","iTabIndex","fnStateLoadCallback","fnStateSaveCallback","renderer","searchDelay",["iCookieDuration","iStateDuration"],["oSearch","oPreviousSearch"],["aoSearchCols","aoPreSearchCols"],["iDisplayLength","_iDisplayLength"],["bJQueryUI","bJUI"]]);qa(x.oScroll,q,[["sScrollX","sX"],["sScrollXInner","sXInner"],["sScrollY","sY"],["bScrollCollapse","bCollapse"]]);
qa(x.oLanguage,q,"fnInfoCallback");pa(x,"aoDrawCallback",q.fnDrawCallback,"user");pa(x,"aoServerParams",q.fnServerParams,"user");pa(x,"aoStateSaveParams",q.fnStateSaveParams,"user");pa(x,"aoStateLoadParams",q.fnStateLoadParams,"user");pa(x,"aoStateLoaded",q.fnStateLoaded,"user");pa(x,"aoRowCallback",q.fnRowCallback,"user");pa(x,"aoRowCreatedCallback",q.fnCreatedRow,"user");pa(x,"aoHeaderCallback",q.fnHeaderCallback,"user");pa(x,"aoFooterCallback",q.fnFooterCallback,"user");pa(x,"aoInitComplete",q.fnInitComplete,
"user");pa(x,"aoPreDrawCallback",q.fnPreDrawCallback,"user");z=x.oClasses;q.bJQueryUI?(a.extend(z,D.ext.oJUIClasses,q.oClasses),q.sDom===p.sDom&&"lfrtip"===p.sDom&&(x.sDom='<"H"lfr>t<"F"ip>'),x.renderer)?a.isPlainObject(x.renderer)&&!x.renderer.header&&(x.renderer.header="jqueryui"):x.renderer="jqueryui":a.extend(z,D.ext.classes,q.oClasses);a(this).addClass(z.sTable);if(""!==x.oScroll.sX||""!==x.oScroll.sY)x.oScroll.iBarWidth=qb();!0===x.oScroll.sX&&(x.oScroll.sX="100%");x.iInitDisplayStart===b&&
(x.iInitDisplayStart=q.iDisplayStart,x._iDisplayStart=q.iDisplayStart);null!==q.iDeferLoading&&(x.bDeferLoading=!0,y=a.isArray(q.iDeferLoading),x._iRecordsDisplay=y?q.iDeferLoading[0]:q.iDeferLoading,x._iRecordsTotal=y?q.iDeferLoading[1]:q.iDeferLoading);var P=x.oLanguage;a.extend(!0,P,q.oLanguage);""!==P.sUrl&&(a.ajax({dataType:"json",url:P.sUrl,success:function(b){d(b);g(p.oLanguage,b);a.extend(!0,P,b);Ta(x)},error:function(){Ta(x)}}),S=!0);null===q.asStripeClasses&&(x.asStripeClasses=[z.sStripeOdd,
z.sStripeEven]);var y=x.asStripeClasses,O=a("tbody tr:eq(0)",this);-1!==a.inArray(!0,a.map(y,function(a,b){return O.hasClass(a)}))&&(a("tbody tr",this).removeClass(y.join(" ")),x.asDestroyStripes=y.slice());var A=[],B,y=this.getElementsByTagName("thead");0!==y.length&&(Y(x.aoHeader,y[0]),A=ua(x));if(null===q.aoColumns)for(B=[],y=0,w=A.length;y<w;y++)B.push(null);else B=q.aoColumns;y=0;for(w=B.length;y<w;y++)e(x,A?A[y]:null);I(x,q.aoColumnDefs,B,function(a,b){t(x,a,b)});if(O.length){var M=function(a,
b){return a.getAttribute("data-"+b)?b:null};a.each(ca(x,O[0]).cells,function(a,c){var d=x.aoColumns[a];if(d.mData===a){var e=M(c,"sort")||M(c,"order"),h=M(c,"filter")||M(c,"search");if(null!==e||null!==h)d.mData={_:a+".display",sort:null!==e?a+".@data-"+e:b,type:null!==e?a+".@data-"+e:b,filter:null!==h?a+".@data-"+h:b},t(x,a)}})}var E=x.oFeatures;q.bStateSave&&(E.bStateSave=!0,Qa(x,q),pa(x,"aoDrawCallback",ma,"state_save"));if(q.aaSorting===b)for(A=x.aaSorting,y=0,w=A.length;y<w;y++)A[y][1]=x.aoColumns[y].asSorting[0];
$a(x);E.bSort&&pa(x,"aoDrawCallback",function(){if(x.bSorted){var b=Ia(x),c={};a.each(b,function(a,b){c[b.src]=b.dir});ea(x,null,"order",[x,b,c]);Ib(x)}});pa(x,"aoDrawCallback",function(){(x.bSorted||"ssp"===ja(x)||E.bDeferRender)&&$a(x)},"sc");r(x);y=a(this).children("caption").each(function(){this._captionSide=a(this).css("caption-side")});w=a(this).children("thead");0===w.length&&(w=a("<thead/>").appendTo(this));x.nTHead=w[0];w=a(this).children("tbody");0===w.length&&(w=a("<tbody/>").appendTo(this));
x.nTBody=w[0];w=a(this).children("tfoot");0===w.length&&0<y.length&&(""!==x.oScroll.sX||""!==x.oScroll.sY)&&(w=a("<tfoot/>").appendTo(this));0===w.length||0===w.children().length?a(this).addClass(z.sNoFooter):0<w.length&&(x.nTFoot=w[0],Y(x.aoFooter,x.nTFoot));if(q.aaData)for(y=0;y<q.aaData.length;y++)h(x,q.aaData[y]);else(x.bDeferLoading||"dom"==ja(x))&&C(x,a(x.nTBody).children("tr"));x.aiDisplay=x.aiDisplayMaster.slice();x.bInitialised=!0;!1===S&&Ta(x)}});l=null;return this};var Ob=[],ga=Array.prototype,
Tb=function(b){var c,d,e=D.settings,h=a.map(e,function(a,b){return a.nTable});if(b){if(b.nTable&&b.oApi)return[b];if(b.nodeName&&"table"===b.nodeName.toLowerCase())return c=a.inArray(b,h),-1!==c?[e[c]]:null;if(b&&"function"===typeof b.settings)return b.settings().toArray();"string"===typeof b?d=a(b):b instanceof a&&(d=b)}else return[];if(d)return d.map(function(b){c=a.inArray(this,h);return-1!==c?e[c]:null}).toArray()};T=function(b,c){if(!this instanceof T)throw"DT API must be constructed as a new object";
var d=[],e=function(a){(a=Tb(a))&&d.push.apply(d,a)};if(a.isArray(b))for(var h=0,f=b.length;h<f;h++)e(b[h]);else e(b);this.context=gb(d);c&&this.push.apply(this,c.toArray?c.toArray():c);this.selector={rows:null,cols:null,opts:null};T.extend(this,this,Ob)};D.Api=T;T.prototype={concat:ga.concat,context:[],each:function(a){for(var b=0,c=this.length;b<c;b++)a.call(this,this[b],b,this);return this},eq:function(a){var b=this.context;return b.length>a?new T(b[a],this[a]):null},filter:function(a){var b=[];
if(ga.filter)b=ga.filter.call(this,a,this);else for(var c=0,d=this.length;c<d;c++)a.call(this,this[c],c,this)&&b.push(this[c]);return new T(this.context,b)},flatten:function(){var a=[];return new T(this.context,a.concat.apply(a,this.toArray()))},join:ga.join,indexOf:ga.indexOf||function(a,b){for(var c=b||0,d=this.length;c<d;c++)if(this[c]===a)return c;return-1},iterator:function(a,c,d,e){var h=[],f,g,l,k,n,m=this.context,q,y,w=this.selector;"string"===typeof a&&(e=d,d=c,c=a,a=!1);g=0;for(l=m.length;g<
l;g++){var z=new T(m[g]);if("table"===c)f=d.call(z,m[g],g),f!==b&&h.push(f);else if("columns"===c||"rows"===c)f=d.call(z,m[g],this[g],g),f!==b&&h.push(f);else if("column"===c||"column-rows"===c||"row"===c||"cell"===c)for(y=this[g],"column-rows"===c&&(q=jb(m[g],w.opts)),k=0,n=y.length;k<n;k++)f=y[k],f="cell"===c?d.call(z,m[g],f.row,f.column,g,k):d.call(z,m[g],f,g,k,q),f!==b&&h.push(f)}return h.length||e?(a=new T(m,a?h.concat.apply([],h):h),c=a.selector,c.rows=w.rows,c.cols=w.cols,c.opts=w.opts,a):
this},lastIndexOf:ga.lastIndexOf||function(a,b){return this.indexOf.apply(this.toArray.reverse(),arguments)},length:0,map:function(a){var b=[];if(ga.map)b=ga.map.call(this,a,this);else for(var c=0,d=this.length;c<d;c++)b.push(a.call(this,this[c],c));return new T(this.context,b)},pluck:function(a){return this.map(function(b){return b[a]})},pop:ga.pop,push:ga.push,reduce:ga.reduce||function(a,b){return l(this,a,b,0,this.length,1)},reduceRight:ga.reduceRight||function(a,b){return l(this,a,b,this.length-
1,-1,-1)},reverse:ga.reverse,selector:null,shift:ga.shift,sort:ga.sort,splice:ga.splice,toArray:function(){return ga.slice.call(this)},to$:function(){return a(this)},toJQuery:function(){return a(this)},unique:function(){return new T(this.context,gb(this))},unshift:ga.unshift};T.extend=function(b,c,d){if(c&&(c instanceof T||c.__dt_wrapper)){var e,h,f,g=function(a,b,c){return function(){var d=b.apply(a,arguments);T.extend(d,d,c.methodExt);return d}};e=0;for(h=d.length;e<h;e++)f=d[e],c[f.name]="function"===
typeof f.val?g(b,f.val,f):a.isPlainObject(f.val)?{}:f.val,c[f.name].__dt_wrapper=!0,T.extend(b,c[f.name],f.propExt)}};T.register=K=function(b,c){if(a.isArray(b))for(var d=0,e=b.length;d<e;d++)T.register(b[d],c);else for(var h=b.split("."),f=Ob,g,l,d=0,e=h.length;d<e;d++){g=(l=-1!==h[d].indexOf("()"))?h[d].replace("()",""):h[d];var k;a:{k=0;for(var m=f.length;k<m;k++)if(f[k].name===g){k=f[k];break a}k=null}k||(k={name:g,val:{},methodExt:[],propExt:[]},f.push(k));d===e-1?k.val=c:f=l?k.methodExt:k.propExt}};
T.registerPlural=aa=function(c,d,e){T.register(c,e);T.register(d,function(){var c=e.apply(this,arguments);return c===this?this:c instanceof T?c.length?a.isArray(c[0])?new T(c.context,c[0]):c[0]:b:c})};var Ya=function(b,c){if("number"===typeof b)return[c[b]];var d=a.map(c,function(a,b){return a.nTable});return a(d).filter(b).map(function(b){b=a.inArray(this,d);return c[b]}).toArray()};K("tables()",function(a){return a?new T(Ya(a,this.context)):this});K("table()",function(a){a=this.tables(a);var b=
a.context;return b.length?new T(b[0]):a});aa("tables().nodes()","table().node()",function(){return this.iterator("table",function(a){return a.nTable},1)});aa("tables().body()","table().body()",function(){return this.iterator("table",function(a){return a.nTBody},1)});aa("tables().header()","table().header()",function(){return this.iterator("table",function(a){return a.nTHead},1)});aa("tables().footer()","table().footer()",function(){return this.iterator("table",function(a){return a.nTFoot},1)});aa("tables().containers()",
"table().container()",function(){return this.iterator("table",function(a){return a.nTableWrapper},1)});K("draw()",function(a){return this.iterator("table",function(b){ba(b,!1===a)})});K("page()",function(a){return a===b?this.page.info().page:this.iterator("table",function(b){ya(b,a)})});K("page.info()",function(a){if(0===this.context.length)return b;a=this.context[0];var c=a._iDisplayStart,d=a._iDisplayLength,e=a.fnRecordsDisplay(),h=-1===d;return{page:h?0:Math.floor(c/d),pages:h?1:Math.ceil(e/d),
start:c,end:a.fnDisplayEnd(),length:d,recordsTotal:a.fnRecordsTotal(),recordsDisplay:e}});K("page.len()",function(a){return a===b?0!==this.context.length?this.context[0]._iDisplayLength:b:this.iterator("table",function(b){ta(b,a)})});var yb=function(a,b,c){"ssp"==ja(a)?ba(a,b):(V(a,!0),va(a,[],function(c){O(a);c=wa(a,c);for(var d=0,e=c.length;d<e;d++)h(a,c[d]);ba(a,b);V(a,!1)}));if(c){var d=new T(a);d.one("draw",function(){c(d.ajax.json())})}};K("ajax.json()",function(){var a=this.context;if(0<a.length)return a[0].json});
K("ajax.params()",function(){var a=this.context;if(0<a.length)return a[0].oAjaxData});K("ajax.reload()",function(a,b){return this.iterator("table",function(c){yb(c,!1===b,a)})});K("ajax.url()",function(c){var d=this.context;if(c===b){if(0===d.length)return b;d=d[0];return d.ajax?a.isPlainObject(d.ajax)?d.ajax.url:d.ajax:d.sAjaxSource}return this.iterator("table",function(b){a.isPlainObject(b.ajax)?b.ajax.url=c:b.ajax=c})});K("ajax.url().load()",function(a,b){return this.iterator("table",function(c){yb(c,
!1===b,a)})});var Za=function(c,d){var e=[],h,f,g,l,k,m;h=typeof c;c&&"string"!==h&&"function"!==h&&c.length!==b||(c=[c]);g=0;for(l=c.length;g<l;g++)for(f=c[g]&&c[g].split?c[g].split(","):[c[g]],k=0,m=f.length;k<m;k++)(h=d("string"===typeof f[k]?a.trim(f[k]):f[k]))&&h.length&&e.push.apply(e,h);return e},hb=function(a){a||(a={});a.filter&&!a.search&&(a.search=a.filter);return{search:a.search||"none",order:a.order||"current",page:a.page||"all"}},ib=function(a){for(var b=0,c=a.length;b<c;b++)if(0<a[b].length)return a[0]=
a[b],a.length=1,a.context=[a.context[b]],a;a.length=0;return a},jb=function(b,c){var d,e,h,f=[],g=b.aiDisplay;d=b.aiDisplayMaster;var l=c.search;e=c.order;h=c.page;if("ssp"==ja(b))return"removed"===l?[]:Ka(0,d.length);if("current"==h)for(d=b._iDisplayStart,e=b.fnDisplayEnd();d<e;d++)f.push(g[d]);else if("current"==e||"applied"==e)f="none"==l?d.slice():"applied"==l?g.slice():a.map(d,function(b,c){return-1===a.inArray(b,g)?b:null});else if("index"==e||"original"==e)for(d=0,e=b.aoData.length;d<e;d++)"none"==
l?f.push(d):(h=a.inArray(d,g),(-1===h&&"removed"==l||0<=h&&"applied"==l)&&f.push(d));return f},Ub=function(b,c,d){return Za(c,function(c){var e=Mb(c);if(null!==e&&!d)return[e];var h=jb(b,d);if(null!==e&&-1!==a.inArray(e,h))return[e];if(!c)return h;if("function"===typeof c)return a.map(h,function(a){var d=b.aoData[a];return c(a,d._aData,d.nTr)?a:null});e=ab(Na(b.aoData,h,"nTr"));return c.nodeName&&-1!==a.inArray(c,e)?[c._DT_RowIndex]:a(e).filter(c).map(function(){return this._DT_RowIndex}).toArray()})};
K("rows()",function(c,d){c===b?c="":a.isPlainObject(c)&&(d=c,c="");d=hb(d);var e=this.iterator("table",function(a){return Ub(a,c,d)},1);e.selector.rows=c;e.selector.opts=d;return e});K("rows().nodes()",function(){return this.iterator("row",function(a,c){return a.aoData[c].nTr||b},1)});K("rows().data()",function(){return this.iterator(!0,"rows",function(a,b){return Na(a.aoData,b,"_aData")},1)});aa("rows().cache()","row().cache()",function(a){return this.iterator("row",function(b,c){var d=b.aoData[c];
return"search"===a?d._aFilterData:d._aSortData},1)});aa("rows().invalidate()","row().invalidate()",function(a){return this.iterator("row",function(b,c){U(b,c,a)})});aa("rows().indexes()","row().index()",function(){return this.iterator("row",function(a,b){return b},1)});aa("rows().remove()","row().remove()",function(){var b=this;return this.iterator("row",function(c,d,e){var h=c.aoData;h.splice(d,1);for(var f=0,g=h.length;f<g;f++)null!==h[f].nTr&&(h[f].nTr._DT_RowIndex=f);a.inArray(d,c.aiDisplay);
M(c.aiDisplayMaster,d);M(c.aiDisplay,d);M(b[e],d,!1);tb(c)})});K("rows.add()",function(a){var b=this.iterator("table",function(b){var c,d,e,f=[];d=0;for(e=a.length;d<e;d++)c=a[d],c.nodeName&&"TR"===c.nodeName.toUpperCase()?f.push(C(b,c)[0]):f.push(h(b,c));return f},1),c=this.rows(-1);c.pop();c.push.apply(c,b.toArray());return c});K("row()",function(a,b){return ib(this.rows(a,b))});K("row().data()",function(a){var c=this.context;if(a===b)return c.length&&this.length?c[0].aoData[this[0]]._aData:b;c[0].aoData[this[0]]._aData=
a;U(c[0],this[0],"data");return this});K("row().node()",function(){var a=this.context;return a.length&&this.length?a[0].aoData[this[0]].nTr||null:null});K("row.add()",function(b){b instanceof a&&b.length&&(b=b[0]);var c=this.iterator("table",function(a){return b.nodeName&&"TR"===b.nodeName.toUpperCase()?C(a,b)[0]:h(a,b)});return this.row(c[0])});var F=function(b,c,d,e){var h=[],f=function(c,d){if(c.nodeName&&"tr"===c.nodeName.toLowerCase())h.push(c);else{var e=a("<tr><td/></tr>").addClass(d);a("td",
e).addClass(d).html(c)[0].colSpan=G(b);h.push(e[0])}};if(a.isArray(d)||d instanceof a)for(var g=0,l=d.length;g<l;g++)f(d[g],e);else f(d,e);c._details&&c._details.remove();c._details=a(h);c._detailsShow&&c._details.insertAfter(c.nTr)},Pb=function(a,c){var d=a.context;d.length&&(d=d[0].aoData[c!==b?c:a[0]],d._details&&(d._details.remove(),d._detailsShow=b,d._details=b))},Fa=function(a,b){var c=a.context;if(c.length&&a.length){var d=c[0].aoData[a[0]];d._details&&((d._detailsShow=b)?d._details.insertAfter(d.nTr):
d._details.detach(),Xb(c[0]))}},Xb=function(a){var b=new T(a),c=a.aoData;b.off("draw.dt.DT_details column-visibility.dt.DT_details destroy.dt.DT_details");0<xa(c,"_details").length&&(b.on("draw.dt.DT_details",function(d,e){a===e&&b.rows({page:"current"}).eq(0).each(function(a){a=c[a];a._detailsShow&&a._details.insertAfter(a.nTr)})}),b.on("column-visibility.dt.DT_details",function(b,d,e,h){if(a===d)for(d=G(d),e=0,h=c.length;e<h;e++)b=c[e],b._details&&b._details.children("td[colspan]").attr("colspan",
d)}),b.on("destroy.dt.DT_details",function(d,e){if(a===e)for(var h=0,f=c.length;h<f;h++)c[h]._details&&Pb(b,h)}))};K("row().child()",function(a,c){var d=this.context;if(a===b)return d.length&&this.length?d[0].aoData[this[0]]._details:b;!0===a?this.child.show():!1===a?Pb(this):d.length&&this.length&&F(d[0],d[0].aoData[this[0]],a,c);return this});K(["row().child.show()","row().child().show()"],function(a){Fa(this,!0);return this});K(["row().child.hide()","row().child().hide()"],function(){Fa(this,!1);
return this});K(["row().child.remove()","row().child().remove()"],function(){Pb(this);return this});K("row().child.isShown()",function(){var a=this.context;return a.length&&this.length?a[0].aoData[this[0]]._detailsShow||!1:!1});var Yb=/^(.+):(name|visIdx|visible)$/,Vb=function(a,b,c,d,e){c=[];d=0;for(var h=e.length;d<h;d++)c.push(w(a,e[d],b));return c},Zb=function(b,c,d){var e=b.aoColumns,h=xa(e,"sName"),f=xa(e,"nTh");return Za(c,function(c){var g=Mb(c);if(""===c)return Ka(e.length);if(null!==g)return[0<=
g?g:e.length+g];if("function"===typeof c){var l=jb(b,d);return a.map(e,function(a,d){return c(d,Vb(b,d,0,0,l),f[d])?d:null})}var k="string"===typeof c?c.match(Yb):"";if(k)switch(k[2]){case "visIdx":case "visible":g=parseInt(k[1],10);if(0>g){var m=a.map(e,function(a,b){return a.bVisible?b:null});return[m[m.length+g]]}return[B(b,g)];case "name":return a.map(h,function(a,b){return a===k[1]?b:null})}else return a(f).filter(c).map(function(){return a.inArray(this,f)}).toArray()})};K("columns()",function(c,
d){c===b?c="":a.isPlainObject(c)&&(d=c,c="");d=hb(d);var e=this.iterator("table",function(a){return Zb(a,c,d)},1);e.selector.cols=c;e.selector.opts=d;return e});aa("columns().header()","column().header()",function(a,b){return this.iterator("column",function(a,b){return a.aoColumns[b].nTh},1)});aa("columns().footer()","column().footer()",function(a,b){return this.iterator("column",function(a,b){return a.aoColumns[b].nTf},1)});aa("columns().data()","column().data()",function(){return this.iterator("column-rows",
Vb,1)});aa("columns().dataSrc()","column().dataSrc()",function(){return this.iterator("column",function(a,b){return a.aoColumns[b].mData},1)});aa("columns().cache()","column().cache()",function(a){return this.iterator("column-rows",function(b,c,d,e,h){return Na(b.aoData,h,"search"===a?"_aFilterData":"_aSortData",c)},1)});aa("columns().nodes()","column().nodes()",function(){return this.iterator("column-rows",function(a,b,c,d,e){return Na(a.aoData,e,"anCells",b)},1)});aa("columns().visible()","column().visible()",
function(c,d){return this.iterator("column",function(e,h){if(c===b)return e.aoColumns[h].bVisible;var f=e.aoColumns,g=f[h],l=e.aoData,k,m,n;if(c!==b&&g.bVisible!==c){if(c){var y=a.inArray(!0,xa(f,"bVisible"),h+1);k=0;for(m=l.length;k<m;k++)n=l[k].nTr,f=l[k].anCells,n&&n.insertBefore(f[h],f[y]||null)}else a(xa(e.aoData,"anCells",h)).detach();g.bVisible=c;Z(e,e.aoHeader);Z(e,e.aoFooter);if(d===b||d)q(e),(e.oScroll.sX||e.oScroll.sY)&&Oa(e);ea(e,null,"column-visibility",[e,h,c]);ma(e)}})});aa("columns().indexes()",
"column().index()",function(a){return this.iterator("column",function(b,c){return"visible"===a?x(b,c):c},1)});K("columns.adjust()",function(){return this.iterator("table",function(a){q(a)},1)});K("column.index()",function(a,b){if(0!==this.context.length){var c=this.context[0];if("fromVisible"===a||"toData"===a)return B(c,b);if("fromData"===a||"toVisible"===a)return x(c,b)}});K("column()",function(a,b){return ib(this.columns(a,b))});var $b=function(c,d,e){var h=c.aoData,f=jb(c,e);e=ab(Na(h,f,"anCells"));
var g=a([].concat.apply([],e)),l,k=c.aoColumns.length,m,n,q,y,z,C;return Za(d,function(d){var e="function"===typeof d;if(null===d||d===b||e){m=[];n=0;for(q=f.length;n<q;n++)for(l=f[n],y=0;y<k;y++)z={row:l,column:y},e?(C=c.aoData[l],d(z,w(c,l,y),C.anCells[y])&&m.push(z)):m.push(z);return m}return a.isPlainObject(d)?[d]:g.filter(d).map(function(b,c){l=c.parentNode._DT_RowIndex;return{row:l,column:a.inArray(c,h[l].anCells)}}).toArray()})};K("cells()",function(c,d,e){a.isPlainObject(c)&&(typeof c.row!==
b?(e=d,d=null):(e=c,c=null));a.isPlainObject(d)&&(e=d,d=null);if(null===d||d===b)return this.iterator("table",function(a){return $b(a,c,hb(e))});var h=this.columns(d,e),f=this.rows(c,e),g,l,k,m,n,q=this.iterator("table",function(a,b){g=[];l=0;for(k=f[b].length;l<k;l++)for(m=0,n=h[b].length;m<n;m++)g.push({row:f[b][l],column:h[b][m]});return g},1);a.extend(q.selector,{cols:d,rows:c,opts:e});return q});aa("cells().nodes()","cell().node()",function(){return this.iterator("cell",function(a,c,d){return(a=
a.aoData[c].anCells)?a[d]:b},1)});K("cells().data()",function(){return this.iterator("cell",function(a,b,c){return w(a,b,c)},1)});aa("cells().cache()","cell().cache()",function(a){a="search"===a?"_aFilterData":"_aSortData";return this.iterator("cell",function(b,c,d){return b.aoData[c][a][d]},1)});aa("cells().render()","cell().render()",function(a){return this.iterator("cell",function(b,c,d){return w(b,c,d,a)},1)});aa("cells().indexes()","cell().index()",function(){return this.iterator("cell",function(a,
b,c){return{row:b,column:c,columnVisible:x(a,c)}},1)});aa("cells().invalidate()","cell().invalidate()",function(a){return this.iterator("cell",function(b,c,d){U(b,c,a,d)})});K("cell()",function(a,b,c){return ib(this.cells(a,b,c))});K("cell().data()",function(a){var c=this.context,d=this[0];if(a===b)return c.length&&d.length?w(c[0],d[0].row,d[0].column):b;z(c[0],d[0].row,d[0].column,a);U(c[0],d[0].row,"data",d[0].column);return this});K("order()",function(c,d){var e=this.context;if(c===b)return 0!==
e.length?e[0].aaSorting:b;"number"===typeof c?c=[[c,d]]:a.isArray(c[0])||(c=Array.prototype.slice.call(arguments));return this.iterator("table",function(a){a.aaSorting=c.slice()})});K("order.listener()",function(a,b,c){return this.iterator("table",function(d){eb(d,a,b,c)})});K(["columns().order()","column().order()"],function(b){var c=this;return this.iterator("table",function(d,e){var h=[];a.each(c[e],function(a,c){h.push([c,b])});d.aaSorting=h})});K("search()",function(c,d,e,h){var f=this.context;
return c===b?0!==f.length?f[0].oPreviousSearch.sSearch:b:this.iterator("table",function(b){b.oFeatures.bFilter&&Q(b,a.extend({},b.oPreviousSearch,{sSearch:c+"",bRegex:null===d?!1:d,bSmart:null===e?!0:e,bCaseInsensitive:null===h?!0:h}),1)})});aa("columns().search()","column().search()",function(c,d,e,h){return this.iterator("column",function(f,g){var l=f.aoPreSearchCols;if(c===b)return l[g].sSearch;f.oFeatures.bFilter&&(a.extend(l[g],{sSearch:c+"",bRegex:null===d?!1:d,bSmart:null===e?!0:e,bCaseInsensitive:null===
h?!0:h}),Q(f,f.oPreviousSearch,1))})});K("state()",function(){return this.context.length?this.context[0].oSavedState:null});K("state.clear()",function(){return this.iterator("table",function(a){a.fnStateSaveCallback.call(a.oInstance,a,{})})});K("state.loaded()",function(){return this.context.length?this.context[0].oLoadedState:null});K("state.save()",function(){return this.iterator("table",function(a){ma(a)})});D.versionCheck=D.fnVersionCheck=function(a){var b=D.version.split(".");a=a.split(".");
for(var c,d,e=0,h=a.length;e<h;e++)if(c=parseInt(b[e],10)||0,d=parseInt(a[e],10)||0,c!==d)return c>d;return!0};D.isDataTable=D.fnIsDataTable=function(b){var c=a(b).get(0),d=!1;a.each(D.settings,function(a,b){if(b.nTable===c||b.nScrollHead===c||b.nScrollFoot===c)d=!0});return d};D.tables=D.fnTables=function(b){return a.map(D.settings,function(c){if(!b||b&&a(c.nTable).is(":visible"))return c.nTable})};D.util={throttle:Da,escapeRegex:cb};D.camelToHungarian=g;K("$()",function(b,c){var d=this.rows(c).nodes(),
d=a(d);return a([].concat(d.filter(b).toArray(),d.find(b).toArray()))});a.each(["on","one","off"],function(b,c){K(c+"()",function(){var b=Array.prototype.slice.call(arguments);b[0].match(/\.dt\b/)||(b[0]+=".dt");var d=a(this.tables().nodes());d[c].apply(d,b);return this})});K("clear()",function(){return this.iterator("table",function(a){O(a)})});K("settings()",function(){return new T(this.context,this.context)});K("data()",function(){return this.iterator("table",function(a){return xa(a.aoData,"_aData")}).flatten()});
K("destroy()",function(b){b=b||!1;return this.iterator("table",function(d){var e=d.nTableWrapper.parentNode,h=d.oClasses,f=d.nTable,g=d.nTBody,l=d.nTHead,k=d.nTFoot,m=a(f),g=a(g),n=a(d.nTableWrapper),q=a.map(d.aoData,function(a){return a.nTr}),y;d.bDestroying=!0;ea(d,"aoDestroyCallback","destroy",[d]);b||(new T(d)).columns().visible(!0);n.unbind(".DT").find(":not(tbody *)").unbind(".DT");a(c).unbind(".DT-"+d.sInstance);f!=l.parentNode&&(m.children("thead").detach(),m.append(l));k&&f!=k.parentNode&&
(m.children("tfoot").detach(),m.append(k));m.detach();n.detach();d.aaSorting=[];d.aaSortingFixed=[];$a(d);a(q).removeClass(d.asStripeClasses.join(" "));a("th, td",l).removeClass(h.sSortable+" "+h.sSortableAsc+" "+h.sSortableDesc+" "+h.sSortableNone);d.bJUI&&(a("th span."+h.sSortIcon+", td span."+h.sSortIcon,l).detach(),a("th, td",l).each(function(){var b=a("div."+h.sSortJUIWrapper,this);a(this).append(b.contents());b.detach()}));!b&&e&&e.insertBefore(f,d.nTableReinsertBefore);g.children().detach();
g.append(q);m.css("width",d.sDestroyWidth).removeClass(h.sTable);(y=d.asDestroyStripes.length)&&g.children().each(function(b){a(this).addClass(d.asDestroyStripes[b%y])});e=a.inArray(d,D.settings);-1!==e&&D.settings.splice(e,1)})});D.version="1.10.4";D.settings=[];D.models={};D.models.oSearch={bCaseInsensitive:!0,sSearch:"",bRegex:!1,bSmart:!0};D.models.oRow={nTr:null,anCells:null,_aData:[],_aSortData:null,_aFilterData:null,_sFilterRow:null,_sRowStripe:"",src:null};D.models.oColumn={idx:null,aDataSort:null,
asSorting:null,bSearchable:null,bSortable:null,bVisible:null,_sManualType:null,_bAttrSrc:!1,fnCreatedCell:null,fnGetData:null,fnSetData:null,mData:null,mRender:null,nTh:null,nTf:null,sClass:null,sContentPadding:null,sDefaultContent:null,sName:null,sSortDataType:"std",sSortingClass:null,sSortingClassJUI:null,sTitle:null,sType:null,sWidth:null,sWidthOrig:null};D.defaults={aaData:null,aaSorting:[[0,"asc"]],aaSortingFixed:[],ajax:null,aLengthMenu:[10,25,50,100],aoColumns:null,aoColumnDefs:null,aoSearchCols:[],
asStripeClasses:null,bAutoWidth:!0,bDeferRender:!1,bDestroy:!1,bFilter:!0,bInfo:!0,bJQueryUI:!1,bLengthChange:!0,bPaginate:!0,bProcessing:!1,bRetrieve:!1,bScrollCollapse:!1,bServerSide:!1,bSort:!0,bSortMulti:!0,bSortCellsTop:!1,bSortClasses:!0,bStateSave:!1,fnCreatedRow:null,fnDrawCallback:null,fnFooterCallback:null,fnFormatNumber:function(a){return a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,this.oLanguage.sThousands)},fnHeaderCallback:null,fnInfoCallback:null,fnInitComplete:null,fnPreDrawCallback:null,
fnRowCallback:null,fnServerData:null,fnServerParams:null,fnStateLoadCallback:function(a){try{return JSON.parse((-1===a.iStateDuration?sessionStorage:localStorage).getItem("DataTables_"+a.sInstance+"_"+location.pathname))}catch(b){}},fnStateLoadParams:null,fnStateLoaded:null,fnStateSaveCallback:function(a,b){try{(-1===a.iStateDuration?sessionStorage:localStorage).setItem("DataTables_"+a.sInstance+"_"+location.pathname,JSON.stringify(b))}catch(c){}},fnStateSaveParams:null,iStateDuration:7200,iDeferLoading:null,
iDisplayLength:10,iDisplayStart:0,iTabIndex:0,oClasses:{},oLanguage:{oAria:{sSortAscending:": activate to sort column ascending",sSortDescending:": activate to sort column descending"},oPaginate:{sFirst:"First",sLast:"Last",sNext:"Next",sPrevious:"Previous"},sEmptyTable:"No data available in table",sInfo:"Showing _START_ to _END_ of _TOTAL_ entries",sInfoEmpty:"Showing 0 to 0 of 0 entries",sInfoFiltered:"(filtered from _MAX_ total entries)",sInfoPostFix:"",sDecimal:"",sThousands:",",sLengthMenu:"Show _MENU_ entries",
sLoadingRecords:"Loading...",sProcessing:"Processing...",sSearch:"Search:",sSearchPlaceholder:"",sUrl:"",sZeroRecords:"No matching records found"},oSearch:a.extend({},D.models.oSearch),sAjaxDataProp:"data",sAjaxSource:null,sDom:"lfrtip",searchDelay:null,sPaginationType:"simple_numbers",sScrollX:"",sScrollXInner:"",sScrollY:"",sServerMethod:"GET",renderer:null};k(D.defaults);D.defaults.column={aDataSort:null,iDataSort:-1,asSorting:["asc","desc"],bSearchable:!0,bSortable:!0,bVisible:!0,fnCreatedCell:null,
mData:null,mRender:null,sCellType:"td",sClass:"",sContentPadding:"",sDefaultContent:null,sName:"",sSortDataType:"std",sTitle:null,sType:null,sWidth:null};k(D.defaults.column);D.models.oSettings={oFeatures:{bAutoWidth:null,bDeferRender:null,bFilter:null,bInfo:null,bLengthChange:null,bPaginate:null,bProcessing:null,bServerSide:null,bSort:null,bSortMulti:null,bSortClasses:null,bStateSave:null},oScroll:{bCollapse:null,iBarWidth:0,sX:null,sXInner:null,sY:null},oLanguage:{fnInfoCallback:null},oBrowser:{bScrollOversize:!1,
bScrollbarLeft:!1},ajax:null,aanFeatures:[],aoData:[],aiDisplay:[],aiDisplayMaster:[],aoColumns:[],aoHeader:[],aoFooter:[],oPreviousSearch:{},aoPreSearchCols:[],aaSorting:null,aaSortingFixed:[],asStripeClasses:null,asDestroyStripes:[],sDestroyWidth:0,aoRowCallback:[],aoHeaderCallback:[],aoFooterCallback:[],aoDrawCallback:[],aoRowCreatedCallback:[],aoPreDrawCallback:[],aoInitComplete:[],aoStateSaveParams:[],aoStateLoadParams:[],aoStateLoaded:[],sTableId:"",nTable:null,nTHead:null,nTFoot:null,nTBody:null,
nTableWrapper:null,bDeferLoading:!1,bInitialised:!1,aoOpenRows:[],sDom:null,searchDelay:null,sPaginationType:"two_button",iStateDuration:0,aoStateSave:[],aoStateLoad:[],oSavedState:null,oLoadedState:null,sAjaxSource:null,sAjaxDataProp:null,bAjaxDataGet:!0,jqXHR:null,json:b,oAjaxData:b,fnServerData:null,aoServerParams:[],sServerMethod:null,fnFormatNumber:null,aLengthMenu:null,iDraw:0,bDrawing:!1,iDrawError:-1,_iDisplayLength:10,_iDisplayStart:0,_iRecordsTotal:0,_iRecordsDisplay:0,bJUI:null,oClasses:{},
bFiltered:!1,bSorted:!1,bSortCellsTop:null,oInit:null,aoDestroyCallback:[],fnRecordsTotal:function(){return"ssp"==ja(this)?1*this._iRecordsTotal:this.aiDisplayMaster.length},fnRecordsDisplay:function(){return"ssp"==ja(this)?1*this._iRecordsDisplay:this.aiDisplay.length},fnDisplayEnd:function(){var a=this._iDisplayLength,b=this._iDisplayStart,c=b+a,d=this.aiDisplay.length,e=this.oFeatures,h=e.bPaginate;return e.bServerSide?!1===h||-1===a?b+d:Math.min(b+a,this._iRecordsDisplay):!h||c>d||-1===a?d:c},
oInstance:null,sInstance:null,iTabIndex:0,nScrollHead:null,nScrollFoot:null,aLastSort:[],oPlugins:{}};D.ext=la={classes:{},errMode:"alert",feature:[],search:[],internal:{},legacy:{ajax:null},pager:{},renderer:{pageButton:{},header:{}},order:{},type:{detect:[],search:{},order:{}},_unique:0,fnVersionCheck:D.fnVersionCheck,iApiIndex:0,oJUIClasses:{},sVersion:D.version};a.extend(la,{afnFiltering:la.search,aTypes:la.type.detect,ofnSearch:la.type.search,oSort:la.type.order,afnSortData:la.order,aoFeatures:la.feature,
oApi:la.internal,oStdClasses:la.classes,oPagination:la.pager});a.extend(D.ext.classes,{sTable:"dataTable",sNoFooter:"no-footer",sPageButton:"paginate_button",sPageButtonActive:"current",sPageButtonDisabled:"disabled",sStripeOdd:"odd",sStripeEven:"even",sRowEmpty:"dataTables_empty",sWrapper:"dataTables_wrapper",sFilter:"dataTables_filter",sInfo:"dataTables_info",sPaging:"dataTables_paginate paging_",sLength:"dataTables_length",sProcessing:"dataTables_processing",sSortAsc:"sorting_asc",sSortDesc:"sorting_desc",
sSortable:"sorting",sSortableAsc:"sorting_asc_disabled",sSortableDesc:"sorting_desc_disabled",sSortableNone:"sorting_disabled",sSortColumn:"sorting_",sFilterInput:"",sLengthSelect:"",sScrollWrapper:"dataTables_scroll",sScrollHead:"dataTables_scrollHead",sScrollHeadInner:"dataTables_scrollHeadInner",sScrollBody:"dataTables_scrollBody",sScrollFoot:"dataTables_scrollFoot",sScrollFootInner:"dataTables_scrollFootInner",sHeaderTH:"",sFooterTH:"",sSortJUIAsc:"",sSortJUIDesc:"",sSortJUI:"",sSortJUIAscAllowed:"",
sSortJUIDescAllowed:"",sSortJUIWrapper:"",sSortIcon:"",sJUIHeader:"",sJUIFooter:""});(function(){var b="",b="",c=b+"ui-state-default",d=b+"css_right ui-icon ui-icon-",b=b+"fg-toolbar ui-toolbar ui-widget-header ui-helper-clearfix";a.extend(D.ext.oJUIClasses,D.ext.classes,{sPageButton:"fg-button ui-button "+c,sPageButtonActive:"ui-state-disabled",sPageButtonDisabled:"ui-state-disabled",sPaging:"dataTables_paginate fg-buttonset ui-buttonset fg-buttonset-multi ui-buttonset-multi paging_",sSortAsc:c+
" sorting_asc",sSortDesc:c+" sorting_desc",sSortable:c+" sorting",sSortableAsc:c+" sorting_asc_disabled",sSortableDesc:c+" sorting_desc_disabled",sSortableNone:c+" sorting_disabled",sSortJUIAsc:d+"triangle-1-n",sSortJUIDesc:d+"triangle-1-s",sSortJUI:d+"carat-2-n-s",sSortJUIAscAllowed:d+"carat-1-n",sSortJUIDescAllowed:d+"carat-1-s",sSortJUIWrapper:"DataTables_sort_wrapper",sSortIcon:"DataTables_sort_icon",sScrollHead:"dataTables_scrollHead "+c,sScrollFoot:"dataTables_scrollFoot "+c,sHeaderTH:c,sFooterTH:c,
sJUIHeader:b+" ui-corner-tl ui-corner-tr",sJUIFooter:b+" ui-corner-bl ui-corner-br"})})();var Wb=D.ext.pager;a.extend(Wb,{simple:function(a,b){return["previous","next"]},full:function(a,b){return["first","previous","next","last"]},simple_numbers:function(a,b){return["previous",Ea(a,b),"next"]},full_numbers:function(a,b){return["first","previous",Ea(a,b),"next","last"]},_numbers:Ea,numbers_length:7});a.extend(!0,D.ext.renderer,{pageButton:{_:function(b,c,d,e,h,f){var g=b.oClasses,l=b.oLanguage.oPaginate,
k,m,n=0,q=function(c,e){var y,w,z,C,t=function(a){ya(b,a.data.action,!0)};y=0;for(w=e.length;y<w;y++)if(C=e[y],a.isArray(C))z=a("<"+(C.DT_el||"div")+"/>").appendTo(c),q(z,C);else{m=k="";switch(C){case "ellipsis":c.append("<span>&hellip;</span>");break;case "first":k=l.sFirst;m=C+(0<h?"":" "+g.sPageButtonDisabled);break;case "previous":k=l.sPrevious;m=C+(0<h?"":" "+g.sPageButtonDisabled);break;case "next":k=l.sNext;m=C+(h<f-1?"":" "+g.sPageButtonDisabled);break;case "last":k=l.sLast;m=C+(h<f-1?"":
" "+g.sPageButtonDisabled);break;default:k=C+1,m=h===C?g.sPageButtonActive:""}k&&(z=a("<a>",{"class":g.sPageButton+" "+m,"aria-controls":b.sTableId,"data-dt-idx":n,tabindex:b.iTabIndex,id:0===d&&"string"===typeof C?b.sTableId+"_"+C:null}).html(k).appendTo(c),sb(z,{action:C},t),n++)}};try{var y=a(p.activeElement).data("dt-idx");q(a(c).empty(),e);null!==y&&a(c).find("[data-dt-idx="+y+"]").focus()}catch(w){}}}});a.extend(D.ext.type.detect,[function(a,b){var c=b.oLanguage.sDecimal;return xb(a,c)?"num"+
c:null},function(a,b){if(!(!a||a instanceof Date||Qb.test(a)&&ub.test(a)))return null;var c=Date.parse(a);return null!==c&&!isNaN(c)||na(a)?"date":null},function(a,b){var c=b.oLanguage.sDecimal;return xb(a,c,!0)?"num-fmt"+c:null},function(a,b){var c=b.oLanguage.sDecimal;return Nb(a,c)?"html-num"+c:null},function(a,b){var c=b.oLanguage.sDecimal;return Nb(a,c,!0)?"html-num-fmt"+c:null},function(a,b){return na(a)||"string"===typeof a&&-1!==a.indexOf("<")?"html":null}]);a.extend(D.ext.type.search,{html:function(a){return na(a)?
a:"string"===typeof a?a.replace(Lb," ").replace(Ma,""):""},string:function(a){return na(a)?a:"string"===typeof a?a.replace(Lb," "):a}});var Bb=function(a,b,c,d){if(0!==a&&(!a||"-"===a))return-Infinity;b&&(a=wb(a,b));a.replace&&(c&&(a=a.replace(c,"")),d&&(a=a.replace(d,"")));return 1*a};a.extend(la.type.order,{"date-pre":function(a){return Date.parse(a)||0},"html-pre":function(a){return na(a)?"":a.replace?a.replace(/<.*?>/g,"").toLowerCase():a+""},"string-pre":function(a){return na(a)?"":"string"===
typeof a?a.toLowerCase():a.toString?a.toString():""},"string-asc":function(a,b){return a<b?-1:a>b?1:0},"string-desc":function(a,b){return a<b?1:a>b?-1:0}});Va("");a.extend(!0,D.ext.renderer,{header:{_:function(b,c,d,e){a(b.nTable).on("order.dt.DT",function(a,h,f,g){b===h&&(a=d.idx,c.removeClass(d.sSortingClass+" "+e.sSortAsc+" "+e.sSortDesc).addClass("asc"==g[a]?e.sSortAsc:"desc"==g[a]?e.sSortDesc:d.sSortingClass))})},jqueryui:function(b,c,d,e){a("<div/>").addClass(e.sSortJUIWrapper).append(c.contents()).append(a("<span/>").addClass(e.sSortIcon+
" "+d.sSortingClassJUI)).appendTo(c);a(b.nTable).on("order.dt.DT",function(a,h,f,g){b===h&&(a=d.idx,c.removeClass(e.sSortAsc+" "+e.sSortDesc).addClass("asc"==g[a]?e.sSortAsc:"desc"==g[a]?e.sSortDesc:d.sSortingClass),c.find("span."+e.sSortIcon).removeClass(e.sSortJUIAsc+" "+e.sSortJUIDesc+" "+e.sSortJUI+" "+e.sSortJUIAscAllowed+" "+e.sSortJUIDescAllowed).addClass("asc"==g[a]?e.sSortJUIAsc:"desc"==g[a]?e.sSortJUIDesc:d.sSortingClassJUI))})}}});D.render={number:function(a,b,c,d){return{display:function(e){var h=
0>e?"-":"";e=Math.abs(parseFloat(e));var f=parseInt(e,10);e=c?b+(e-f).toFixed(c).substring(2):"";return h+(d||"")+f.toString().replace(/\B(?=(\d{3})+(?!\d))/g,a)+e}}}};a.extend(D.ext.internal,{_fnExternApiFunc:Kb,_fnBuildAjax:va,_fnAjaxUpdate:sa,_fnAjaxParameters:Aa,_fnAjaxUpdateDraw:Ba,_fnAjaxDataSrc:wa,_fnAddColumn:e,_fnColumnOptions:t,_fnAdjustColumnSizing:q,_fnVisibleToColumnIndex:B,_fnColumnIndexToVisible:x,_fnVisbleColumns:G,_fnGetColumns:A,_fnColumnTypes:E,_fnApplyColumnDefs:I,_fnHungarianMap:k,
_fnCamelToHungarian:g,_fnLanguageCompat:d,_fnBrowserDetect:r,_fnAddData:h,_fnAddTr:C,_fnNodeToDataIndex:function(a,c){return c._DT_RowIndex!==b?c._DT_RowIndex:null},_fnNodeToColumnIndex:function(b,c,d){return a.inArray(d,b.aoData[c].anCells)},_fnGetCellData:w,_fnSetCellData:z,_fnSplitObjNotation:y,_fnGetObjectDataFn:S,_fnSetObjectDataFn:P,_fnGetDataMaster:J,_fnClearTable:O,_fnDeleteIndex:M,_fnInvalidate:U,_fnGetRowElements:ca,_fnCreateTr:fa,_fnBuildHead:oa,_fnDrawHead:Z,_fnDraw:W,_fnReDraw:ba,_fnAddOptionsHtml:ka,
_fnDetectHeader:Y,_fnGetUniqueThs:ua,_fnFeatureHtmlFilter:X,_fnFilterComplete:Q,_fnFilterCustom:m,_fnFilterColumn:bb,_fnFilter:Cb,_fnFilterCreateSearch:lb,_fnEscapeRegex:cb,_fnFilterData:Ha,_fnFeatureHtmlInfo:zb,_fnUpdateInfo:Sa,_fnInfoMacros:Eb,_fnInitialise:Ta,_fnInitComplete:db,_fnLengthChange:ta,_fnFeatureHtmlLength:kb,_fnFeatureHtmlPaginate:Ua,_fnPageChange:ya,_fnFeatureHtmlProcessing:N,_fnProcessingDisplay:V,_fnFeatureHtmlTable:Ab,_fnScrollDraw:Oa,_fnApplyToChildren:ha,_fnCalculateColumnWidths:za,
_fnThrottle:Da,_fnConvertToWidth:ob,_fnScrollingWidthAdjust:Fb,_fnGetWidestNode:Gb,_fnGetMaxLenString:pb,_fnStringToCss:R,_fnScrollBarWidth:qb,_fnSortFlatten:Ia,_fnSort:Hb,_fnSortAria:Ib,_fnSortListener:rb,_fnSortAttachListener:eb,_fnSortingClasses:$a,_fnSortData:Jb,_fnSaveState:ma,_fnLoadState:Qa,_fnSettingsFromNode:Pa,_fnLog:Ga,_fnMap:qa,_fnBindAction:sb,_fnCallbackReg:pa,_fnCallbackFire:ea,_fnLengthOverflow:tb,_fnRenderer:fb,_fnDataSource:ja,_fnRowAttributes:da,_fnCalculateEnd:function(){}});a.fn.dataTable=
D;a.fn.dataTableSettings=D.settings;a.fn.dataTableExt=D.ext;a.fn.DataTable=function(b){return a(this).dataTable(b).api()};a.each(D,function(b,c){a.fn.DataTable[b]=c});return a.fn.dataTable})})(window,document);window.TOONTALK||(window.TOONTALK={});window.TOONTALK.creators_from_json={};window.TOONTALK.widget=function(c){var p=function(b){var a=this.get_frontside&&this.get_frontside(!0);if(a)return b&&this.rerender(),a.get_element()};c.creators_from_json.top_level=function(b){b=c.widget.create_top_level_widget(b.settings);$(b.get_backside(!0).get_element()).addClass("toontalk-top-level-backside");return b};return{add_standard_widget_functionality:function(b){var a=function(){return!1},k;this.add_sides_functionality(b);this.runnable(b);this.stackable(b);this.animatable(b);this.has_title(b);
this.has_parent(b);this.has_description(b);this.has_listeners(b);this.droppable(b);this.erasable(b);b.top_level_widget=function(){var a;if(k)return k;if(this.is_top_level())return this;if(k=c.UTILITIES.widget_from_jquery($(this.get_frontside_element()).closest(".toontalk-top-level-backside")))return k;if(a=this.get_parent_of_frontside()||this.get_parent_of_backside())return k=a.get_widget().top_level_widget();a=$(".toontalk-top-level-backside");if(0<a.length)return 1<a.length&&console.log("Cannot find the top-level widget of "+
this+" but found "+a.length+" top-level backsides so picked one."),k=c.UTILITIES.widget_from_jquery(a);console.log("Could not find top_level_widget of "+this+". Created one instead");return k=this.create_top_level_widget()};b.is_of_type||(b.is_of_type=function(a){return this.get_type_name()===a});b.dereference||(b.dereference=function(){return this});b.is_number||(b.is_number=a);b.is_box||(b.is_box=a);b.is_empty_hole||(b.is_empty_hole=a);b.is_hole||(b.is_hole=a);b.is_scale||(b.is_scale=a);b.is_bird||
(b.is_bird=a);b.is_nest||(b.is_nest=a);b.is_robot||(b.is_robot=a);b.is_element||(b.is_element=a);b.is_function_nest||(b.is_function_nest=a);b.is_top_level=a;b.is_widget=!0;return b},erasable:function(b){var a;b.get_erased||(b.get_erased=function(){return a});b.set_erased||(b.set_erased=function(b,c){a=b;c&&this.rerender()});return b},add_sides_functionality:function(b){var a,k;b.get_frontside||(b.get_frontside=function(g){g&&!a&&(a=c.frontside.create(b));return a},b.save_dimensions=function(){return this.save_dimensions_of(this)},
b.save_dimensions_of=function(a){var b;if(a.is_element()){if(!this.get_original_width())return;b=a.get_attribute("width");a=a.get_attribute("height")}else a=a.get_frontside_element(),b=$(a).width(),a=$(a).height();0<b&&(this.saved_width=b);0<a&&(this.saved_height=a);return!0},b.restore_dimensions=function(){var a;0<this.saved_width&&(this.set_size_attributes?this.set_size_attributes(this.saved_width,this.saved_height):(a=this.get_frontside_element(),$(a).css({width:this.saved_width,height:this.saved_height})),
this.saved_height=this.saved_width=void 0)});b.get_backside||(b.get_backside=function(a){a&&!k&&(k=this.create_backside());return k});b.set_backside||(b.set_backside=function(a){k=a});b.forget_backside||(b.forget_backside=function(){k=void 0});b.create_backside||(b.create_backside=function(){return c.backside.create(b)});return b},runnable:function(b){var a=!1,c=!1;b.get_running||(b.get_running=function(){var b=!1,c;a&&(c=this.get_backside_widgets(),0===c.length?a=!1:(c.some(function(a){if(a.get_widget().get_running())return b=
!0}),a=b));return a},b.is_ok_to_run=function(){return c});b.set_running||(b.set_running=function(g,d){var n=a===g,f,r;c=g;n&&a||(f=this.get_backside_widgets(),a=g,this.get_backside()&&this.get_backside().run_status_changed(a),f.forEach(function(c){r=c.get_widget();c.is_backside()&&0<=this.backside_widgets.indexOf(r)||(r.is_robot()?c.is_backside()||a&&r.get_running()||(a?(r.set_stopped(!1),r.run(b,d)):(r.set_stopped(!0),r.set_running(!1)),r.rerender()):r.set_running&&(!d&&c.is_backside()&&"top-level"!==
b.get_type_name()?r.set_running(g,b):r.set_running(g)))}.bind(this)),this.walk_children&&this.walk_children(function(b){b.set_running&&b.set_running(a);return!0}),!this.is_robot()||g&&this.get_running()||(g?b.get_parent_of_backside()&&(this.set_stopped(!1),this.run(b.get_parent_of_backside().get_widget(),d)):this.set_stopped(!0)),n||this.rerender())});return b},droppable:function(b){b.drop_on||(b.drop_on=function(a,b,c,d){if(a.widget_dropped_on_me)return a.widget_dropped_on_me(this,b,c,d);console.log("No handler for drop of '"+
this+"' on '"+a+"'")})},stackable:function(b){var a=!1;b.get_infinite_stack||(b.get_infinite_stack=function(){return a});b.set_infinite_stack||(b.set_infinite_stack=function(c){var g=b.get_backside_element(),d=b.get_frontside_element();a=c;g&&$(g).find(".toontalk-infinite-stack-check-box").prop("checked",c);d&&(c?$(d).addClass("toontalk-infinite-stack"):$(d).removeClass("toontalk-infinite-stack"))});return b},animatable:function(b){var a;b.animate_to_widget||(a=function(a){var b=a.get_element();b&&
(a.is_backside()||$(b).is(":visible"))||(b=c.UTILITIES.find_resource_equal_to_widget(a));return b},b.animate_to_widget=function(b,c,d,n,f,r){setTimeout(function(){this.animate_to_element(a(b),c,d,n,f,r);this.render()}.bind(this),100)});b.animate_to_element||(b.animate_to_element=function(a,b,c,n,f,r){var l=$(a).offset(),e=$(this.get_frontside_element()),t=$(a).is(".toontalk-backside");if(a&&$(a).is(":visible")){if("number"===typeof a.animation_left_offset)n=a.animation_left_offset;else if("undefined"===
typeof n||t)n=($(a).width()-e.width())*Math.random();if("number"===typeof a.animation_top_offset)f=a.animation_top_offset;else if("undefined"===typeof f||t)f=($(a).height()-e.height())*Math.random();l?(l.left+=n,l.top+=f):l={left:0,top:0};this.animate_to_absolute_position(l,b,c,r)}else b&&b()});b.animate_to_absolute_position||(b.animate_to_absolute_position=function(a,b,d,n){c.UTILITIES.animate_to_absolute_position(this.get_frontside_element(),a,b,d,n)});return b},has_title:function(b){b.get_title||
(b.get_title=function(){var a=this.get_type_name(),b=this.get_backside(),g=this.get_frontside_element(),d=this.get_description(),n="";$(g).is(".toontalk-top-level-resource")?n=this.can_run&&this.can_run()?this.get_running()?"Click elsewhere to stop me from running. Click on it to start me up again.":"Click to start me running. Click elsewhere to stop me.":"Drag me to a work area.":b&&b.get_element()&&$(b.get_element()).is(":visible")||(n=this.can_run&&this.can_run()?"There are robots are on my back.\nTo see them in action click to open my back side and then click the green flag.":
"Click to see my back side.");d&&(d="I'm "+d,n=n?d+"\n"+n:d);if(this.get_erased())return this.get_title_of_erased_widget();n=this.get_custom_title_prefix&&!$(g).is(".toontalk-top-level-resource")?this.get_custom_title_prefix()+"\n"+n:"I'm "+c.UTILITIES.add_a_or_an(a)+". "+n;n=n.trim();0>".?!".indexOf(n[n.length-1])&&(n+=".");return n});b.update_title=function(){c.UTILITIES.give_tooltip(this.get_frontside_element(),this.get_title())};return b},get_title_of_erased_widget:function(){var b=this.get_frontside_element(),
a=this.get_type_name();return b&&$(b).closest(".toontalk-conditions-contents-container").is("*")?"I'm an erased "+a+".\nI'll match with any other "+a+".":"I'm an erased "+a+".\nDusty the Vacuum can restore me to normal."},has_parent:function(b){var a,c;b.get_parent_of_frontside=function(){return a};b.get_parent_of_backside=function(){return c};b.set_parent_of_frontside=function(b,c,k){var f=a;b&&c&&(b=b.get_backside(!0));if(a===b)return;a=b;f&&!k&&f.is_backside()&&f.get_widget().remove_backside_widget(this,
!1,!0)};b.set_parent_of_backside=function(a,b,n){c&&!n&&c.is_backside()&&c.get_widget().remove_backside_widget(this,!0,!0);c=a&&b?a.get_backside(!0):a};b.closest_visible_ancestor=function(){for(var a=this;a&&!a.visible();)a=a.is_backside()?a.get_parent_of_backside():a.get_parent_of_frontside();return a||this};b.closest_visible_ancestor_or_frontside=function(){for(var a=this,b;a&&!a.visible();)b=a,a.is_backside()?(a=a.get_parent_of_backside())||(a=b.get_widget()):a=a.get_parent_of_frontside();return a||
this};b.ancestor_of_type=function(a){for(var b=this;b&&!b.is_of_type(a);)b=b.is_backside()?b.get_widget().get_parent_of_backside():b.get_parent_of_frontside();return b};b.has_ancestor=function(a){for(var b=this;b;){if(a===b)return!0;b=b.is_backside()?b.get_widget().get_parent_of_backside():b.get_parent_of_frontside()}return!1};b.remove_from_parent_of_frontside=function(b){a&&(a.is_backside()?a.remove_backside_widget(this,!1,!b):a.removed_from_container&&a.removed_from_container(this,!1,b,void 0,!0))};
return b},has_description:function(b){var a;b.get_description||(b.get_description=function(){return a});b.set_description||(b.set_description=function(b,c){if(a===b||!a&&""===b)return!1;a=b;c&&this.rerender();return!0});b.receive_description_from_dropped=function(a){if(a.get_text&&(a=a.get_text(),this.set_description(a,!0)))return this.get_description()}},has_listeners:function(b){var a={};b.add_listener||(b.add_listener=function(b,c){var d=a[b];d?0>d.indexOf(c)&&d.push(c):a[b]=[c]});b.remove_listener||
(b.remove_listener=function(b,g,d){if(b=a[b])if(g=b.indexOf(g),0<=g){b.splice(g,1);return}!d&&c.debugging&&console.log("Listener of type "+type_name+" could not be removed.")});b.get_listeners||(b.get_listeners=function(b){return a[b]})},get_full_description:function(b){var a;if(this.get_erased&&this.get_erased())return b&&"conditions"===b.role?"any "+this.get_type_name():"erased "+this.get_type_name();a=this.get_description(b);b=this.toString(b);return a?b+" ("+a+")":b},remove:function(b){var a=
this.get_backside(),c=this.get_frontside(),g=this.get_parent_of_frontside();this.get_parent_of_backside();a&&a.hide_backside();c&&(c.remove(),g&&this.remove_from_parent_of_frontside(b));this.set_running(!1);this.set_visible(!1);this.walk_children&&this.walk_children(function(a){a.remove&&a.remove();return!0})},get_frontside_element:p,get_element:p,get_backside_element:function(b){if(b=this.get_backside&&this.get_backside(b))return b.get_element()},add_to_json:function(b,a){var c,g,d,n,f;if(b){b.view?
(g=b,c=b.view,b=b.semantic):(c={},g={semantic:b,view:c});g.version=1;this.get_erased&&this.get_erased()&&(b.erased=!0);this.get_infinite_stack&&this.get_infinite_stack()&&(b.infinite_stack=!0);this.get_running&&this.get_running()&&(b.running=!0);if(!this.get_parent_of_frontside()||this.get_parent_of_frontside().is_backside())if(n=this.get_frontside_element&&this.get_frontside_element())f=$(n).width(),$(n).is(".toontalk-plain-text-element")||0===f||(c.frontside_width=$(n).width(),c.frontside_height=
$(n).height()),0!==f&&(d=$(n).position()),d&&(c.frontside_left=d.left,c.frontside_top=d.top);if(n=this.get_backside()){if(f=n.get_element())c.backside_width=$(f).width(),c.backside_height=$(f).height(),c.backside_left||(d=$(f).position(),c.backside_left=d.left,c.backside_top=d.top,"&lt;"===$(f).find(".toontalk-settings-backside-button").html()&&(c.advanced_settings_open=!0));n.get_backside_dimensions()&&(c.backside_geometry=n.get_backside_dimensions())}!c.backside_geometry&&this.backside_geometry&&
(c.backside_geometry=this.backside_geometry);c.saved_width=this.saved_width;c.saved_height=this.saved_height;b.description=this.get_description&&this.get_description();return g}console.log("get_json not defined");return{}},add_backside_widgets_to_json:function(b,a){var k=this.get_backside_widgets(),g;0<k.length&&(b.semantic.backside_widgets=c.UTILITIES.get_json_of_array(k,a),(k=this.get_backside_widgets_json_views())&&k.forEach(function(c,k){var f;if(g=b.semantic.backside_widgets[k]){if(0<=g.widget.shared_widget_index){f=
a.widgets_encountered.indexOf(a.shared_widgets[g.widget.shared_widget_index]);if(!a.json_of_widgets_encountered[f])return;f=a.json_of_widgets_encountered[f].view}else f=g.widget.view;g.is_backside?c.backside_left&&(f.backside_left=c.backside_left,f.backside_top=c.backside_top):c.frontside_left&&(f.frontside_left=c.frontside_left,f.frontside_top=c.frontside_top)}}))},get_backside_widgets:function(){return this.backside_widgets||[]},add_backside_widget:function(b,a){var k=this.get_backside(!0),g=a?
b.get_backside():b;c.debugging&&b===this?c.UTILITIES.report_internal_error("Adding a widget to a list of its backside widgets!"):(this.backside_widgets?0>this.backside_widgets.indexOf(g)&&this.backside_widgets.push(g):this.backside_widgets=[g],a?b.set_parent_of_backside(this,!0):b.set_parent_of_frontside(this,!0),k.visible()&&(g.set_visible(!0),b.render()),this.get_running()&&b.set_running(!0))},remove_all_backside_widgets:function(){if(this.backside_widgets)for(;0<this.backside_widgets.length;)this.backside_widgets[0].remove()},
remove_backside_widget:function(b,a,k){this.get_backside();var g=a?b.get_backside(!0):b,d;c.debugging&&!this.backside_widgets?k?console.log("remove_backside_widget called and there are no backside_widgets"):c.UTILITIES.report_internal_error("Couldn't remove a widget from backside widgets."):(d=this.backside_widgets.indexOf(g),0>d?k?c.debugging&&console.log("Warning: Probable redundant call to remove_backside_widget"):c.UTILITIES.report_internal_error("Couldn't find a widget to remove it from backside widgets. "+
g.get_widget()+" ("+g.get_widget().debug_id+")"):(this.backside_widgets.splice(d,1),this.backside_widgets_json_views&&this.backside_widgets_json_views.splice(d,1),a?(a=b.get_parent_of_backside())&&a.get_widget()===this&&b.set_parent_of_backside(void 0,!0,!0):(a=b.get_parent_of_frontside())&&a.get_widget()===this&&b.set_parent_of_frontside(void 0,void 0,!0),g.set_visible(!1)))},set_backside_widget_sides:function(b,a){var c=this.get_backside(),g=c&&c.visible();this.backside_widgets=b;0<b.length&&(this.get_backside()?
this.get_backside().add_backside_widgets(b,a):this.backside_widgets_json_views=a,b.forEach(function(a){a.is_backside()?a.get_widget().set_parent_of_backside(this,!0):a.get_widget().set_parent_of_frontside(this,!0);a.set_visible(g)}.bind(this)))},get_backside_widgets_json_views:function(b){!this.backside_widgets_json_views&&b&&(this.backside_widgets_json_views=[]);return this.backside_widgets_json_views},can_run:function(){var b=!1,a;this.get_backside_widgets().some(function(c){a=c.get_widget();if(a.get_body&&
!a.get_body().is_empty()||a.can_run())return b=!0});return b},add_to_copy:function(b,a){var k;this.get_erased&&this.get_erased()&&(b.set_erased||c.widget.erasable(b),b.set_erased(this.get_erased()));a&&a.just_value||(k=this.get_backside_widgets(),0<k.length&&b.set_backside_widget_sides(c.UTILITIES.copy_widget_sides(k,a),this.get_backside_widgets_json_views()));b.set_visible(this.visible());return b},get_type_name:function(){return""},copy:function(){console.assert(!1,"copy not implemented")},add_copy_to_container:function(b,
a,k){b||(b=this.copy({}));var g=this.get_frontside_element(),d=b.get_frontside_element(),n=$(g).closest(".toontalk-backside"),f,r;0===n.length&&(n=$(".toontalk-backside"));"undefined"===typeof a&&(a=30);"undefined"===typeof k&&(k=30);f=c.UTILITIES.relative_position(g,n.get(0));r=c.UTILITIES.widget_from_jquery(n);$(d).css({width:$(g).width(),height:$(g).height(),left:f.left+a,top:f.top+k});n.get(0).appendChild(d);r&&r.add_backside_widget(b);this.robot_in_training()&&this.robot_in_training().copied(this,
b,!1);return b},visible:function(){var b=this.get_frontside();return b?b.visible():!1},set_visible:function(b){var a=this.get_frontside(b);a&&a.set_visible(b)},is_backside:function(){return!1},get_parent:function(){return this.get_parent_of_frontside()},drag_started:function(b,a){this.robot_in_training()&&this.robot_in_training().picked_up(this,b,a)},match:function(b){console.assert(!1,"match not implemented for "+b.toString())},removed:function(b){c.UTILITIES.report_internal_error("removed not implemented")},
equals_box:function(){return!1},equals_number:function(){return!1},open_backside:function(b){var a=this.get_backside(),k=b&&function(){setTimeout(b)},g=function(a,b){c.UTILITIES.set_timeout(function(){$(a).addClass("toontalk-side-appearing");c.UTILITIES.add_one_shot_event_handler(a,"transitionend",2500,function(){$(a).removeClass("toontalk-side-appearing");k&&k()});$(a).css({left:r,top:l,opacity:b});this.apply_backside_geometry()}.bind(this))}.bind(this),d,n,f,r,l,e,t,q;if(a){d=a.get_element();if($(d).is(":visible"))return c.UTILITIES.highlight_element(d,
void 0,1E3),k&&k(),a;if((a=this.get_parent_of_backside())&&a.is_backside())return a.get_widget().open_backside(b)}n=this.get_frontside_element();f=$(n).parent();a=$(n);if(a.is(".toontalk-top-level-resource"))k&&k();else{for(;0<f.length&&!f.is(".toontalk-backside");)a=f,f=f.parent();a.get(0);a=this.get_backside(!0);d=a.get_element();d.toontalk_widget=this;e=$(n).offset();t=f.offset();q=f.width();t||(t={left:0,top:0});$(d).css({left:e.left-t.left,top:e.top-t.top,opacity:.01});f.append(d);(f=c.UTILITIES.widget_from_jquery(f))&&
f.add_backside_widget(this,!0);f=this.is_element()?this.get_attribute("height"):$(n).height();n=$(d).width();r=e.left-t.left;r+n>q&&(r=Math.max(0,q-n));l=e.top-t.top+f+26;g(d,"inherit");a.render();this.backside_widgets&&this.backside_widgets.forEach(function(a){a.render();a.set_visible(!0)});return a}},hide_backside:function(){var b=this.get_backside();b&&b.hide_backside()},apply_backside_geometry:function(){var b=this.get_backside(!0),a=b.get_element();this.backside_geometry&&a&&(c.backside.scale_backside($(a),
this.backside_geometry.x_scale,this.backside_geometry.y_scale,this.backside_geometry.original_width,this.backside_geometry.original_height),b.set_dimensions(this.backside_geometry))},robot_in_training:function(){return this.top_level_widget().robot_in_training()},robot_training_this_robot:function(){return this.top_level_widget().robot_training_this_robot()},robot_started_training:function(b){this.top_level_widget().robot_started_training(b)},robot_finished_training:function(){this.top_level_widget().robot_finished_training()},
backup_all:function(b){var a=this.top_level_widget();a&&a.save(b)},render:function(){c.DISPLAY_UPDATES.pending_update(this)},rerender:function(){this.visible()&&this.render()},hide:function(){$(this.get_frontside_element()).hide()},close_button_ok:function(b){return"top-level"!==this.get_type_name()&&!$(b).is(".toontalk-top-level-resource")&&!$(b).closest(".toontalk-conditions-panel").is("*")},get_widget:function(){return this},add_to_top_level_backside:function(b,a){var c=this.top_level_widget(),
g=b.get_frontside_element(!0);c.add_backside_widget(b);c.get_backside_element().appendChild(g);b.render();a&&this.robot_in_training()&&this.robot_in_training().dropped_on(b,c);return g},create_top_level_widget:function(b){var a=Object.create(c.widget),k=[],g=function(){return!1};b||(b={});a.is_top_level=function(){return!0};a.is_number=g;a.is_box=g;a.is_empty_hole=g;a.is_scale=g;a.is_bird=g;a.is_nest=g;a.is_robot=g;a.is_element=g;a.is_function_nest=g;a.is_hole=g;a.get_json=function(a){a=this.get_backside(!0).get_element();
a=document.defaultView.getComputedStyle(a,null).getPropertyValue("background-color");return{semantic:{type:"top_level",settings:b},view:{background_color:a}}};a.get_type_name=function(){return"top-level"};a.is_of_type=function(a){return"top-level"===a};a.toString=function(){return"top level widget"};a.get_description=function(){};a.match=function(){return"matched"};a.update_display=function(){this.backside_widgets&&this.backside_widgets.forEach(function(a){a.visible()&&a.update_display()})};a.copy=
function(){return this};a.visible=function(){return!0};a.get_parent_of_frontside=function(){};a.get_parent_of_backside=function(){};a.closest_visible_ancestor=function(){return this};a.get_infinite_stack=function(){return!1};a.top_level_widget=function(){return this};a=a.add_sides_functionality(a);a=a.runnable(a);a=a.has_parent(a);a.removed_from_container=function(a,b,c,g,l){this.robot_in_training()||this.remove_backside_widget(a,b,l)};a.widget_dropped_on_me=function(a,b,c,g,l){return this.get_backside().widget_dropped_on_me(a,
b,c,g,l)};a.get_element=function(){return this.get_backside().get_element()};a.get_setting=function(a,g){"undefined"!==typeof b[a]||g||(b[a]=c.DEFAULT_SETTINGS&&c.DEFAULT_SETTINGS[a]);return b[a]};a.set_setting=function(a,c){b[a]=c};a.open_settings=function(){c.SETTINGS.open(a)};a.robot_in_training=function(){if(0<k.length)return k[k.length-1]};a.robot_training_this_robot=function(){if(1<k.length)return k[k.length-2]};a.robot_started_training=function(a){k.push(a)};a.robot_finished_training=function(){k.pop()};
a.save=function(a,b,f){var g=this.get_setting("program_name",!0),l;g&&(b||(b={}),"undefined"===typeof b.google_drive&&(b.google_drive=c.google_drive&&this.get_setting("auto_save_to_google_drive")),"undefined"===typeof b.local_storage&&(b.local_storage=this.get_setting("auto_save_to_local_storage")),a?(b.google_drive&&!this.get_setting("google_drive_unavailable")&&(l=c.UTILITIES.get_json_top_level(this),a=c.google_drive.get_status(),"Ready"===a?(c.google_drive.upload_file(g,"json",JSON.stringify(l,
c.UTILITIES.clean_JSON),f),f=void 0):c.google_drive.connection_to_google_drive_possible()&&("Need to authorize"===a?(c.UTILITIES.display_message_if_new("Unable to save to your Google Drive because you need to log in. Click on the settings icon to log in."),c.UTILITIES.display_tooltip($(".toontalk-settings-button"))):console.log("Unable to save to Google Drive because: "+a))),b.local_storage&&(l||(l=c.UTILITIES.get_json_top_level(this)),this.save_to_local_storage(l)),f&&f()):setTimeout(function(){this.save(!0,
b,f)}.bind(this),100))};a.publish=function(a,b){c.publish.publish_widget(this.get_setting("program_name"),this,b,a)};a.save_to_local_storage=function(a,b){var f=this.get_setting("program_name"),g=c.UTILITIES.local_storage_program_key(f),l=c.UTILITIES.local_storage_program_meta_data_key(f),e,k,q;b||(b=Date.now());try{k=(k=window.localStorage.getItem(l))?JSON.parse(k):{created:b},k.last_modified=b,q=JSON.stringify(a,c.UTILITIES.clean_json),k.file_size=q.length,window.localStorage.setItem(l,JSON.stringify(k)),
window.localStorage.setItem(g,q),window.localStorage.setItem("toontalk-last-key",g),e=c.UTILITIES.get_all_locally_stored_program_names(),0>e.indexOf(f)&&(e.push(f),c.UTILITIES.set_all_locally_stored_program_names(e))}catch(p){f=q?"Failed to save state to local storage since it requires "+q.length+" bytes. Error message is "+p:"Error while saving to local storage. Error message is "+p,c.UTILITIES.is_internet_explorer()?console.error(f):c.UTILITIES.display_message(f),this.last_local_storage_error=f}};
a.load=function(b,g,f){var k=this.get_setting("program_name"),l=k+".json",e=c.UTILITIES.local_storage_program_key(k),t=function(b){var d;if(b)try{d=JSON.parse(b),a.remove_all_backside_widgets(),c.UTILITIES.add_backside_widgets_from_json(a,d.semantic.backside_widgets,{json_of_shared_widgets:d.shared_widgets,shared_widgets:[],shared_html:d.shared_html}),g&&g()}catch(e){c.UTILITIES.display_message("Error encountered loading "+k+" : "+e)}else f&&f()},q=function(a){a?c.google_drive.download_file(a,t):
t(window.localStorage.getItem(e))};b&&c.google_drive&&"Ready"===c.google_drive.get_status()?c.google_drive.get_toontalk_program_file(l,q):t(window.localStorage.getItem(e))};a.walk_children=function(){};a.render=function(){};a.is_widget=!0;a.get_backside(!0).set_visible(!0);c.debugging&&(a.debug_id=c.UTILITIES.generate_unique_id(),a.debug_string="Top-level widget");return a}}}(window.TOONTALK);window.TOONTALK.backside=function(c){return{create:function(p){var b=Object.create(this),a=document.createElement("div"),k=$(a),g=1,d=1,n=document.createElement("div"),f=document.createElement("div"),r=p.get_help_URL&&p.get_help_URL(),l,e,t,q,B,x,G,A,E,I,h,C=function(a){a?($(n).addClass("toontalk-green-flag-active").removeClass("toontalk-green-flag-inactive"),$(f).addClass("toontalk-stop-sign-inactive").removeClass("toontalk-stop-sign-active")):($(n).addClass("toontalk-green-flag-inactive").removeClass("toontalk-green-flag-active"),
$(f).addClass("toontalk-stop-sign-active").removeClass("toontalk-stop-sign-inactive"))},w=function(){var a=k.width();k.height();var b,c,d;0===a?setTimeout(w,100):(a=$(f).width(),b=(b=$(G).width())?b+14:0,$(f).css({right:b}),$(n).css({right:b+a+6}),c=$(n).width(),E&&$(E).css({right:b+a+c+12}),l&&(d=$(E).width()||0,$(l).css({right:b+a+c+d+12})))};A=this.create_description_label(b,p);var z=function(){var a;a=p.get_running()?"To stop this click on the stop sign.":p.can_run()?"Click this to start this running.":
"There is nothing to run on this.";c.UTILITIES.give_tooltip(n,a)},y=function(){var a;a=p.get_running()?"Click to stop this from running.":p.can_run()?"This has stopped. Click on the flag to start running it.":"There is nothing to run here.";c.UTILITIES.give_tooltip(f,a)},S,P,J;c.TRANSLATION_ENABLED&&(r=c.UTILITIES.add_URL_parameter(r,"translate","1"));p.close_button_ok(a)&&(P=function(a){b.hide_backside(a);a.stopPropagation();p.robot_in_training()&&p.robot_in_training().backside_closed(p)},S=(S=p.get_description())?
"the "+p.get_type_name()+" who "+S:"the "+p.get_type_name(),G=c.UTILITIES.create_close_button(P,"Click to hide this back side of "+S+"."),a.appendChild(G));$(n).addClass("toontalk-green-flag toontalk-green-flag-inactive").click(function(a){p.can_run()?(C(!0),p.set_running(!0),y()):p.is_top_level()?c.UTILITIES.display_message("There is nothing to run."):c.UTILITIES.display_message("This "+p.get_type_name()+" has nothing to run. Add some robots on the back.");p.robot_in_training()&&p.robot_in_training().button_clicked(".toontalk-green-flag",
p)}).on("mouseenter",y);$(f).addClass("toontalk-stop-sign toontalk-stop-sign-active").click(function(a){C(!1);p.set_running(!1);z();p.robot_in_training()&&p.robot_in_training().button_clicked(".toontalk-stop-sign",p)}).on("mouseenter",z);a.appendChild(n);a.appendChild(f);c.UTILITIES.use_custom_tooltip(n);c.UTILITIES.use_custom_tooltip(f);r&&(E=document.createElement("div"),$(E).addClass("toontalk-help-button notranslate toontalk-widget-help-button").click(function(a){I=document.createElement("iframe");
$(I).addClass("toontalk-help-frame");I.src=r;document.body.appendChild(h);document.body.appendChild(I)}),E.innerHTML="i",E.translate=!1,c.UTILITIES.give_tooltip(E,"Click to learn more about "+p.get_type_name(!0,!0)+"."),h=document.createElement("div"),$(h).addClass("toontalk-close-help-frame-button").button().click(function(a){$(I).remove();$(h).remove()}),h.innerHTML="Return to ToonTalk",a.appendChild(E));A&&a.appendChild(A);p.is_top_level()&&(l=document.createElement("div"),$(l).addClass("toontalk-settings-button").click(function(a){p.open_settings()}),
c.UTILITIES.give_tooltip(l,"Click to change settings or open a different program."),a.appendChild(l));c.UTILITIES.set_timeout(w);k.addClass("toontalk-backside toontalk-side toontalk-backside-of-"+p.get_type_name());k.css({"z-index":c.UTILITIES.next_z_index()});b.get_element=function(){return a};b.get_widget=function(){return p};b.visible=function(){return e};b.set_visible=function(a){var b=this.get_widget().get_backside_widgets();e=a;b.forEach(function(b){b.set_visible(a);a&&b.render()})};p.get_backside||
(p.get_backside=function(){return b});b.get_parent_of_backside=function(){return p.get_parent_of_backside()};b.get_parent_of_frontside=function(){return p.get_parent_of_frontside()};b.get_frontside=function(){return p.get_frontside()};b.get_frontside_element=function(){return p.get_frontside_element()};b.get_description_text_area=function(){return J};b.set_description_text_area=function(a){J=a};p.removed_from_container||(p.removed_from_container=function(a,b,c,d,e){p.robot_in_training()||this.remove_backside_widget(a,
b,e)});b.widget_dropped_on_me=function(a,b,d,e,h){var f,g,l;b?(f=a.get_backside(!0),g=f.get_element(),f.rerender()):(f=a.get_frontside(!0),g=f.get_element(),a.rerender());f=$(g);k.append(f);this.get_widget().is_top_level()&&e&&!e.visible()&&f.addClass("toontalk-widget-added-to-backside-by-unwatched-robot");c.UTILITIES.set_position_is_absolute(g,!0,d);p.robot_in_training()&&!h&&d&&setTimeout(function(){p.robot_in_training().dropped_on(a,this,d)}.bind(this));b&&"top-level"!=this.get_widget().get_type_name()&&
(l=a.get_backside(),a.forget_backside(),a.remove(d),a.set_backside(l));this.add_backside_widget(a,b);a.dropped_on_other&&a.dropped_on_other(this.get_widget(),!0,d,e);d&&a.get_body&&a.get_body().is_empty()&&!a.being_trained&&setTimeout(function(){(l=a.open_backside())&&$(l.get_element()).find(".toontalk-train-backside-button").click()});d&&a.get_widget().backup_all();!this.get_widget().is_ok_to_run()||this.get_widget().get_running()||this.get_widget().is_top_level()||this.get_widget().set_running(!0);
return!0};b.add_backside_widget=function(a,b){return this.get_widget().add_backside_widget(a,b)};b.add_backside_widgets=function(b,d){0!==b.length&&c.UTILITIES.set_timeout(function(){var e=this.visible(),h,f,g;b.forEach(function(b,l){var q=b.get_widget().get_backside();h=b.get_element();h.toontalk_widget=b.get_widget();d&&(f=d[l])&&(b.is_backside()?(g={left:f.backside_left,top:f.backside_top,width:f.backside_width,height:f.backside_height},b.get_widget().apply_backside_geometry(),f.advanced_settings_open&&
q.set_advanced_settings_showing(!0,q.get_element())):(0===f.frontside_width&&(f.frontside_width=""),0===f.frontside_height&&(f.frontside_height=""),g={left:f.frontside_left,top:f.frontside_top,width:f.frontside_width,height:f.frontside_height}),c.UTILITIES.constrain_css_to_fit_inside(a,g),$(h).css(g));k.append(h);b.set_visible(e);b.get_widget().rerender()})}.bind(this))};b.get_backside_dimensions=function(){if(1!==g||1!==d)return{x_scale:g,y_scale:d,original_width:t,original_height:q}};b.set_dimensions=
function(a){g=a.x_scale;d=a.y_scale;t=a.original_width;q=a.original_height};b.scale_to_fit=function(a,b){var e;!t&&this.get_widget().backside_geometry&&(t=this.get_widget().backside_geometry.original_width,q=this.get_widget().backside_geometry.original_height);e=c.UTILITIES.scale_to_fit(a,b,t,q);g=e.x_scale;d=e.y_scale};b.run_status_changed=function(a){C(a)};a.toontalk_widget=p;c.UTILITIES.drag_and_drop(a);k.resizable({start:function(){B=k.width();x=k.height();t||(t=B);q||(q=x)},resize:function(a,
b){var e=b.size.width,h=b.size.height;k.is(".toontalk-top-level-backside")||(g*=e/B,d*=h/x,B=e,x=h,c.backside.scale_backside(k,g,d,t,q))},handles:"e,s,se"});a.addEventListener("mouseenter",function(a){a=p.get_frontside();var b=p.get_parent_of_backside();!a||b&&!b.get_widget().is_top_level()||c.UTILITIES.highlight_element(a.get_element())});a.addEventListener("mouseleave",function(a){p.is_top_level()||c.UTILITIES.remove_highlight()});b.update_display=function(){var a=this.get_description_text_area(),
c;a&&(c=this.get_widget().get_description())&&(a.button.value=c);b.display_updated()};b.display_updated=function(){var a=$(this.get_element());t||(t=a.width());q||(q=a.height())};p.get_backside_widgets&&(A=p.get_backside_widgets(),b.add_backside_widgets(A,p.get_backside_widgets_json_views()));c.debugging&&(a.id=p.debug_id);return b},toString:function(){return"backside of "+this.get_widget()},remove_element:function(){$(this.get_element()).remove()},create_infinite_stack_check_box:function(p,b){var a=
c.UTILITIES.create_check_box(b.get_infinite_stack(),"toontalk-infinite-stack-check-box","Copy when dragged.","Check this if you want the "+b.get_type_name()+" to be copied instead of moved.");$(a.button).click(function(c){var g=a.button.checked,d;b.set_infinite_stack(g);b.robot_in_training()&&(d=g?"change dragging to make a copy of ":"change dragging back to moving for ",b.robot_in_training().edited(b,{setter_name:"set_infinite_stack",argument_1:g,toString:d,button_selector:".toontalk-infinite-stack-check-box"}));
c.stopPropagation()});return a},create_description_label:function(p,b){var a=b.get_description();if(a)return c.UTILITIES.create_text_element("I'm the back side of a "+b.get_type_name()+" that is "+a)},add_advanced_settings:function(p){var b=this.get_widget(),a=this.create_infinite_stack_check_box(this,b),k=b.get_type_name(),g=c.UTILITIES.create_text_area(b.get_description(),"toontalk-description-input","I'm ","Type here to provide additional information about this "+k+".",function(a){(a=c.UTILITIES.input_area_drop_handler(a,
b.receive_description_from_dropped.bind(b)))&&b.robot_in_training()&&b.robot_in_training().dropped_on_text_area(a,b,{area_selector:".toontalk-description-input",setter:"receive_description_from_dropped",toString:"for a widget's description"})}),d=$("<button>Make a sensor nest</button>").button(),n=$("<button>Make a function bird</button>").button(),f=function(){var a=g.button.value.trim();b.set_description(a,!0)&&b.robot_in_training()&&b.robot_in_training().edited(b,{setter_name:"set_description",
argument_1:a,toString:"change the description to '"+a+"'' of the "+k,button_selector:".toontalk-description-input"})},r=document.createElement("table"),l=this.get_element(),e=function(a,d){var e=b.get_parent_of_frontside(),f=a.get_frontside_element(!0),g;e&&!e.get_widget().is_top_level()?(e.add_backside_widget(a),g=e.get_element(),g.appendChild(f),e=$(g).offset(),e.top+=.6*$(g).height()):(b.add_to_top_level_backside(a,!1),e=d.offset(),e.left-=120,0>e.left&&(e.left=0));c.UTILITIES.set_absolute_position($(f),
e)};$(r).addClass("toontalk-advanced-setting");$(g.button).val(b.get_description());g.button.addEventListener("change",f);g.button.addEventListener("mouseout",f);this.set_description_text_area(g);d.addClass("toontalk-make-sensor_nest_button").click(function(a){a=c.sensor.create("click","which",void 0,void 0,!0,b);e(a,d);b.robot_in_training()&&b.robot_in_training().created_widget(a,b,".toontalk-make-sensor_nest_button")});d.attr("title","Click to create a nest which receives messages when events happen to this "+
b.get_type_name()+".");n.addClass("toontalk-make-function_bird_button").click(function(a){a=c.bird.create_function(k);e(a,n);b.robot_in_training()&&b.robot_in_training().created_widget(a,b,".toontalk-make-function_bird_button")});b.is_number()?n.attr("title","Click to get a bird that flies to functions of "+b.get_type_name(!0)+"."):(n.attr("title","There are no functions that operate on "+b.get_type_name(!0)+" (yet)."),n.button("option","disabled",!0));r.appendChild(c.UTILITIES.create_row(g.container));
r.appendChild(c.UTILITIES.create_row(d.get(0),n.get(0),a.container));l.appendChild(r);p?$(l).find(".toontalk-settings-backside-button").remove():$(l).find(".toontalk-advanced-setting").hide()},get_type_name:function(){return"the backside of "+c.UTILITIES.add_a_or_an(this.get_widget().get_type_name())},hide_backside:function(p){var b=this.get_widget(),a=b.get_frontside_element(),k=$(b.get_backside_element()),g=k.position(),d=k.parent().closest(".toontalk-backside"),n=b.get_parent_of_backside();c.UTILITIES.remove_highlight();
n&&(n.is_backside()?b.set_parent_of_backside(void 0,!0):n.removed_from_container(b,!0,p,void 0,!0),b.forget_backside&&b.forget_backside());(function(){var a=b.get_backside_widgets(),c=b.get_backside_widgets_json_views(!0),d;a.forEach(function(a,b){a.get_widget();var f;if(d=a.get_element())c[b]||(c[b]={}),a.start_position?(f=a.start_position,a.start_position=void 0):f=$(d).position(),a.is_backside()?(c[b].backside_left=f.left,c[b].backside_top=f.top):(c[b].frontside_left=f.left,c[b].frontside_top=
f.top)})})();b.backside_geometry=this.get_backside_dimensions();(function(b){var g=$(a).offset(),l=d.position(),e=function(){b.remove()};b.is(":visible")&&(b.addClass("toontalk-side-appearing"),c.UTILITIES.add_one_shot_event_handler(b.get(0),"transitionend",2500,e),l||(l={left:0,top:0}),b.css({left:g.left-l.left,top:g.top-l.top,opacity:.1}))})(k);!$(a).is(":visible")&&(g&&$(a).css({left:g.left,top:g.top}),p=c.UTILITIES.widget_from_jquery(d))&&(p.add_backside_widget(b),d.append(a),b.render());b.backside_widgets&&
b.backside_widgets.forEach(function(a){a.set_visible(!1)});if(b.on_backside_hidden)b.on_backside_hidden()},create_advanced_settings_button:function(p,b){var a=document.createElement("div"),k=$(a),g=!1;a.innerHTML="&gt;";k.addClass("toontalk-settings-backside-button");k.css({"z-index":c.UTILITIES.next_z_index()});k.click(function(a){g=!g;this.set_advanced_settings_showing(g,p.get_element(),k);a.stopPropagation();b.robot_in_training()&&b.robot_in_training().button_clicked(".toontalk-settings-backside-button",
p)}.bind(this));c.UTILITIES.give_tooltip(k.get(0),"Click to see the advanced settings of this "+b.get_type_name()+".");return k.get(0)},set_advanced_settings_showing:function(p,b,a){a||(a=$(b).find(".toontalk-settings-backside-button"));p?($(b).find(".toontalk-advanced-setting").show(),a.html("<"),c.UTILITIES.give_tooltip(a.get(0),"Click to hide the advanced settings.")):($(b).find(".toontalk-advanced-setting").hide(),a.html(">"),c.UTILITIES.give_tooltip(a.get(0),"Click to show the advanced settings."))},
get_widgets:function(){var c=[];$(this.get_element()).children().each(function(b,a){var k=a.toontalk_widget;k&&0>c.indexOf(k)&&c.push(k)});return c},scale_backside:function(c,b,a,k,g){var d=Math.min(1,b,a);1===b&&1===a?c.css({width:"",height:""}):c.css({transform:"scale("+d+", "+d+")","transform-origin":"left top",width:k*b/d,height:g*a/d})},render:function(){c.DISPLAY_UPDATES.pending_update(this)},rerender:function(){this.visible()&&c.DISPLAY_UPDATES.pending_update(this)},remove_backside_widget:function(c,
b,a){return this.get_widget().remove_backside_widget(c,b,a)},remove:function(){this.get_widget().remove()},is_backside:function(){return!0},get_parent:function(){return this.get_parent_of_backside()},is_of_type:function(c){return this.get_widget().is_of_type(c)},save_dimensions:function(){return!1}}}(window.TOONTALK);window.TOONTALK.frontside=function(c){return{create:function(p){var b=Object.create(this),a=document.createElement("div"),k=$(a),g=function(a){$(a.target).is(".ui-resizable-handle")||"click"===a.type&&1!==a.which||(k.is(".toontalk-top-level-resource")?p.set_running(!p.get_running()):p.get_running()&&!p.robot_in_training()?c.debugging&&c.UTILITIES.display_message("Clicks on running widgets are ignored. If you wish to see its backside then stop it and click again."):(p.open_backside(),p.robot_in_training()&&
p.robot_in_training().backside_opened(p)),a.stopPropagation())},d;$(a).addClass("toontalk-frontside toontalk-side");a.toontalk_widget=p;c.UTILITIES.drag_and_drop(a);b.get_element=function(){return a};b.get_widget=function(){return p};b.visible=function(){return d};b.set_visible=function(a){var b;d!==a&&(d=a,b=this.get_widget(),b.walk_children&&b.walk_children(function(b){b.set_visible(a);return!0}))};a.addEventListener("click",g);a.addEventListener("touchstart",g);a.addEventListener("mouseenter",
function(a){var b=p.get_backside(),d=(p.is_empty_hole()?wiget.get_parent_of_frontside():p).get_frontside_element();b&&c.UTILITIES.highlight_element(b.get_element());$(".toontalk-wiggle").removeClass("toontalk-wiggle");$(d).is(".toontalk-top-level-resource")||$(d).addClass("toontalk-wiggle");a.stopPropagation()});a.addEventListener("mouseleave",function(a){a=p.get_backside();var b=p.is_empty_hole()?wiget.get_parent_of_frontside():p;a&&c.UTILITIES.remove_highlight();$(b.get_frontside_element()).removeClass("toontalk-wiggle")});
c.debugging&&(a.id=p.debug_id);return b},update_display:function(){return this.get_widget().update_display()},remove:function(){$(this.get_element()).remove()}}}(window.TOONTALK);(function(c){var p=180/Math.PI,b=Math.log(10),a=bigrat.fromInteger(10),k=bigrat.fromValues(1,2),g=bigrat.fromValues(-1,2),d=bigrat.fromInteger(360),n=bigrat.fromDecimal(2*Math.PI),f=Math.log10?Math.log10:function(a){return Math.log(a)/b},r=function(a){var b=bigrat.fromValues(bigrat.toBigInteger(a),1);a=bigrat.subtract(bigrat.create(),a,b);return{integer_part:b,fractional_part:a}},l=function(a){var b=r(a),d=c.number.ZERO(),e=c.number.ZERO();d.set_value(b.integer_part);e.set_value(b.fractional_part);
return c.box.create(2,!0,[d,e],"The integer and fraction parts of "+a.toString().replace(",","/"))},e=function(a,b){var c=bigrat.divide(bigrat.create(),a,b),d=r(c);return bigrat.multiply(c,d.fractional_part,b)},t=function(a){a=r(a);return bigrat.isLessThan(a.fractional_part,g)?bigrat.subtract(a.integer_part,a.integer_part,bigrat.ONE):bigrat.isLessThan(a.fractional_part,bigrat.ZERO)||bigrat.isLessThan(a.fractional_part,k)?a.integer_part:bigrat.add(a.integer_part,a.integer_part,bigrat.ONE)},q=function(a){a=
r(a);return bigrat.isLessThan(a.fractional_part,bigrat.ZERO)?bigrat.subtract(a.integer_part,a.integer_part,bigrat.ONE):a.integer_part},B=function(a){a=r(a);return bigrat.isLessThan(a.fractional_part,bigrat.ZERO)||bigrat.equals(a.fractional_part,bigrat.ZERO)?a.integer_part:bigrat.add(a.integer_part,a.integer_part,bigrat.ONE)};window.TOONTALK.number=function(){var b=Object.create(c.widget),d=function(a,b,c,d){var e="",h=100;c=50/c;b/=1+b;if(d)for(d=0;h>=c&&d<a.length;)e=e+"<span class='toontalk-digit' style='font-size:"+
h+"%'>"+a[d]+"</span>",d+=1,"-"!==a[d]&&(h*=b);else for(d=a.length-1;h>=c&&0<d;)e="<span class='toontalk-digit' style='font-size:"+h+"%'>"+a[d]+"</span>"+e,--d,"-"!==a[d]&&(h*=b);return e},e=function(a,b){var c=a/(1+a);return Math.ceil(Math.log(.5/b)/Math.log(c))},g=function(a,b,c){if(a.length<=Math.round(b))return'<span class="toontalk-digit" style="font-size:100%">'+a+"</span>";if(1>b)return"";if(5>b)return"<span style='font-size: 80%'>"+g(a,1.25*b,.8*c)+"</span>";b=b/2-1;return d(a,b,c,!0)+d(a,
b,c,!1)},l=function(b,c){bigrat.isNegative(b)&&bigrat.abs(b,b);var d;a:{d=bigrat.fromValues(b[0],1);var e=bigrat.fromValues(b[1],1),f="",g=bigrat.create(),l=bigrat.create(),k=bigrat.create();for(bigrat.multiply(d,d,a);c>f.length;){if(bigrat.isLessThan(d,e))f+="0";else if(bigrat.divide(g,d,e),l=bigrat.toBigInteger(g),f+=l.toString(),bigrat.subtract(k,g,bigrat.fromValues(l,1)),bigrat.multiply(d,k,e),bigrat.equals(d,bigrat.ZERO)){d=f=h(f);break a}bigrat.multiply(d,d,a)}d=f}return d},h=function(a){return 0<
a.length&&"0"===a.charAt(a.length-1)?h(a.substring(0,a.length-1)):a},k=function(a,b){var c=Math.min(b,a/2);return a-(c+1)},q=function(a,b){b||(b=1);if(!("number"!==typeof a&&"string"!==typeof a||"number"!==typeof b&&"string"!==typeof b))return bigrat.fromValues(a,b);var c=bigrat.create();1===b?bigrat.set(c,bigrat.toBigInteger(a.get_value()),BigInteger.ONE):a.get_value&&b.get_value?bigrat.set(c,bigrat.toBigInteger(a.get_value()),bigrat.toBigInteger(b.get_value())):bigrat.set(c,a,b);return c},n=function(a){switch(a){case "+":return"";
case "-":return"&minus;";case "*":return"&times;";case "/":return"&divide;";case "=":return"&equals;";case "^":return"^";default:return c.UTILITIES.report_internal_error("Number has an unsupported operator: "+a),""}};b.create=function(a,d,e,h,f){var g=Object.create(b),l=q(a,d);h||(h="improper_fraction");e||(e="+");g.is_number=function(){return!0};g.set_value=function(a,b){if(b||!bigrat.equals(l,a))return this.fire_value_change_listeners(l,a),l=a,this.rerender(),c.debugging&&(this.debug_string=this.toString(),
"0,0"===a.toString()&&c.UTILITIES.report_internal_error("Impossible numeric value -- can be caused by decimal string not being parsable as a number.")),this};g.set_value_from_sub_classes=g.set_value;g.fire_value_change_listeners=function(a,b){var c=this.get_listeners("value_changed"),d;c&&(d={type:"value_changed",old_value:a,new_value:b},c.forEach(function(a){a(d)}))};g.get_value=function(){return l};g.set_value_from_decimal=function(a){this.set_value(bigrat.fromDecimal(a))};g.get_format=function(){return h};
g.set_format=function(a,b){h=a;b&&this.rerender();return this};g.get_operator=function(){return e};g.set_operator=function(a,b){e=a;b&&this.rerender();return this};g=b.add_standard_widget_functionality(g);g.set_description(f);c.debugging&&(g.debug_string=g.toString(),g.debug_id=c.UTILITIES.generate_unique_id(),l.debug_id_new=g.debug_id);return g};b.create_from_bigrat=function(a){var b=c.number.ZERO();b.set_value(a);return b};b.create_backside=function(){return c.number_backside.create(this)};b.set_from_values=
function(a,b){return this.set_value(q(a,b))};b.set_numerator=function(a){return this.set_value(q(a,this.get_value()[1].toString()))};b.set_denominator=function(a){return this.set_value(q(this.get_value()[0].toString(),a))};b.ONE=function(){return c.number.create(1)};b.ZERO=function(){return c.number.create(0)};b.copy=function(a){return this.add_to_copy(b.create(this.get_value()[0],this.get_value()[1],this.get_operator(),this.get_format(),this.get_description()),a)};b.equals=function(a){return a.equals_number&&
a.equals_number(this)};b.equals_number=function(a){return bigrat.equals(this.get_value(),a.get_value())};b.compare_with=function(a){if(a.compare_with_number)return-1*a.compare_with_number(this)};b.compare_with_number=function(a){return bigrat.equals(this.get_value(),a.get_value())?0:bigrat.isGreaterThan(this.get_value(),a.get_value())?1:-1};b.update_display=function(){var a,b,d,e,h;a=this.get_frontside(!0).get_element();$(a).is(".toontalk-conditions-contents")?b=$(a):$(a).parent().is(".toontalk-backside, .toontalk-json")?
(b=$(a),h=!0):b=$(a).parent().is(".toontalk-scale-half")?$(a):$(a).parent();if($(a).is(".toontalk-carried-by-bird"))d=100,e=40;else if($(a).is(".toontalk-element-attribute"))d=200,e=32;else{if(!b.is(":visible"))return;d=b.width();e=b.height();if(0===d||0===e)return;b.is(".toontalk-nest")&&(d*=c.nest.CONTENTS_WIDTH_FACTOR,e*=c.nest.CONTENTS_HEIGHT_FACTOR)}$(a).removeClass("toontalk-number-eighth-size-border toontalk-number-quarter-size-border toontalk-number-half-size-border toontalk-number-full-size-border");
64>=d||64>=e?($(a).addClass("toontalk-number-eighth-size-border toontalk-number"),a.toontalk_border_size=4):128>=d||128>=e?($(a).addClass("toontalk-number-quarter-size-border toontalk-number"),a.toontalk_border_size=8):256>=d||256>=e?($(a).addClass("toontalk-number-half-size-border toontalk-number"),a.toontalk_border_size=16):($(a).addClass("toontalk-number-full-size-border toontalk-number"),a.toontalk_border_size=32);b=e-2*a.toontalk_border_size;h=this.to_HTML(d/(.64*b),b,this.get_format(),!0,this.get_operator(),
h);c.UTILITIES.on_a_nest_in_a_box(a)&&(d="width:"+d+"px;",b=h.indexOf('style="'),h=0<=b?h.substring(0,b+7)+d+h.substring(b+7):h);d=$(a).children(".toontalk-widget");d.is("*")?d=d.get(0):(d=document.createElement("div"),a.appendChild(d));d.innerHTML=h;d.translate=!1;$(d).addClass("toontalk-widget notranslate");c.UTILITIES.give_tooltip(a,this.get_title())};b.to_HTML=function(b,c,h,q,w,t){var r,p,x,B,oa,Z,W=!1!==q?" toontalk-top-level-number":"";t&&(W+=" toontalk-number-size-unconstrained-by-container");
p=w?n(w):"";b||(b=4);c||(c=16);if(this.get_erased&&this.get_erased())return'<div class="toontalk-number toontalk-integer'+W+'" style="font-size: '+c+'px;"></div>';0<p.length&&(--b,2>b&&(c*=Math.max(1,b)/2,b=2));if(this.is_integer()&&"scientific_notation"!==h){try{r=bigrat.toBigInteger(this.get_value()).toString()}catch(ba){console.log("Error converting number to a string: "+ba),r="0"}q=r.length;0<p.length&&q++;4>b&&q>b&&(q=Math.min(4,q),c*=b/q,b=q);return'<div class="toontalk-number toontalk-integer'+
W+'" style="font-size: '+c+'px;">'+p+g(r,b,c)+"</div>"}r=' style="font-size:'+.4*c+'px;"';if("improper_fraction"===h||!h)return c='<table class="toontalk-number toontalk-improper-fraction'+W+'"'+r+'><tr class="toontalk-numerator"><td align="center" class="toontalk-number">'+g(this.numerator_string(),2*b,c)+'</td></tr><tr class="toontalk-fraction-line-as-row"><td  class="toontalk-fraction-line-as-table-entry"><div class="toontalk-fraction-line"></div></tr><tr class="toontalk-denominator"><td align="center" class="toontalk-number">'+
g(this.denominator_string(),2*b,c)+"</td></tr></table>",""===p?c:"<table class='toontalk-operator-and-fraction'"+r+"><tr><td>"+p+"</td><td>"+c+"</td></tr></table>";if("mixed_number"===h||"proper_fraction"===h){p=this.integer_part();if(p.is_zero())return this.to_HTML(b,c,"improper_fraction",q,w);q=this.copy({just_value:!0}).subtract(p).absolute_value();return'<table class="toontalk-number toontalk-mixed-number'+W+'"'+r+'><tr><td class="toontalk-number toontalk-integer-part-of-mixed-number">'+p.to_HTML(b/
2,c,"",!1,this.get_operator())+'</td><td class="toontalk-number toontalk-fraction-part-of-mixed-number">'+q.to_HTML(b/2,c,"improper_fraction",!1)+"</td></tr></table>"}if("decimal"===h)return 4>b&&(c*=Math.max(1,b)/4,b=4),'<div class="toontalk-number toontalk-decimal'+W+'" style="font-size: '+c+'px;">'+p+this.decimal_string(b,c)+"</div>";if("scientific_notation"===h){Z=bigrat.isNegative(this.get_value());x=this.get_value();B=bigrat.abs(bigrat.create(),x);x=bigrat.isLessThan(B,bigrat.ONE);B=(x?bigrat.toBigInteger(bigrat.divide(bigrat.create(),
bigrat.ONE,B)):bigrat.toBigInteger(B)).toString();x=x?-B.length:B.length-1;B=bigrat.power(bigrat.create(),a,x+1);oa=bigrat.divide(bigrat.create(),this.get_value(),B);B=6+(0===x?1:Math.ceil(f(Math.abs(x)))/2);Z&&B++;if(b<B+1)return this.to_HTML(B+1,c*b/(B+1),h,q,w,t);q=e(k(b,B),c);q=l(oa,q);w=Z?"-"+q.substring(0,1):q.substring(0,1);q=q.substring(1);b=d(q,b*(1-B/b),c,!0);0<b.length&&(b="<span class='toontalk-decimal-point'>.</span>"+b);return'<table class="toontalk-number toontalk-scientific_notation'+
W+'"'+r+'><tr><td class="toontalk-number toontalk-significand-of-scientific-notation"><div class="toontalk-number toontalk-decimal'+W+'" style="font-size: '+c+'px;">'+p+w+b+'</td><td class="toontalk-number toontalk-exponent-of-scientific-notation"><div style="font-size: '+c+'px;"> &times;10<sup style="font-size: '+c/2+'px;">'+x+"</sup></div></td></tr></table>"}};b.drop_on=function(a,b,c,d){if(a.number_dropped_on_me)return a.number_dropped_on_me(this,b,c,d),!0;if(a.widget_dropped_on_me)return a.widget_dropped_on_me(this,
b,c,d);console.log("No handler for drop of '"+this+"' on '"+a+"'")};b.number_dropped_on_me=function(a,b,d,e){var h,f,g,l;return a.visible()&&(d||e&&e.visible())?(e&&(a.robot_waiting_before_next_step=e),h=document.createElement("div"),$(h).addClass("toontalk-bammer-down"),f=$(this.get_frontside_element()).closest(".toontalk-top-level-backside"),h.style.left="-10px",h.style.top=f.height()+"px",f.append(h),b=this.get_frontside_element(),g=$(b).offset(),g.left-=.75*$(h).width(),g.left+=.5*$(b).width()+
.1*$(h).width(),g.top-=.5*$(b).height()+.4*$(h).height(),b=function(){this.number_dropped_on_me_semantics(a,d,e)&&e&&e.run_next_step();d&&this.backup_all();$(h).removeClass("toontalk-bammer-down");c.UTILITIES.set_timeout(function(){var a=f.offset();a||(a={left:0,top:0});$(h).addClass("toontalk-bammer-away");g.left=a.left+f.width()-100;g.top=a.top+f.height()+100;l=function(){$(h).remove()};c.UTILITIES.animate_to_absolute_position(h,g,l);$(h).css({opacity:.01})})}.bind(this),c.UTILITIES.animate_to_absolute_position(h,
g,b),$(h).css({opacity:1,"z-index":c.UTILITIES.next_z_index()+100}),this):this.number_dropped_on_me_semantics(a,d,e)};b.number_dropped_on_me_semantics=function(a,b,d){b&&this.robot_in_training()&&this.robot_in_training().dropped_on(a,this);a.remove();switch(a.get_operator()){case "+":return this.add(a);case "-":return this.subtract(a);case "*":return this.multiply(a);case "/":return this.divide(a);case "=":return this.set_value(a.get_value());case "^":return this.power(a);default:c.UTILITIES.report_internal_error("Number received a number with unsupported operator: "+
a.get_operator())}};b.widget_dropped_on_me=function(a,b,c,d){return a.number_dropped_on_me?this.number_dropped_on_me(a,b,c,d):!1};b.add=function(a){this.set_value(bigrat.add(this.get_value(),this.get_value(),a.get_value()),!0);return this};b.subtract=function(a){this.set_value(bigrat.subtract(this.get_value(),this.get_value(),a.get_value()),!0);return this};b.multiply=function(a){this.set_value(bigrat.multiply(this.get_value(),this.get_value(),a.get_value()),!0);return this};b.divide=function(a){this.set_value(bigrat.divide(this.get_value(),
this.get_value(),a.get_value()),!0);return this};b.minimum=function(a){this.set_value(bigrat.min(this.get_value(),this.get_value(),a.get_value()),!0);return this};b.maximum=function(a){this.set_value(bigrat.max(this.get_value(),this.get_value(),a.get_value()),!0);return this};b.power=function(a){this.set_value(bigrat.power(this.get_value(),this.get_value(),bigrat.toInteger(a.get_value())),!0);return this};b.absolute_value=function(){this.set_value(bigrat.abs(this.get_value(),this.get_value()),!0);
return this};b.is_zero=function(){return bigrat.equals(this.get_value(),bigrat.ZERO)};b.is_negative=function(){return bigrat.isNegative(this.get_value())};b.toString=function(){return this.get_erased()?"erased number":("+"===this.get_operator()?"":this.get_operator())+bigrat.str(this.get_value())};b.operator_word=function(a){switch(this.get_operator()){case "+":return"add "+a+" to";case "-":return"subtract "+a+" from";case "*":return"multiply "+a+" with";case "/":return"divide "+a+" into"}};b.get_text=
function(){return this.is_integer()||"improper_fraction"===this.get_format()?this.toString():bigrat.toDecimal(this.get_value()).toString()};b.to_float=function(){return bigrat.toDecimal(this.get_value())};b.get_type_name=function(a){return a?"numbers":"number"};b.get_help_URL=function(){return"docs/manual/numbers.html"};b.get_json=function(){return{type:"number",operator:this.get_operator(),numerator:this.numerator_string(),denominator:this.denominator_string(),format:this.get_format()}};c.creators_from_json.number=
function(a){return b.create(a.numerator,a.denominator,a.operator,a.format,a.description)};b.is_integer=function(){return 0===this.get_value()[1].compare(BigInteger.ONE)||0===this.get_value()[0].compare(BigInteger.ZERO)};b.numerator=function(){var a=bigrat.create();return bigrat.set(a,this.get_value()[0],BigInteger.ONE)};b.denominator=function(){var a=bigrat.create();return bigrat.set(a,this.get_value()[1],BigInteger.ONE)};b.numerator_string=function(){return this.get_value()[0].toString()};b.denominator_string=
function(){return this.get_value()[1].toString()};b.integer_part=function(){return this.create(this)};b.decimal_string=function(a,c){if(this.is_integer())return this.numerator_string();var h=b.copy.call(this),f=h.integer_part(),q=f.toString();"0"===q&&this.is_negative()&&(q="-"+q);h=h.get_value();bigrat.subtract(h,h,f.get_value());var n=k(a,q.length),w=e(n,c),f=Math.min(q.length,a/2),h=l(h,w),h=h.length<a?h:d(h,n,c,!0);return g(q,f,c)+"<span class='toontalk-decimal-point'>.</span>"+h};b.match=function(a){return this.get_erased&&
this.get_erased()?a.match_with_any_number?a.match_with_any_number():this:a.match_with_this_number?a.match_with_this_number(this):this};b.match_with_any_number=function(){return"matched"};b.match_with_this_number=function(a){return a.equals(this)?"matched":a};b.get_custom_title_prefix=function(){return"="===this.get_operator()?"Drop me on another number I'll give him my value.":"Drop me on another number and I'll "+this.operator_word("myself")+" him."};return b}();window.TOONTALK.number_backside=function(){return{create:function(a){var b=
c.backside.create(a),d=b.get_element(),e=document.createElement("div"),f=a.numerator_string(),h=a.denominator_string(),g=c.UTILITIES.create_text_area(f,"toontalk-numerator-input","","Type here to edit the numerator",void 0,"number"),l=c.UTILITIES.create_text_area(h,"toontalk-denominator-input","","Type here to edit the denominator",void 0,"number"),k=c.UTILITIES.create_radio_button("number_format","decimal","toontalk-decimal-radio-button","Decimal number","Display number as a decimal."),q=c.UTILITIES.create_radio_button("number_format",
"proper_fraction","toontalk-proper-fraction-radio-button","Mixed number","Display number as an integer part and a proper fraction."),n=c.UTILITIES.create_radio_button("number_format","improper_fraction","toontalk-improper-fraction-radio-button","Improper fraction","Display number as a simple fraction."),t=c.UTILITIES.create_radio_button("number_format","scientific_notation","toontalk-scientific-notation-radio-button","Scientific notation","Display number as a decimal between 1 and 10 multiplied by ten to some power."),
r=c.UTILITIES.create_radio_button("operator","+","toontalk-plus-radio-button","+","Add me to what I'm dropped on."),p=c.UTILITIES.create_radio_button("operator","-","toontalk-minus-radio-button","&minus;","Subtract me from what I'm dropped on."),B=c.UTILITIES.create_radio_button("operator","*","toontalk-times-radio-button","&times;","Multiply me with what I'm dropped on."),U=c.UTILITIES.create_radio_button("operator","/","toontalk-divide-radio-button","&divide;","Divide me into what I'm dropped on."),
ca=c.UTILITIES.create_radio_button("operator","=","toontalk-set-equal-radio-button","&equals;","Set what I'm dropped on to my value."),fa=function(b){var d=g.button.value.trim(),e=l.button.value.trim(),k=function(a,b,c){if(1>a.length)return{message:"Empty "+b+" treated as 1.",replacement:"1"};if("-"===a.charAt(0)){if(c)return{message:"'-' only allowed as the first character of the "+b+". Ignoring extra '-'s.",replacement:k(a,b).replacement};a=k(a.substring(1,a.length),b,!0);a.message||(a.replacement=
"-"+a.replacement);return a}return/^\d+$/.test(a)?{replacement:a}:{message:"The "+b+" can only contain digits. '"+a+"' doesn't make sense.",replacement:a.replace(/[^\d]*/g,"")}},q;if(d!==f||e!==h)q=k(d,"numerator"),q.message&&(c.UTILITIES.display_message(q.message),d=q.replacement),"0"===e?(c.UTILITIES.display_message("It doesn't make sense for a fraction to have a denominator of 0. Resetting it to 1."),e="1"):(q=k(e,"denominator"),q.message&&(c.UTILITIES.display_message(q.message),e=q.replacement)),
a.set_from_values(d,e)&&(f=d,h=e,a.robot_in_training()&&(b=b.srcElement.className.split(" ",1)[0],"toontalk-denominator-input"===b?a.robot_in_training().edited(a,{setter_name:"set_denominator",argument_1:e,toString:"by changing the value of the denominator to "+e,button_selector:"."+b}):a.robot_in_training().edited(a,{setter_name:"set_numerator",argument_1:d,toString:"by changing the value of the numerator to "+d,button_selector:"."+b})),a.rerender())},da=function(){var b=c.UTILITIES.selected_radio_button(k.button,
q.button,n.button,t.button),d=b.value;a.set_format(d,!0);a.robot_in_training()&&a.robot_in_training().edited(a,{setter_name:"set_format",argument_1:d,toString:"by changing the format to "+d+" of the number",button_selector:"."+b.className.split(" ",1)[0]});a.rerender()},oa=function(){var b=c.UTILITIES.selected_radio_button(r.button,p.button,B.button,U.button,ca.button),d=b.value;a.set_operator(d,!0);a.robot_in_training()&&a.robot_in_training().edited(a,{setter_name:"set_operator",argument_1:d,toString:"by changing the operator to "+
d+" of the number",button_selector:"."+b.className.split(" ",1)[0]})},Z=c.UTILITIES.create_horizontal_table(g.container,e,l.container),W=$(c.UTILITIES.create_horizontal_table(k.container,q.container,n.container,t.container)).buttonset().get(0),ba=$(c.UTILITIES.create_horizontal_table(r.container,p.container,B.container,U.container,ca.container)).buttonset().get(0),ka=c.backside.create_advanced_settings_button(b,a),Y=b.update_display.bind(b);e.innerHTML="/";$(e).addClass("ui-widget");d.appendChild(Z);
d.appendChild(ka);g.button.addEventListener("change",fa);g.button.addEventListener("mouseout",fa);g.button.addEventListener("mouseenter",function(){f=g.button.value.trim()});l.button.addEventListener("change",fa);l.button.addEventListener("mouseout",fa);l.button.addEventListener("mouseenter",function(){h=l.button.value.trim()});k.button.addEventListener("change",da);q.button.addEventListener("change",da);n.button.addEventListener("change",da);t.button.addEventListener("change",da);switch(a.get_format()){case "decimal":c.UTILITIES.check_radio_button(k);
break;case "improper_fraction":c.UTILITIES.check_radio_button(n);break;case "mixed_number":case "proper_fraction":c.UTILITIES.check_radio_button(q);break;case "scientific_format":c.UTILITIES.check_radio_button(t)}switch(a.get_operator()){case "+":c.UTILITIES.check_radio_button(r);break;case "-":c.UTILITIES.check_radio_button(p);break;case "*":c.UTILITIES.check_radio_button(B);break;case "/":c.UTILITIES.check_radio_button(U);break;case "=":c.UTILITIES.check_radio_button(ca)}r.button.addEventListener("change",
oa);p.button.addEventListener("change",oa);B.button.addEventListener("change",oa);U.button.addEventListener("change",oa);ca.button.addEventListener("change",oa);b.update_display=function(){$(g.button).val(a.numerator_string());$(l.button).val(a.denominator_string());Y()};$(W).addClass("toontalk-advanced-setting");$(ba).addClass("toontalk-advanced-setting");d.appendChild(W);d.appendChild(ba);b.add_advanced_settings();return b}}}();window.TOONTALK.number.function=function(){var a=function(a,b,d,e){var h,
f;if(a.is_box())if(h=a.get_size(),1>h)c.UTILITIES.display_message("Function birds can only respond to boxes with holes.");else if(f=a.get_hole_contents(0)){if(f.is_bird()){if(b=b(f,h))e&&e.add_newly_created_widget_if_new(b),d&&a.robot_in_training()&&a.robot_in_training().add_newly_created_widget_if_new(b),f.widget_dropped_on_me(b,!1,void 0,e,!0);a.remove();return b}c.UTILITIES.display_message("Function birds can only respond to boxes with a bird in the first hole. The first hole contains "+c.UTILITIES.add_a_or_an(f.get_type_name()+
"."))}else c.UTILITIES.display_message("Function birds can only respond to boxes with something in the first hole.");else c.UTILITIES.display_message("Function birds can only respond to boxes. One was given "+c.UTILITIES.add_a_or_an(a.get_type_name()))},b=function(a,b,d){if(!a)return c.UTILITIES.display_message("Birds for the "+b+" function can only respond to boxes with a number in the "+c.UTILITIES.ordinal(d)+" hole. The "+c.UTILITIES.ordinal(d)+" hole is empty."),!1;if(a.dereference().is_number())return!0;
if(a.is_nest())throw{wait_for_nest_to_receive_something:a};c.UTILITIES.display_message("Birds for the "+b+" function can only respond to boxes with a number in the "+c.UTILITIES.ordinal(d)+" hole. The "+c.UTILITIES.ordinal(d)+" hole contains "+c.UTILITIES.add_a_or_an(a.get_type_name()+"."));return!1},f=function(c,d,e,h,f,g){return a(c,function(a,f){var g,l,k,q;if(1===f)return d();l=1;k=c.get_hole_contents(l).dereference();if(q=b(k,h,l)){for(l++;l<f;){g=c.get_hole_contents(l).dereference();q=b(g,h,
l);if(!q)return;e.call(k,g);l++}return k}},f,g)},g=function(d,e,h,f,g,l){return a(d,function(a,g){var l,k,q,n;if(g<h+1)c.UTILITIES.display_message("Birds for the "+f+" function can only respond to boxes with at least "+(h+1)+" holes. Not "+g+" holes.");else{q=[];for(k=1;k<g;){l=d.get_hole_contents(k).dereference();n=b(l,f,k);if(!n)return;q.push(l.get_value());k++}return e.apply(null,q)}},g,l)},k=function(a,b){for(var c=a.length,d=0,e=[];d<c;)e.push(b(a[d])),d++;return e},h=function(a,b){return function(){var d=
c.number.ZERO();d.set_value_from_decimal(a.apply(null,k(arguments,b||bigrat.toDecimal)));return d}},C=function(a){return bigrat.toDecimal(e(a,d))},w=function(a){return bigrat.toDecimal(e(a,n))},z=function(a){return function(){return c.number.create_from_bigrat(a.apply(null,arguments))}},y=function(){return"If you give me a box with another bird and some numbers then "+c.UTILITIES.lower_case_first_letter(this.title)+"\nOn my back side you can change me to compute other functions."},r=function(){return c.UTILITIES.add_a_or_an("'"+
this.name+"' function bird")},P={},J=function(a,b,c){P[a]={name:a,respond_to_message:b,get_description:y,toString:r,title:c}};J("sum",function(a,b,d){return f(a,c.number.ZERO,c.number.add,"sum",b,d)},"The bird will return with the sum of the numbers in the box.");J("difference",function(a,b,d){return f(a,c.number.ZERO,c.number.subtract,"difference",b,d)},"The bird will return with the result of subtracting the numbers in the box from the first number.");J("product",function(a,b,d){return f(a,c.number.ONE,
c.number.multiply,"product",b,d)},"The bird will return with the product of the numbers in the box.");J("division",function(a,b,d){return f(a,c.number.ONE,c.number.divide,"division",b,d)},"The bird will return with the result of dividing the numbers into the first number in the box.");J("modulo",function(a,b,c){return g(a,z(e),2,"modulo",b,c)},"The bird will return with the first number modulo the second number. For positive numbers this is like the remainder after division.");J("minimum",function(a,
b,d){return f(a,c.number.ONE,c.number.minimum,"minimum",b,d)},"The bird will return with the smallest of the numbers in the box.");J("maximum",function(a,b,d){return f(a,c.number.ONE,c.number.maximum,"maximum",b,d)},"The bird will return with the largest of the numbers in the box.");J("absolute value",function(a,b,d){return g(a,function(a){var b=c.number.ZERO();bigrat.abs(b.get_value(),a);return b},1,"absolute value",b,d)},"The bird will return with the positive version of the number.");J("power",
function(a,b,c){return g(a,z(function(a,b){var c=bigrat.power(bigrat.create(),a,b[0].valueOf()),d=b[1].valueOf();return 1===d?c:bigrat.nthRoot(c,c,d)}),2,"power",b,c)},"The bird will return with the first number to the power of the second number.");J("logarithm",function(a,b,c){return g(a,h(function(){return 1===arguments.length?Math.log(arguments[0]):Math.log(arguments[0])/Math.log(arguments[1])}),1,"logarithm",b,c)},"The bird will return an approximation of the logarithm number of the first number.\nIf a second number is provided then it is used as the base of the logarithm.\nIf there is no second number the logarithm is natural (the base is e).");
J("random",function(a,b,c){return g(a,h(function(){return 0===arguments.length?Math.random():1===arguments.length?Math.random()*arguments[0]:arguments[0]+Math.random()*arguments[1]}),0,"random",b,c)},"The bird will return a random number between the first and second numbers.\nIf the second number isn't provided a number less than the first number is returned.\nIf no numbers are given then the bird returns with a number between 0 and 1.");J("round",function(a,b,c){return g(a,z(t),1,"round",b,c)},"The bird will return the number rounded to the nearest integer.");
J("floor",function(a,b,c){return g(a,z(q),1,"floor",b,c)},"The bird will return the largest integer less than or equal to the number.");J("ceiling",function(a,b,c){return g(a,z(B),1,"ceiling",b,c)},"The bird will return the smallest integer greater than or equal to the number.");J("integer and fraction parts",function(a,b,c){return g(a,l,1,"integer and fraction parts",b,c)},"The bird will return with a box containing the integer part and the fraction.");J("sine",function(a,b,c){return g(a,h(function(a){return Math.sin(a/
p)},C),1,"sine",b,c)},"The bird will return with an approximation of the sine of the number (in degrees).");J("cosine",function(a,b,c){return g(a,h(function(a){return Math.cos(a/p)},C),1,"cosine",b,c)},"The bird will return with an approximation of the cosine of the number (in degrees).");J("arc tangent",function(a,b,c){return g(a,h(function(a){return p*Math.atan(a)}),1,"arc tangent",b,c)},"The bird will return with an approximation of the arc tangent (in degrees) of the number.");J("arc tangent of y and x",
function(a,b,c){return g(a,h(function(a,b){return p*Math.atan2(a,b)}),2,"arc tangent of y and x",b,c)},"The bird will return with an approximation of the arc tangent (in degrees) of the point where the first number is the y coordinate and the second one is the x.");J("sine (in radians)",function(a,b,c){return g(a,h(Math.sin,w),1,"sine (in radians)",b,c)},"The bird will return with an approximation of the sine of the number (in radians).");J("cosine (in radians)",function(a,b,c){return g(a,h(Math.cos,
w),1,"cosine (in radians)",b,c)},"The bird will return with an approximation of the cosine of the number (in radians).");J("arc tangent (in radians)",function(a,b,c){return g(a,h(Math.atan),1,"arc tangent (in radians)",b,c)},"The bird will return with an approximation of the arc tangent (in radians) of the number.");J("arc tangent of y and x (in radians)",function(a,b,c){return g(a,h(Math.atan2),2,"arc tangent of y and x (in radians)",b,c)},"The bird will return with an approximation of the arc tangent (in radians) of the point where the first number is the y coordinate and the second one is the x.");
return P}()})(window.TOONTALK);window.TOONTALK.box=function(c){var p=Object.create(c.widget);p.create=function(b,a,k,g){var d=Object.create(p),n=[],f;"undefined"===typeof a&&(a=!0);d.is_box=function(){return!0};d.get_horizontal=function(){return a};d.set_horizontal=function(b,c){a=b;c&&($(this.get_frontside_element()).children(".toontalk-side").remove(),this.rerender());return this};d.get_hole=function(a){return n[a]};d.get_hole_contents=function(a){return n[a].get_contents()};d.set_hole=function(a,b,d){n[a].set_contents(b);d&&
(b&&b.save_dimensions(),this.update_hole_display(a,b));this.rerender();c.debugging&&(this.debug_string=this.toString())};d.get_holes=function(){return n};d.temporarily_remove_contents=function(a,b){var c=this.get_index_of(a);this.temporarily_removed_contents||(this.temporarily_removed_contents=[]);this.temporarily_removed_contents[c]=a;this.set_hole(c,void 0,b);return function(){this.set_hole(c,a,b);this.temporarily_removed_contents[c]=void 0}.bind(this)};d.get_contents_temporarily_removed=function(a){if(this.temporarily_removed_contents)return this.temporarily_removed_contents[a]};
d.set_contents=function(a){a.forEach(function(a,b){n[b].set_contents(a)})};d.get_size=function(){return b};d.set_size=function(a,f){var e,g;if(b===a||0>a||isNaN(a))return!1;g=this.visible();n.length=a;if(a>b)for(e=b;e<a;e++)n[e]=c.box_hole.create(e),n[e].set_parent_of_frontside(d),n[e].set_visible(g);b=a;f&&this.rerender();c.debugging&&(this.debug_string=this.toString());return!0};d.receive_size_from_dropped=function(a,b){var d;if(a.is_number())return d=c.number.create(this.get_size()),d.number_dropped_on_me_semantics(a),
d=Math.max(0,Math.round(d.to_float())),this.set_size(d),d.toString()};d.copy=function(c){var d;c||(c={});d=n.map(function(a){if(a=a.get_contents())return a.copy(c)});d=p.create(b,a,d,this.get_description());return this.add_to_copy(d,c)};d=d.add_standard_widget_functionality(d);for(f=0;f<b;f++)n[f]=c.box_hole.create(f),n[f].set_parent_of_frontside(d);d.set_description(g);d.set_contents(k);c.debugging&&(d.debug_string=d.toString(),d.debug_id=c.UTILITIES.generate_unique_id());return d};p.create_backside=
function(){return c.box_backside.create(this)};p.equals=function(b){return b.equals_box&&this.get_type_name()===b.get_type_name()&&b.equals_box(this)};p.equals_box=function(b){var a=this.get_size(),c,g,d;if(a!==b.get_size())return!1;for(c=0;c<a;c++)if(g=this.get_hole_contents(c),d=b.get_hole_contents(c),!g&&d||g&&!d||g&&d&&(!g.equals||!g.equals(d)))return!1;return!0};p.compare_with=function(b){if(b.compare_with_box)return-1*b.compare_with_box(this)};p.compare_with_box=function(b){var a=this.get_size(),
c=b.get_size(),g,d;if(a>c)return 1;if(a<c)return-1;for(c=0;c<a;c++){g=this.get_hole_contents(c);d=b.get_hole_contents(c);if(g&&!d)return 1;if(!g&&d)return-1;if(g&&d)if(g.compare_with){if(g=g.compare_with(d),1===g||-1===g)return g}else return}return 0};p.match=function(b){return this.get_erased&&this.get_erased()?b.match_with_any_box?b.match_with_any_box():this:b.match_with_this_box?b.match_with_this_box(this):this};p.match_with_any_box=function(){return"matched"};p.match_with_this_box=function(b){var a=
this.get_size(),k=[],g,d,n;if(a!==b.get_size())return b;for(g=0;g<a;g++)if(n=b.get_hole_contents(g))if(d=this.get_hole_contents(g)){d=c.UTILITIES.match(n,d);if(d.is_widget)return d;"matched"!==d&&(k=0===k.length?d:k.concat(d))}else if(d=this.get_contents_temporarily_removed(g))k.push(d);else return b;return 0<k.length?k:"matched"};p.toString=function(b){var a="",c=this.get_size(),g,d,n=this.get_type_name()+" that looks like ";for(g=0;g<c;g++)d=this.get_hole(g),a+=d.get_full_description(b),g<c-1&&
(a+=" | ");return n+"["+a.replace(n,"")+"]"};p.get_type_name=function(b){return b?"boxes":"box"};p.get_help_URL=function(){return"docs/manual/boxes.html"};p.get_json=function(b){var a=[],k=this.get_size(),g;for(g=0;g<k;g++)this.get_hole_contents(g)?a[g]=c.UTILITIES.get_json(this.get_hole_contents(g),b):a[g]=null;return{type:"box",size:k,contents:a,horizontal:this.get_horizontal()}};p.walk_children=function(b){var a=this.get_size(),c;for(c=0;c<a&&b(this.get_hole(c));c++);};c.creators_from_json.box=
function(b,a){return p.create(b.size,b.horizontal,c.UTILITIES.create_array_from_json(b.contents,a),b.description)};p.update_display=function(){var b=this.get_frontside(!0).get_element(),a=this.get_size(),k=function(b,d,f){var l=d.get_frontside_element(!0),k=$(b).parents(".toontalk-box-hole"),n=function(){$(b).parents(".toontalk-box-hole").children(".toontalk-nest").is("*")&&(w/=c.nest.CONTENTS_WIDTH_FACTOR,z/=c.nest.CONTENTS_HEIGHT_FACTOR)},h,C,w,z;g?(C=0,0<k.length?(w=r-2*q/a,z=e-2*q):(w=r,z=e),
n(),h=w*f,1<f&&(h+=q*(f-1))):(h=0,0<k.length?(w=r-2*q,z=e-2*q/a):(w=r,z=e),n(),C=z*f,1<f&&(C+=q*(f-1)));$(b).css({left:h,top:C,width:w,height:z});c.UTILITIES.has_animating_image(l)||(0<f&&($(b).removeClass("toontalk-box-eighth-size-border-left toontalk-box-quarter-size-border-left toontalk-box-half-size-border-left toontalk-box-full-size-border-left"),$(b).removeClass("toontalk-box-eighth-size-border-top toontalk-box-quarter-size-border-top toontalk-box-half-size-border-top toontalk-box-full-size-border-top"),
g?$(b).addClass(t+"-left"):$(b).addClass(t+"-top")),b.toontalk_border_size=q);b!==l&&($(l).css({left:0,top:0,width:"",height:""}),b.appendChild(l),d.get_contents().update_display());d.is_element()&&(d=d.get_contents(),d.set_size_attributes(w,z,!0))},g=this.get_horizontal();$(b).is(".toontalk-box");var d=function(){var c=$(b).children(".toontalk-box-hole");c.length===a?c.each(function(a,b){var c=this.get_hole(a);c&&k(b,c,a)}.bind(this)):(c.remove(),this.get_holes().forEach(function(a,c){n=a.get_element();
$(n).addClass("toontalk-hole-number-"+c);k(n,a,c);b.appendChild(n)}));$(b).parent(".toontalk-conditions-contents-container").is("*")||$(b).css({width:f,height:l})}.bind(this),n,f,r,l,e,t,q;$(b).addClass("toontalk-box");$(b).removeClass("toontalk-box-eighth-size-border toontalk-box-quarter-size-border toontalk-box-half-size-border toontalk-box-full-size-border");c.UTILITIES.give_tooltip(b,this.get_title());c.debugging&&(this.debug_string=this.toString());this.get_erased()?($(b).addClass("toontalk-box-erased"),
$(b).children(".toontalk-side").remove()):($(b).removeClass("toontalk-box-erased"),f=$(b).width()||c.box.get_default_width(),l=$(b).height()||c.box.get_default_height(),g?(r=f/a,e=l):(r=f,e=l/a),32>=r||32>=e?(t="toontalk-box-eighth-size-border",q=4):64>=r||64>=e?(t="toontalk-box-quarter-size-border",q=8):128>=r||128>=e?(t="toontalk-box-half-size-border",q=16):(t="toontalk-box-full-size-border",q=32),g?r-=(a-1)*q/a:e-=(a-1)*q/a,$(b).addClass(t),b.toontalk_border_size=q,c.UTILITIES.set_timeout(d))};
p.get_default_width=function(){return 164};p.get_default_height=function(){return 68};p.update_hole_display=function(b,a){var c=this.get_frontside_element(),c=$(c).children(".toontalk-hole-number-"+b),g;c.empty();a&&(g=a.get_frontside_element(!0),c.append(g),$(g).css({left:0,top:0}),a.rerender())};p.drop_on=function(b,a,c,g){if(b.box_dropped_on_me)return a=b.box_dropped_on_me(this,c,g),c&&b.rerender(),a&&this.remove(),a;if(b.widget_dropped_on_me)return b.widget_dropped_on_me(this,a,c,g);console.log("No handler for drop of "+
this+" on "+b)};p.box_dropped_on_me=function(b,a){console.log("box on box not yet implemented");return!1};p.widget_dropped_on_me=function(b,a,k,g){var d=this.which_hole(k),n;if(0<=d)return n=this.get_hole(d),(d=n.get_contents())?b.drop_on(d,a,k,g):n.widget_dropped_on_me(b,a,k,g);c.UTILITIES.report_internal_error(b+" dropped on "+this+" but no event was provided.")};p.get_index_of=function(b){return b.get_parent_of_frontside().get_index()};p.removed_from_container=function(b,a,k,g,d){a=!!k;"undefined"===
typeof g&&(g=this.get_index_of(b));0<=g?(this.set_hole(g,void 0,a),a&&(this.rerender(),b.restore_dimensions())):d&&c.UTILITIES.report_internal_error("Attempted to remove "+b+" from "+this+" but not found.")};p.get_path_to=function(b,a){var k=this.get_size(),g,d;if("empty hole"===b.get_type_name()){k=b.get_parent_of_frontside();d=c.box.path.create(b.get_index());if(k===this)return d;k=this.get_path_to(k);if(!k)return;k.next=d;return k}for(g=0;g<k;g++)if(d=this.get_hole_contents(g)||this.get_contents_temporarily_removed(g)){if(b===
d||d.top_contents_is&&d.top_contents_is(b))return c.box.path.create(g);if(d.get_path_to&&(d=d.get_path_to(b,a)))return k=c.box.path.create(g),k.next=d,k}};p.element_to_highlight=function(b){b=this.which_hole(b,!0);var a;if(0>b)return this.get_frontside_element();b=this.get_hole(b);return(a=b.get_contents())?a.get_frontside_element():b.get_frontside_element()};p.which_hole=function(b){var a=this.get_horizontal(),c=this.get_frontside_element(),g=this.get_size(),d;if(0!==g&&(d=$(c).offset(),c=a?$(c).width()/
g:$(c).height()/g,d=a?d.left:d.top,b))for(b=0;b<g;b++)if(d+=c,(a?event.pageX<=d:event.pageY<=d)||b+1===g)return b};p.dereference_path=function(b,a,k){var g,d;if(b){g=b.get_index&&b.get_index();if(!c.debugging||"number"===typeof g){if(d=this.get_hole_contents(g)){if(d.dereference_contents&&!b.not_to_be_dereferenced)return d.dereference_contents(b,a,k);if(b.next){if(d.dereference_path)return d.dereference_path(b.next,a,k);c.UTILITIES.report_internal_error("Expected to refer to a part of "+d+" but it lacks a method to obtain "+
c.path.toString(b.next))}b.removing_widget&&("empty hole"===d.get_type_name()?c.UTILITIES.report_internal_error("Robot is trying to remove something from an empty hole. "):d.get_infinite_stack()||k.remove_from_container(d,this));return d}return this.get_hole(g)}c.UTILITIES.report_internal_error(this+" unable to dereference the path: "+c.path.toString(b))}else return this};p.path={create:function(b){return{get_index:function(){return b},toString:function(){return"scale"===this.true_type?0===b?"the left pan ":
"the right pan ":"the "+c.UTILITIES.ordinal(b)+" hole "},get_json:function(a){return{type:"box_path",index:b,true_type:this.true_type,next:this.next&&this.next.get_json(a)}}}}};p.get_custom_title_prefix=function(){return"Drop things in my holes to store them."};c.creators_from_json.box_path=function(b,a){var k=p.path.create(b.index);b.next&&(k.next=c.UTILITIES.create_from_json(b.next,a));b.true_type&&(k.true_type=b.true_type);return k};return p}(window.TOONTALK);
window.TOONTALK.box_backside=function(c){return{create:function(p){var b=c.backside.create(p),a=c.UTILITIES.create_text_input(p.get_size().toString(),"toontalk-box-size-input","Number of holes","Type here to edit the number of holes.",void 0,"number",function(a){(a=c.UTILITIES.input_area_drop_handler(a,p.receive_size_from_dropped.bind(p)))&&p.robot_in_training()&&p.robot_in_training().dropped_on_text_area(a,p,{area_selector:".toontalk-box-size-input",setter:"receive_size_from_dropped",toString:"for the box's size"})}),
k=c.UTILITIES.create_radio_button("box_orientation","horizontal","toontalk-horizontal-radio-button","Left to right","Show box horizontally."),g=c.UTILITIES.create_radio_button("box_orientation","vertical","toontalk-vertical-radio-button","Top to bottom","Show box vertically."),d=function(){var b=parseInt(a.button.value.trim(),10);p.set_size(b,!0)&&p.robot_in_training()&&p.robot_in_training().edited(p,{setter_name:"set_size",argument_1:b,toString:"by changing the number of holes to "+b+" of the box",
button_selector:".toontalk-box-size-input"})},n=function(){var a=c.UTILITIES.selected_radio_button(k.button,g.button),b=a.value,d="horizontal"===b;p.set_horizontal(d,!0);p.robot_in_training()&&p.robot_in_training().edited(p,{setter_name:"set_horizontal",argument_1:d,toString:"by changing the orientation to "+b+" of the box",button_selector:"."+a.className.split(" ",1)[0]})},f=b.get_element(),r=c.backside.create_advanced_settings_button(b,p),l=b.update_display.bind(b);a.button.addEventListener("change",
d);a.button.addEventListener("mouseout",d);k.button.addEventListener("change",n);g.button.addEventListener("change",n);b.update_display=function(){a.button.value=p.get_size().toString();p.get_horizontal()?c.UTILITIES.check_radio_button(k):c.UTILITIES.check_radio_button(g);l()};f.appendChild(a.container);f.appendChild($(c.UTILITIES.create_horizontal_table(k.container,g.container)).buttonset().get(0));f.appendChild(r);b.add_advanced_settings();b.render();return b}}}(window.TOONTALK);
window.TOONTALK.box_hole=function(c){return{create:function(p){var b=Object.create(this),a,k,g;b.is_hole=function(){return!0};b.is_empty_hole=function(){return!a};b.get_element=function(){g||(g=document.createElement("div"),g.className="toontalk-box-hole toontalk-frontside toontalk-side",g.toontalk_widget=b);return g};b.get_frontside=function(b){return a?a.get_frontside(b):this.get_element()};b.get_side_element=function(){return this.get_element()};b.get_frontside_element=function(b){return a?a.get_frontside_element(b):
this.get_element()};b.get_frontside=function(){return this};b.widget_dropped_on_me=function(a,b,c,g){b=this.get_parent_of_frontside();var l;c&&b.robot_in_training()&&b.robot_in_training().dropped_on(a,this);c&&a.save_dimensions&&a.set_size_attributes&&(l=$(this.get_element()),a.set_size_attributes(l.width(),l.height()));this.set_contents(a);a.dropped_on_other&&a.dropped_on_other(this,!1,c,g);b.render();return!0};b.get_json=function(){return null};b.add_to_json=function(a){return a};b.copy=function(a){return c.box_hole.create(p)};
b.match=function(){return"matched"};b.get_type_name=function(b){return a?a.get_type_name(b):b?"empty holes":"empty hole"};b.is_of_type=function(b){return a?a.is_of_type(b):"empty hole"===b};b.get_box=function(){return this.get_parent_of_frontside()};b.dereference=function(){return a?a[0].dereference():this};b.get_index=function(){return p};b.get_contents=function(){return a};b.set_contents=function(d){var g=this.get_listeners("value_changed");g&&(a!==d&&g.forEach(function(b){b({type:"value_changed",
old_value:a,new_value:d})}),a&&g.forEach(function(b){a.remove_listener("value_changed",b,!0)}),d&&g.forEach(function(a){d.add_listener("value_changed",a)}));a&&a.set_parent_of_frontside(void 0);(a=d)?(a.set_parent_of_frontside(this),c.debugging&&(b.debug_string="A hole containing "+a),a.set_visible(k)):c.debugging&&(b.debug_string="An empty hole")};b.visible=function(){return this.get_parent_of_frontside().visible()};b.set_visible=function(b){k=b;a&&a.set_visible(b)};b.remove=function(){a&&a.remove()};
b.render=function(){if(a)return a.render()};b.rerender=function(){if(a)return a.rerender()};b.set_running=function(b){a&&a.set_running(b)};b.removed_from_container=function(b,g,f,k,l){a?(f&&a.restore_dimensions(),this.set_contents(void 0),f&&this.get_parent_of_frontside().render()):l&&c.UTILITIES.report_internal_error("Holes can't be removed from containers.")};b.temporarily_remove_contents=function(b,c){if(a)return this.get_parent_of_frontside().temporarily_remove_contents(b,c)};b.toString=function(){return a?
a.toString():"_"};b.get_description=function(){return a?a.get_description():"_"};b.get_full_description=function(b){return a?a.get_full_description(b):"_"};b.is_backside=function(){return!1};b.get_widget=function(){return this.get_parent_of_frontside()};b.is_number=function(){return a?a.is_number():!1};b.is_box=function(){return a?a.is_box():!1};b.is_scale=function(){return a?a.is_scale():!1};b.is_bird=function(){return a?a.is_bird():!1};b.is_nest=function(){return a?a.is_nest():!1};b.is_robot=function(){return a?
a.is_robot():!1};b.is_element=function(){return a?a.is_element():!1};b.is_top_level=function(){return!1};c.debugging&&(b.debug_string="An empty hole");c.widget.has_parent(b);c.widget.has_listeners(b);return b}}}(window.TOONTALK);(function(){var c,p,b,a,k;window.TOONTALK.bird=function(a){var b=Object.create(a.widget),n=function(b,c,d){b.get_function_type();b=b.get_function_object();var e=Object.keys(TOONTALK.number.function),k=e.map(function(a){return TOONTALK.number.function[a].title}),e=a.UTILITIES.create_select_menu("functions",e,"toontalk-select-function","Which function should I fly to? ","Click to select the function that this bird will use when given a box.",k);c=c.get_element();b&&(e.menu.value=b.name);e.menu.addEventListener("change",
function(a){d.set_function_name(a.target.value)});c.insertBefore(e.container,c.firstChild)};b.create=function(f,r){var l=Object.create(b),e=[],t=[];c=function(a){f=a};l.is_bird=function(){return!0};l.widget_dropped_on_me=function(b,c,d,e,l){var k=c?b.get_backside():b,n,h;if(f){if(f.has_ancestor(b))return a.UTILITIES.display_message("Bird can't take its nest to its nest!"),!1;f.visible()||this.visible()||f.any_nest_copies_visible()?(b.save_dimensions(),n=this.get_frontside_element(),setTimeout(function(){$(n).removeClass("toontalk-bird-gimme")}),
b.set_visible(!0),e&&!l&&(b.robot_waiting_before_next_step=e,b.remove_from_parent_of_frontside(),e.run_next_step&&(h=function(){k.robot_waiting_before_next_step=void 0;e.run_next_step()})),f.animate_bird_delivery(k,this,h,d,e)):(f.add_to_contents(k,d,e),e&&e===k.robot_waiting_before_next_step&&(k.robot_waiting_before_next_step=void 0,e.run_next_step()))}else console.log("TODO: handle drop on a nestless bird -- just removes other?");d&&this.robot_in_training()&&this.robot_in_training().dropped_on(b,
this);return!0};l.animate_delivery_to=function(b,c,d,l,k,n,r,h){var C=!!d,w=this.get_parent_of_frontside(),z=this.get_frontside_element();$(z).width();var y=this.closest_visible_ancestor_or_frontside(),p=$(y.get_frontside_element()).offset(),P=function(){var b=$(fa).offset(),c;C?this.remove():this.visible()&&(c=function(){$(z).removeClass("toontalk-bird-morph-to-static");$(z).addClass("toontalk-bird-static");w&&w.get_widget().rerender()},z.style.position=da,b&&(p.left-=b.left,p.top-=b.top),$(z).css(p),
fa&&fa.appendChild(z),w&&(w.get_widget().is_top_level()?this.rerender():w.get_widget().rerender()),W&&(ua.remove_backside_widget(this,!1,!0),W(),e&&(b=e,e=[],t=[],b.forEach(function(a){a()}))),a.UTILITIES.add_animation_class(z,"toontalk-bird-morph-to-static"),a.UTILITIES.add_one_shot_event_handler(z,"animationend",1E3,c));n&&n()}.bind(this),J=function(){try{d.add_to_contents(b,r,h,this,!0)}catch(c){if(c.wait_for_nest_to_receive_something){c.wait_for_nest_to_receive_something.run_when_non_empty(J,
this);n&&(n(),n=void 0);return}throw c;}M();a.UTILITIES.set_timeout(function(){this.fly_to(p,P)}.bind(this))}.bind(this),O=function(b,c){b.width_before_carry=$(b).width();b.height_before_carry=$(b).height();this.element_to_display_when_flying=b;c&&(this.update_display(),setTimeout(function(){c.update_display()}));$(this.element_to_display_when_flying).addClass("toontalk-carried-by-bird");a.UTILITIES.set_timeout(function(){$(this.element_to_display_when_flying).css({left:"",top:"",width:"",height:"",
position:""});this.update_display()}.bind(this))}.bind(this),M=function(b){if(this.element_to_display_when_flying){var c=this.element_to_display_when_flying.width_before_carry,d=this.element_to_display_when_flying.height_before_carry;$(this.element_to_display_when_flying).removeClass("toontalk-carried-by-bird");b?($(this.element_to_display_when_flying).css({width:c||"",height:d||"","z-index":a.UTILITIES.next_z_index()}),$(z).closest(".toontalk-top-level-backside").append(this.element_to_display_when_flying),
a.UTILITIES.set_absolute_position($(this.element_to_display_when_flying),b)):$(this.element_to_display_when_flying).remove();this.element_to_display_when_flying=void 0;this.update_display()}}.bind(this),U,ca,fa,da,oa,Z,W,ba,ka,Y,ua;d||(d=f);Y=b.get_element();O(Y,b);c.is_function_nest()||(ca=c.get_widget().closest_visible_ancestor_or_frontside().get_widget().get_frontside_element());if(!c.visible()&&!this.visible()||!c.is_function_nest()&&!$(ca).is(":visible"))d.add_to_contents(b,r,h,this,!0);else if(c.is_function_nest()||
(ca=c.get_widget().closest_visible_ancestor_or_frontside().get_widget().get_frontside_element(),U=$(ca).offset(),Z=$(d.get_frontside_element()).closest(".toontalk-top-level-backside")),Z&&Z.is("*")||(Z=$(this.get_frontside_element()).closest(".toontalk-top-level-backside")),(c=Z.offset())||(c={left:0,top:0}),l?p={left:l+c.left,top:k+c.top}:0===p.left&&0===p.top&&(p={left:-Y.clientWidth,top:c.top+Z.height()/2}),U||(U={left:-Y.clientWidth,top:c.top+Z.height()/2}),fa=z.parentElement,y=$(z).width(),oa=
$(z).height(),da=z.style.position,z.style.position="absolute",ua=this.top_level_widget(),w&&w.get_widget().temporarily_remove_contents&&(W=w.get_widget().temporarily_remove_contents(this,!0))&&ua.add_to_top_level_backside(this),Z.append(z),$(z).css({left:l||p.left-c.left,top:k||p.top-c.top,width:y,height:oa}),(ba=d.get_contents_frontside_element&&d.get_contents_frontside_element())&&d.visible()&&(!h||h.visible())){l=$(ca).width();k=$(ca).height();ka=$(ca).offset();c.max_left=c.left+Z.width();c.max_top=
c.top+Z.height();U.left+=l;U.top+=k;var va={left:Math.min(ka.left+l,c.max_left-l),top:Math.min(ka.top+k,c.max_top-k)},sa={left:Math.max(ka.left-l,c.left),top:Math.max(ka.top-k,c.top)};U=function(){var a=function(){d.set_locked(!0);this.fly_to(ka,Aa,300)}.bind(this);M(va);d.get_locked()?d.run_when_unlocked(a):a()}.bind(this);var Aa=function(){O(ba);this.fly_to(sa,Ba,300)}.bind(this),Ba=function(){M(sa);this.fly_to(va,wa,300)}.bind(this),wa=function(){O(Y,b);this.fly_to(ka,X,300)}.bind(this),X=function(){M(ka);
this.fly_to(sa,Q,300)}.bind(this),Q=function(){O(ba);this.fly_to(ka,m,300)}.bind(this),m=function(){d.set_locked(!1);M();d.update_display();J()}.bind(this);this.fly_to(va,U,300)}else this.fly_to(U,J,300)};l.get_json=function(b){return{type:"bird",nest:f&&a.UTILITIES.get_json(f,b)}};l.copy=function(a){var b,c,d;if(a)if(a.just_value)b=this.create(void 0,this.get_description());else{if((d=f.get_guid())&&a.nests_copied&&a.nests_copied[d]){b=a.nests_copied[d][0];k.call(b);for(c=1;c<a.nests_copied[d].length;c++)p.call(a.nests_copied[d][c],
b);b=this.create(b,this.get_description())}else b=this.create(f,this.get_description());a.birds_copied||(a.birds_copied={});d&&(a.birds_copied[d]||(a.birds_copied[d]=[]),a.birds_copied[d].push(b))}else b=f&&f.is_function_nest()?this.create(f.copy(),this.get_description()):this.create(f,this.get_description());return this.add_to_copy(b,a)};l.run_when_non_empty=function(a,b){0>t.indexOf(b)&&(e.push(a),t.push(b))};l.create_backside=function(){var b=a.bird_backside.create(this);f&&f.is_function_nest()&&
n(f,b,this);return b};l.get_help_URL=function(){return f&&f.is_function_nest()?"docs/manual/function-birds.html":"docs/manual/birds-nests.html"};l.is_function_bird=function(){return f&&f.is_function_nest()};l.get_custom_title_prefix=function(){var a;return f?f.is_function_nest()&&(a=f.get_function_object())?a.get_description():"Drop something on me and I'll take it to my nest.":"This bird no longer knows where her nest is. She'll get rid of anything you give her."};l.toString=function(a){return f?
f.is_function_nest()?f.get_function_object().toString():"a bird":a&&"conditions"===a.role?"any bird":"a bird without a nest"};l.set_function_name=function(a){f&&f.is_function_nest()&&f.set_function_name(a)&&(this.rerender(),this.robot_in_training()&&this.robot_in_training().edited(this,{setter_name:"set_function_name",argument_1:a,toString:"change the function bird to '"+a+"'",button_selector:".toontalk-select-function"}))};l=l.add_standard_widget_functionality(l);l.set_description(r);a.debugging&&
(l.debug_id=a.UTILITIES.generate_unique_id(),l.debug_string=f?"a bird with "+f.debug_string:"a bird without a nest");return l};b.create_function=function(c,k,l){return b.create(a.nest.create_function(k,c,l||a.UTILITIES.get_first_property(a[c].function)))};b.match=function(a){return a.match_with_any_bird?a.match_with_any_bird(this):this};b.match_with_any_bird=function(){return"matched"};b.update_display=function(){var b=this.get_frontside(!0);this.get_backside();var c;c=b.get_element();a.UTILITIES.give_tooltip(c,
this.get_title());$(c).is(".toontalk-bird, .toontalk-side-animating")||($(c).addClass("toontalk-bird toontalk-bird-static"),c.addEventListener("dragover",function(b){$(c).is(".toontalk-bird-static")&&($(c).removeClass("toontalk-bird-static"),a.UTILITIES.add_animation_class(c,"toontalk-bird-gimme"))}),c.addEventListener("dragleave",function(a){$(c).is(".toontalk-bird-gimme")&&$(c).addClass("toontalk-bird-static").removeClass("toontalk-bird-gimme")}));this.element_to_display_when_flying?c.appendChild(this.element_to_display_when_flying):
$(c).children(".toontalk-side").remove()};b.fly_to=function(b,c,d){var e=this.get_frontside_element(),k=$(e).offset(),k=Math.atan2(b.top-k.top,b.left-k.left),q="toontalk-fly-west toontalk-fly-northwest toontalk-fly-north toontalk-fly-northeast toontalk-fly-east toontalk-fly-southeast toontalk-fly-south toontalk-fly-southwest".split(" ")[Math.round(4*(k/Math.PI+1))%8];$(e).position();a.UTILITIES.add_animation_class(e,q);this.animate_to_absolute_position(b,function(){$(e).removeClass(q);d?($(e).addClass("toontalk-bird-static"),
setTimeout(c,d)):c()})};b.get_type_name=function(a,b){return a?b&&this.is_function_bird()?"function birds":"birds":"bird"};b.matching_resource=function(a){return a.get_type_name&&a.get_type_name()===this.get_type_name()};b.drop_on=function(a,b,c,d){if(a.widget_dropped_on_me)return a.widget_dropped_on_me(this,!1,c,d)};a.creators_from_json.bird=function(b,c){return a.bird.create(a.UTILITIES.create_from_json(b.nest,c),b.description)};return b}(window.TOONTALK);window.TOONTALK.bird_backside=function(a){return{create:function(b){b=
a.backside.create(b);b.add_advanced_settings(!0);return b}}}(window.TOONTALK);window.TOONTALK.nest=function(g){var d=Object.create(g.widget),n,f={};d.create=function(f,l,e,t){var q=Object.create(d),B=[],x=[],G;l||(l=[]);p=function(c){t&&a.call(t,this);t=c;e=c.get_guid();b.call(c,this)};k=function(){t&&a.call(t,this);t=void 0;e=g.UTILITIES.generate_unique_id()};b=function(a){n||(n=g.UTILITIES.generate_unique_id());this[n](a)};a=function(a){n||(n=g.UTILITIES.generate_unique_id());this[n](a,!0)};q.is_nest=
function(){return!0};q.get_guid=function(){return e};q.matched_by=function(a){return 0<l.length?g.UTILITIES.match(a,l[0].get_widget()):[[this,a]]};q.run_when_non_empty=function(a,b){0<l.length?a(l[0]):0>x.indexOf(b)&&(B.push(a),x.push(b))};q.dereference=function(){return 0<l.length?l[0]:this};q.add_to_contents=function(a,b,c,d,e){var f;1===l.push(a)?(0<B.length&&(f=B,B=[],x=[],f.forEach(function(b){b(a)})),a.set_visible(this.visible())):(a.get_widget().hide(),a.set_visible(!1));a.is_backside()?a.get_widget().set_parent_of_backside(this):
a.get_widget().set_parent_of_frontside(this);G&&!e&&(d?G.forEach(function(e){e.has_ancestor(a.get_widget())||e.animate_bird_delivery(g.UTILITIES.copy_side(a),d,void 0,b,c)}):G.forEach(function(d){d.has_ancestor(a.get_widget())||d.add_to_contents(g.UTILITIES.copy_side(a,!1,!0),b,c)}));this.rerender()};q.animate_bird_delivery=function(a,b,c,d,e){var f,l,k;b.animate_delivery_to(a,this,void 0,void 0,void 0,c,d,e);G&&(f=$(b.closest_visible_ancestor().get_widget().get_frontside_element()).closest(":visible").position(),
l=b.get_parent_of_frontside().get_element(),k=this.visible(),G.forEach(function(c){var d=g.UTILITIES.copy_side(a,!1,k),h,q;c.has_ancestor(a.get_widget())||(c.visible()||k?(h=b.copy({just_value:!0}),q=h.get_frontside_element(!0),$(l).append(q),h.animate_delivery_to(d,c,c,f.left,f.top,void 0,e)):c.add_to_contents(d,void 0,e))}))};q.get_contents_frontside_element=function(){if(0<l.length)return l[0].get_widget().get_frontside_element()};q.get_locked=function(){return this.locked_for_animating_deliveries};
q.set_locked=function(a){this.locked_for_animating_deliveries=a;!a&&this.to_run_when_unlocked&&0<this.to_run_when_unlocked.length&&this.to_run_when_unlocked.shift()()};q.run_when_unlocked=function(a){this.to_run_when_unlocked?this.to_run_when_unlocked.push(a):this.to_run_when_unlocked=[a]};q.removed_from_container=function(a,b,c,d,e){if(a=l.shift())a.is_backside()?a.get_widget().set_parent_of_backside(void 0):a.get_widget().set_parent_of_frontside(void 0);else if(e){g.UTILITIES.report_internal_error("Nothing removed from nest!");
return}this.visible()&&(a.get_widget().restore_dimensions(),0<l.length&&(l[0].set_visible(!0),$(l[0].get_element()).show()),this.render());return a};q.dereference_path=function(a,b,c){if(0===l.length)return{wait_until_this_nest_receives_something:this};if(l)return l[0].dereference_path(a,b,c);g.UTILITIES.display_message("Robot expected to find a nest something that it could get "+g.path.toString(a)+". But the nest is empty.");return this};q.dereference_contents=function(a,b,c){var d,e,f,k;return 0===
l.length?{wait_until_this_nest_receives_something:this}:a.removing_widget?(a=l[0],c.remove_from_container(a,this),this.visible()&&(f=this.get_frontside_element(),c=$(f).offset(),b=$(f).closest(".toontalk-backside-of-top-level"),(d=b.offset())||(d={left:0,top:0}),e=a.get_frontside_element(),k=$(f).width(),f=$(f).height(),$(e).css({left:.1*k+c.left-d.left,top:.1*f+c.top-d.top,width:k*g.nest.CONTENTS_WIDTH_FACTOR,height:f*g.nest.CONTENTS_HEIGHT_FACTOR}),b.append(e)),a):a.next?l[0].get_widget().dereference_path(a.next,
b,c):l[0].get_widget()};q.get_json=function(a){return{type:"nest",contents:g.UTILITIES.get_json_of_array(l,a),guid:e,original_nest:t&&g.UTILITIES.get_json(t,a)}};q.copy=function(a){var b,d,h,f;if(a&&a.just_value)return 0<l.length?l[0].get_widget().copy(a):g.nest.create(this.get_description(),[],"in a robot's condition");b=g.UTILITIES.copy_widget_sides(l,a);a?a.fresh_copy?d=g.nest.create(this.get_description(),b,e&&g.UTILITIES.generate_unique_id()):(h=t||this,a.birds_copied&&a.birds_copied[e]?(f=h.get_guid(),
a.nests_copied&&a.nests_copied[f]?(d=a.nests_copied[f][0].copy(),a.nests_copied[f].forEach(function(a){p.call(a,d)})):d=g.nest.create(this.get_description(),b,g.UTILITIES.generate_unique_id()),a.birds_copied[e].forEach(function(a){c.call(a,d)})):d=g.nest.create(this.get_description(),b,e,h),a.nests_copied||(a.nests_copied={}),a.nests_copied[h]?a.nests_copied[f].push(d):a.nests_copied[f]=[d]):d=g.nest.create(this.get_description(),b,e,t||this);return this.add_to_copy(d,a)};q.has_contents=function(){return 0<
l.length};q.dropped_on_other=function(a,b,c,d){var f,l,k,n,t,p,r;if(!e){e=g.UTILITIES.generate_unique_id();g.debugging&&(q.debug_string="A nest with "+e);f=g.bird.create(this);if(d){d.add_newly_created_widget(f);if(!this.visible())return;this.robot_waiting_before_next_step=d}c&&this.robot_in_training()&&this.robot_in_training().add_newly_created_widget(f);this.rerender();l=this.get_frontside_element(!0);g.UTILITIES.add_animation_class(l,"toontalk-hatch-egg");t=function(){var e,q,t;if(b)e=a.get_backside();
else if((t=g.UTILITIES.widget_from_jquery($(l).closest(".toontalk-top-level-backside")))||(t=g.UTILITIES.widget_from_jquery($(a.get_widget().get_frontside_element(!0)).closest(".toontalk-top-level-backside"))),t)e=t.get_backside();else{g.UTILITIES.report_internal_error("Unable to find the top-level backside for bird to go to.");return}q=e.get_element();t=$(q).offset();k=f.get_frontside_element(!0);$(k).removeClass("toontalk-bird-static");g.UTILITIES.add_animation_class(k,"toontalk-fly-southwest");
n=g.UTILITIES.relative_position(l,q);$(k).css({left:n.left,top:n.top});c&&this.robot_in_training()?e.widget_dropped_on_me(f,!1,c,void 0,!0):e.widget_dropped_on_me(f,!1,c);$(l).removeClass("toontalk-hatch-egg").addClass("toontalk-empty-nest").css({width:"",height:""});this.get_parent_of_frontside().get_widget().is_top_level()&&$(l).css({left:n.left-5,top:n.top+45});r=function(){$(k).removeClass("toontalk-fly-southwest");g.UTILITIES.set_timeout(function(){g.UTILITIES.add_animation_class(k,"toontalk-fly-down");
p=function(){$(k).removeClass("toontalk-fly-down");g.UTILITIES.add_animation_class(k,"toontalk-bird-morph-to-static");g.UTILITIES.add_one_shot_event_handler(k,"animationend",1E3,function(){$(k).removeClass("toontalk-bird-morph-to-static toontalk-side-animating").addClass("toontalk-bird-static")});d&&(this.robot_waiting_before_next_step=void 0,d.run_next_step());f.update_display()}.bind(this);g.UTILITIES.add_one_shot_event_handler(l,"animationend",1E3,p)}.bind(this))}.bind(this);$(k).removeClass("toontalk-bird-static");
e=Math.max(10,n.left-70);q=Math.max(10,n.top+70);f.animate_to_absolute_position({left:e+t.left,top:q+t.top},r);this.rerender()}.bind(this);g.UTILITIES.add_one_shot_event_handler(l,"animationend",2E3,t)}return!0};q.widget_dropped_on_me=function(a,b,c,d){c&&a.save_dimensions&&a.save_dimensions();0===l.length?(this.add_to_contents(b?a.get_backside():a,c,d),a.dropped_on_other?a.dropped_on_other(this,b,c,d):c&&this.robot_in_training()&&this.robot_in_training().dropped_on(a,this)):a.drop_on(l[0].get_widget(),
b,c,d);return!0};q.drop_on=function(a,b,c,d){return a.widget_dropped_on_me?(a.widget_dropped_on_me(this,!1,c,d),!0):!1};q.element_to_highlight=function(){return 0===l.length?this.get_frontside_element():l[0].get_frontside_element()};q.update_display=function(){var a=this.get_frontside(!0),b=this.get_backside(),c,d,f,k,q,a=a.get_element();0<l.length?(c=l[0].get_widget(),l[0].is_backside()?(k=c.get_backside(!0),q=k.get_element(),k.update_display(),k.scale_to_fit(q,a)):(c.render(),q=l[0].get_element()),
d=$(a).width(),f=$(a).height(),0<d&&0<f&&g.UTILITIES.set_timeout(function(){for(var a=2*q.toontalk_border_size||0,b=g.nest.CONTENTS_WIDTH_FACTOR*d,e=g.nest.CONTENTS_HEIGHT_FACTOR*f;2*a>=b||2*a>=e;)a/=2;b-=a;e-=a;$(q).css({width:b,height:e,left:.1*d,top:.1*f});c.set_size_attributes&&c.set_size_attributes(b,e)},2),a.appendChild(q),$(a).addClass("toontalk-empty-nest"),l[0].is_backside()?c.set_parent_of_backside(this):c.set_parent_of_frontside(this)):(g.UTILITIES.give_tooltip(a,this.get_title()),e?($(a).removeClass("toontalk-nest-with-egg"),
$(a).addClass("toontalk-empty-nest")):g.UTILITIES.add_animation_class(a,"toontalk-nest-with-egg"));$(a).addClass("toontalk-nest");b&&b.rerender()};n||(n=g.UTILITIES.generate_unique_id());q[n]=function(a,b){if(!G){if(b)return;G=[]}b?G.splice(G.indexOf(a),1):G.push(a)};q.get_path_to=function(a,b){var c;if(0<l.length){c=l[0].get_widget();if(c===a)return g.path.to_widget_on_nest();if(c.get_path_to)return c.get_path_to(a,b)}};q.walk_children=function(a){if(0<l.length)return a(l[0])};q.top_contents_is=
function(a){return 0<l.length&&l[0].get_widget()===a};q.any_nest_copies_visible=function(){var a=!1;if(!G)return!1;G.some(function(b){b.visible()&&(a=!0)});return a};q.compare_with=function(a){if(0<l.length)return l[0].compare_with(a);if(a.compare_with_nest)return-1*a.compare_with_nest(this)};q.compare_with_nest=function(a){return 0===l.length?0:1};q.compare_with_number=function(a){return 0<l.length?l[0].compare_with(a):-1};q.compare_with_box=q.compare_with_number;q.compare_with_scale=q.compare_with_number;
q=q.add_standard_widget_functionality(q);q.set_description(f);g.debugging&&(q.debug_id=g.UTILITIES.generate_unique_id(),q.debug_string=e?"A nest with "+e:"A nest with an egg");t&&e&&(n||(n=g.UTILITIES.generate_unique_id()),t[n](q));return q};d.create_function=function(a,b,c){var d=function(){return!1},f=g[b]&&g[b].function&&g[b].function[c],d={get_function_type:function(){return b},get_function_object:function(){return f},set_function_name:function(a){if(c===a)return!1;c=a;f=g[b]&&g[b].function&&
g[b].function[c];this.add_to_contents=f.respond_to_message;return!0},is_function_nest:function(){return!0},copy:function(){return g.nest.create_function(a,b,c)},animate_bird_delivery:function(a,b,c,d,e){b.animate_delivery_to(a,this,void 0,void 0,void 0,c,d,e)},get_json:function(a){return{type:"function_nest",function_type:b,function_name:f?f.name:g.UTILITIES.get_first_property(g[b].function)}},add_to_json:g.widget.add_to_json,get_widget:function(){return this},get_guid:function(){},has_ancestor:d,
visible:d,any_nest_copies_visible:d,is_backside:d};g.widget.has_parent(d);g.widget.has_description(d);g.widget.add_sides_functionality(d);d.set_description(a);f?(d.add_to_contents=f.respond_to_message,g.debugging&&(d.debug_id=g.UTILITIES.generate_unique_id(),d.debug_string="a function nest that "+f.get_description())):g.UTILITIES.report_internal_error("Cannot create a function nest because TOONTALK."+b+"."+c+" is not defined.");return d};g.creators_from_json.function_nest=function(a,b){return g.nest.create_function(a.description,
a.function_type,a.function_name)};d.create_backside=function(){return g.nest_backside.create(this)};d.match=function(a){return a.match_nest_with_nest?a.match_nest_with_nest(this):a};d.match_nest_with_nest=function(a){return"matched"};d.toString=function(){return"a nest"};d.get_help_URL=function(){return"docs/manual/birds-nests.html"};d.get_type_name=function(a){return a?"nests":"nest"};d.matching_resource=function(a){return a.get_type_name&&a.get_type_name()===this.get_type_name()};d.get_custom_title_prefix=
function(){return"Drop something on my bird and she'll take it here."};g.creators_from_json.nest=function(a,b){var c=!a.original_nest&&a.guid&&f[a.guid];c||(c=g.nest.create(a.description,g.UTILITIES.create_array_from_json(a.contents,b),a.guid,a.original_nest&&g.UTILITIES.create_from_json(a.original_nest,b)),f[a.guid]=c);return c};d.CONTENTS_WIDTH_FACTOR=.8;d.CONTENTS_HEIGHT_FACTOR=.8;return d}(window.TOONTALK);window.TOONTALK.nest_backside=function(a){return{create:function(b){b=a.backside.create(b);
b.add_advanced_settings(!0);return b}}}(window.TOONTALK)})();window.TOONTALK.scale=function(c){var p=Object.create(c.widget);p.create=function(b,a,k,g){var d=function(){k.rerender()},n,f,p;k||(k=c.box.create(2,void 0,b,a));n=k.get_json;f=k.copy;p=k.get_path_to;k.is_scale=function(){return!0};k.copy=function(a){var b;a||(a={});b=f.call(this,a);b=c.scale.create(void 0,void 0,b,a.just_value&&this.get_state());return k.add_to_copy(b,a)};k.get_json=function(a){a=n.call(this,a);a.type="scale";a.inactive_state=this.get_inactive_state();return a};k.get_path_to=function(a,
b){var c=p.call(this,a,b);c&&(c.true_type="scale");return c};k.drop_on=function(a,b,c,d){if(a.widget_dropped_on_me)return a.widget_dropped_on_me(this,b,c,d)};k.widget_dropped_on_me=function(a,b,c,d){var f=this.get_hole_contents(0),g=this.get_hole_contents(1),k;a.dropped_on_other&&a.dropped_on_other(this,!1,c,d);if(f&&!g)return this.get_hole(1).widget_dropped_on_me(a,b,c,d),!0;if(!f&&(g||!c))return this.get_hole(0).widget_dropped_on_me(a,b,c,d),!0;k=this.which_hole(c,!1);if(0===k){if(f){if(f.drop_on)return a.drop_on(f,
b,c,d);return}}else if(g){if(g.drop_on)return a.drop_on(g,b,c,d);return}this.get_hole(k).widget_dropped_on_me(a,b,c,d);return!0};k.which_hole=function(a,b){var c=$(k.get_frontside_element()),d=c.offset(),c=c.width(),d=a.clientX-(d.left+c/2),c=b?c/10:0;return-d>c?0:d>c?1:-1};k.get_inactive_state=function(){return g};k.update_display=function(){var a=this.get_frontside_element(),b=$(a),d=$(a).children(".toontalk-scale-half"),f=$(a).parent(),f=f.is(".toontalk-backside")?a:f.get(0),g=$(f).width(),k=$(f).height(),
n=function(a,b,c){var d=b.get_frontside_element(!0),e=c*g*.5,f=.5*g,l=k;b=b.get_contents();$(a).css({left:e,top:0,width:f,height:l});a!==d&&(e=0===c?-.05*g:.15*g,c="toontalk-scale-balanced"===r?.1*k:0===c&&"toontalk-scale-left_heavier"===r||1===c&&"toontalk-scale-right_heavier"===r?.25*k:1===c&&"toontalk-scale-left_heavier"===r||0===c&&"toontalk-scale-right_heavier"===r?-.1*k:.2*k,f=.4*g,l=.4*k,$(d).css({left:e,top:c,width:f,height:l}),b&&(b.set_location_attributes&&b.set_location_attributes(e,c),
b.set_size_attributes&&b.set_size_attributes(f,l)),a.appendChild(d))},p,r;b.is(".toontalk-top-level-resource")?r="toontalk-scale-balanced":(p=this.get_state(),r="undefined"===typeof p?"toontalk-scale-unbalanced":["toontalk-scale-right_heavier","toontalk-scale-balanced","toontalk-scale-left_heavier"][p+1]);b.removeClass("toontalk-scale-balanced toontalk-scale-left_heavier toontalk-scale-right_heavier toontalk-scale-unbalanced");b.addClass(r);b.addClass("toontalk-scale");b=c.UTILITIES.scale_to_fit(a,
f,123,91);0===g&&(g=1);0===k&&(k=1);g/=b.x_scale;k/=b.y_scale;2===d.length?d.each(function(a,b){c.UTILITIES.set_timeout(function(){n(b,this.get_hole(a),a)}.bind(this))}.bind(this)):this.get_holes().forEach(function(b,c){var d=b.get_element();0===c?$(d).addClass("toontalk-left_scale  toontalk-scale-half"):$(d).addClass("toontalk-right_scale toontalk-scale-half");n(d,b,c);a.appendChild(d)});c.UTILITIES.give_tooltip(a,this.get_title());c.debugging&&(this.debug_string=this.toString())};k.render=function(){c.DISPLAY_UPDATES.pending_update(this)};
k.get_type_name=function(a){return a?"scales":"scale"};k.get_help_URL=function(){return"docs/manual/scales.html"};k.toString=function(){var a=this.get_hole_contents(0),b=this.get_hole_contents(1),d,f,g;switch(this.get_state()){case -1:d="scale leaning to the right";break;case 1:d="scale leaning to the left";break;case 0:d="balanced scale";break;default:if(d="unbalanced scale",!f&&!g)return d}f=a?"contains "+c.UTILITIES.add_a_or_an(a.get_full_description()):"is empty";g=b?"contains "+c.UTILITIES.add_a_or_an(b.get_full_description()):
"is empty";return d+" and the left pan "+f+" and the right pan "+g};k.create_backside=function(){return c.scale_backside.create(this)};k.get_state=function(){var a=this.get_inactive_state(),b;if(a)return a;a=this.get_hole_contents(0);b=this.get_hole_contents(1);if(a||b)if(a){if(!b)return 1;if(a.compare_with)return a.compare_with(b)}else return-1};k.match=function(a){return a.match_with_scale?a.match_with_scale(this):this};k.match_with_scale=function(a){return this.get_state()===a.get_state()?"matched":
a};k.compare_with=function(a){if(a.compare_with_scale)return-1*a.compare_with_scale(this)};k.compare_with_scale=function(a){var b=this.get_state();a=a.get_state();return b&&!a?1:!b&&a?-1:b>a?1:b<a?-1:0};k.get_hole(0).add_listener("value_changed",d);k.get_hole(1).add_listener("value_changed",d);k.get_hole_contents(0)&&k.get_hole_contents(0).add_listener("value_changed",d);k.get_hole_contents(1)&&k.get_hole_contents(1).add_listener("value_changed",d);k.get_custom_title_prefix=function(){var a=this.get_state(),
b=this.get_hole_contents(0),c=this.get_hole_contents(1);if("undefined"===typeof a)return b&&c?"I can't compare "+b+" and "+c+".":"Use me to compare two things. Drop them in my pans.";b||(b="empty pan");c||(c="empty pan");return["The "+c+" is greater than the "+b+".","The "+c+" is equal to the "+b+".","The "+c+" is less than the "+b+"."][a+1]};c.debugging&&(k.debug_string=k.toString(),k.debug_id=c.UTILITIES.generate_unique_id());return k};c.creators_from_json.scale=function(b,a){return p.create(c.UTILITIES.create_array_from_json(b.contents,
a),b.description,void 0,b.inactive_state)};return p}(window.TOONTALK);window.TOONTALK.scale_backside=function(c){return{create:function(p){p=c.backside.create(p);p.add_advanced_settings(!0);return p}}}(window.TOONTALK);(function(){window.TOONTALK.robot=function(c){var p=function(a,b,g,d,n){g.current_action_name=b;(a=c.path.get_path_to(a,g))?g.add_step(c.robot_action.create(a,b,d),n):console.log("No path found for "+b);g.current_action_name=void 0},b=Object.create(c.widget);b.create=function(a,k,g,d,n,f,p){var l=Object.create(b),e,t=!1,q=[],B,x,G;g||(g=c.actions.create());e||(e=l);l.is_robot=function(){return!0};l.get_frontside_conditions=function(){return a};l.set_frontside_conditions=function(b){a=b;a.set_parent_of_frontside(this)};
a&&a.set_parent_of_frontside(this);l.get_backside_conditions=function(){return k};l.set_backside_conditions=function(a){(k=a)&&c.UTILITIES.available_types.forEach(function(a){k[a]&&(c.widget.erasable(k[a]),k[a].set_parent_of_frontside(this))}.bind(this))};l.add_to_backside_conditions=function(a){var b,d;if(!(0<=this.get_newly_created_widgets().indexOf(a))){d=a.get_type_name();if(k){if(k[d])return}else k={};G.some(function(a){if(a.is_of_type(d))return b=a,!0});b&&(k[d]=b,c.widget.erasable(b))}};l.get_body=
function(){return g};l.running_or_waiting=function(){return B};l.set_running_or_waiting=function(a){B=a};l.stopped=function(){return x};l.set_stopped=function(a){(x=a)&&this.visible()&&$(this.get_frontside_element()).removeClass("toontalk-robot-waiting");this.get_next_robot()&&this.get_next_robot().set_stopped(a)};l.get_animating=function(){return t};l.set_animating=function(a,b){var d=this.get_frontside_element();(t=a)?(b||(b=$(d).offset()),$(d).addClass("toontalk-robot-animating toontalk-side-animating"),
$(d).css({width:"",height:"","z-index":c.UTILITIES.next_z_index()}),c.UTILITIES.set_position_relative_to_top_level_backside($(d),b),$(d).closest(".toontalk-top-level-backside").append(d)):$(d).removeClass("toontalk-robot-animating toontalk-side-animating")};l.add_body_finished_listener=function(a){q.push(a)};l.run_body_finished_listeners=function(){q.forEach(function(a){a()});q=[]};l.get_thing_in_hand=function(){return n};l.set_thing_in_hand=function(a){c.debugging&&a&&"empty hole"===a.get_type_name()?
c.UTILITIES.report_internal_error("Robot trying to pick up an empty hole."):n=a};l.get_next_robot=function(){return p};l.set_next_robot=function(a){var b=this.get_backside_element();a&&a.set_first_in_team(this.get_first_in_team());!a&&p&&p.set_first_in_team(p);p=a;b&&(a=a?"When the robot can't run then this one will try: ":window.TOONTALK.robot.empty_drop_area_instructions,$(b).find(".toontalk-drop-area-instructions").get(0).innerHTML=a)};l.get_first_in_team=function(){return e};l.set_first_in_team=
function(a){e=a;p&&p.set_first_in_team(a)};l.walk_children=function(a){var b;p&&!a(p)||!(b=this.get_frontside_conditions())||b.is_top_level()||a(b)};l.get_run_once=function(){return f};l.set_run_once=function(a){f=a;this.update_title()};l.can_run=function(){return this.get_frontside_conditions()&&this.get_frontside_conditions().is_top_level()||c.widget.can_run.call(this)};l.training_started=function(a){var b=this.get_context();b?this.being_trained||(this.being_trained=!0,this.set_frontside_conditions(b.copy({just_value:!0})),
a||$("*").css({cursor:"url("+c.UTILITIES.absolute_file_path("images/RB19.32x32.PNG")+"), default"}),this.update_title(),a=this.get_backside_element(),$(a).find(".toontalk-conditions-panel").remove(),G=c.UTILITIES.copy_widget_sides(b.get_backside_widgets(),{just_value:!0}),this.robot_training_this_robot()&&this.robot_training_this_robot().started_training_another(this)):c.UTILITIES.report_internal_error("Robot started training but can't find its 'context'.")};l.training_finished=function(){if(this.being_trained){var a,
b,d;a=this.get_body().get_newly_created_widgets();for(b=0;b<a.length;b++)d=a[b],"drop it on top-level"!==d.last_action&&"copy"!==d.last_action||this.add_step(c.robot_action.create(c.newly_created_widgets_path.create(b),"add to the top-level backside"));this.rerender();this.being_trained=!1;this.update_title();this.backup_all();this.robot_finished_training();this.robot_in_training()?this.robot_in_training().finished_training_another(this):$("*").css({cursor:""})}};p&&l.set_next_robot(p);l=l.add_standard_widget_functionality(l);
l.set_description(d);c.debugging&&(l.debug_id=c.UTILITIES.generate_unique_id());return l};b.create_backside=function(){return c.robot_backside.create(this)};b.copy=function(a){var b=this.get_frontside_conditions(),g=this.get_backside_conditions(),b=b?b.copy({just_value:!0}):void 0,d=this.get_next_robot(),d=d?d.copy(a):void 0,n;g&&(n={},c.UTILITIES.available_types.forEach(function(a){n[a]&&(n[a]=n[a].copy({just_value:!0}))}));g=this.create(b,n,this.get_body().copy(),this.get_description(),this.get_thing_in_hand(),
this.get_run_once(),d);return this.add_to_copy(g,a)};b.match=function(a){return a.is_robot()?"matched":this};b.run=function(a,b,g){var d=this.get_frontside_conditions(),n,f,p;if(this.being_trained||!d||this.get_first_in_team().running_or_waiting())return this;p=function(a){a.visible()&&$(a.get_frontside_element()).removeClass("toontalk-conditions-not-matched toontalk-conditions-waiting").find(".toontalk-conditions-not-matched, .toontalk-conditions-waiting").removeClass("toontalk-conditions-not-matched toontalk-conditions-waiting")};
p(d);this.rerender();this.match_status=c.UTILITIES.match(d,a);"matched"===this.match_status&&(n=this.get_backside_conditions())&&(d=a.get_backside_widgets())&&d.some(function(a){var b=!a.is_backside()&&n[a.get_widget().get_type_name()];if(b&&(p(b),a=c.UTILITIES.match(b,a.get_widget()),"matched"!==a))return this.match_status=a,!0}.bind(this));if("matched"===this.match_status)return g||(g=c.QUEUE),this.get_body().reset_newly_created_widgets(),this.get_first_in_team().set_running_or_waiting(!0),g.enqueue({robot:this,
context:a,top_level_context:b,queue:g}),this.match_status;if(this.match_status.is_widget)return $(this.match_status.get_frontside_element()).addClass("toontalk-conditions-not-matched"),this.rerender(),this.get_next_robot()?this.get_next_robot().run(a,b,g):this.match_status;this.match_status.forEach(function(a){a[1]&&$(a[1].get_frontside_element()).addClass("toontalk-conditions-waiting")});if(this.get_next_robot()){d=this.get_next_robot().run(a,b,g);if("matched"===d)return d;d.is_widget||d.forEach(function(a){0>
this.match_status.indexOf(a)&&this.match_status.push(a)}.bind(this))}this.get_first_in_team()===this&&(f=function(){this.set_waiting(!1);this.run(a,b,g)}.bind(this),this.match_status.forEach(function(a){a[0]?a[0].run_when_non_empty(f,this):a.run_when_non_empty(f,this)}.bind(this)),this.set_waiting(!0));return this.match_status};b.set_waiting=function(a){var b=this.get_frontside_element();a?(c.UTILITIES.add_animation_class(b,"toontalk-robot-waiting"),c.UTILITIES.give_tooltip(b,"This robot is waiting for a bird to deliver something.")):
($(b).removeClass("toontalk-robot-waiting"),c.UTILITIES.give_tooltip(b,this.get_title()))};b.run_actions=function(a,b,c){return this.stopped()?(this.get_first_in_team().set_running_or_waiting(!1),!1):this.visible()?this.get_body().run_watched(a,b,c,this):this.get_body().run_unwatched(a,b,c,this)};b.picked_up=function(a,b,g){var d;this===a||a.is_top_level()||b.view.backside||(a.get_infinite_stack&&a.get_infinite_stack()?this.current_action_name="pick up a copy of":this.current_action_name="pick up",
g?(d=a,b=a.copy(),b=c.path.get_path_to_resource(b)):b=c.path.get_path_to(a,this),b&&(b=c.robot_action.create(b,this.current_action_name),this.add_step(b,d)),a.last_action=this.current_action_name,this.current_action_name=void 0,this.set_thing_in_hand(a))};b.dropped_on=function(a,b,g){var d,n,f,p;if(this!==a&&this.get_parent_of_frontside().get_widget()!==a){this.current_action_name="drop it on";if(g=c.path.get_path_to(b,this))b.is_backside()&&(n=$(b.get_element()),d=n.offset(),f=n.width(),p=n.height(),
n=$(a.get_frontside_element()).offset(),d={left_offset_fraction:(n.left-d.left)/f,top_offset_fraction:(n.top-d.top)/p}),g=c.robot_action.create(g,this.current_action_name,d),this.add_step(g);a.last_action=this.current_action_name+" "+b.get_type_name();this.current_action_name=void 0;this.set_thing_in_hand(void 0)}};b.dropped_on_text_area=function(a,b,c){p(a,"drop it on the text area of",this,c);a.last_action="drop it on the text area of "+b.get_type_name();this.set_thing_in_hand(void 0)};b.copied=
function(a,b,c){c=c?"pick up a copy of":"copy";p(a,c,this,void 0,b);b.last_action=c};b.removed=function(a){var b;this.get_parent_of_frontside()&&(b=this.get_parent_of_frontside().get_widget());p(a,"remove",this);a.last_action="remove";b===a||a===this?(this.add_to_top_level_backside(this.copy()),this.training_finished()):this.add_newly_created_widget_if_new(a)};b.edited=function(a,b){p(a,"edit",this,b)};b.erased_widget=function(a){p(a,"change whether erased",this)};b.started_training_another=function(a){p(a,
"start training",this)};b.finished_training_another=function(a){p(a,"stop training",this)};b.trained=function(a,b){p(a,"train",this,{step:b})};b.backside_opened=function(a){p(a,"open the backside",this)};b.backside_closed=function(a){p(a,"close the backside",this)};b.button_clicked=function(a,b){p(b.get_widget(),"click the button of",this,{button_selector:a})};b.created_widget=function(a,b,g){this.add_newly_created_widget(a);this.add_to_top_level_backside(a,!1);this.add_step(c.robot_action.create(c.path.get_path_to_resource(a.copy()),
"add a new widget to the work space",{button_selector:g,path_to_source:c.path.get_path_to(b,this)}))};b.get_newly_created_widgets=function(){return this.get_body().get_newly_created_widgets()};b.remove_from_container=function(a,b){var g=b.get_index_of&&a.get_parent_of_frontside()&&b.get_index_of(a),d=function(){b.removed_from_container(a,!1,!0,g,!1)};this.get_animating()?c.UTILITIES.add_one_shot_event_handler(this.get_frontside_element(),"transitionend",2500,d):d();this.add_newly_created_widget_if_new(a)};
b.add_step=function(a,b){this.get_body().add_step(a,b);this.update_title();"train"!==a.get_action_name()&&"start training"!==a.get_action_name()&&this.robot_training_this_robot()&&this.robot_training_this_robot().trained(this,a)};b.get_context=function(){var a=this.get_frontside_element(),b=$(a).parent(),a=c.UTILITIES.widget_from_jquery(b);return!a&&(b=c.UTILITIES.widget_from_jquery(b.closest(".toontalk-backside-of-robot")))?b.get_context():a};b.update_display=function(){var a=this.get_frontside(!0);
this.get_backside();var b=this.get_thing_in_hand(),g,d;c.debugging&&(this.debug_string=this.toString());g=a.get_element();b&&(d=b.get_frontside_element());!d&&this.carrying_tool&&(d=document.createElement("div"),$(d).addClass(this.carrying_tool));c.UTILITIES.give_tooltip(g,this.get_title());$(g).addClass("toontalk-robot");$(g).children(".toontalk-side, .toontalk-held-by-robot").remove();d&&g.appendChild(d);this.match_status&&(this.match_status.is_widget?$(g).addClass("toontalk-side-animating toontalk-robot-not-matched"):
$(g).removeClass("toontalk-robot-not-matched"));c.UTILITIES.set_timeout(function(){var a,c,p,l,e;d&&(e={position:"absolute"},$(d).addClass("toontalk-held-by-robot"),a=$(d).width(),$(d).height(),p=$(g).width(),l=$(g).height(),0===a&&(a=b.get_default_width?b.get_default_width():2*p,c=b.get_default_height?b.get_default_height():l/2,e.width=a,e.height=c),e.left=(p-a)/2,e.top=l/4,$(d).css(e),b&&b.render())})};b.add_newly_created_widget=function(a){return this.get_body().add_newly_created_widget(a)};b.add_newly_created_widget_if_new=
function(a){if(a!==this.get_context())return this.get_body().add_newly_created_widget_if_new(a)};b.get_recently_created_widget=function(){var a=this.get_body().get_newly_created_widgets();return a[a.length-1]};b.get_title=function(){var a=this.get_description();if(a)return a="This robot "+a,0>a.lastIndexOf(".")&&(a+="."),a+"\n"+this.toString();a=this.get_frontside_element();return $(a).is(".toontalk-top-level-resource")?"Drag this robot to a work area.":this.toString()};b.toString=function(a){var b,
g,d,n,f,p,l;if(a&&"conditions"===a.role)return"any robot";b=this.get_frontside_conditions();if(!b)return"an untrained robot";g=this.get_backside_conditions();n=this.get_body();p=f="";a=this.get_next_robot();b.is_top_level()?l="When the workspace's green flag is pressed":(b=c.UTILITIES.add_a_or_an(b.get_full_description({role:"conditions"})),l="When working on something that matches "+b);g&&(Object.keys(g).forEach(function(a){var b=g[a];b&&(l+=" and\nif on the back is "+c.UTILITIES.add_a_or_an(a)+
" that matches "+c.UTILITIES.add_a_or_an(b.get_full_description({role:"conditions"})));d=!0}),d&&(l+="\n"));if(this.being_trained){if(n.is_empty())return"I'm ready to be trained. Show me what to do and then click on my 'Stop training' button.";f="is being trained.\n";p="\n..."}n=f+l+" I will "+(this.get_run_once()?"":"repeatedly ")+"\n"+n.toString({robot:this})+p;this.match_status&&(this.match_status.is_widget?n="I'm not running because the "+this.match_status+" in my conditions (highlighted in red) doesn't match the corresponding widget. Perhaps editing my conditions will help.\n"+
n:"matched"!==this.match_status&&(n="I'm waiting for something to be delivered to the nest that matches the "+this.match_status[0][1]+"in my conditions (highlighted in yellow).\n"+n));a&&(n+="\nIf it doesn't match then the next robot will try to run.\n"+a.toString());return n};b.get_type_name=function(a){return a?"robots":"robot"};b.matching_resource=function(a){return a.is_robot()&&!this.get_frontside_conditions()&&!a.get_frontside_conditions()};b.get_top_level_context_description=function(a){var b=
this.get_frontside_conditions().get_type_name();return"top-level"===b?a&&"third"===a.person?"his workspace":"my workspace":a&&"third"===a.person?"the "+b+" he's working on":"the "+b+" I'm working on"};b.get_help_URL=function(){return"docs/manual/robots.html"};b.get_json=function(a){var b=this.get_frontside_conditions(),g=this.get_backside_conditions(),d,n,f;b&&(d=b.is_top_level()?{type:"top_level"}:c.UTILITIES.get_json(b,a));g&&c.UTILITIES.available_types.forEach(function(b){g[b]&&(n||(n={}),n[b]=
c.UTILITIES.get_json(g[b],a))});this.get_next_robot()&&(f=c.UTILITIES.get_json(this.get_next_robot(),a));return{type:"robot",frontside_conditions:d,backside_conditions:n,body:this.get_body().get_json(a),run_once:this.get_run_once(),next_robot:f}};c.creators_from_json.robot=function(a,b){var g,d,n;a.thing_in_hand&&(d=c.UTILITIES.create_from_json(a.thing_in_hand,b));a.next_robot&&(g=c.UTILITIES.create_from_json(a.next_robot,b));a.backside_conditions&&(n={},c.UTILITIES.available_types.forEach(function(d){n[d]=
c.UTILITIES.create_from_json(a.backside_conditions[d],b)}));return c.robot.create(c.UTILITIES.create_from_json(a.frontside_conditions||a.bubble,b),n,c.UTILITIES.create_from_json(a.body,b),a.description,d,a.run_once,g)};b.find_conditions_path=function(a,b,g){var d=b.get_frontside_conditions(),n=d===a?"entire_condition":d.get_path_to&&d.get_path_to(a,g),d=c.path.get_path_to(b,g),f,p;n||(f=b.get_backside_conditions(),c.UTILITIES.available_types.some(function(b){f[b]&&(n=f[b].get_path_to(a,g))&&(p=b)}));
if(n)return c.robot.create_conditions_path(n,d,p);c.UTILITIES.report_internal_error("Robot has widget in its conditions but unable to construct the path.")};b.create_conditions_path=function(a,b,g){return{dereference_path:function(d,n,f){d=c.path.dereference_path(b,d,n,f);d=g?d.get_backside_conditions()[g]:d.get_frontside_conditions();return"entire_condition"===a?d:c.path.dereference_path(a,d,n,f)},toString:function(){var d="entire_condition"===a?"the ":c.path.toString(a)+" of the ";return g?d+g+
" backside condition of "+c.path.toString(b):d+" front side condition of "+c.path.toString(b)},get_json:function(){return{type:"path_to_robot_conditions",backside_conditions_type:g,path_to_robot:b.get_json(),path_within_conditions:"entire_condition"===a?"entire_condition":a.get_json()}}}};c.creators_from_json.path_to_robot_conditions=function(a){var b=c.UTILITIES.create_from_json(a.path_to_robot),g="entire_condition"===a.path_within_conditions?a.path_within_conditions:c.UTILITIES.create_from_json(a.path_within_conditions);
return c.robot.create_conditions_path(g,b,a.backside_conditions_type)};return b}(window.TOONTALK);window.TOONTALK.robot_backside=function(c){var p=function(a,b,g,d){a=c.UTILITIES.create_text_element(a);var n=b.get_frontside_element(!0),f=document.createElement("div");$(n).addClass("toontalk-conditions-contents "+d);c.UTILITIES.set_timeout(function(){$(n).parent().addClass("toontalk-conditions-contents-container");$(n).css({left:"inherit",width:"inherit",height:"inherit"});b.render()});g.match_status&&
(g.match_status.is_widget?$(g.match_status.get_frontside_element()).addClass("toontalk-conditions-not-matched"):"matched"!==g.match_status&&g.match_status.forEach(function(a){$(a[1].get_frontside_element()).addClass("toontalk-conditions-waiting")}));f.appendChild(n);g=c.UTILITIES.create_horizontal_table(a,f);$(g).addClass("toontalk-conditions-panel");return g},b=function(a,b){var g=b.get_frontside_conditions(),d=b.get_backside_conditions(),n=b.visible(),f,r;g&&(g.is_top_level()?"This robot always runs when the workspace green flag is clicked."!==
a.firstChild.textContent&&a.insertBefore(c.UTILITIES.create_text_element("This robot always runs when the workspace green flag is clicked."),a.firstChild):0===$(a).find(".toontalk-frontside-conditions-area").length&&a.insertBefore(p("Runs only if the widget matches: ",g,b,"toontalk-frontside-conditions-area"),a.firstChild),g.set_visible(n),g.rerender());d&&Object.keys(d).forEach(function(g){if(f=d[g])r="toontalk-backside-"+g+"-conditions-area",0===$(a).find("."+r).length&&(g="bird"===g?c.UTILITIES.create_text_element("And there is a bird on the back."):
p("Runs only if the "+g+" on the backside matches: ",f,b,r),a.insertBefore(g,a.firstChild.nextSibling),f.set_visible(n),f.rerender())})};return{create:function(a){var k=c.backside.create(a),g=k.get_element(),d=c.UTILITIES.create_check_box(!a.get_run_once(),"toontalk-run-once-check-box","When finished start again","Check this if you want the robot to start over again after finishing what he was trained to do."),n=c.UTILITIES.create_drop_area(window.TOONTALK.robot.empty_drop_area_instructions),f=a.get_next_robot(),
p=c.backside.create_advanced_settings_button(k,a),l=k.update_display.bind(k);n.data("drop_area_owner",a);$(d.button).click(function(b){var c=d.button.checked;a.set_run_once(!c);a.robot_in_training()&&a.robot_in_training().edited(a,{setter_name:"set_run_once",argument_1:!c,toString:"change to "+(c?"run again":"run once")+" of the robot",button_selector:".toontalk-run-once-check-box"});b.stopPropagation()});f&&n.append(f.get_frontside_element(!0));n.get(0).addEventListener("drop",function(b){b=c.UTILITIES.get_dragee();
(b=c.UTILITIES.widget_from_jquery(b))&&b.is_robot()&&(b.get_body().is_empty()?(b=b.open_backside(),$(b.get_element()).find(".toontalk-train-backside-button").click()):a.set_next_robot(b))});k.update_display=function(){var b=a.get_frontside_element();b&&c.UTILITIES.give_tooltip(b,a.get_title());l()};g.appendChild(this.create_train_button(k,a));g.appendChild(p);$(d.container).addClass("toontalk-advanced-setting");n.addClass("toontalk-advanced-setting");g.appendChild(d.container);g.appendChild(n.get(0));
b(g,a);k.add_advanced_settings();return k},create_train_button:function(a,k){var g=a.get_element();$(g);var d=$("<button>Train</button>").button();d.addClass("toontalk-train-backside-button");var n=!1;a.change_label_and_title_of_train_button=function(a){a?(d.button("option","label","Stop training"),c.UTILITIES.give_tooltip(d.get(0),"Click to stop training this robot.")):k.get_body().is_empty()?(d.button("option","label","Train"),c.UTILITIES.give_tooltip(d.get(0),"Click to start training this robot.")):
(d.button("option","label","Re-train"),c.UTILITIES.give_tooltip(d.get(0),"Click to start training this robot all over again."));$(g).is(":visible")&&b(g,k)};a.change_label_and_title_of_train_button(n);d.click(function(b){n=!n;a.change_label_and_title_of_train_button(n);n?(k.get_body().reset_steps(),k.robot_started_training(k),k.training_started()):k.training_finished();b.stopPropagation()});return d.get(0)}}}(window.TOONTALK);window.TOONTALK.robot.empty_drop_area_instructions="Drop a robot here who will try to run when this robot can't run."})();(function(){var c=function(b){return"rotate"===b||"skewX"===b||"skewY"===b||"transform-origin-x"===b||"transform-origin-y"===b},p=function(b){return"transform-origin-x"===b||"transform-origin-y"===b?"https://developer.mozilla.org/en-US/docs/Web/CSS/transform-origin#"+b:c(b)?"https://developer.mozilla.org/en-US/docs/Web/CSS/transform#"+b:"http://www.w3.org/community/webed/wiki/CSS/Properties/"+b};window.TOONTALK.element=function(b){var a=["left","top","width","height"],k=Object.create(b.widget),g=
function(a,b){var c,g;if(!a)return 0;"number"===typeof a&&(g=a);0===a.length&&(g=0);if("undefined"===typeof g&&(c=a.substring(a.length-1),0<="0123456789x".indexOf(c)&&(g=parseFloat(a),isNaN(g))))return;c=g;0<=["rotate","skewX","skewY"].indexOf(b)&&(c%=360,0>c&&(c+=360));return c};k.create=function(a,g,f,p){var l=Object.create(k),e=b.UTILITIES.generate_unique_id(),t=l.drag_started,q={},B={},x,G,A,E,I,h,C,w;g||(g=[]);l.is_element=function(){return!0};l.get_HTML=function(){return a};l.get_guid=function(){return e};
l.get_text=function(){var a=this.get_frontside_element().textContent;""===a&&(this.update_display(),a=this.get_frontside_element().textContent);return""===a?this.get_HTML():a};l.set_HTML=function(b){var c=this.get_frontside_element();if(!c||a===b)return!1;a=b;$(c).children(":not(.ui-resizable-handle)").remove();c.innerHTML=a;this.compute_original_dimensions(!0);this.rerender();return!0};l.set_HTML_from_sub_classes=l.set_HTML;l.set_text=function(a){var b=this.get_frontside_element(),c=function(b){$(b).contents().each(function(){this.nodeType==
Node.TEXT_NODE?(this.textContent=a,a=""):c(this,a)})};if(!b||a===b.textContent)return!1;if($(b).is(".toontalk-plain-text-element"))return this.set_HTML(a);c(b);return this.set_HTML(b.innerHTML)};l.get_style_attributes=function(){return g};l.set_style_attributes=function(a){g=a};l.get_attribute_widgets_in_backside_table=function(){return q};l.get_original_copies=function(){return B};l.get_pending_css=function(){return I};l.get_transform_css=function(){return h};l.add_to_css=function(a,b){c(a)?(h||
(h={}),h[a]=b):(I||(I={}),I[a]=b)};l.apply_css=function(){var a="",c,d,e;if((I||h)&&(c=this.get_frontside_element())&&!$(c).is(".toontalk-not-observable"))if($(c).is(":visible")){I?(I.width&&(A=I.width),I.height&&(E=I.height)):I={};h&&(h.rotate&&(a+="rotate("+h.rotate+"deg)"),h.skewX&&(a+="skewX("+h.skewX+"deg)"),h.skewY&&(a+="skewY("+h.skewY+"deg)"),h["transform-origin-x"]||h["transform-origin-y"])&&(I["transform-origin"]=(h["transform-origin-x"]||0)+" "+(h["transform-origin-y"]||0));if(I.left||
I.top)I.left&&(d=$(this.get_parent_of_frontside().get_element()),e=d.width(),I.left=(I.left%e+e)%e),I.top&&(d||(d=$(this.get_parent_of_frontside().get_element())),d=d.height(),I.top=(I.top%d+d)%d);A||E?(w&&w.css({width:x,height:G}),$(c).css({width:"",height:""}),b.UTILITIES.run_when_dimensions_known(c,function(d){b.UTILITIES.scale_element(c,A,E,x,G,a,I,d);I=void 0})):(b.UTILITIES.add_transform_to_css(a,"",I,0>c.parentElement.className.indexOf("toontalk-box-hole")),$(c).css(I),I=void 0)}else b.UTILITIES.set_timeout(function(){this.apply_css()}.bind(this),
100)};l.on_update_display=function(a){C?C.push(a):C=[a]};l.fire_on_update_display_handlers=function(){C&&b.UTILITIES.set_timeout(function(){C.forEach(function(a,b){a()||C.splice(b,1)})})};l.get_image_element=function(){return w};l.set_image_element=function(a,b){w=$(a).find("img");0===w.length?w=void 0:($(b).width(w.width()),$(b).height(w.height()))};l.get_additional_classes=function(){return p};l.set_additional_classes=function(a){p=a};l=l.add_standard_widget_functionality(l);l.drag_started=function(a,
b){this.drag_x_offset=a.view.drag_x_offset;this.drag_y_offset=a.view.drag_y_offset;t.call(this,a,b)};l.update_display=function(){var a=this.get_frontside_element();this.get_backside();var c=function(a){return this.get_image_element()?"image":$(a).is(".toontalk-plain-text-element")?"text":"element"}.bind(this);if(!this.being_dragged)if(this.get_erased()){var d;d=$(a).parent(".toontalk-backside").is("*")?c="":c="100%";this.save_dimensions();$(a).removeClass().empty().addClass("toontalk-erased-element toontalk-side").css({width:c,
height:d,transform:""});$(a).parent(".toontalk-conditions-contents-container").is("*")?b.UTILITIES.give_tooltip(a,"This is an element that has been erased. It will match any element."):b.UTILITIES.give_tooltip(a,"This is an erased element. It will replace its HTML with the HTML of the element you drop on it.")}else $(a).is(".toontalk-erased-element")&&($(a).removeClass("toontalk-erased-element"),this.restore_dimensions()),this.initialise_element(),b.UTILITIES.on_a_nest_in_a_box(a)&&(this.set_attribute("width",
$(a).closest(".toontalk-box-hole").width(),!1),this.set_attribute("height",$(a).closest(".toontalk-box-hole").height(),!1)),"undefined"===typeof x&&a.parentElement&&this.compute_original_dimensions(),this.apply_css(),this.fire_on_update_display_handlers(),b.UTILITIES.give_tooltip(a,"Click to see the backside where you can place robots or change the style of this "+c(a)+".")};l.initialise_element=function(){var a=this.get_frontside_element(),b;a.children.length===$(a).children(".ui-resizable-handle").length&&
(a.innerHTML=this.get_HTML(),this.set_image_element(void 0,a),$(a).addClass("toontalk-element-frontside"),"<"!==a.innerHTML.substring(0,1)&&((b=this.get_additional_classes())&&$(a).addClass(b),$(a).addClass("ui-widget toontalk-plain-text-element")))};l.compute_original_dimensions=function(a){b.UTILITIES.original_dimensions(this,function(a,b){var c=this.get_parent_of_frontside();x=a;G=b;c&&c.get_box?c.get_box().rerender():this.rerender()}.bind(this),a)};l.get_attribute_from_current_css=function(a){var b,
c;if("width"===a&&(A||x))return A||x;if("height"===a&&(E||G))return E||G;b=this.get_frontside_element();c=b.style[a];""===c&&(c=$(b).css(a));return c?"number"===typeof c?c:c.replace("px",""):0};l.get_original_width=function(){return x};l.get_original_height=function(){return G};l.increment_width=function(a){this.set_attribute("width",(A||x)+a)};l.increment_height=function(a){this.set_attribute("height",(E||G)+a)};l.set_description(f);b.debugging&&(l.debug_string=l.toString(),l.debug_id=b.UTILITIES.generate_unique_id());
return l};k.copy=function(a){var b=this.get_style_attributes(),c=k.create(this.get_HTML(),b.slice(),this.get_description());a&&(a.elements_copied||(a.elements_copied={}),a.elements_copied[this.get_guid()]=c);b.forEach(function(a){c.set_attribute(a,this.get_attribute(a))}.bind(this));return this.add_to_copy(c,a)};k.match=function(a){return this.get_erased&&this.get_erased()?a.match_with_any_element?a.match_with_any_element():this:a.match_with_another_element_widget?a.match_with_another_element_widget(this):
this};k.match_with_any_element=function(){return"matched"};k.match_with_another_element_widget=function(a){var b;if(this.get_HTML()===a.get_HTML())return"matched";b=a.get_text();return""!==b&&b===this.get_text()?"matched":a};k.compare_with=function(a){if(a.compare_with_other_element)return a.compare_with_other_element(this)};k.compare_with_other_element=function(a){a=a.get_HTML().localeCompare(this.get_HTML());return 0>a?-1:0<a?1:a};k.widget_dropped_on_me=function(a,b,c,g){if(this.get_erased()&&a.get_HTML)return this.set_HTML(a.get_HTML()),
this.set_erased(!1),a.remove(),!0;console.log("Dropping widgets on un-erased elements does nothing (but may someday)")};k.create_backside=function(){return b.element_backside.create(this)};k.get_attribute_from_pending_css=function(a){var b=this.get_pending_css();if(b&&b[a]||(b=this.get_transform_css())&&b[a])return b[a]};k.get_attribute=function(a){var b=this.get_attribute_from_pending_css(a);return"undefined"!==typeof b?b:this.get_attribute_from_current_css(a)};k.set_attribute=function(a,b,c,k){var l,
e;if(!this.get_frontside(!0).get_element())return!1;l=this.get_attribute_from_pending_css(a);if(l===b)return!1;"undefined"===typeof l&&(l=this.get_attribute_from_current_css(a));e=g(b,a);if("number"===typeof e){if(l==e)return!1;b=e}c&&this.robot_in_training()&&this.robot_in_training().edited(this,{setter_name:"set_attribute",argument_1:a,argument_2:b,toString:"change the '"+a+"' style to "+b+" of",button_selector:".toontalk-element-"+a+"-attribute-input"});this.add_to_css(a,b);k&&(b=this.get_style_attributes(),
0>b.indexOf(a)&&b.push(a));this.rerender();return!0};k.dropped_on_style_attribute=function(a,b,c,g){var l,e,k;if(a){l=a.toString();if(a.is_number()){e=this.get_attribute(b);if("number"===typeof e)k=e;else if("auto"===e)switch(b){case "left":k=$(this.get_frontside_element()).offset().left;break;case "top":k=$(this.get_frontside_element()).offset().top;break;default:k=0}else k=parseFloat(e);e=a.to_float();switch(l.substring(0,1)){case "-":l=k-e;break;case "*":l=k*e;break;case "/":l=k/e;break;case "^":l=
Math.pow(k,e);break;default:l=k+e}this.set_attribute(b,l,!1);(c||g&&g.visible())&&this.get_backside().render()}a.get_infinite_stack()||a.remove();c&&this.robot_in_training()&&this.robot_in_training().dropped_on(a,this.create_attribute_widget(b))}};k.get_attribute_widget_in_backside_table=function(a,b){var c=this.get_attribute_widgets_in_backside_table()[a];c||b||(c=this.create_attribute_widget(a),this.get_attribute_widgets_in_backside_table()[a]=c);return c};k.create_attribute_widget=function(c){var g=
".toontalk-element-"+c+"-attribute-input",f=this.get_backside_element(),k=this.get_attribute(c),l=this,e=function(a,c){var d=c.toString,e=c.equals;A=c.update_display;c.element_widget=this;c.attribute=a;c.get_type_name=function(a){return a?"element attributes":"element attribute"};c.toString=function(){return d.call(this)+" ("+this.attribute+" of this.element_widget)"};c.get_custom_title_prefix=function(){return"I'm the '"+this.attribute+"' attribute of "+this.element_widget+".\nDrop a number on me or edit my back side to change my value. My back side has an info button to learn more."};
c.equals=function(b){return a===b.attribute?this.equals(b.element_widget):e.call(this,b)};c.update_display=function(){var a;this.get_erased()||(a=this.get_attribute_owner().get_attribute(this.attribute),G(a));A.call(this)};c.copy=function(b){var c;if(b){if(b.just_value)return x(b);b.elements_copied&&(c=b.elements_copied[l.get_guid()])}return this.add_to_copy((c||l).create_attribute_widget(a),b)};c.get_json=function(c){return{type:"attribute_widget",attribute_name:a,element:b.UTILITIES.get_json(l,
c)}};c.get_original_attribute_widget=function(){return l.get_original_copies()[a][0]};c.get_attribute_owner=function(){var a=function(b){if(b=b.get_parent_of_frontside())return b.is_backside()?b:a(b.get_widget())},b=this.get_original_attribute_widget();if(b!==this)return b.get_attribute_owner();var c,b=a(this);if(!b||!b.get_widget().is_element())return l;b=b.get_widget();for(c=b.get_parent_of_backside();c&&c.get_widget().is_element();)b=c.get_widget(),c=b.get_parent_of_backside();return b};c.get_help_URL=
function(){return p(a)}}.bind(this),t=function(a,c){var d=b.number.create(0,1);e(a,d);d.set_value_from_decimal(c);d.set_format("decimal");d.set_value=function(b){var c=l.get_original_copies()[a];b=bigrat.toDecimal(b);var d,e;this.get_attribute_owner().set_attribute(this.attribute,b)&&(e=bigrat.fromDecimal(b),c.forEach(function(a,b){d=a.set_value_from_sub_classes(e,!0)}));return d};return d}.bind(this),q=function(a,c){var d=b.element.create(c);e(a,d);d.set_HTML=function(b){var c=l.get_original_copies()[a],
d;this.get_attribute_owner().set_attribute(this.attribute,b)&&c.forEach(function(a,c){d=a.set_HTML_from_sub_classes(b)});return d};d.set_additional_classes("toontalk-string-attribute-widget");return d}.bind(this),B;B=0<=["background-color","color"].indexOf(c)?"string":"number";var x,G,A,E;f&&(g=$(f).find(g),0<g.length&&(g.get(0).toontalk_widget=this));if("number"===B){if(E=t(c,k),G=E.set_value_from_decimal.bind(E),x=b.number.copy.bind(E),0<=a.indexOf(c)&&(this.on_update_display(function(){E.rerender();
return!0}),"left"===c||"top"===c))t=function(a){var b=E.get_attribute_owner(),e;a.currentTarget.toontalk_widget===b&&(e=$(b.get_frontside_element()).closest(".toontalk-top-level-backside").offset(),e||(console.log("Unable to find top-level backside of an element for its position. Perhaps is 'visible' but not attached."),e={left:0,top:0}),a="left"===c?a.pageX-e.left-b.drag_x_offset:a.pageY-e.top-b.drag_y_offset,E.set_value_from_decimal(a),A.call(E))}.bind(this),k=this.get_frontside_element(),k.addEventListener("drag",
t)}else if("string"===B)E=q(c,k),G=E.set_HTML.bind(E),x=b.element.copy.bind(E);else{b.UTILITIES.report_internal_error("Unrecognized attribute type: "+B+" for "+c);return}(k=this.get_original_copies()[c])?k.push(E):this.get_original_copies()[c]=[E];return E};b.creators_from_json.attribute_widget=function(a,c){return b.UTILITIES.create_from_json(a.element,c).create_attribute_widget(a.attribute_name)};b.creators_from_json.attribute_number=b.creators_from_json.attribute_widget;k.on_backside_hidden=function(){this.get_style_attributes().forEach(function(a){(a=
this.get_attribute_widget_in_backside_table(a,!0))&&a.set_visible(!1)}.bind(this))};k.toString=function(a){if(a&&"conditions"===a.role)a=this.get_text();else{a=this.get_HTML();var b;1<a.length&&"<"===a.charAt(0)?(b=a.indexOf(" "),a=a.substring(0,b+1)+"style='width: 50px; height: 30px;'"+a.substring(b)):a='"'+a+'"';a="the element "+a}return a};k.get_type_name=function(a){return a?"elements":"element"};k.get_help_URL=function(){return"docs/manual/elements.html"};k.get_json=function(a){var c=this.get_style_attributes(),
f=[],g=b.UTILITIES.remove_z_index(this.get_HTML()),l=encodeURIComponent(g);0===g.indexOf("<img src='data:image/")?(a.shared_html||(a.shared_html=[]),g=a.shared_html.indexOf(l),0>g&&(g=a.shared_html.push(l)-1),a={shared_html_index:g}):a=l;c.forEach(function(a){f.push(a)});return{type:"element",html:a,attributes:f,attribute_values:f.map(this.get_attribute.bind(this)),additional_classes:this.get_additional_classes()}};b.creators_from_json.element=function(a,b){var c=decodeURIComponent("string"===typeof a.html?
a.html:b.shared_html[a.html.shared_html_index]),p=k.create(c,a.attributes,a.description),l;l=b&&b.event?["left","top"]:[];a.attribute_values.forEach(function(b,c){var f=a.attributes[c];0>l.indexOf(f)&&p.add_to_css(f,g(b)||b)});a.additional_classes&&p.set_additional_classes(a.additional_classes);return p};k.create_attribute_path=function(a,c){var f=b.path.get_path_to(a.element_widget,c);return this.extend_attribute_path(f,a.attribute)};k.extend_attribute_path=function(a,b){return{dereference_path:function(c,
g,l){return a.dereference_path(g||c,void 0,l).get_attribute_widget_in_backside_table(b)},toString:function(){return"the '"+b+"' property of "+a},get_json:function(){return{type:"path_to_style_attribute",attribute:b,element_widget_path:a.get_json()}}}};b.creators_from_json.path_to_style_attribute=function(a){var c=b.UTILITIES.create_from_json(a.element_widget_path);return k.extend_attribute_path(c,a.attribute)};k.set_size_attributes=function(a,c,f){f?(this.add_to_css("width",a),this.add_to_css("height",
c)):(this.set_attribute("width",a),this.set_attribute("height",c));b.UTILITIES.set_timeout(function(){this.rerender()}.bind(this))};k.set_location_attributes=function(a,b){this.set_attribute("left",a);this.set_attribute("top",b)};k.receive_HTML_from_dropped=function(a){a=a.get_text();if(this.set_HTML(a))return this.get_text()};return k}(window.TOONTALK);window.TOONTALK.element_backside=function(b){var a=function(d,g,f){var r=function(a){var b=g.get_style_attributes();0>b.indexOf(a)&&(b.push(a),"left"===
a?(a=g.get_frontside_element(),$(a).on("drag",function(a){var b=g.get_backside_element(),c=g.get_frontside_element();b&&c&&$(b).find(".toontalk-element-left-attribute-input").val(a.originalEvent.clientX)})):"top"===a&&(a=g.get_frontside_element(),$(a).on("drag",function(a){var b=g.get_backside_element(),c=g.get_frontside_element();b&&c&&$(b).find(".toontalk-element-top-attribute-input").val(a.originalEvent.clientY)})))},l=function(e,l){var B=0<=g.get_style_attributes().indexOf(e),x=b.UTILITIES.create_check_box(B,
"toontalk-style-attribute-check-box",e+"&nbsp;","Click to add or remove the '"+e+"' style attribute from my backside."),B=b.UTILITIES.create_anchor_element("i",p(e)),G=document.createElement("li");$(B).addClass("toontalk-help-button notranslate toontalk-attribute-help-button");$(B).css({color:"white"});B.translate=!1;B.lang="en";x.container.appendChild(B);x.button.addEventListener("click",function(b){if(x.button.checked)r(e);else{b=g.get_style_attributes();var l=b.indexOf(e);0<=l&&(b.splice(l,1),
a(d,g,f))}c(f,g,g.get_backside())});G.appendChild(x.container);l.appendChild(G)},e=function(a,b){var c,d;"string"===typeof a?l(a,b):a.label?(c=document.createElement("h3"),c.textContent=a.label,d=document.createElement("ul"),b.appendChild(c),b.appendChild(d),e(a.sub_menus,d)):a.forEach(function(a){e(a,b)})};$(d).is(".ui-accordion")&&$(d).accordion("destroy");$(d).empty();e([{label:"Geometry attributes",sub_menus:"left top width height z-index background-position".split(" ")},{label:"Color attributes",
sub_menus:["background-color","color","opacity"]},{label:"Font attributes",sub_menus:["font-size","font-weight"]},{label:"Visibility",sub_menus:["display","visibility"]},{label:"Transformations",sub_menus:["rotate","skewX","skewY","transform-origin-x","transform-origin-y"]}],d);$(d).accordion({active:0,heightStyle:"content"});return d},c=function(a,c,f){if(f.visible()){var g=c.get_style_attributes();c.get_frontside_element();$(a).empty();g.forEach(function(g){c.get_attribute(g);var e=document.createElement("tr"),
k=document.createElement("td"),q=c.get_attribute_widget_in_backside_table(g),p=q.get_frontside_element();q.set_parent_of_frontside(f,!1,!0);q.set_infinite_stack(!0);a.appendChild(e);e.appendChild(k);k.appendChild(b.UTILITIES.create_text_element(g));k=document.createElement("td");e.appendChild(k);q.set_visible(!0);$(p).addClass("toontalk-element-attribute");k.appendChild(p);q.render()})}},g=function(a){var c=$("<button>Add or remove my style attributes</button>").button();c.addClass("toontalk-show-attributes-chooser-button");
c.click(function(f){$(a).is(":visible")?($(a).hide(),c.button("option","label","Add or remove my style attributes"),b.UTILITIES.give_tooltip(c.get(0),"Click to add widgets for my style attributes.")):($(a).show(),c.button("option","label","Hide my style attributes list"),b.UTILITIES.give_tooltip(c.get(0),"Click to hide my list of attributes that can be added or removed."))});b.UTILITIES.give_tooltip(c.get(0),"Click to add widgets for my style attributes.");return c.get(0)};return{create:function(d){var n=
b.backside.create(d),f=n.get_element();d.get_HTML();var p=document.createElement("table"),l=document.createElement("div"),e=g(l),t=b.backside.create_advanced_settings_button(n,d),q=b.UTILITIES.get_current_url_boolean_parameter("elementHTML",!1),B=q?"get_HTML":"get_text",x=n.update_display.bind(n),G,A,E;d.initialise_element();G=d[B]().trim();0<G.length&&!d.get_image_element()&&(E=function(a){(a=b.UTILITIES.input_area_drop_handler(a,d.receive_HTML_from_dropped.bind(d)))&&d.robot_in_training()&&d.robot_in_training().dropped_on_text_area(a,
d,{area_selector:".toontalk-html-input",setter:"receive_HTML_from_dropped",toString:"for the element's text"})},A=b.UTILITIES.create_text_area(G,"toontalk-html-input","","Type here to edit the text.",E),G=function(a){a=A.button.value.trim();d.get_frontside_element();var b=q?"set_HTML":"set_text";d[b](a)&&d.robot_in_training()&&d.robot_in_training().edited(d,{setter_name:b,argument_1:a,toString:"change the text to "+a+" of",button_selector:".toontalk-html-input"})},$(A.container).resizable(),$(A.container).css({width:"100%"}),
$(A.button).css({width:"100%"}),A.button.addEventListener("change",G),A.button.addEventListener("mouseout",G),f.appendChild(A.container));n.get_attributes_chooser=function(){return l};a(l,d,p);c(p,d,n);f.appendChild(l);f.appendChild(e);f.appendChild(p);f.appendChild(t);$(l).hide();$(l).addClass("toontalk-attributes-chooser");n.update_display=function(){A&&$(A.button).val(d[B]());c(p,d,n);$(l).is(":visible")&&a(l,d,p);x()};$(f).find(".toontalk-hide-backside-button").click(function(a){$(l).hide()});
n.add_advanced_settings();return n}}}(window.TOONTALK)})();window.TOONTALK.sensor=function(c){var p=Object.create(c.widget),b=function(a,b){"element"===a.get_type_name()&&(a.set_attribute("font-size",.5*$(b.get_frontside_element(!0)).height(),!1,!0),a.set_additional_classes("toontalk-string-value-from-sensor"),b.visible()&&a.rerender())};p.create=function(a,k,g,d,n,f){var r=c.nest.create(g,d,"sensor"),l=r.get_json,e=r.update_display,t=r.copy,q=function(a){var d=a[k],e=r.visible(),f=$(r.get_frontside_element()).closest(".toontalk-top-level-backside"),g;if("keyCode"===
k){if(16===d)return;d=String.fromCharCode(d);a.shiftKey||(d=d.toLowerCase())}switch(typeof d){case "number":g=c.number.create(Math.round(d),1);break;case "string":g=c.element.create(d,void 0,void 0,"toontalk-string-value-from-sensor");b(g,r);break;case "boolean":g=c.element.create(d.toString(),void 0,void 0,"toontalk-string-value-from-sensor");b(g,r);break;case "undefined":c.UTILITIES.report_internal_error("No "+k+" in sensor "+p);return}e?(a=c.bird.create(),r.add_to_top_level_backside(a),a.animate_delivery_to(g,
r,r,f.width()/2,f.height())):r.add_to_contents(g)}.bind(this);r.copy=function(b){var d;if(b&&b.just_value&&this.has_contents())return t.call(this,b);d=b?c.sensor.create(a,k,g,void 0,b.copying_resource||n,f):c.sensor.create(a,k,g,void 0,n,f);return r.add_to_copy(d,b)};r.get_json=function(b){var d=l.call(this,b);d.type="sensor";d.event_name=a;d.attribute=k;d.active=n;d.sensor_of=f&&c.UTILITIES.get_json(f,b);return d};r.update_display=function(){var a=$(this.get_frontside_element());e.call(this);n||
a.is(".toontalk-top-level-resource")?(a.addClass("toontalk-sensor-nest"),a.removeClass("toontalk-sensor-inactive-nest")):(a.addClass("toontalk-sensor-inactive-nest"),a.removeClass("toontalk-sensor-nest"));a.removeClass("toontalk-empty-nest")};r.get_type_name=function(a){return a?"sensors":"sensor"};r.get_help_URL=function(){return"docs/manual/sensors.html"};r.toString=function(){return"a sensor that receives the '"+k+"' attribute of "+a+" events"};r.get_active=function(){return n};r.set_active=function(b,
c){if(n!==b||c)b?f?f.get_frontside_element().addEventListener(a,q):window.addEventListener(a,q):f?f.get_frontside_element().removeEventListener(a,q):window.removeEventListener(a,q),n=b};r.set_active(n,!0);r.create_backside=function(){return c.sensor_backside.create(this)};r.get_event_name=function(){return a};r.set_event_name=function(b){var c=n;a&&n&&this.set_active(!1);a=b;c&&this.set_active(!0)};r.get_attribute=function(){return k};r.set_attribute=function(a){k=a};r.match=function(a){return this};
r.set_sensor_of=function(a){f=a};r.get_custom_title_prefix=function(){return"My bird brings me notices of events."};return r};c.creators_from_json.sensor=function(a,k){var g=c.UTILITIES.create_array_from_json(a.contents,k),d=c.sensor.create(a.event_name,a.attribute,a.description,g,!1);a.sensor_of?c.UTILITIES.set_timeout(function(){d.set_sensor_of(c.UTILITIES.create_from_json(a.sensor_of,k));d.set_active(a.active)}):d.set_active(a.active);0<g.length&&setTimeout(function(){g.forEach(function(a){b(a.get_widget(),
d)})},500);return d};return p}(window.TOONTALK);
window.TOONTALK.sensor_backside=function(c){return{create:function(p){var b=c.UTILITIES.create_text_input(p.get_event_name(),"toontalk-sensor-event-name-input","Event name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;","Type here the event name.","https://developer.mozilla.org/en-US/docs/Web/Events/"+p.get_event_name()),a=c.UTILITIES.create_text_input(p.get_attribute(),"toontalk-sensor-event-attribute-input","Event attribute","Type here the event attribute name.","https://developer.mozilla.org/en/docs/Web/API/Event"),k=
c.UTILITIES.create_check_box(p.get_active(),"toontalk-sensor-active-check-box","Listening to events","Check the box if you want to make this sensor active."),g=c.nest_backside.create(p),d=g.get_element(),n=$(d).find(".toontalk-settings-backside-button").get(0);b.button.addEventListener("change",function(){p.set_event_name(b.button.value.trim())});a.button.addEventListener("change",function(){p.set_attribute(a.button.value.trim())});$(k.button).click(function(a){var b=k.button.checked;p.set_active(b);
p.robot_in_training()&&p.robot_in_training().edited(robot,{setter_name:"set_active",argument_1:b,toString:"change to "+(b?"active":"inactive")+" of the "+p,button_selector:".toontalk-sensor-active-check-box"});p.render();a.stopPropagation()});d.insertBefore(b.container,n);d.insertBefore(a.container,n);d.insertBefore(k.container,n);return g}}}(window.TOONTALK);window.TOONTALK.tool=function(c){return{add_listeners:function(p,b){var a,k,g,d,n,f=function(b){var e=p.getBoundingClientRect();k=c.UTILITIES.get_mouse_or_first_touch_event_attribute("clientX",b)-e.left;g=c.UTILITIES.get_mouse_or_first_touch_event_attribute("clientY",b)-e.top;d=e.height;b.preventDefault();$(p).addClass("toontalk-tool-held");a=$(p).offset();document.addEventListener("mousemove",r);document.addEventListener("touchmove",r);document.addEventListener("mouseup",l);document.addEventListener("touchend",
l);c.debugging&&0===c.debugging.indexOf("touch")&&(c.debugging+="\nmouse_down at "+Date.now());$(".ui-tooltip").each(function(){$(this).hide()})},r=function(a){var b=c.UTILITIES.find_widget_on_page(a,p,k,g-d/2),f,l,r;a.preventDefault();$(".ui-tooltip").each(function(){$(this).hide()});l=e(a);r=c.UTILITIES.get_mouse_or_first_touch_event_attribute("pageX",a)-l.deltaX-k;a=c.UTILITIES.get_mouse_or_first_touch_event_attribute("pageY",a)-l.deltaY-g;p.style.left=r+"px";p.style.top=a+"px";c.debugging&&0===
c.debugging.indexOf("touch")&&(c.debugging+="\nmouse_move at "+Date.now()+" now at "+p.style.left+", "+p.style.top);if(b&&b.is_top_level())n&&(c.UTILITIES.remove_highlight(),n=void 0);else{if(b&&(f=b.get_frontside_element(),f===n))return;n=f;c.UTILITIES.highlight_element(n)}},l=function(e){var f=c.UTILITIES.find_widget_on_page(e,p,k,g-d/2),B;e.preventDefault();n&&c.UTILITIES.remove_highlight();f&&f.top_level_widget&&(B=f.top_level_widget(),b.apply_tool(f,e),B.backup_all());!f&&b.nothing_under_tool&&
b.nothing_under_tool();$(p).removeClass("toontalk-tool-held");$(p).addClass("toontalk-tool-returning");c.UTILITIES.add_one_shot_event_handler(p,"transitionend",1E3,function(){$(p).removeClass("toontalk-tool-returning")});c.UTILITIES.set_timeout(function(){p.style.left=a.left+"px";p.style.top=a.top+"px"});document.removeEventListener("mousemove",r);document.removeEventListener("touchmove",r);document.removeEventListener("mouseup",l);document.removeEventListener("touchend",l);c.debugging&&0===c.debugging.indexOf("touch")&&
(c.debugging+="\nmouse_up at "+Date.now(),alert(c.debugging),c.debugging="touch")},e=function(a){var b=0,c=0;20>a.clientX?b=-20:a.clientX+20>window.innerWidth&&(b=20);20>a.clientY?c=-20:a.clientY+20>window.innerHeight&&(c=20);window.scrollBy(b,c);return{deltaX:b,deltaY:c}};p.addEventListener("mousedown",f);p.addEventListener("touchstart",f)}}}(window.TOONTALK);window.TOONTALK.vacuum=function(c){var p=Object.create(null),b={suck:"I'm a vacuum. Drag me over the thing you want to remove.\nType 'e' to switch to erasing, type 'r' to swich to restoring, or 'a' for removing all.\nOr click to switch modes.",erase:"I'm a vacuum. Drag me over the thing you want to erase (or un-erase).\nType 's' to switch to sucking, type 'r' to switch to restoring, or 'a' for removing all.\nOr click to switch modes.",restore:"Drag me over the work area. Each time you release me I'll restore a widget.\nType 's' to switch to sucking, type 'e' to swich to erasing, or 'a' for removing all.\nOr click to switch modes.",
suck_all:"Drag me over the work area and click. Everything will be removed.\nType 'r' to switch to restoring, type 'e' to switch to erasing, or type 's' to switch to sucking.\nOr click to switch modes."},a={suck:"toontalk-vacuum-s",erase:"toontalk-vacuum-e",restore:"toontalk-vacuum-r",suck_all:"toontalk-vacuum-a"},k={suck:"erase",erase:"restore",restore:"suck_all",suck_all:"suck"};p.create=function(){var g,d,n,f=[],p=function(b){n!==b&&(n=b,$(g).removeClass(d),d=a[n],$(g).addClass(d),l())},l=function(){"restore"===
n&&0===f.length?c.UTILITIES.give_tooltip(g,"I'm empty.\nType 's' to switch to sucking, or type 'e' to switch to erasing, or 'a' to remove all."):c.UTILITIES.give_tooltip(g,b[n])};return{apply_tool:function(a,b){var d=a.get_widget(),l=function(a){var c;a.is_backside()?a.hide_backside():(b&&d.robot_in_training()&&d.robot_in_training().removed(a),a===d.robot_in_training()?(a.training_finished(),a.set_run_once(!0)):(c=a.copy(),c.save_dimensions_of(a),f.push(c),a.set_running&&a.set_running(!1),a.remove(b)))},
k,p;"suck"===n?a.remove&&"top-level"!==a.get_type_name()&&l(a):"erase"===n||"restore"===n&&a.get_erased&&a.get_erased()?"top-level"!==a.get_type_name()&&(k=!a.get_erased(),a.set_erased(k,!0),b&&d.robot_in_training()&&d.robot_in_training().erased_widget(a,k)):"restore"===n?0<f.length&&(k=f.pop(),k.restore_dimensions(),p=a.add_to_top_level_backside(k,!0),k=$(g).offset(),k.left-=$(p).width(),c.UTILITIES.set_absolute_position($(p),k)):"suck_all"===n&&(k=a.top_level_widget(),k=k.get_backside_widgets().slice(),
k.forEach(function(a){d!==d.robot_in_training()&&l(a)}))},nothing_under_tool:function(){p(k[n])},get_element:function(){g||(g=document.createElement("div"),$(g).addClass("toontalk-vacuum"),c.tool.add_listeners(g,this),p("suck"),document.addEventListener("keyup",function(a){a=String.fromCharCode(a.keyCode);"s"===a||"S"===a?p("suck"):"e"===a||"E"===a?p("erase"):"r"===a||"R"===a?p("restore"):"a"!==a&&"A"!==a||p("suck_all")}),l());return g}}};c.creators_from_json.vacuum=function(a,b){var k=c.vacuum.create();
a.mode&&c.UTILITIES.set_timeout(function(){k.set_mode(a.mode)});return k};return p}(window.TOONTALK);window.TOONTALK.wand=function(c){var p=Object.create(null);p.create=function(){var b;return{apply_tool:function(a){"top-level"!==a.get_type_name()&&a.add_copy_to_container()},get_element:function(){b||(b=document.createElement("div"),$(b).addClass("toontalk-wand"),c.UTILITIES.give_tooltip(b,"I'm a magic wand. Drag me over the thing you want me to copy."),c.tool.add_listeners(b,this));return b}}};c.creators_from_json.wand=function(){return c.wand.create()};return p}(window.TOONTALK);window.TOONTALK.SETTINGS=function(c){var p=[],b=function(b,d,n){var f=[],r=c.UTILITIES.create_local_files_table(),l=function(d,f){var l=function(a){a||f.newPanel.appendChild(c.UTILITIES.create_text_element("Error connecting to cloud"))},k=f.newPanel.is(".dataTable");$(".dataTables_info").hide();$(".dataTables_wrapper").hide();f.newPanel.is(".toontalk-programs-in-cloud-table")?k?($("#tab-1_info").show(),$("#tab-1_wrapper").show()):a(f.newPanel,"program",b,n,l):f.newPanel.is(".toontalk-pages-in-cloud-table")?
k?($("#tab-2_info").show(),$("#tab-2_wrapper").show()):a(f.newPanel,"page",b,n,l):($("#tab-0_info").show(),$("#tab-0_wrapper").show())};f[0]="Programs stored in browser";p[0]=r;d?(f[1]="Programs in cloud",p[1]=c.UTILITIES.create_file_data_table("toontalk-programs-in-cloud-table"),f[2]="Published pages",p[2]=c.UTILITIES.create_file_data_table("toontalk-pages-in-cloud-table"),d=c.UTILITIES.create_tabs(f,p),n.appendChild(d),$(d).on("tabsactivate",l)):n.appendChild(c.UTILITIES.create_tabs(f,p));$(r).on("draw.dt",
function(){k(b,r,!1,n)})},a=function(a,b,n,f,p){c.google_drive.get_toontalk_files(!1,b,function(l){var e;"string"===typeof l?e=l:l.error&&(e=l.error.message);e?"Need to authorize"===e||"Login Required"===e?c.google_drive.authorize(p):(console.log(e),console.log("Google drive status: "+c.google_drive.get_status()),p(null)):(e="program"===b&&"toontalk-file-load-button toontalk-file-load-button-without-click-handler",c.UTILITIES.become_file_data_table(a,l.items,!0,e),a.on("draw.dt",function(){k(n,a.get(0),
!0,f)}),p(a.get(0)))})},k=function(a,b,c,f){$(b).find(".toontalk-file-load-button-without-click-handler").click(function(b){var d=function(){$(f).remove()},e=function(){a.set_setting("program_name",b.target.textContent);a.load(c,d)}.bind(this);a.save(!0,void 0,e)}).removeClass("toontalk-file-load-button-without-click-handler")};return{open:function(a){var d=document.createElement("div"),k=a.get_backside_element(),f=a.get_setting("program_name"),p=c.UTILITIES.create_text_input(f,"toontalk-program-name-input",
"Current program name:","Edit this to change the name of your program","docs/manual/settings.html"),l=c.UTILITIES.create_close_button(function(){$(d).remove()},"Click to close the settings panel."),e=c.UTILITIES.create_text_element("How should your program be saved?"),t=c.UTILITIES.create_check_box(a.get_setting("auto_save_to_google_drive"),"toontalk-save-setting","Save automatically to my Google Drive",'Check this if you want your programs automatically saved to a "ToonTalk Programs" folder in your Google Drive.'),
q=c.UTILITIES.create_check_box(a.get_setting("auto_save_to_local_storage"),"toontalk-save-setting","Save automatically to this browser's local storage","Check this if you want your programs automatically saved in this browser's local storage."),B=c.UTILITIES.create_button("Save to Google Drive now","toontalk-save-button","Click to save your program now to your Google Drive account.",function(){a.save(!0,{google_drive:!0})}),x=c.UTILITIES.create_button("Save to browser's storage now","toontalk-save-button",
"Click to save your program now to this browser's local storage.",function(){a.save(!0,{local_storage:!0})}),G=c.UTILITIES.create_button("Login to Google","toontalk-google-login-button","Click to log in to Google to authorize use of your Google Drive.",function(){c.google_drive.authorize(function(){$(G).remove()})}),A=c.UTILITIES.create_button("Publish","toontalk-publish-button","Click to publish your program by generating a Google Drive URL.",function(){c.UTILITIES.display_message("Creating your web page...");
a.publish(I,E.button.checked)}),E=c.UTILITIES.create_check_box(a.get_setting("publish_as_workspace"),"toontalk-publish-setting","As a workspace","Check this if you want to publish the workspace and its widgets. Uncheck it you wish to publish just the widgets."),I=function(b,d){var e=document.createElement("span"),h=c.google_drive.google_drive_url(b.id);c.TRANSLATION_ENABLED&&(h=c.UTILITIES.add_URL_parameter(h,"translate","1"));e.innerHTML="Published: <a href='"+h+"' target='_blank'>"+a.get_setting("program_name")+
"</a>";c.UTILITIES.display_message("Your web page is ready for you to edit. Just click on the link.");$(p.container).children("tr").append(c.UTILITIES.create_table_entry(e))},h=document.createElement("div"),C=c.google_drive&&"undefined"!==typeof gapi?c.google_drive.get_status():"Google Drive API not loaded",w=!0,z=c.UTILITIES.create_vertical_table(A,E.container);$(d).addClass("toontalk-settings-panel").css({width:$(k).width()+29,height:$(k).height()+50,left:-2,top:-25,"z-index":c.UTILITIES.next_z_index()});
d.appendChild(l);p.button.addEventListener("change",function(){var b=p.button.value.trim();f!==b&&a.save(!0,void 0,function(){f=b;a.set_setting("program_name",b);a.load(!0,function(){setTimeout(function(){$(d).css({"z-index":c.UTILITIES.next_z_index()})},500)},function(){a.save(!0,void 0,function(){$(".toontalk-settings-panel").remove();c.UTILITIES.display_message("Your program was copied and the new copy's name is '"+a.get_setting("program_name")+"'.")})})})});t.button.addEventListener("click",function(b){a.save(!0,
{auto_save_to_google_drive:q.button.checked,gooogle_drive:!0});a.set_setting("auto_save_to_google_drive",t.button.checked);t.button.checked?$(B).hide():$(B).show()});q.button.addEventListener("click",function(b){a.save(!0,{auto_save_to_local_storage:q.button.checked,local_storage:!0});a.set_setting("auto_save_to_local_storage",q.button.checked);q.button.checked?$(x).hide():$(x).show()});E.button.addEventListener("click",function(b){a.set_setting("publish_as_workspace",E.button.checked)});d.appendChild(h);
$(e).css({"font-weight":"bold","font-size":24,color:"navy"});h.appendChild(e);h.appendChild(p.container);h.appendChild(t.container);h.appendChild(q.container);t.container.appendChild(c.UTILITIES.create_space());t.container.appendChild(B);a.get_setting("auto_save_to_google_drive")&&$(B).hide();q.container.appendChild(c.UTILITIES.create_space());q.container.appendChild(x);a.get_setting("auto_save_to_local_storage")&&$(x).hide();"Need to authorize"===C?(t.container.appendChild(c.UTILITIES.create_space()),
t.container.appendChild(G)):"Authorized"!==C&&"Ready"!==C&&"Authorized but not yet ready"!==C&&(w=!1,a.set_setting("google_drive_unavailable",!0),setTimeout(function(){t.button.disabled=!0;$(A).button("option","disabled",!0);$(B).button("option","disabled",!0);c.UTILITIES.give_tooltip(t.container,"Inactivated because attempt to connect to Google Drive returned: "+C);A.title=t.container.title;B.title=t.container.title},1));$(p.container).children("tr").append(c.UTILITIES.create_table_entry(z));b(a,
w,d);k.appendChild(d)}}}(window.TOONTALK);window.TOONTALK.DEFAULT_SETTINGS={program_name:"My first program",auto_save_to_google_drive:!0,auto_save_to_local_storage:!0};window.TOONTALK.DISPLAY_UPDATES=function(c){var p=[];return{pending_update:function(b){0<=p.indexOf(b)||p.push(b)},update_display:function(){var b,a;0!==p.length&&(b=p,a=function(b,c){$(b).children().each(function(b,k){$(k).css({"z-index":c+1});a(k,c+1)})},p=[],b.forEach(function(b){var g=b.get_frontside_element&&b.get_frontside_element(),d,n,f;b.update_display();b.get_backside&&(n=b.get_backside())&&n.update_display();setTimeout(function(){c.UTILITIES.use_custom_tooltip(g)});d=$(g).parent().closest(".toontalk-side");
d.is("*")&&(n=c.UTILITIES.get_style_numeric_property(g,"z-index"),f=c.UTILITIES.get_style_numeric_property(d.get(0),"z-index"),f||(f=c.UTILITIES.next_z_index(),d.css({"z-index":f})),!n||d.is(".toontalk-top-level-backside")?(n=c.UTILITIES.next_z_index(),$(g).css({"z-index":n})):n>=f&&(n=f+1,$(g).css({"z-index":n})),a(g,n));g&&!$(g).is(".toontalk-top-level-resource, .toontalk-bird, .toontalk-nest, .toontalk-box-hole, .toontalk-plain-text-element, .toontalk-conditions-contents, .toontalk-robot, .toontalk-widget, .toontalk-held-by-robot")&&
c.UTILITIES.set_timeout(function(){d.is(".toontalk-box-hole")?$(g).is(".ui-resizable")&&$(g).resizable("destroy"):$(g).is(".ui-resizable")||c.UTILITIES.make_resizable($(g),b)})}))},run_cycle_is_over:function(){this.update_display()}}}(window.TOONTALK);window.TOONTALK.actions=function(c){c.creators_from_json.body=function(p,b){var a=c.actions.create();b.body=a;a.initialise_steps(c.UTILITIES.create_array_from_json(p.steps,b));return a};return{create:function(p){var b=Object.create(this),a=[];p||(p=[]);b.copy=function(){return c.actions.create(c.UTILITIES.copy_array(p))};b.get_steps=function(){return p};b.initialise_steps=function(a){p=a};b.is_empty=function(){return 0===p.length};b.reset_steps=function(){p=[];this.reset_newly_created_widgets()};
b.reset_newly_created_widgets=function(){a=[]};b.add_step=function(a,b){p.push(a);b&&this.add_newly_created_widget_if_new(b)};b.add_newly_created_widget_if_new=function(b){0<=a.indexOf(b)||this.add_newly_created_widget(b)};b.add_newly_created_widget=function(b){c.debugging&&0<=a.indexOf(b)?console.log("add_newly_created_widget called with not new widget."):a.push(b)};b.get_newly_created_widgets=function(){return a};b.get_path_to=function(b,g){var d,n;a.some(function(a,p){if(a===b)return d=c.newly_created_widgets_path.create(p),
!0;if(a.get_path_to&&(n=a.get_path_to(b,g)))return d=c.newly_created_widgets_path.create(p),d.next=n,!0});return d};b.dereference_path=function(b){c.debugging&&!a[b]&&c.UTILITIES.report_internal_error("Expected to find the "+c.UTILITIES.ordinal(b)+" newly created widget.");return a[b]};return b},run_unwatched:function(c,b,a,k,g){var d=this.get_steps();g||(g=0);k.run_next_step=function(){if(g<d.length){var n=d[g];g++;n.run_unwatched(c,b,k)}else k.run_body_finished_listeners(),k.get_first_in_team().set_running_or_waiting(!1),
k.get_run_once()?k.set_running(!1):k.get_first_in_team().run(c,b,a)};k.run_next_step()},run_watched:function(p,b,a,k){var g=this.get_steps(),d=k.get_frontside_element();k.get_parent_of_frontside()||(p.get_backside_element().appendChild(d),p.add_backside_widget(k),k.update_display());var n=d.parentElement,f=function(){var e=k.visible();e&&($(d).addClass("toontalk-side-animating"),c.UTILITIES.set_position_relative_to_top_level_backside($(d),l));setTimeout(function(){e&&(n.appendChild(d),c.UTILITIES.set_absolute_position($(d),
l),k.set_animating(!1));k.get_first_in_team().set_running_or_waiting(!1);k.get_run_once()?k.set_running(!1):k.stopped()||k.get_first_in_team().run(p,b,a);k.rerender()},1E3)},r=0,l=$(d).offset(),e=$(d).position(),t=$(d).width(),q=$(d).height(),B=$(d).closest(".toontalk-backside"),x=B.get(0).getBoundingClientRect(),G=$(d).closest(".toontalk-top-level-backside").offset(),A=p.get_backside();0===t&&($(d).css({width:"",height:""}),t=$(d).width(),q=$(d).height());G||(console.log("Unable to find top-level backside. Perhaps is 'visible' but not attached."),
G={left:0,top:0});if(l.left<x.left-G.left||l.top<x.top-G.top||l.left+t>x.right+G.left||l.top+q>x.bottom+G.top)l=B.offset(),l.left+=B.width()/2,l.top+=B.height()-q;k.start_position=e;k.run_next_step=function(){A&&A.visible()?setTimeout(function(){if(r<g.length){var a=g[r];r++;a.run_watched(p,b,k);k.get_thing_in_hand()&&(k.get_thing_in_hand().save_dimensions(),k.render())}else k.run_body_finished_listeners(),f()},500):(k.set_animating(!1),$(d).css({width:"",height:""}),d.style.left=e.left+"px",d.style.top=
e.top+"px",n.appendChild(d),this.run_unwatched(p,b,a,k,r))}.bind(this);k.set_animating(!0,l);k.run_next_step();return!0},toString:function(c){for(var b="",a=this.get_steps().map(function(a){return a.toString(c)});""===a[a.length-1];)a.pop();a.forEach(function(c,g){c&&(b+=c,b=g===a.length-2?b+" and \n":g<a.length-2?b+", \n":b+".")});return b},get_json:function(p){return{type:"body",steps:c.UTILITIES.get_json_of_array(this.get_steps(),p)}}}}(window.TOONTALK);
window.TOONTALK.newly_created_widgets_path=function(c){c.creators_from_json.newly_created_widgets_path=function(p){return c.newly_created_widgets_path.create(p.index)};return{create:function(p){return{dereference_path:function(b,a,k){b=k.get_body().dereference_path(p);if(this.next)return c.path.dereference_path(this.next,b,a,k);this.removing_widget&&(a=b.get_parent_of_frontside())&&a.removed_from_container&&k.remove_from_container(b,a);return b},toString:function(){return"the "+c.UTILITIES.ordinal(p)+
" new widget"},get_json:function(){return{type:"newly_created_widgets_path",index:p}}}}}}(window.TOONTALK);window.TOONTALK.robot_action=function(c){var p={copy:function(a,b,c,d){d.add_newly_created_widget(a.copy());return!0},"pick up":function(a,b,c,d){d.set_thing_in_hand(a);return!0},"pick up a copy of":function(a,b,c,d){a=a.copy();d.add_newly_created_widget(a);d.set_thing_in_hand(a);return!0},"drop it on":function(a,b,d,f,g){if(a)if(b=f.get_thing_in_hand()){if(b.drop_on)return c.debugging&&b===a&&console.error("Dropping something on itself!"),b.drop_on(a,!1,void 0,f),f.set_thing_in_hand(void 0),a.visible&&
a.visible()&&a.render(),b.robot_waiting_before_next_step===f?(g&&g.running_watched||(b.robot_waiting_before_next_step=void 0),!1):!0;c.UTILITIES.report_internal_error("Thing in robot's hand ("+b+") doesn't handle 'drop_on'. Robot that "+f)}else c.UTILITIES.report_internal_error("The robot that '"+f.toString()+"' is executing drop_on but has nothing in its hand.");else c.UTILITIES.report_internal_error("The robot that '"+f.toString()+"' is executing drop_on but doesn't know where to drop what its holding")},
"drop it on the text area of":function(a,b,d,f,g){if(a){if(b=f.get_thing_in_hand())return f.set_thing_in_hand(void 0),a[g.setter](b),!0;c.UTILITIES.report_internal_error("The robot that '"+f.toString()+"' is executing dropped_on_text_area but has nothing in its hand.")}else c.UTILITIES.report_internal_error("The robot that '"+f.toString()+"' is executing dropped_on_text_area but doesn't know where to drop what its holding")},remove:function(a,b,c,d){a.remove();a===d&&d.set_stopped(!0);return!0},"change whether erased":function(a,
b,d,f,g){if(a.set_erased)return a.set_erased(!a.get_erased()),!0;c.UTILITIES.display_message("Robot is unable to erase "+a)},edit:function(a,b,d,f,g){if(a[g.setter_name])return g.argument_2?a[g.setter_name].call(a,g.argument_1,g.argument_2,a.visible()):a[g.setter_name].call(a,g.argument_1,a.visible()),!0;c.UTILITIES.report_internal_error(a+" cannot be edited.")},"add to the top-level backside":function(a,b,c,d,f){d.visible()||(d=a.get_frontside_element(!0),c=$(b.get_frontside_element()).position(),
b=$(b.get_frontside_element()).closest(".toontalk-top-level-backside").get(0)||$(d).closest(".toontalk-top-level-backside").get(0),$(d).css({left:c.left,top:c.top}),b.appendChild(d),b.toontalk_widget.add_backside_widget(a),a.animate_to_element(b));return!0},"add a new widget to the work space":function(a,b,d,f,g){b.is_top_level()?(b=f.add_to_top_level_backside(a),f=$(f.get_frontside_element()).offset(),a.update_display(),c.UTILITIES.set_position_relative_to_top_level_backside($(b),f,!0)):a.drop_on(b.get_backside(),
!1,void 0,f,!0);return!0},"start training":function(a,b,c,d,f){a.training_started(d);return!0},"stop training":function(a,b,c,d,f){a.training_finished();return!0},train:function(a,b,c,d,f){a.add_step(f.step)},"open the backside":function(){return!0},"close the backside":function(){return!0},"click the button of":function(){return!0}},b=function(a,b,c,d){var f=b.get_thing_in_hand(),g=b.get_frontside_element(),k=a.get_element(),n=$(k).width(),p=$(k).height(),r,h,C,w,z;d&&d.left_offset_fraction?(b.original_animation_left_offset||
(b.original_animation_left_offset=[]),b.original_animation_top_offset||(b.original_animation_top_offset=[]),w=f.get_element(),C=d.left_offset_fraction*n,d=d.top_offset_fraction*p,z=$(w).offset(),g=$(g).offset(),C-=z.left-g.left,d-=z.top-g.top,f&&0<=b.original_animation_left_offset.indexOf(C)&&0<=b.original_animation_top_offset.indexOf(d)?(C=b.animation_left_offset+b.last_thing_in_hand_width,d=b.animation_top_offset,C>=n&&(C=0,d+=b.max_thing_in_hand_height,d>=p&&(d=0)),b.last_thing_in_hand_width=$(w).width(),
"undefined"===typeof b.max_thing_in_hand_height&&(b.max_thing_in_hand_height=0),b.max_thing_in_hand_height=Math.max(b.max_thing_in_hand_height,$(w).height())):(b.original_animation_left_offset.push(C),b.original_animation_top_offset.push(d),b.last_thing_in_hand_width=$(w).width(),b.max_thing_in_hand_height=$(w).height()),k.animation_left_offset=C,k.animation_top_offset=d,b.animation_left_offset=C,b.animation_top_offset=d):(r=n/2,h=p/2);b.animate_to_widget(a,c,.25,r,h)},a=function(a,c,d){b(a,c,function(){a.open_backside(function(){d();
c.add_body_finished_listener(function(){a.get_backside()&&a.get_backside().hide_backside()})})})},k=function(a,b){var c=a.get_backside_element(!0);return $(c).find(b).get(0)},g=function(a,b,c,d,f,g,n,p){var r=k(a,g);d.get_frontside_element();var I=r&&$(r).is(":visible"),h=function(){f(r);$(r).addClass("ui-state-active");if(".toontalk-select-function"===g||".toontalk-box-size-input"===g)r.value=n.argument_1;setTimeout(function(){$(r).removeClass("ui-state-active");!I&&a.get_backside()&&d.add_body_finished_listener(function(){a.get_backside()&&
a.get_backside().hide_backside()});d.run_next_step()},p)};b=function(){!$(r).is(":visible")&&C&&C.set_advanced_settings_showing(!0,C.get_element());d.animate_to_element(r,h,.25,0,0)};var C;!I&&a.open_backside?a.open_backside(b):b()},d=function(a,b,c,d,f,g,k){k=$("."+k).get(0);var p=function(){n(a,b,c,d,f,g)};k?d.animate_to_element(k,p,.5,0,0):p()},n=function(a,b,c,d,f,g){d.get_frontside_element();d.carrying_tool=g;d.update_display();d.animate_to_element(a.get_frontside_element(),function(){d.carrying_tool=
void 0;d.update_display();f();d.run_next_step()},.25,0,0)},f=function(a,b,c,f,g){var k=a.get_parent_of_frontside();d(a,b,c,f,function(){g();k&&"top-level"!==k.get_widget().get_type_name()&&k.update_display&&k.update_display();a.render()},"toontalk-vacuum-ready-small","toontalk-vacuum")},r={copy:function(a,b,c,f,g){d(a,b,c,f,function(){g();a.add_copy_to_container(f.get_recently_created_widget())},"toontalk-wand-small","toontalk-wand")},"pick up":function(a,d,f,g,k){d=a.get_frontside_element();f=function(){k();
g.run_next_step()};"empty hole"===a.get_type_name()?c.UTILITIES.report_internal_error("Robot trying to pick up an empty hole."):a.save_dimensions()?(d.offsetWidth&&$(d).css({width:d.offsetWidth+"px",height:d.offsetHeight+"px"}),b(a,g,f)):f()},"pick up a copy of":function(a,c,d,f,g){b(a,f,function(){g();f.get_recently_created_widget().set_visible(!0);f.update_display();f.run_next_step()})},"drop it on":function(d,e,f,g,k,n){var p=g.get_thing_in_hand(),r;p?(c.debugging&&p===d&&console.error("Dropping something on itself!"),
r=$(p.get_frontside_element()),e=function(){var a=r.offset(),b;r.removeClass("toontalk-held-by-robot");k();p.drop_on&&(r.is(":visible")||(b=$(g.get_frontside_element()).closest(".toontalk-top-level-backside"),b.append(r.get(0))),c.UTILITIES.set_absolute_position(r,a),p.restore_dimensions(),p.robot_waiting_before_next_step!==g&&(g.set_thing_in_hand(void 0),g.run_next_step()),g.rerender())},d.is_backside()&&!$(d.get_element()).is(":visible")?a(d.get_widget(),g,e):b(d,g,e,n)):(c.UTILITIES.report_internal_error("Expected the robot to be holding something."),
console.log("The robot is "+g),b(d,g,k))},"drop it on the text area of":function(d,e,f,g,k,n){var p=g.get_thing_in_hand(),r,E,I,h;p?(r=$(p.get_frontside_element()),E=function(){r.offset();var a;r.removeClass("toontalk-held-by-robot");k();p.remove();a=d.get_parent_of_frontside().get_widget();a.is_hole()&&(a=a.get_parent_of_frontside());a.is_top_level()?d.render():a.render();g.set_thing_in_hand(void 0);g.run_next_step()},I=function(){return $(d.get_backside_element()).find(n.area_selector).get(0)},
g.rerender(),$(d.get_backside_element()).is(":visible")?(h=I(),g.animate_to_element(h,E,.25,0,0)):a(d,g,function(){h=I();g.animate_to_element(h,E,.25,0,0)})):(c.UTILITIES.report_internal_error("Expected the robot to be holding something."),console.log("The robot is "+g),b(d,g,k))},remove:f,"change whether erased":f,edit:function(a,b,c,d,f,k){g(a,b,c,d,function(){a.get_backside()&&a.get_backside().update_display();f()},k.button_selector,k,1E3)},"add to the top-level backside":function(a,b,c,d,f){f();
d.run_next_step()},"add a new widget to the work space":function(a,b,d,f,k,n){n&&n.button_selector?(a=c.path.dereference_path(n.path_to_source,b,d,f),g(a,b,d,f,k,n.button_selector,n,3E3)):(k(),f.run_next_step())},"start training":function(a,b,c,d,f){b=a.open_backside();a=a.get_frontside_element();f();b&&$(b.get_element()).find(".toontalk-train-backside-button").click();$(a).addClass("toontalk-robot-animating toontalk-robot-being-trained-by-robot");a.toontalk_followed_by={element:d.get_frontside_element(),
left_offset:30,top_offset:-20};a.toontalk_return_to=$(a).offset();d.run_next_step()},"stop training":function(a,b,d,f,k,n){var p=a.get_frontside_element();g(a,b,d,f,function(){var b=function(){p.toontalk_return_to=void 0;a.get_backside().change_label_and_title_of_train_button(!1);$(p).removeClass("toontalk-robot-animating toontalk-robot-being-trained-by-robot");p.toontalk_followed_by=void 0;setTimeout(k,1500)};p.toontalk_return_to?c.UTILITIES.animate_to_absolute_position(p,p.toontalk_return_to,b):
b()},".toontalk-train-backside-button",n,1E3)},train:function(a,b,c,d,f,g){b=function(){f();d.run_next_step()};(g=g.step.run_watched)?(a.run_next_step=b,g(a.get_parent_of_frontside().get_widget(),c,a)):b()},"open the backside":function(a,b,c,d,f){a.open_backside(function(){d.add_body_finished_listener(function(){a.get_backside()&&a.get_backside().hide_backside()});f();d.run_next_step()})},"close the backside":function(a,b,c,d,f){a.hide_backside();f();d.run_next_step()},"click the button of":function(a,
b,c,d,f,k){g(a,b,c,d,function(a){$(a).click();f()},k.button_selector)}};c.creators_from_json.robot_action=function(a,b){return a.additional_info?c.robot_action.create(c.path.create_from_json(a.path,b),a.action_name,c.UTILITIES.create_keys_from_json(a.additional_info,b)):c.robot_action.create(c.path.create_from_json(a.path,b),a.action_name)};return{create:function(a,b,d){var f=Object.create(this),g=p[b],k=r[b];if(k)return a||c.UTILITIES.report_internal_error("path undefined in "+b+" action"),g||c.UTILITIES.report_internal_error("no run_function for "+
b),f.get_action_name=function(){return b},f.run_unwatched=function(b,e,f){var k=c.path.dereference_path(a,b,e,f);if(!k)return c.UTILITIES.report_internal_error("Unable to dereference path: "+c.path.toString(a)+" in context: "+b.toString()),!1;k.wait_until_this_nest_receives_something?k.wait_until_this_nest_receives_something.run_when_non_empty(function(){this.run_unwatched(b,e,f)}.bind(this),f):g(k,b,e,f,d)&&f.run_next_step()},f.run_watched=function(b,e,f){var n=c.path.dereference_path(a,b,e,f),h=
function(){d||(d={});d.running_watched=!0;g(n,b,e,f,d)};n?n.wait_until_this_nest_receives_something?(n.wait_until_this_nest_receives_something.run_when_non_empty(function(){f.set_waiting(!1);this.run_watched(b,e,f)}.bind(this),f),f.set_waiting(!0)):(n.set_visible(!0),k(n,b,e,f,h,d)):c.UTILITIES.report_internal_error("Unable to dereference the path: "+c.path.toString(a)+" in context: "+b.toString())},f.toString=function(f){var g="",k="",n=b,h;if("open the backside"===b||"close the backside"===b)return"";
if("click the button of"===b)switch(d.button_selector){case ".toontalk-green-flag":n="click the green flag of";break;case ".toontalk-stop-sign":n="click the stop sign of";break;default:return""}if("add a new widget to the work space"===b)return b.replace("a new widget",c.path.toString(a));if("add to the top-level backside"===b)return"";h=c.path.toString(a,f);if("edit"===b||"drop it on the text area of"===b)g=" ("+d.toString+")";else if("train"===b){g=d.step.toString({person:"third"});if(""===g)return g;
g=" to "+g;k="- ";f&&f.robot_being_trained_description&&(h=f.robot_being_trained_description)}else"start training"===b?f&&(f.robot_being_trained_description="it"):"stop training"===b&&(h=f.robot_being_trained_description,f.robot_being_trained_description=void 0);return 0<="pick up;edit;remove;copy;change whether erased;pick up a copy of;drop it on the text area of".split(";").indexOf(b)&&0<=h.indexOf("hole of")?k+n+" what is in "+h+g:k+n+" "+h+g},f.get_json=function(f){return{type:"robot_action",
action_name:b,path:c.path.get_json(a,f),additional_info:d&&c.UTILITIES.get_json_of_keys(d,["running_watched"])}},f;c.UTILITIES.report_internal_error("No watched function for "+b)}}}(window.TOONTALK);window.TOONTALK.queue=function(c){return{create:function(){var p=Object.create(this);p.to_run=c.UTILITIES.create_queue();return p},enqueue:function(p){if(c.debugging&&this.to_run.does_any_item_satisfy(function(b){return b.robot===p.robot}))console.error("The same robot is being queued twice.\nRobot is: "+p.robot.debug_id);else return this.to_run.enqueue(p)},maximum_run:50,paused:!1,run:function(){for(var p,b=Date.now()+this.maximum_run;!(this.to_run.isEmpty()||this.paused||Date.now()>=b);)p=this.to_run.dequeue(),
p.robot.run_actions(p.context,p.top_level_context,p.queue);c.DISPLAY_UPDATES.run_cycle_is_over();c.UTILITIES.set_timeout(function(){this.run()}.bind(this),this.to_run.isEmpty()?this.maximum_run:0)}}}(window.TOONTALK);window.TOONTALK.path=function(c){var p;c.creators_from_json["path.to_entire_context"]=function(){return c.path.to_entire_context()};c.creators_from_json["path.to_widget_on_nest"]=function(){return c.path.to_widget_on_nest()};c.creators_from_json["path.top_level_backside"]=function(){return c.path.top_level_backside};c.creators_from_json["path.to_backside_widget_of_context"]=function(b){return c.path.get_path_to_backside_widget_of_context(b.type_name)};c.creators_from_json["path.to_resource"]=function(b,
a){return c.path.get_path_to_resource(c.UTILITIES.create_from_json(b.resource,a))};return{get_path_to:function(b,a){var k=function(a,b){var k=b.get_context(),f=b.get_body(),p,l,e;a.is_backside()&&(e=!0,a=a.get_widget());if(k===a)return p=c.path.to_entire_context(),p.is_backside=e,p;l=a.get_type_name();if("top-level"===l)return c.path.top_level_backside;if(p=f.get_path_to(a,b))return p.is_backside=e,p;if("element attribute"===l&&a.get_original_attribute_widget()===a)return p=c.element.create_attribute_path(a,
b),p.is_backside=e,p;if(c.debugging&&!k)c.UTILITIES.report_internal_error("No context to compute the path");else{if(k.get_path_to&&(f=k.get_path_to(a,b)))return f.is_backside=e,p=c.path.to_entire_context(),p.next=f,p;k.backside_widgets.some(function(f){f=f.get_widget();var k;if(f===a||f.top_contents_is&&f.top_contents_is(a))return p=c.path.get_path_to_backside_widget_of_context(f.get_type_name()),p.is_backside=e,b.add_to_backside_conditions(f),!0;if(f.get_path_to&&(k=f.get_path_to(a,b)))return k.is_backside=
e,p=c.path.get_path_to_backside_widget_of_context(f.get_type_name()),p.next=k,b.add_to_backside_conditions(f),!0});if(p)return p.is_backside=e,p;if(k=a.ancestor_of_type("robot"))return c.robot.find_conditions_path(a,k,b);p=c.path.get_path_to_resource(a.copy());p.is_backside=e;return p}}(b,a);k&&b.dereference_contents&&(c.path.path_end(k).not_to_be_dereferenced=!0);!k||"pick up"!==a.current_action_name&&"remove"!==a.current_action_name||(c.path.path_end(k).removing_widget=!0);return k},path_end:function(b){for(;b.next;)b=
b.next;return b},dereference_path:function(b,a,c,g){var d;b?b.dereference_path?d=b.dereference_path(a,c,g):a.dereference_path&&(d=a.dereference_path(b,c,g)):d=a;return d&&b&&b.is_backside?d.get_backside(!0):d},continue_dereferencing_path:function(b,a,c,g){return b.next?a.dereference_contents&&!b.next.not_to_be_dereferenced?(a=a.dereference_contents(b.next,c,g))&&b.is_backside?a.get_backside(!0):a:(a=a.dereference_path(b.next,c,g))&&b.next.is_backside?a.get_backside(!0):a:a.dereference_contents&&!b.not_to_be_dereferenced?
(a=a.dereference_contents(b,c,g))&&b.is_backside?a.get_backside(!0):a:a},toString:function(b,a){var k="";b.is_backside&&(k="the backside of ");return b.next?(c.path.toString(b.next,a),k+c.path.toString(b.next,a).trim()+" of "+b.toString(a)):k+b.toString(a)},get_json:function(b,a){var k;if(!b.get_json)return b;k=b.get_json(a);b.next&&(k.next_path=c.path.get_json(b.next,a));b.removing_widget&&(k.removing_widget=!0);b.not_to_be_dereferenced&&(k.not_to_be_dereferenced=!0);b.is_backside&&(k.is_backside=
!0);return k},to_entire_context:function(b){return{dereference_path:function(a,b,g){return c.path.continue_dereferencing_path(this,a,b,g)},toString:function(a){return a&&a.robot?a.robot.get_top_level_context_description(a):a&&"third"===a.person?"what he's working on":"what I'm working on"},get_json:function(){return{type:"path.to_entire_context"}}}},to_widget_on_nest:function(){return{dereference_path:function(b,a,k){return c.path.continue_dereferencing_path(this,b,a,k)},toString:function(){return"what is on the nest"},
get_json:function(){return{type:"path.to_widget_on_nest"}}}},get_path_to_resource:function(b){b=b.get_widget();return{dereference_path:function(a,k,g){a=b.copy({copying_resource:!0});var d,n,f;g.add_newly_created_widget(a);g.visible()&&(d=c.UTILITIES.find_resource_equal_to_widget(b))&&(a.save_dimensions_of(c.UTILITIES.widget_of_element(d)),f=a.get_frontside_element(),n=$(d).position(),c.UTILITIES.set_timeout(function(){$(f).css({left:n.left,top:n.top,width:$(d).width(),height:$(d).height()})}));return a},
toString:function(){return c.UTILITIES.add_a_or_an(b.toString())},get_json:function(){return{type:"path.to_resource",resource:c.path.get_json(b,c.UTILITIES.fresh_json_history())}}}},get_path_to_backside_widget_of_context:function(b){return{dereference_path:function(a,k,g){var d;a.backside_widgets.some(function(a){if(a.get_widget().is_of_type(b))return d=a.get_widget(),!0});if(d)return c.path.continue_dereferencing_path(this,d,k,g)},toString:function(){var a="the "+b+" on the back of what I'm working on";
return this.removing_widget?"what is on "+a:a},get_json:function(){return{type:"path.to_backside_widget_of_context",type_name:b}}}},create_from_json:function(b,a){var k=c.UTILITIES.create_from_json(b,a);b.next_path&&(k.next=this.create_from_json(b.next_path,a));b.removing_widget&&(k.removing_widget=!0);b.not_to_be_dereferenced&&(k.not_to_be_dereferenced=!0);b.is_backside&&(k.is_backside=!0);return k},top_level_backside:{dereference_path:function(b,a,k){if(b=b.ancestor_of_type("top-level"))return b;
p||(p=c.widget.create_top_level_widget());return p},toString:function(){return"the top-level backside"},get_json:function(){return{type:"path.top_level_backside"}}}}}(window.TOONTALK);window.TOONTALK.publish=function(c){var p=function(b,a,c){var g='<!DOCTYPE html>\n<html>\n<head>\n<link rel="stylesheet" media="all" href="https://toontalk.github.io/ToonTalk/toontalk.css">\n<link href="https://dl.dropboxusercontent.com/u/51973316/ToonTalk/libraries/froala-wysiwyg-editor/css/font-awesome.min.css" rel="stylesheet" type="text/css" />\n<link href="https://dl.dropboxusercontent.com/u/51973316/ToonTalk/libraries/froala-wysiwyg-editor/css/froala_editor.min.css" rel="stylesheet" type="text/css" />\n<script src="https://toontalk.github.io/ToonTalk/compile/toontalk.js">\x3c/script>\n<script src="https://toontalk.github.io/ToonTalk/libraries/jquery-ui-1.11.2.custom/jquery-ui.min.js">\x3c/script>\n<script src="https://dl.dropboxusercontent.com/u/51973316/ToonTalk/libraries/froala-wysiwyg-editor/js/froala_editor.min.js">\x3c/script>\n<script src="https://dl.dropboxusercontent.com/u/51973316/ToonTalk/libraries/froala-wysiwyg-editor/js/plugins/block_styles.min.js">\x3c/script>\n<script src="https://dl.dropboxusercontent.com/u/51973316/ToonTalk/libraries/froala-wysiwyg-editor/js/plugins/colors.min.js">\x3c/script>\n<script src="https://dl.dropboxusercontent.com/u/51973316/ToonTalk/libraries/froala-wysiwyg-editor/js/plugins/font_family.min.js">\x3c/script>\n<script src="https://dl.dropboxusercontent.com/u/51973316/ToonTalk/libraries/froala-wysiwyg-editor/js/plugins/font_size.min.js">\x3c/script>\n<script src="https://dl.dropboxusercontent.com/u/51973316/ToonTalk/libraries/froala-wysiwyg-editor/js/plugins/lists.min.js">\x3c/script>\n<script src="https://dl.dropboxusercontent.com/u/51973316/ToonTalk/libraries/froala-wysiwyg-editor/js/plugins/tables.min.js">\x3c/script>\n<script src="https://dl.dropboxusercontent.com/u/51973316/ToonTalk/libraries/froala-wysiwyg-editor/js/plugins/video.min.js">\x3c/script>\n<title>\n'+
b+'</title>\n<link rel="shortcut icon" href="favicon.ico" />\n</head>\n<body>\n';a.forEach(function(a,b){g+='<div class="toontalk-edit" name="content">\n'+a+"\n</div>\n";c[b]&&(g+=c[b])});return g+='<script src="https://toontalk.github.io/ToonTalk/support/published_support.js">\x3c/script>\n</body>\n</html>\n'};return{publish_widget:function(b,a,k,g){var d=c.google_drive.get_status(),n=["Edit this. Select text for formatting.","And edit this."],f=function(a){(a=a&&a.items&&0<a.items.length&&a.items[0])?
g(a,e):(a=p(b,n,e),c.google_drive.upload_file(r,"html",a,g))},r,l,e;"Ready"===d?(r=a.get_setting("program_name"),k?(l=c.UTILITIES.get_json_top_level(a),a.set_setting("program_name",r+" (published version)"),e=[c.UTILITIES.toontalk_json_div(l,a)],a.set_setting("program_name",r)):(a=a.get_backside_widgets(),e=[],a.forEach(function(a,b){a.visible()&&(l=c.UTILITIES.get_json_top_level(a),e.push(c.UTILITIES.toontalk_json_div(l,a.get_widget())),1<b&&(n[b]=n[1]))}),n.push(n[1])),c.google_drive.get_toontalk_files(c.google_drive.full_file_name(r,
"page"),"page",f)):(console.log("Unable to publish to Google Drive because: "+d),g(null))},republish:function(b){c.google_drive.insert_or_update_file(void 0,b.file_id,"page",p(b.title,b.editable_contents,b.widgets_json),function(){console.log("Published page '"+b.title+"' updated.")})}}}(window.TOONTALK);function handle_client_load(){window.TOONTALK.google_drive.handle_client_load()}
window.TOONTALK.google_drive=function(c){var p=c.GOOGLE_DRIVE_CLIENT_ID||"148386604750-704q35l4gcffpj2nn3p4ivcopl81nm27.apps.googleusercontent.com",b=c.ORIGIN_FOR_GOOGLE_DRIVE||"toontalk.github.io",a="Need to authorize",k,g;return{handle_client_load:function(d){0>window.location.href.indexOf(b)?(a="Connections to Google Drive are configured for the following domain only: "+b+".\nIf you are hosting ToonTalk elsewhere you need to set TOONTALK.GOOGLE_DRIVE_CLIENT_ID and TOONTALK.ORIGIN_FOR_GOOGLE_DRIVE",d&&
d(a)):setTimeout(function(){c.google_drive.check_authorization(d)})},check_authorization:function(b){a="Awaiting authorization";gapi.auth.authorize({client_id:p,scope:"https://www.googleapis.com/auth/drive",immediate:!0},function(a){c.google_drive.handle_authorization_result(a,b)})},handle_authorization_result:function(b,g){b&&!b.error?(a="Authorized but not yet ready",gapi.client.load("drive","v2",function(){c.google_drive.get_folder_ids(function(){a="Ready"})}),g&&g()):(a="Need to authorize",g&&
g(a))},authorize:function(a){gapi.auth.authorize({client_id:p,scope:"https://www.googleapis.com/auth/drive",immediate:!1},function(b){c.google_drive.handle_authorization_result(b,a)})},get_folder_ids:function(a){c.google_drive.get_folder_id(!0,function(b){k=b;c.google_drive.get_folder_id(!1,function(b){g=b;a()})})},get_folder_id:function(a,b){var f=a?"ToonTalk Programs":"ToonTalk Pages",p=function(g){var e=function(a){a&&a.id?b(a.id):console.error("Failure to create folder '"+f+"'. Response was "+
a)};(g=g&&g.items&&0<g.items.length&&g.items[0].id)?b(g):a?c.google_drive.create_folder("ToonTalk Programs",!1,e):c.google_drive.create_folder("ToonTalk Pages",!0,e)};a&&k?b(k):!a&&g?b(g):c.google_drive.fetch_folder_id(f,p)},get_status:function(){return a},connection_to_google_drive_possible:function(){return 0!==a.indexOf("Connections to Google Drive are configured for the following domain only: ")},list_files:function(a,b){gapi.client.request({path:"/drive/v2/files",method:"GET",params:a}).execute(b)},
fetch_folder_id:function(a,b){c.google_drive.list_files({q:"mimeType = 'application/vnd.google-apps.folder' and title ='"+a+"' and trashed = false"},b)},get_toontalk_files:function(a,b,f){"undefined"===typeof gapi?f("Google Drive API not available."):(b="properties has {key='ToonTalkType' and value='"+b+"' and visibility='PUBLIC'} and trashed = false",a&&(b+=" and title='"+a+"'"),c.google_drive.list_files({q:b},f))},get_toontalk_program_file:function(a,b){c.google_drive.list_files({q:"'"+k+"' in parents and trashed = false and title='"+
a+"'"},function(a){a&&a.items&&0<a.items.length?b(a.items[0]):b(null)})},upload_file:function(a,b,f,g){var k="json"===b?"program":"page",e=a+"."+b;c.google_drive.get_toontalk_files(e,k,function(a){gapi.client.load("drive","v2",function(){var b=a&&a.items&&0<a.items.length&&a.items[0].id;g||(g=function(a){a.error&&(console.log("Google drive status: "+c.google_drive.get_status()),"Login Required"!==a.error.message&&console.log(a.error.message));console.log("File "+a.title+" ("+a.id+") "+(b?"updated":
"created"))});b?c.google_drive.insert_or_update_file(void 0,b,k,f,g):c.google_drive.insert_or_update_file(e,void 0,k,f,g)})})},full_file_name:function(a,b){return a+"."+("program"===b?"json":"html")},insert_or_update_file:function(a,b,f,p,l){var e={title:a,mimeType:"text/html"};e.parents=[{kind:"drive#fileLink",id:"program"===f?k:g}];p="\r\n---------314159265358979323846\r\nContent-Type: application/json\r\n\r\n"+JSON.stringify(e)+"\r\n---------314159265358979323846\r\nContent-Type: text/html\r\n\r\n"+
p+"\r\n---------314159265358979323846--";a?(a="/upload/drive/v2/files",e="POST"):(a="/upload/drive/v2/files/"+b,e="PUT");gapi.client.request({path:a,method:e,params:{uploadType:"multipart"},headers:{"Content-Type":'multipart/mixed; boundary="-------314159265358979323846"'},body:p}).execute(function(a){b||c.google_drive.insert_property(a.id,"ToonTalkType",f,"PUBLIC");l&&l(a)})},create_folder:function(a,b,c){gapi.client.drive.files.insert({resource:{title:a,mimeType:"application/vnd.google-apps.folder"}}).execute(b?
function(a){gapi.client.drive.permissions.insert({fileId:a.id,resource:{value:"",type:"anyone",role:"reader"}}).execute(function(b){c(a)})}:c)},download_file:function(a,b){if(a.downloadUrl){var c=gapi.auth.getToken().access_token,g=new XMLHttpRequest;g.open("GET",a.downloadUrl);g.setRequestHeader("Authorization","Bearer "+c);g.onload=function(){b(g.responseText)};g.onerror=function(){b(null)};g.send()}else b(null)},google_drive_url:function(a){return"https://googledrive.com/host/"+a+"/"},insert_property:function(a,
b,c,g){gapi.client.drive.properties.insert({fileId:a,resource:{key:b,value:c,visibility:g}}).execute(function(a){})}}}(window.TOONTALK);function googleTranslateElementInit(){new google.translate.TranslateElement({pageLanguage:"en",layout:google.translate.TranslateElement.InlineLayout.SIMPLE},"google_translate_element")}
window.TOONTALK.UTILITIES=function(c){var p,b=100,a=(new Date).getTime(),k=function(a){var b=a.indexOf("{"),c=a.lastIndexOf("}");if(!(0>b||0>c))return a.substring(b,c+1)},g=function(a,b){var d=$(b).closest(".toontalk-side"),e=c.UTILITIES.get_mouse_or_first_touch_event_attribute("clientX",a),f=c.UTILITIES.get_mouse_or_first_touch_event_attribute("clientY",a),g,k,l;$(".ui-tooltip").remove();$(".ui-tooltip").removeClass("toontalk-side-animating");a.dataTransfer&&a.dataTransfer.getData("text")&&0<a.dataTransfer.getData("text").length||
(p=d||$(b),k=c.UTILITIES.widget_from_jquery(p),k||(k=c.UTILITIES.widget_of_element(b),c.UTILITIES.report_internal_error("Possible bug that "+p+" doesn't have a known owner."),p=$(b)),!k.save_dimensions||k.get_parent_of_frontside()&&!k.get_parent_of_frontside().get_widget().is_top_level()||k.save_dimensions(),k.being_dragged=!0,g=p.get(0).getBoundingClientRect(),l=p.is(".toontalk-top-level-resource"),k.get_json&&(d=c.UTILITIES.get_json_top_level(k),d.view.drag_x_offset=e-g.left,d.view.drag_y_offset=
f-g.top,!d.view.frontside_width&&p.parent().is(".toontalk-backside")&&(d.view.frontside_width=p.width(),d.view.frontside_height=p.height()),p.is(".toontalk-backside")&&(d.view.backside=!0),p.data("json",d),a.dataTransfer&&(e=c.UTILITIES.toontalk_json_div(d,k),a.dataTransfer.effectAllowed=l?"copy":"move",a.dataTransfer.setData("text",e),c.UTILITIES.is_internet_explorer()||a.dataTransfer.setData("text/html",e)),k.drag_started(d,l)),p.addClass("toontalk-being-dragged"),a.stopPropagation())},d=function(a){p||
(p=$(a.target).closest(".toontalk-side"));c.UTILITIES.widget_from_jquery(p).being_dragged=void 0;if(p.is(".toontalk-frontside"))if(p.parent().is(".toontalk-backside")){var b=p.data("json");b&&p.css({width:b.view.frontside_width,height:b.view.frontside_height})}else p.parent().is(".toontalk-top-level-resource, .toontalk-drop-area, .toontalk-json")||p.is(".toontalk-carried-by-bird, .toontalk-element-attribute, .toontalk-function-bird-documentation-bird")||c.UTILITIES.has_animating_image(p.get(0))||
p.css({width:"100%",height:"100%"});B();a.stopPropagation()},n=function(a){if(p)return c.UTILITIES.widget_from_jquery(p);a=c.UTILITIES.data_transfer_json_object(a);return c.UTILITIES.create_from_json(a)},f=function(a,b){var d=c.UTILITIES.data_transfer_json_object(a),f,g,k,l,n,q,r,x,A,E;!d&&p&&(d=p.data("json"));p&&p.data("json","");f=p;B();if(f||d||a.dataTransfer.files){if($(a.target).is(".toontalk-drop-area-instructions"))k=$(a.target).parent();else if($(a.target).is(".toontalk-element-attribute-input")){if(k=
$(a.target).closest(".toontalk-side"),l=c.UTILITIES.widget_from_jquery(k)){g=f?c.UTILITIES.widget_from_jquery(f):c.UTILITIES.create_from_json(d);c.UTILITIES.restore_resource(f,g);l.dropped_on_style_attribute(g,a.target.name,a);a.stopPropagation();return}}else if($(a.target).is(".toontalk-drop-area"))k=$(a.target);else{if(d&&$(a.currentTarget).is(".froala-element")){r=d;k=c.UTILITIES.create_from_json(r);l=document.createElement("div");r=r.view.backside?k.get_backside_element(!0):k.get_frontside_element(!0);
d=$(b).closest(".toontalk-edit");f=c.published_support.create_editable_text();g=a.target;$(l).addClass("toontalk-json toontalk-top-level-resource toontalk-top-level-resource-container");$(r).addClass("toontalk-top-level-resource").css({position:"relative"});r.toontalk_widget=k;l.toontalk_widget=k;l.appendChild(r);for($(l).insertAfter(d);g.nextSibling;)$(f).children(".froala-element").get(0).appendChild(g.nextSibling);$(f).insertAfter(l);k.update_display();return}k=$(a.target).closest(".toontalk-side")}if(0!==
k.length&&!k.is(".toontalk-top-level-resource")){r=k.offset();c.UTILITIES.remove_highlight();l=c.UTILITIES.widget_from_jquery(k);if(f&&0<f.length&&!(l&&l.get_infinite_stack&&l.get_infinite_stack())&&(f.get(0)===k.get(0)||jQuery.contains(f.get(0),k.get(0)))){if(f.is(".toontalk-top-level-backside"))return;k.hide();g=c.UTILITIES.get_mouse_or_first_touch_event_attribute("pageX",a);n=c.UTILITIES.get_mouse_or_first_touch_event_attribute("pageY",a);g=document.elementFromPoint(g-window.pageXOffset,n-window.pageYOffset);
k.show();g&&(k=$(g).closest(".toontalk-side"),r=k.offset(),l=c.UTILITIES.widget_from_jquery(k))}d&&d.view&&d.view.drag_x_offset?(n=d.view.drag_x_offset,q=d.view.drag_y_offset):q=n=0;if(f&&0<f.length){if(!(l&&l.get_infinite_stack&&l.get_infinite_stack()||f.get(0)!==k.get(0)&&!jQuery.contains(f.get(0),k.get(0)))){f.css({left:f.get(0).offsetLeft+(a.layerX-n),top:f.get(0).offsetTop+(a.layerY-q)});a.stopPropagation();return}x=f.is(".toontalk-backside");g=c.UTILITIES.widget_from_jquery(f);f.parent().is(".toontalk-drop-area")?
(f.removeClass("toontalk-widget-in-drop_area"),f.parent().data("drop_area_owner").set_next_robot(void 0)):(A=f.parents(".toontalk-side:first"),(E=c.UTILITIES.widget_from_jquery(A))?!x&&g.get_infinite_stack&&g.get_infinite_stack()?(A=g.saved_width,E=g.saved_height,g=g.copy(),g.saved_width=A,g.saved_height=E,A=f.width(),E=f.height(),f=$(g.get_frontside_element(!0)),k.is(".toontalk-backside")&&f.css({width:d.view.frontside_width||A,height:d.view.frontside_height||E})):E.removed_from_container&&(A.is(".toontalk-backside")?
E.remove_backside_widget(g,x,!0):(E.removed_from_container(g,x,a,void 0,!0),g.restore_dimensions&&g.restore_dimensions())):c.UTILITIES.restore_resource(f,g),g.robot_in_training()&&g.robot_in_training().add_newly_created_widget_if_new(g))}else{if(0<a.dataTransfer.files.length){for(d=0;d<a.dataTransfer.files.length;d++)t(a.dataTransfer.files[d],k,l,r,a);a.stopPropagation();return}g=c.UTILITIES.create_from_json(d,{event:a});if(!g){d?c.UTILITIES.report_internal_error("Unable to construct a ToonTalk widget from the JSON."):
c.debugging&&console.log("No data transfer in drop.");a.stopPropagation();return}(x=d.view.backside)?(f=$(g.get_backside_element()),f.css({width:d.view.backside_width,height:d.view.backside_height,"background-color":d.view.background_color,"border-width":d.view.border_width}),g.apply_backside_geometry()):f=$(g.get_frontside_element())}g!==l&&e(k,f,g,l,r,a,d,n,q,x)}}else a.dataTransfer?c.UTILITIES.report_internal_error("Drop failed since unable to parse as JSON."):c.UTILITIES.report_internal_error("Drop failed since there is no event.dataTransfer"),
a.stopPropagation()},r=function(a,b){a.addEventListener("drop",function(a){var d=n(a);c.UTILITIES.restore_resource(c.UTILITIES.get_dragee(),d);b(a)})},l=function(a,b){var d;d=$(b).closest(".toontalk-side");var e=c.UTILITIES.get_dragee();d=!d.is("*")||d.is(".toontalk-top-level-backside")||d.closest(".toontalk-top-level-resource").is("*")||d.is(".toontalk-being-dragged")||e&&x(d.get(0),e.get(0))?void 0:d;if(d)return c.UTILITIES.highlight_element(d.get(0),a),d.get(0)},e=function(a,b,d,e,f,g,k,l,n,p){var q=
c.UTILITIES.get_mouse_or_first_touch_event_attribute("pageX",g),r=c.UTILITIES.get_mouse_or_first_touch_event_attribute("pageY",g),t,x,A,B,E,G;d.set_visible(!0);if(a.is(".toontalk-backside")){if(d.is_top_level()){t=k.semantic.backside_widgets;x=k.shared_widgets;A=a.get(0);g=d.get_backside_widgets().slice();g.forEach(function(a,b){var f=a.get_widget(),h,g,k,l,n,p,q;d.remove_backside_widget(f,a.is_backside());h=0<=t[b].widget.shared_widget_index?x[t[b].widget.shared_widget_index].view:t[b].widget.view;
a.is_backside()?(g=f.get_backside_element(!0),k=h.backside_left,l=h.backside_top,n=h.backside_width,p=h.backside_height):(g=f.get_frontside_element(!0),k=h.frontside_left,l=h.frontside_top,n=h.frontside_width,p=h.frontside_height);e.add_backside_widget(f,a.is_backside());A.appendChild(g);q=$(g).position();G={left:q.left+k,top:q.top+l,width:n,height:p};c.UTILITIES.constrain_css_to_fit_inside(A,G);$(g).css(G);a.is_backside()&&(f.backside_geometry=h.backside_geometry,f.apply_backside_geometry())}.bind(this));
return}d?e.get_backside().widget_dropped_on_me(d,p,g):c.UTILITIES.report_internal_error("No source_widget");"undefined"===typeof l&&d.is_element()&&(n=l=0,setTimeout(function(){var a=d.get_HTML(),c=b.width(),e=b.height();0<=a.indexOf("data:image")?(a=Math.min(80,c)/2,c=90,90>e&&(c-=(90-e)/2)):(a=Math.min(60,c/2),c=Math.min(30,e/2));b.css({left:B-a,top:E-c})},50));B=q-(f.left+(l||0));E=r-(f.top+(n||0));b.css({left:B,top:E});k&&k.semantic.running&&d.set_running(!0)}else if(a.is(".toontalk-drop-area"))b.addClass("toontalk-widget-in-drop_area"),
a.append(b.get(0)),b.is(".toontalk-robot")&&a.data("drop_area_owner").set_next_robot(c.UTILITIES.widget_from_jquery(b));else{if(b.is(".toontalk-backside-of-top-level"))return;if(e||g.changedTouches)A=a.closest(".toontalk-top-level-backside").get(0),!A&&g.changedTouches&&(f=document.elementFromPoint(q-window.pageXOffset,r-window.pageYOffset),(A=$(f).is(".toontalk-top-level-backside")?f:$(f).closest(".toontalk-top-level-backside").get(0))||(A=$(".toontalk-top-level-backside").get(0)),e=c.UTILITIES.widget_of_element(A).get_backside()),
A.appendChild(b.get(0)),f=$(A).offset(),b.css({left:q-(f.left+l),top:r-(f.top+n)}),d.drop_on&&d.drop_on(e,p,g)||e.widget_dropped_on_me&&e.widget_dropped_on_me(d,p,g)||(a=a.closest(".toontalk-top-level-backside"),0<a.length&&(e=c.UTILITIES.widget_from_jquery(a))&&e.get_backside().widget_dropped_on_me(d,p,g));else{c.UTILITIES.report_internal_error("target widget missing");return}}c.UTILITIES.remove_highlight()},t=function(a,b,d,f,g){var l=new FileReader,n=0===a.type.indexOf("image"),p,q,r;l.onloadend=
function(){if(n)p=c.element.create("<img src='"+l.result+"' alt='"+a.name+"'/>");else{if(q=k(l.result))try{r=JSON.parse(q),p=c.UTILITIES.create_from_json(r)}catch(t){}p||(p=c.element.create(l.result))}e(b,$(p.get_frontside_element(!0)),p,d,f,g,r)};n?l.readAsDataURL(a):l.readAsText(a)},q=function(a){var b=document.createElement("script");b.src=a;document.body.appendChild(b)},B=function(){p&&(p.removeClass("toontalk-being-dragged"),c.UTILITIES.set_timeout(function(){p=void 0}))},x=function(a,b){if(a===
b)return!0;if(a.parentNode)return x(a.parentNode,b)},G=[],A=[],E,I;window.addEventListener("message",function(a){"zero-timeout-message"===a.data&&a.source===window?(a.stopPropagation(),0<G.length&&G.shift()()):a.data.editable_contents&&c.publish.republish(a.data)},!1);$(document).ready(function(){var a=$("<div class='toontalk-robot'>"),b;c.debugging=c.UTILITIES.get_current_url_parameter("debugging");c.UTILITIES.process_json_elements();$(document).click(function(a){$(".toontalk-top-level-resource-container").each(function(a,
b){var c=b.toontalk_widget;c&&c.set_running&&c.set_running(!1)})});c.QUEUE=window.TOONTALK.queue.create();c.QUEUE.run();window.addEventListener("beforeunload",function(a){try{c.UTILITIES.backup_all_top_level_widgets(!0)}catch(b){console.log(b)}});c.TRANSLATION_ENABLED=c.UTILITIES.get_current_url_boolean_parameter("translate",!1);c.TRANSLATION_ENABLED?($("a").each(function(a,b){b.href=c.UTILITIES.add_URL_parameter(b.href,"translate","1")}),$("#google_translate_element").is("*")||(b=document.createElement("div"),
b.id="google_translate_element",document.body.insertBefore(b,document.body.firstChild)),document.head.appendChild($('<meta name="google-translate-customization" content="7e20c0dc38d147d6-a2c819007bfac9d1-gc84ee27cc12fd5d1-1b"></meta>')[0]),q("https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit")):$("#google_translate_element").remove();c.UTILITIES.add_test_all_button();c.UTILITIES.run_when_dimensions_known(a.get(0),function(){var b=a.width(),d=a.height();c.robot.get_default_width=
function(){return b};c.robot.get_default_height=function(){return d}})});return{create_from_json:function(a,b,d){var e=function(a,b,c){b.shared_widgets[c]=a;a.finish_create_from_json_continuation&&(a.finish_create_from_json_continuation(),a.finish_create_from_json_continuation=void 0);return a},f,g,k,l;if(a){b||(b={});a.shared_widgets&&(b.json_of_shared_widgets=a.shared_widgets,b.shared_widgets=[]);a.shared_html&&(b.shared_html=a.shared_html);if(a.widget)return(f=c.UTILITIES.create_from_json(a.widget,
b))&&a.is_backside?f.get_backside(!0):f;if(b&&b.shared_widgets&&0<=a.shared_widget_index){if(d=b.shared_widgets[a.shared_widget_index])return d;d=b.json_of_shared_widgets[a.shared_widget_index];f=c.UTILITIES.create_from_json(d,b,!0);return e(f,b,a.shared_widget_index)}(k=a.semantic)||(k=a);a=a.view;if(0<=k.shared_widget_index){if(!b.json_of_shared_widgets){c.UTILITIES.report_internal_error("JSON refers to shared widgets but they can't be found. Sorry.");return}f=c.UTILITIES.create_from_json(b.json_of_shared_widgets[k.shared_widget_index],
b,!0);return e(f,b,k.shared_widget_index)}if(c.creators_from_json[k.type]){b||(b={});a?b.json_view=a:a=b.json_view;try{f=c.creators_from_json[k.type](k,b)}catch(n){c.UTILITIES.report_internal_error("Unable to recreate a "+k.type+". Error is "+n)}if(f&&f.get_backside){k.erased&&(c.widget.erasable(f),f.set_erased(k.erased));k.infinite_stack&&f.set_infinite_stack(k.infinite_stack);if(a&&a.frontside_width)if(g=a.backside?f.get_backside(!0).get_element():f.get_frontside_element(),l={width:a.frontside_width,
height:a.frontside_height},"element"===k.type)f.on_update_display(function(){$(g).css(l)});else $(g).css(l);a&&a.saved_width&&(f.saved_width=a.saved_width,f.saved_height=a.saved_height);a&&a.backside_geometry&&(f.backside_geometry=a.backside_geometry);k.backside_widgets&&(d?f.finish_create_from_json_continuation=function(){this.add_backside_widgets_from_json(f,k.backside_widgets,b)}.bind(this):this.add_backside_widgets_from_json(f,k.backside_widgets,b))}return f}c.UTILITIES.report_internal_error("JSON type '"+
k.type+"' not supported. Perhaps a JavaScript file implementing it is missing.")}},add_backside_widgets_from_json:function(a,b,c){var d;b&&(d=this.create_array_from_json(b,c),a.set_backside_widget_sides(d,b.map(function(a){return 0<=a.widget.shared_widget_index?c.json_of_shared_widgets[a.widget.shared_widget_index].view:a.widget.view})))},create_array_from_json:function(a,b){var d=[];a.forEach(function(a,e){d[e]=a?c.UTILITIES.create_from_json(a,b):a});return d},get_json_of_array:function(a,b){var d=
[];a.forEach(function(a,e){try{a.is_backside&&a.is_backside()?d[e]={widget:c.UTILITIES.get_json(a.get_widget(),b),is_backside:!0}:d[e]=a.get_type_name?{widget:c.UTILITIES.get_json(a,b)}:a.get_json(b)}catch(f){c.UTILITIES.report_internal_error("Error trying to save "+a)}});return d},fresh_json_history:function(){return{widgets_encountered:[],shared_widgets:[],json_of_widgets_encountered:[]}},get_json_top_level:function(a){var b=this.fresh_json_history(),d=c.UTILITIES.get_json(a,b);0<b.shared_widgets.length&&
(d.shared_widgets=b.shared_widgets.map(function(e,f){var g=function(a){a=b.widgets_encountered.indexOf(a);return b.json_of_widgets_encountered[a]},k=function(a){return g(b.shared_widgets[a])},l=g(e);a===e?(l={semantic:l.semantic,view:l.view,version:l.version},d.semantic={shared_widget_index:f}):c.UTILITIES.tree_replace_once(d.semantic,l,{shared_widget_index:f},k,c.UTILITIES.generate_unique_id());return l}));d.shared_html=b.shared_html;return d},get_json:function(a,b){var d,e,f;c.debugging&&!b&&c.UTILITIES.report_internal_error("no json_history");
d=b.shared_widgets.indexOf(a);if(0<=d)return{shared_widget_index:d};d=b.widgets_encountered.indexOf(a);if(0<=d)return d=c.UTILITIES.insert_ancestors_last(a,b.shared_widgets),{shared_widget_index:d};d=b.widgets_encountered.push(a)-1;f=a.is_backside();a=a.get_widget();e=a.get_json(b);e=a.add_to_json(e,b);e.view.backside=f;b.json_of_widgets_encountered[d]=e;a.add_backside_widgets_to_json&&a.add_backside_widgets_to_json(e,b);return e},get_json_of_keys:function(a,b){var c;b||(b=[]);Object.keys(a).forEach(function(d){0>
b.indexOf(d)&&(c||(c={}),c[d]=a[d].get_json?{json:a[d].get_json()}:a[d])});return c},create_keys_from_json:function(a,b){var d={};Object.keys(a).forEach(function(e){d[e]=a[e].json?c.UTILITIES.create_from_json(a[e].json,b):a[e]});return d},tree_replace_once:function(a,b,c,d,e){if(a.id_of_tree_replace_once_task!==e){a.id_of_tree_replace_once_task=e;var f;Object.keys(a).forEach(function(g){if(f=a[g]){if(f===b)return a[g]=c,!0;if("shared_widget_index"===g){if(this.tree_replace_once(d(f),b,c,d,e))return!0}else if(!(0<=
["string","number","function","undefined","boolean"].indexOf(typeof f))&&this.tree_replace_once(f,b,c,d,e))return!0}}.bind(this));return!1}},insert_ancestors_last:function(a,b){var c=-1;b.some(function(b,d){if(a.has_ancestor(b))return c=d,!0});0>c&&(c=b.length);b.splice(c,0,a);return c},toontalk_json_div:function(a,b){var d=a.view.backside,e=b.get_backside_widgets(),f=b.get_type_name(),g=b.toString();"top-level"===f?d?(a.semantic.settings=void 0,f="a work area containing ",0===e.length?f="an empty work area":
(f=1===e.length?f+"one thing: ":f+(e.length+" things: "),E=e.length,e.forEach(function(a){E--;f+=c.UTILITIES.add_a_or_an(a.get_type_name());1===E?f+=", and ":1<E&&(f+=", ")}))):f="a top-level widget":(f=c.UTILITIES.add_a_or_an(f),d&&(f="the back of "+f));g&&(d=g.indexOf("data:image/"),0<d&&(e=g.indexOf("alt=",d),0>e&&(e=g.indexOf(">",d)),g=g.substring(0,d+20)+" ... "+g.substring(e)));return"<div class='toontalk-json'>\nThis will be replaced by "+f+".\n"+(g?g+"\n":"")+"<div style='display:none;'>"+
JSON.stringify(a,c.UTILITIES.clean_json,"  ")+"</div></div>"},clean_json:function(a,b){return"id_of_tree_replace_once_task"===a?void 0:b},copy_widgets:function(a,b){var c=[],d;for(d=0;d<a.length;d++)c[d]=a[d]&&a[d].copy(b);return c},copy_widget_sides:function(a,b){return a.map(function(a){var c=a.get_widget().copy(b);return a.is_backside()?c.get_backside(!0):c})},copy_array:function(a){return a.slice()},generate_unique_id:function(){a+=1;return"toontalk_id_"+a},get_style_property:function(a,b){if(a.currentStyle)return a.currentStyle[b];
if(window.getComputedStyle)return document.defaultView.getComputedStyle(a,null).getPropertyValue(b)},get_style_numeric_property:function(a,b){var c=this.get_style_property(a,b),d;return"string"===typeof c?(d=c.indexOf("px"),0<=d&&(c=c.substring(0,d)),parseInt(c,10)):c},data_transfer_json_object:function(a){var b;if(a.dataTransfer){try{b=a.dataTransfer.getData("text/html")}catch(d){b=a.dataTransfer.getData("text")}if(!b||b.match(/[\u3400-\u9FBF]/))b=a.dataTransfer.getData("text");if(b){a=k(b);if(!a)return c.UTILITIES.get_json_top_level(c.element.create(b));
try{return JSON.parse(a)}catch(e){c.UTILITIES.report_internal_error("Exception parsing "+a+"\n"+e.toString())}}}},drag_and_drop:function(a){var b;c.UTILITIES.draggable(a);c.UTILITIES.can_receive_drops(a);$(a).is(".toontalk-backside-of-top-level")||(b=$(a).is(".toontalk-top-level-resource")?0:500,c.UTILITIES.enable_touch_events(a,b))},draggable:function(a){$(a).attr("draggable",!0);a.addEventListener("dragstart",function(b){g(b,a)});a.addEventListener("dragend",function(b){d(b,a)})},can_receive_drops:function(a){var b=
function(b){var e=l(b,a);e&&d!==e&&c.UTILITIES.remove_highlight(d);d=e;b.stopPropagation()},d;a.addEventListener("dragover",function(a){b(a);a.preventDefault();return!1});a.addEventListener("drop",function(b){b.preventDefault();f(b,a);b.stopPropagation()});a.addEventListener("dragenter",b);a.addEventListener("dragleave",function(a){d&&!c.UTILITIES.inside_rectangle(a.clientX,a.clientY,d.getBoundingClientRect())&&(c.UTILITIES.remove_highlight(d),d=void 0);a.stopPropagation()})},create_drop_area:function(a){var b=
document.createElement("div"),d=$(b),e=document.createElement("div");e.innerHTML=a;$(e).addClass("toontalk-drop-area-instructions ui-widget");d.addClass("toontalk-drop-area");d.append(e);c.UTILITIES.can_receive_drops(b);return d},process_json_elements:function(){$(".toontalk-json").each(function(a,b){var d=b.textContent,e,f,g,k;if(d)if(d=d.substring(d.indexOf("{"),d.lastIndexOf("}")+1),e=JSON.parse(d),f=c.UTILITIES.create_from_json(e)){b.textContent="";if(f.get_type_name)if(f.is_top_level()){if(!c.no_local_storage&&
!c.UTILITIES.get_current_url_boolean_parameter("reset",!1)){if(e.load_most_recent_program)try{(k=window.localStorage.getItem("toontalk-last-key"))&&(g=window.localStorage.getItem(k))}catch(l){d="Error reading previous state. Error message is "+l,c.UTILITIES.is_internet_explorer()?console.error(d):c.UTILITIES.display_message(d)}g&&(e=JSON.parse(g),f=c.UTILITIES.create_from_json(e))}g=f.get_backside(!0);g=g.get_element();$(b).replaceWith(g);$(g).css({width:e.view.backside_width,height:e.view.backside_height,
"background-color":e.view.background_color,"border-width":e.view.border_width})}else $(b).addClass("toontalk-top-level-resource toontalk-top-level-resource-container"),g=f.get_frontside_element(),$(g).addClass("toontalk-top-level-resource").css({position:"relative"}),b.toontalk_widget=f,b.appendChild(g);else b.appendChild(f.get_element());f.set_active&&f.set_active(!1);f.set_visible&&f.set_visible(!0);setTimeout(function(){f.update_display&&f.update_display();e.semantic.running&&f.set_running(!0)},
1)}else c.UTILITIES.report_internal_error("Could not recreate a widget from this JSON: "+d)})},set_absolute_position:function(a,b){for(var c=a.parent(),d=b.left,e=b.top,f;c.is("*")&&!c.is("html");)f=c.position(),d-=f.left,e-=f.top,c=c.parent();a.css({left:d,top:e,position:"absolute"});a.is(".toontalk-side-animating")&&(a.get(0).style.left=d+"px",a.get(0).style.top=e+"px")},set_position_relative_to_top_level_backside:function(a,b,d){var e=a.closest(".toontalk-top-level-backside"),f=e.offset(),g,k;
f||(console.log("Unable to find top-level backside. Perhaps is 'visible' but not attached."),f={left:0,top:0});g=b.left-f.left;b=b.top-f.top;d&&(d=a.width(),f=a.height(),k=e.width(),e=e.height(),g>k-d&&(g=k-d),0>g&&(g=0),b>e-f&&(b=e-f),0>b&&(b=0));a.css({left:g,top:b,position:"absolute"});a.is(".toontalk-side-animating")&&(a.get(0).style.left=g+"px",a.get(0).style.top=b+"px",c.UTILITIES.add_one_shot_event_handler(a.get(0),"transitionend",2E3,function(){a.removeClass("toontalk-side-animating");a.get(0).style.transitionDuration=
""}))},restore_resource:function(a,b){var d,e;a&&a.is(".toontalk-top-level-resource")&&(d=b.copy({fresh_copy:!0}),e=d.get_frontside_element(),$(e).css({width:a.width(),height:a.height()}),a.parent().removeClass("toontalk-top-level-resource toontalk-top-level-resource-container"),a.removeClass("toontalk-top-level-resource toontalk-top-level-resource-container"),$(e).addClass("toontalk-top-level-resource toontalk-top-level-resource-container").css({position:"relative"}),a.get(0).parentElement.appendChild(e),
c.DISPLAY_UPDATES.pending_update(d),b.set_active&&(b.set_active(!0),d.set_active(!1)))},find_resource_equal_to_widget:function(a){var b;$(".toontalk-top-level-resource.toontalk-side").each(function(d,e){var f=c.UTILITIES.widget_from_jquery($(e));if(f&&(a.equals&&a.equals(f)||a.matching_resource&&a.matching_resource(f)||"matched"===a.match(f)))return b=e,!1});return b},set_position_is_absolute:function(a,b){var c,d;b?(c=$(a).position(),d=c.left,c=c.top,$(a).css({left:d,top:c,position:"absolute"})):
a.style.position="static"},ordinal:function(a){a++;switch(a){case 1:return"first";case 2:return"second";case 3:return"third";case 4:return"fourth";case 5:return"fifth";case 6:return"sixth";case 7:return"seventh";case 8:return"eighth";case 9:return"ninth";case 10:return"tenth";default:return 1===a%10?a+"st":2===a%10?a+"nd":3===a%10?a+"rd":a+"th"}},on_a_nest_in_a_box:function(a){return $(a).closest(".toontalk-nest").is("*")&&$(a).closest(".toontalk-box").is("*")},give_tooltip:function(a,b){a.title=
b;c.UTILITIES.use_custom_tooltip(a)},use_custom_tooltip:function(a){var b=$(a),d;b.tooltip({position:{my:"center bottom-20",at:"center top",using:function(a,c){var e;0>a.top&&(a.top=0,e=b.offset(),e.left<$(window).width()/2?a.left=e.left+b.width()+10:(a.left=0,d=e.left-40));b.is(".toontalk-robot")?(a.top-=30,a.left-=50):b.is(".toontalk-number")?a.top-=30:b.is(".toontalk-box")?a.top-=30:a.top-=20;10>a.left&&(a.left=10);10>a.top&&(a.top=10);$(this).css(a)}},open:function(a,b){var e=b.tooltip.get(0).textContent.length,
f=b.tooltip.get(0),g;f.innerHTML=b.tooltip.get(0).textContent.replace(/(\r\n|\n|\r)/g,"<br>");100<e&&(g=Math.min(800,d||$(window).width()-100),f=$(f).position(),b.tooltip.css({left:Math.max(0,f.left-110),top:f.top+80,maxWidth:g}));I&&I.hide();I=b.tooltip;setTimeout(function(){b.tooltip.hide();I=void 0},e*(c.MAXIMUM_TOOLTIP_DURATION_PER_CHARACTER||100))},close:function(){I=void 0}})},add_one_shot_event_handler:function(a,b,c,d){var e=!1,f=function(c){e=!0;d&&d();a.removeEventListener(b,f)};a.addEventListener(b,
f);setTimeout(function(){e||f()},c)},animate_to_absolute_position:function(a,b,d,e,f){var g=$(a).offset(),k=$(a).position(),l=c.UTILITIES.distance(b,g),n;$(a).css({"z-index":c.UTILITIES.next_z_index()});e||(e=.5);n=Math.round(l/e);$(a).addClass("toontalk-side-animating");a.style.transitionDuration=n+"ms";l=k.left+(b.left-g.left);g=k.top+(b.top-g.top);a.style.left=l+"px";a.style.top=g+"px";a.toontalk_followed_by&&(b.left+=a.toontalk_followed_by.left_offset,b.top+=a.toontalk_followed_by.top_offset,
c.UTILITIES.animate_to_absolute_position(a.toontalk_followed_by.element,b,void 0,e,f));f||setTimeout(function(){$(a).removeClass("toontalk-side-animating");a.style.transitionDuration=""},n);setTimeout(d,n)},distance:function(a,b){var c=a.left-b.left,d=a.top-b.top;return Math.sqrt(c*c+d*d)},highlight_element:function(a,b,d){var e;if(a){c.UTILITIES.remove_highlight();if(!$(a).is(".toontalk-backside")&&(e=c.UTILITIES.widget_of_element(a),!e||e.element_to_highlight&&b&&(a=e.element_to_highlight(b),!a)))return;
$(a).is(".toontalk-highlight")||($(a).addClass("toontalk-highlight").css({"z-index":c.UTILITIES.next_z_index()}),d&&setTimeout(function(){c.UTILITIES.remove_highlight()},d))}},remove_highlight:function(a){a?$(a).removeClass("toontalk-highlight"):$(".toontalk-highlight").removeClass("toontalk-highlight")},cursor_of_image:function(a){var b=a.lastIndexOf(".");return 0<=b?a.substring(0,b)+".32x32"+a.substring(b):a},inside_rectangle:function(a,b,c){return a>=c.left&&a<=c.right&&b>=c.top&&b<=c.bottom},
constrain_css_to_fit_inside:function(a,b){var c=$(a).width();if(0!==c){var d=$(a).height();b.left=Math.min(Math.max(b.left,0),c);b.top=Math.min(Math.max(b.top,0),d)}},next_z_index:function(){b++;return b},create_button:function(a,b,d,e){a=$("<button>"+a+"</button>").button();a.addClass(b).click(e);c.UTILITIES.give_tooltip(a.get(0),d);return a.get(0)},create_close_button:function(a,b){var d=document.createElement("div"),e=document.createElement("div");$(d).addClass("toontalk-close-button");$(d).click(a);
c.UTILITIES.give_tooltip(d,b);e.innerHTML="&times;";d.appendChild(e);return d},check_radio_button:function(a){$(a.button).prop("checked",!0);$(a.label).addClass("ui-state-active")},create_button_set:function(){var a=document.createElement("div"),b,c;for(b=0;b<arguments.length;b++)if(0<=arguments[b].length)for(c=0;c<arguments[b].length;c++)a.appendChild(arguments[b][c]);else a.appendChild(arguments[b]);$(a).buttonset();return a},create_alert_element:function(a){a=c.UTILITIES.create_text_element(a);
$(a).addClass("toontalk-alert-element");return a},create_text_element:function(a){var b=document.createElement("div");b.textContent=a;$(b).addClass("ui-widget");return b},create_space:function(){var a=document.createElement("span");a.innerHTML="&nbsp;";$(a).addClass("ui-widget");return a},create_anchor_element:function(a,b){var d=document.createElement("a");d.innerHTML=a;c.TRANSLATION_ENABLED&&(b=c.UTILITIES.add_URL_parameter(b,"translate","1"));d.href=b;d.target="_blank";return d},create_text_input:function(a,
b,d,e,f,g,k){var l=document.createElement("input"),n;l.type="text";l.className=b;l.value=a;c.UTILITIES.give_tooltip(l,e);g&&(l.type=g);d?(a=document.createElement("label"),a.innerHTML=d,l.id=c.UTILITIES.generate_unique_id(),a.htmlFor=l.id,f&&(n=c.UTILITIES.create_anchor_element("i",f),$(n).addClass("toontalk-help-button notranslate"),n.translate=!1),d=c.UTILITIES.create_horizontal_table(a,l,n),$(a).addClass("ui-widget")):d=l;$(l).button().addClass("toontalk-text-input").css({"background-color":"white"});
l.addEventListener("touchstart",function(){$(l).select()});k&&r(l,k);c.UTILITIES.use_custom_tooltip(l);return{container:d,button:l}},create_text_area:function(a,b,d,e,f,g){var k=document.createElement("textarea");k.className=b;k.value=a;c.UTILITIES.give_tooltip(k,e);a=document.createElement("label");a.innerHTML=d;k.id=c.UTILITIES.generate_unique_id();a.htmlFor=k.id;d=c.UTILITIES.create_horizontal_table(a,k);$(k).button().addClass("toontalk-text-area").css({background:"white"});k.addEventListener("touchstart",
function(){$(k).select()});f&&r(k,f);$(a).addClass("ui-widget");c.UTILITIES.use_custom_tooltip(k);return{container:d,button:k}},input_area_drop_handler:function(a,b){var c,d;a.preventDefault();if(c=n(a)){if(d=b(c,a))$(a.currentTarget).trigger("change"),a.currentTarget.value=d;c.remove()}a.stopPropagation();return"string"===typeof d&&c},create_radio_button:function(a,b,d,e,f){var g=document.createElement("div"),k=document.createElement("input"),l=document.createElement("label");k.type="radio";k.className=
d;k.name=a;k.value=b;l.innerHTML=e;k.id=c.UTILITIES.generate_unique_id();l.htmlFor=k.id;g.appendChild(k);g.appendChild(l);c.UTILITIES.give_tooltip(g,f);$(k).button();c.UTILITIES.use_custom_tooltip(k);return{container:g,button:k,label:l}},create_select_menu:function(a,b,d,e,f,g){var k=document.createElement("div"),l=document.createElement("select"),n=document.createElement("label");l.className=d;l.name=a;l.id=c.UTILITIES.generate_unique_id();n.innerHTML=e;n.htmlFor=l.id;k.appendChild(n);k.appendChild(l);
c.UTILITIES.give_tooltip(k,f);b.forEach(function(a,b){var d=document.createElement("option");d.value=a;d.innerHTML=a;g&&g[b]&&(c.UTILITIES.give_tooltip(d,g[b]),c.UTILITIES.use_custom_tooltip(d));l.appendChild(d)});$(l).addClass("ui-widget");c.UTILITIES.use_custom_tooltip(l);return{container:k,menu:l,label:n}},create_check_box:function(a,b,d,e){var f=document.createElement("div"),g=document.createElement("input"),k=document.createElement("label");g.type="checkbox";g.className=b;g.checked=a;k.innerHTML=
d;g.id=c.UTILITIES.generate_unique_id();k.htmlFor=g.id;$(k).addClass("ui-widget");f.appendChild(g);f.appendChild(k);c.UTILITIES.give_tooltip(f,e);c.UTILITIES.use_custom_tooltip(g);return{container:f,button:g,label:k}},create_horizontal_table:function(){var a=document.createElement("table"),b,c,d;c=document.createElement("tr");a.appendChild(c);for(b=0;b<arguments.length;b++)arguments[b]&&(d=document.createElement("td"),c.appendChild(d),d.appendChild(arguments[b]));return a},create_vertical_table:function(){var a=
document.createElement("table"),b,d;for(b=0;b<arguments.length;b++)arguments[b]&&(d=c.UTILITIES.create_row(arguments[b]),a.appendChild(d));return a},create_row:function(){var a=document.createElement("tr"),b=document.createElement("td"),c;for(c=0;c<arguments.length;c++)a.appendChild(arguments[c]);b.appendChild(a);return a},create_table_entry:function(a){var b=document.createElement("td");b.appendChild(a);return b},selected_radio_button:function(){var a;for(a=0;a<arguments.length;a++)if(arguments[a].checked)return arguments[a]},
create_image:function(a,b){var c=document.createElement("img"),d;c.src=a;b&&$(c).addClass(b);0===a.indexOf("images/")&&(d=function(b){c.removeEventListener("error",d);c.src="http://toontalk.github.io/ToonTalk/"+a},c.addEventListener("error",d));return c},create_tabs:function(a,b){var c=document.createElement("div"),d=document.createElement("ul"),e;if(a.length!==b.length)return console.error("UTILITIES.create_tabs called with different length lists."),c;a.forEach(function(a,c){var f=document.createElement("li"),
g=document.createElement("a"),h;"string"===typeof a?(h=document.createElement("span"),h.innerHTML=a):h=a;e="tab-"+c;g.href="#"+e;g.appendChild(h);f.appendChild(g);d.appendChild(f);b[c].id=e});c.appendChild(d);b.forEach(function(a){c.appendChild(a)});$(c).tabs();return c},create_file_data_table:function(a){var b=$('<table cellpadding="0" cellspacing="0" border="0"></table>');a&&b.addClass(a);return b.get(0)},become_file_data_table:function(a,b,d,e){$(a).DataTable({data:b,autoWidth:!1,order:[[1,"desc"]],
columns:[{data:"title",title:"Name",render:function(a,b,f,g){a=d?a.substring(0,a.length-5):a;b=d?c.google_drive.google_drive_url(f.id):"Click to load this program.";if(e)return"<div class='"+e+"' title='"+b+"'id='"+f.id+"'>"+a+"</div>";c.TRANSLATION_ENABLED&&(b=c.UTILITIES.add_URL_parameter(b,"translate","1"));return"<a href='"+b+"'target='_blank' title='Click to open published page.'>"+a+"</a>"}},{data:"modifiedDate",title:"Modified",render:function(a,b,c,d){return(new Date(a)).toUTCString()}},{data:"createdDate",
title:"Created",render:function(a,b,c,d){return(new Date(a)).toUTCString()}},{data:"fileSize",title:"Size"}]});$(a).addClass("toontalk-file-table")},get_local_files_data:function(){return c.UTILITIES.get_all_locally_stored_program_names().map(function(a){var b=c.UTILITIES.get_local_storage_meta_data(a);if(b)return{title:a,modifiedDate:b.last_modified,createdDate:b.created,fileSize:b.file_size}})},create_local_files_table:function(){var a=c.UTILITIES.get_local_files_data(),b=c.UTILITIES.create_file_data_table();
setTimeout(function(){c.UTILITIES.become_file_data_table(b,a,!1,"toontalk-file-load-button toontalk-file-load-button-without-click-handler")});return b},get_dragee:function(){return p},add_URL_parameter:function(a,b,d){a=c.UTILITIES.remove_URL_parameter(a,b);var e;e=0<=a.indexOf("?")?"&":"?";return a+e+b+"="+d},remove_URL_parameter:function(a,b){var c=a.indexOf("&"+b+"="),d;0>c&&(c=a.indexOf("?"+b+"="));if(0>c)return a;d=a.indexOf("&",c+1);0>d&&(d=a.length);a=a.substring(0,c)+a.substring(d);"?"===
a[a.length-1]&&(a=substring(0,a.length-1));return a},add_a_or_an:function(a,b){var c=a.charAt(0);if("'"===c||'"'===c)c=a.charAt(1);return 0===a.indexOf("the ")||0===a.indexOf("a ")||0===a.indexOf("an ")||0===a.indexOf("any ")?a:0>"aeiou".indexOf(c)?b?"A "+a:"a "+a:b?"An "+a:"an "+a},lower_case_first_letter:function(a){return a.charAt(0).toLowerCase()+a.slice(1)},maximum_string_length:function(a,b){var c;if(a.length<=b)return a;c=a.substring(0,Math.round(.75*b));return c+" ... "+a.substring(a.length-
(b-c.length))},backup_all_top_level_widgets:function(a){$(".toontalk-top-level-backside").each(function(b,d){c.UTILITIES.widget_of_element(d).save(a)})},make_resizable:function(a,b){var c,d;a.resizable({start:function(a,b){c=b.originalSize.width;d=b.originalSize.height},resize:function(e,f){a.is(".toontalk-element-frontside")&&(f.size.width!=c&&(b.increment_width(f.size.width-c),c=f.size.width),f.size.height!=d&&(b.increment_height(f.size.height-d),d=f.size.height));b.rerender()},handles:"n,e,s,w"})},
match:function(a,b){var c=a.match(b);return c.is_widget&&b.matched_by?b.matched_by(a):c},current_URL:function(){return window.location.pathname},absolute_file_path:function(a){var b=window.location.pathname,c=b.lastIndexOf("ToonTalk/");return 0>c?a:b.substring(0,c+9)+a},copy_side:function(a,b,c){b=a.get_widget().copy(b);var d;c&&(c=a.get_widget().get_frontside_element())&&(d=b.get_frontside_element(!0),$(d).css({width:$(c).width(),height:$(c).height()}));return a.is_backside()?b.get_backside():b},
scale_to_fit:function(a,b,d,e){return $(b).is(".toontalk-backside")?c.UTILITIES.scale_element(a,d,e,d,e):c.UTILITIES.scale_element(a,$(b).width(),$(b).height(),d,e)},scale_element:function(a,b,d,e,f,g,k,l){var n,p;e||(e=$(a).width());f||(f=$(a).height());n=b?b/e:1;p=d?d/f:1;0===n&&(n=1);0===p&&(p=1);var q=!0;l=(l=l&&l!==document.body?l:a.parentElement)&&0>l.className.indexOf("toontalk-box-hole")&&0>a.className.indexOf("toontalk-scale");var r="";k||(k={});"number"===typeof k.left&&(k.left-=(e-b)/2,
q=!1);"number"===typeof k.left&&(k.top-=(f-d)/2,q=!1);q&&l&&(b&&(r+="translateX("+(b-e)/2+"px) "),d&&(r+="translateY("+(d-f)/2+"px) "));c.UTILITIES.add_transform_to_css((g||"")+" scale("+n+", "+p+")",r,k,l);k.width=e;k.height=f;$(a).css(k);return{x_scale:n,y_scale:p}},add_transform_to_css:function(a,b,c,d){a&&(c||(c={}),c["transform-origin"]||(c["transform-origin"]=d?"center center":"left top"),a+=b,c["-webkit-transform"]=a,c["-moz-transform"]=a,c["-ms-transform"]=a,c["o-transform"]=a,c.transform=
a)},run_when_dimensions_known:function(a,b,d){var e=a.parentElement,f;!d&&$(a).width()&&0>e.className.indexOf("toontalk-box-hole")?setTimeout(function(){b(e)}):(f=function(d){setTimeout(function(){$(a).width()?0>a.parentElement.className.indexOf("toontalk-box-hole")?(b(e),e?e.appendChild(a):$(a).remove(),$(a).removeClass("toontalk-not-observable")):c.UTILITIES.run_when_dimensions_known(a,b,!0):setTimeout(function(){c.UTILITIES.widget_of_element(a);1E4>d&&f(2*d)},d)})},$(a).addClass("toontalk-not-observable"),
document.body.appendChild(a),d&&$(a).css({width:"",height:"",transform:""}),f(1))},original_dimensions:function(a,b,d){var e=a.get_frontside_element();e.parentElement!==document.body&&c.UTILITIES.run_when_dimensions_known(e,function(){b($(e).width(),$(e).height())},d)},relative_position:function(a,b){var c=$(a).offset(),d;b&&(d=$(b).offset(),c.left-=d.left,c.top-=d.top);return c},add_animation_class:function(a,b){$(a).css({width:"",height:""}).addClass(b)},widget_from_jquery:function(a){if(0<a.length)return a.get(0).toontalk_widget},
widget_of_element:function(a){return a.toontalk_widget},has_animating_image:function(a){a=$(a);return(a=a.css("animation")||a.css("webkit-animation")||a.css("moz-animation")||a.css("ms-animation")||a.css("o-animation"))&&0!==a.indexOf("none")},display_message_if_new:function(a){0>A.indexOf(a)&&(c.UTILITIES.display_message(a),A.push(a))},display_message:function(a){var b=c.UTILITIES.create_alert_element(a);$(".toontalk-alert-element").remove();console.log(a);document.body.insertBefore(b,document.body.firstChild);
setTimeout(function(){$(b).remove()},Math.max(2E3,a.length*(c.MAXIMUM_TOOLTIP_DURATION_PER_CHARACTER||100)))},display_tooltip:function(a){c.UTILITIES.use_custom_tooltip(a.get(0));a.tooltip("open")},report_internal_error:function(a){console.log(a);console.trace();c.debugging&&c.UTILITIES.display_message("Error: "+a)},get_current_url_boolean_parameter:function(a,b){return 0>window.location.href.indexOf(a+"=")?b:0<=window.location.href.indexOf(a+"=1")?!0:!1},get_current_url_parameter:function(a,b){var c=
window.location.href.indexOf(a+"="),d;if(0>c)return b;c=c+a.length+1;d=window.location.href.indexOf("&",c);0>d&&(d=window.location.href.length);return window.location.href.substring(c,d)},is_browser_of_type:function(a){return 0<=window.navigator.userAgent.indexOf(a)},is_internet_explorer:function(){return c.UTILITIES.is_browser_of_type("MSIE")||c.UTILITIES.is_browser_of_type("Trident")},add_position:function(a,b){return{left:a.left+b.left,top:a.top+b.top}},subtract_position:function(a,b){return{left:a.left-
b.left,top:a.top-b.top}},remove_z_index:function(a){if(0===a.length||"<"!==a.charAt(0)||0>a.indexOf("z-index"))return a;a=$(a);a.attr("z-index","");return a.html()},add_test_all_button:function(){var a=$("#toontalk-test-all-button"),b;if(0!==a.length){a.button();b=a.get(0);b.innerHTML="Run all tests";var c=!1;a.click(function(a){c?($(".toontalk-stop-sign").each(function(){$(this).parent().is(".toontalk-top-level-backside")&&$(this).click()}),b.innerHTML="Run all tests"):($(".toontalk-green-flag").each(function(){$(this).parent().is(".toontalk-top-level-backside")&&
$(this).click()}),b.innerHTML="Stop all tests");c=!c})}},set_timeout:function(a,b){b?setTimeout(a,b):(G.push(a),window.postMessage("zero-timeout-message","*"))},get_first_property:function(a){return Object.keys(a)[0]},get_all_locally_stored_program_names:function(){var a=window.localStorage.getItem("toontalk-all-program-names");return a?JSON.parse(a):[]},set_all_locally_stored_program_names:function(a){window.localStorage.setItem("toontalk-all-program-names",JSON.stringify(a))},get_local_storage_meta_data:function(a){a=
c.UTILITIES.local_storage_program_meta_data_key(a);var b;try{if(b=window.localStorage.getItem(a))return JSON.parse(b)}catch(d){}},local_storage_program_key:function(a){return"toontalk-json: "+a},local_storage_program_meta_data_key:function(a){return"toontalk-meta-data: "+a},enable_editor:function(a,b,c,d){(function(a,b){var c=function(a){a.data.editor_enabled_for&&a.data.editor_enabled_for===b&&(e=!0,window.removeEventListener("message",c))},d=function(a,b){e||setTimeout(function(){a();d(a,b)},500)},
e=!1;window.addEventListener("message",c);d(a,b)})(function(){a.postMessage({save_edits_to:window.location.href,file_id:c,widgets_json:d},"*")},c)},touch_available:function(){return"ontouchstart"in window||navigator.msMaxTouchPoints},enable_touch_events:function(a,b){var e=a,k=function(b){var g;b.stopPropagation();b.preventDefault();n?(n=!1,d(b,a),g=c.UTILITIES.widget_of_element(a),c.debugging&&0===c.debugging.indexOf("touch")&&(c.debugging+="\ndrag ended"),g&&(f(b,a),c.debugging&&0===c.debugging.indexOf("touch")&&
(c.debugging+="\ndrop happened")),c.debugging&&0===c.debugging.indexOf("touch")&&(alert(c.debugging),c.debugging="touch")):p=!0;a=e},n=!1,p=!1,q=0,r=0,t;a.addEventListener("touchstart",function(d){c.debugging&&0===c.debugging.indexOf("touch")&&(c.debugging+="\ntouch start");d.preventDefault();"TEXTAREA"===d.srcElement.tagName||"INPUT"===d.srcElement.tagName||$(d.srcElement).is(".ui-resizable-handle")?c.debugging&&0===c.debugging.indexOf("touch")&&(c.debugging+="\ntouch start ignored due to tag name or class"):
(d.stopPropagation(),c.UTILITIES.set_timeout(function(){var b=d.changedTouches[0],e,f,k;p?(p=!1,e=document.createEvent("MouseEvent"),e.initMouseEvent("click",!0,!0,window,1,b.screenX,b.screenY,b.clientX,b.clientY,!1,!1,!1,!1,0,null),b.target.dispatchEvent(e),c.debugging&&0===c.debugging.indexOf("touch")&&(c.debugging+="\ntouch end treated as click",alert(c.debugging),c.debugging="touch")):(n=!0,(e=c.UTILITIES.widget_of_element(a))&&e.get_infinite_stack()?(f=e.copy(),e.add_copy_to_container(f,0,0),
e.set_infinite_stack(!1),f.set_infinite_stack(!0)):$(a).is(".toontalk-top-level-resource")&&(f=e.copy(),e.add_copy_to_container(f,0,0),k=$(a).offset(),a=f.get_frontside_element(!0)),k||(k=$(a).offset()),g(d,a),q=b.clientX-k.left,r=b.clientY-k.top,c.debugging&&0===c.debugging.indexOf("touch")&&(c.debugging+="\ndrag started"))},b))},!0);a.addEventListener("touchmove",function(b){var d;b.preventDefault();if(n){d=b.changedTouches[0];c.UTILITIES.set_absolute_position($(a),{left:d.pageX-q,top:d.pageY-r});
b=c.UTILITIES.find_widget_on_page(d,a,0,0);if(t&&t!==b){var e=t.get_frontside_element();c.UTILITIES.remove_highlight(e);t=void 0}b&&(l(d,b.get_frontside_element()),t=b);c.debugging&&0===c.debugging.indexOf("touch")&&(c.debugging+="\ndragged to "+(d.pageX-q)+", "+(d.pageY-r))}else c.debugging&&0===c.debugging.indexOf("touch")&&(c.debugging+="\ntouch move ignored since drag_started not yet set. "+Date.now())},!0);a.addEventListener("touchend",k,!0);a.addEventListener("touchcancel",k,!0)},get_mouse_or_first_touch_event_attribute:function(a,
b){return b.changedTouches?b.changedTouches[0][a]:b[a]},find_widget_on_page:function(a,b,d,e){var f=c.UTILITIES.get_mouse_or_first_touch_event_attribute("pageX",a);a=c.UTILITIES.get_mouse_or_first_touch_event_attribute("pageY",a);var g;$(b).hide();d=document.elementFromPoint(f-(window.pageXOffset+d),a-(window.pageYOffset+e));for($(b).show();d&&!d.toontalk_widget&&(!$(d).is(".toontalk-backside")||$(d).is(".toontalk-top-level-backside"));)d=d.parentNode;d&&(g=d.toontalk_widget);if(g)return g&&g.get_contents&&
g.get_contents()&&(g=g.get_contents()),b=g.get_type_name(),g&&"empty hole"===b?g.get_parent_of_frontside():g},closest_top_level_backside:function(a,b){var d,e;$(".toontalk-top-level-backside").each(function(){var b=$(this).offset(),b=b.left+$(this).width()/2-a^2+(b.top+$(this).height()/2-a)^2;d?b<e&&(d=this,e=b):(d=this,e=b)});return c.UTILITIES.widget_of_element(d)},create_queue:function(){var a=[],b=0;return{getLength:function(){return a.length-b},isEmpty:function(){return 0==a.length},enqueue:function(b){a.push(b)},
dequeue:function(){var c;if(0!=a.length)return c=a[b],2*++b>=a.length&&(a=a.slice(b),b=0),c},peek:function(){return 0<a.length?a[b]:void 0},does_any_item_satisfy:function(c){var d;for(d=b;d<a.length;d++)if(c(a[d]))return!0;return!1}}}}}(window.TOONTALK);window.TOONTALK.UTILITIES.available_types="number box element robot nest sensor top-level".split(" ");
