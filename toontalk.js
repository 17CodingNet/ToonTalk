// generated by the closure compiler on Feb 4 2014
window.TOONTALK.copy=function(){return{create:function(f,g){var e=Object.create(this);e.robot=f;e.path=g;return e},run:function(f){this.robot.thing_in_hand=this.path.dereference(f).copy();return!0}}}();window.TOONTALK.drop_on=function(){return{create:function(f,g){var e=Object.create(this);e.robot=f;e.path=g;return e},run:function(f){return(f=this.path.dereference(f))?(this.robot.thing_in_hand.drop_on(f),!0):!1}}}();window.TOONTALK.pick_up=function(){return{create:function(f,g){var e=Object.create(this);e.robot=f;e.path=g;return e},run:function(f){this.robot.thing_in_hand=this.path.dereference(f);return!0}}}();window.TOONTALK.condition=function(){return{create:function(f){var g=Object.create(this);g.items=f;return g},copy:function(){return this.create(this.items)},match:function(f){return this.items.match(f)}}}();window.TOONTALK.frontside=function(){return{create:function(f){var g=Object.create(this),e=document.createElement("div");e.className="toontalk-frontside";g.get_element=function(){return e};g.get_number=function(){return f};return g}}}();window.TOONTALK.number=function(){var f=window.TOONTALK,g=function(p,e,f){var g="",c=100;e=(e-1)/e;if(f)for(f=0;1<=c&&f<p.length;)g=g+"<span class='toontalk-digit' style='font-size:"+c+"%'>"+p[f]+"</span>",f+=1,c*=e;else for(f=p.length-1;1<=c&&0<f;)g="<span class='toontalk-digit' style='font-size:"+c+"%'>"+p[f]+"</span>"+g,f-=1,c*=e;return g},e=function(p,e){if(p.length<=e)return p;if(4>e)return p[0]+"<span class='toontalk-three-dots-in-number' style='font-size: 33%'>...</span>"+p[p.length-1];var f=
e/2;return g(p,f,!0)+g(p,f,!1)},k=function(p,e){e||(e=1);if(!("number"!==typeof p&&"string"!==typeof p||"number"!==typeof e&&"string"!==typeof p))return bigrat.fromValues(p,e);var f=bigrat.create();1===e?bigrat.set(f,bigrat.toBigInteger(p.get_value()),BigInteger.ONE):p.get_value&&e.get_value?bigrat.set(f,bigrat.toBigInteger(p.get_value()),bigrat.toBigInteger(e.get_value())):bigrat.set(f,p,e);return f};return{create:function(e,g){var r=Object.create(this),w=k(e,g),c="improper_fraction",t,s;r.set_value=
function(c,e){w=c;e?this.update_display():(t&&f.DISPLAY_UPDATES.add_dirty_number(this),s&&f.DISPLAY_UPDATES.add_dirty_backside(s));return this};r.get_value=function(){return w};r.get_frontside=function(c){c&&!t&&(t=f.frontside.create(this));return t};r.get_backside=function(c){c&&!s&&(s=f.number_backside.create(this));return s};r.set_format=function(d,e){c=d;e&&this.update_display();return this};r.get_format=function(){return c};return r},set_from_values:function(e,f,g){return this.set_value(k(e,
f),g)},ONE:function(){return this.create(1)},ZERO:function(){return this.create(0)},copy:function(){return window.TOONTALK.number.create(this.get_value()[0],this.get_value()[1])},is_number:function(){return!0},equals:function(e){return e.get_value?bigrat.equals(this.get_value(),e.get_value()):!1},update_display:function(){var e=this.get_frontside();if(e){var e=e.get_element(),f,g;f=e.clientWidth;g=0.8*e.clientHeight;f=this.to_HTML(f/(0.64*g),g,this.get_format());e.firstChild||e.appendChild(document.createElement("div"));
e.firstChild.innerHTML=f}},drop_on:function(e,f){return e.number_dropped_on_me(this,f)},number_dropped_on_me:function(e){switch(e.get_operator()){case "+":return this.add(e);case "-":return this.subtract(e);case "*":return this.multiply(e);case "/":return this.divide(e);case "^":return this.power(e);default:return console.log("Number received a number with unsupported operator: "+e.get_operator()),this}},to_HTML_with_operator:function(){switch(this.get_operator()){case "+":return this.to_HTML();case "-":return"&minus"+
this.to_HTML();case "*":return"&times;"+this.to_HTML();case "/":return"&divide;"+this.to_HTML();case "^":return"^<sup>"+this.toHTML()+"</sub>";default:return console.log("Number has an unsupported operator: "+this.get_operator()),this}},get_operator:function(){this.operator||(this.operator="+");return this.operator},set_operator:function(e){this.operator=e;return this},add:function(e){this.set_value(bigrat.add(bigrat.create(),this.get_value(),e.get_value()));return this},subtract:function(e){this.set_value(bigrat.subtract(bigrat.create(),
this.get_value(),e.get_value()));return this},multiply:function(e){this.set_value(bigrat.multiply(bigrat.create(),this.get_value(),e.get_value()));return this},divide:function(e){this.set_value(bigrat.divide(bigrat.create(),this.get_value(),e.get_value()));return this},power:function(e){this.set_value(bigrat.power(bigrat.create(),this.get_value(),bigrat.toInteger(e.get_value())));return this},absolute_value:function(){this.set_value(bigrat.abs(bigrat.create(),this.get_value()));return this},is_zero:function(){return bigrat.equals(this.get_value(),
bigrat.ZERO)},toString:function(){return("+"===this.get_operator()?"":this.get_operator())+bigrat.str(this.get_value())},to_HTML:function(f,g,r,k){var c;k=!1!==k?" toontalk-top-level-number":"";f||(f=4);g||(g=16);if(this.is_integer())return r=bigrat.toBigInteger(this.get_value()).toString(),'<div class="toontalk-number toontalk-integer'+k+'" style="font-size: '+g+'px;">'+e(r,f)+"</div>";if("improper_fraction"===r||!r)return'<table class="toontalk-number toontalk-improper-fraction '+k+'" style="font-size: '+
0.5*g+'px;"><tr><td align="center" class="toontalk-number toontalk-numerator">'+e(this.numerator_string(),2*f)+'</td></tr><tr><td><hr class="toontalk-fraction-line"></td></tr><tr><td align="center" class="toontalk-number toontalk-denominator">'+e(this.denominator_string(),2*f)+"</td></tr></table>";if("proper_fraction"===r){r=this.integer_part();if(r.is_zero())return this.to_HTML(f,"improper_fraction",!1);c=this.copy().subtract(r).absolute_value();return'<table class="toontalk-number toontalk-improper_fraction '+
k+'" style="font-size: '+0.5*g+'px;"><tr><td class="toontalk-number toontalk-integer-part-of-proper-fraction">'+r.to_HTML(f,g,"",!1)+'</td><td class="toontalk-number toontalk-fraction-part-of-proper_fraction">'+c.to_HTML(f,g,"improper_fraction",!1)+"</td></tr></table>"}if("decimal"===r)return'<div class="toontalk-number toontalk-decimal'+k+'" style="font-size: '+g+'px;">'+this.decimal_string(f)+"</div>"},is_integer:function(){return 0===this.get_value()[1].compare(BigInteger.ONE)},numerator:function(){var e=
bigrat.create();return bigrat.set(e,this.get_value()[0],BigInteger.ONE)},denominator:function(){var e=bigrat.create();return bigrat.set(e,this.get_value()[1],BigInteger.ONE)},numerator_string:function(){return this.get_value()[0].toString()},denominator_string:function(){return this.get_value()[1].toString()},integer_part:function(){return this.create(this)},decimal_string:function(f){if(this.is_integer())return this.numerator_string();var k=this.copy(),r=k.integer_part(),w=r.toString(),c=k.subtract(r),
k=Math.min(w.length,f/2),r=f-k,t;a:{var s;t=2*r;s=c.absolute_value();c=s.get_value()[0];s=s.get_value()[1];for(var d=new BigInteger(10),h="";t>h.length;)if(c=c.multiply(d),0>c.compare(s))h+="0";else if(h+=c.divide(s).toString(),c=c.remainder(s).multiply(d),c.isZero()){t=h;break a}t=h}t.length<r&&(k=f-t.length);return e(w,k)+"<span class='toontalk-decimal-point' style='font-family: serif'>.</span>"+g(t,f/2,!0)},match:function(e){return this.erased?e.match_with_any_number():e.match_with_this_number(this)},
match_with_any_number:function(){return"matched"},match_with_this_number:function(e){return e.equals(this)?"matched":"not_matched"},dereference:function(){return this}}}();window.TOONTALK.number_backside=function(){var f=function(e,f,c){var g=document.createElement("input");g.type="text";g.className=f;g.value=e;g.title=c;return g},g=function(e,f,c){var g=document.createElement("button");g.className=f;g.innerHTML=e;g.title=c;return g},e=function(e,f){var c=document.createElement("input");c.type="radio";c.className="toontalk-radio-button";c.name=e;c.value=f;return c},k=function(e,f){var c=document.createElement("div"),g=document.createElement("span");g.innerHTML=f;c.appendChild(e);
c.appendChild(g);return c},p=function(){var e;for(e=0;e<arguments.length;e+=1)if(arguments[e].checked)return arguments[e]},z=function(e,f){var c=g("add "+f+" robot","test","just testing");c.onclick=function(){if(c.robot)c.robot.stop(),c.robot=void 0,c.innerHTML="resume "+f;else{var g;switch(f){case "add-one":g=TOONTALK.tests.add_one_robot();break;case "double":g=TOONTALK.tests.double_robot()}c.robot=g;g.run(e.get_number());c.innerHTML="stop "+f}};e.get_element().appendChild(c)};return{create:function(g){var w=
document.createElement("div");w.className="toontalk-backside";var c=Object.create(this),t=f(g.numerator_string(),"toontalk-numerator-input","Type here to edit the numerator"),s=f(g.denominator_string(),"toontalk-denominator-input","Type here to edit the denominator"),d=e("number_format","decimal"),h=e("number_format","proper_fraction"),a=e("number_format","improper_fraction"),b=function(){g.set_from_values(t.value.trim(),s.value.trim(),!0)},q=function(){g.set_format(p(d,h,a).value,!0)};c.get_element=
function(){return w};c.get_number=function(){return g};t.onchange=b;s.onchange=b;d.onchange=q;h.onchange=q;a.onchange=q;a.checked=!0;w.appendChild(t);w.appendChild(s);w.appendChild(k(d,"&nbsp;Display number as a decimal."));w.appendChild(k(h,"&nbsp;Display number as a proper fraction."));w.appendChild(k(a,"&nbsp;Display number as a simple fraction."));z(c,"add-one");z(c,"double");return c},update_display:function(){var e=window.TOONTALK.UTILITIES.get_first_child_with_class(this.get_element(),"toontalk-numerator-input"),
f=window.TOONTALK.UTILITIES.get_first_child_with_class(this.get_element(),"toontalk-denominator-input"),c=this.get_number();e.value=c.numerator_string();f.value=c.denominator_string()}}}();window.TOONTALK.robot=function(){return{create:function(f,g){var e=Object.create(this);e.get_bubble=function(){return f};e.get_body=function(){return g};g.set_robot(e);return e},copy:function(){return this.create(this.get_bubble().copy(),this.get_body())},run:function(f){if(this.stopped)return"not_matched";var g=this.get_bubble().match(f);switch(g){case "matched":return window.TOONTALK.QUEUE.enqueue(this),window.TOONTALK.QUEUE.enqueue(f),g;case "not_matched":return this.next_robot?this.next_robot.run(f):
g;default:return"waiting_on"===g[0]&&g[1].run_when_non_empty(this),g}},stop:function(){this.stopped=!0},run_actions:function(f){return this.get_body().run(f)}}}();window.TOONTALK.DISPLAY_UPDATES=function(){var f=[],g=[];return{add_dirty_number:function(e){var g;for(g=0;g<f.length;g+=1)if(f[g].get_frontside()===e.get_frontside())return;f.push(e)},add_dirty_backside:function(e){var f;for(f=0;f<g.length;f+=1)if(g[f]===e)return;g.push(e)},update_display:function(){var e;for(e=0;e<f.length;e+=1)f[e].update_display();f=[];for(e=0;e<g.length;e+=1)g[e].update_display();g=[]}}}();"function"!==typeof Object.create&&(Object.create=function(f){var g=function(){};g.prototype=f;return new g});String.prototype.trim||String.method("trim",function(){return this.replace(/^\s+|\s+$/g,"")});window.TOONTALK.path=function(){return{create:function(f){var g=Object.create(this);g.path=f;return g},dereference:function(f){return this.context?"not yet implemented":f}}}();window.TOONTALK.pick_up=function(){return{create:function(f,g){var e=Object.create(this);e.robot=f;e.path=g;return e},run:function(f){this.robot.thing_in_hand=this.path.dereference(f);return!0}}}();window.TOONTALK.actions=function(){return{create:function(){var f=[],g=[],e,k=Object.create(this);k.get_steps=function(e){return e?g:f};k.get_robot=function(){return e};k.set_robot=function(f){e=f};return k},add:function(f,g){this.get_steps(g)[this.get_steps().length]=f},run:function(f,g){var e,k=this.get_steps(g);for(e=0;e<k.length;e++)k[e].run(f);this.get_robot().run(f)}}}();window.TOONTALK.queue=function(){return{create:function(){var f=Object.create(this);f.to_run=[];return f},enqueue:function(f){return this.to_run.push(f)},dequeue:function(){return this.to_run.shift()},maximum_run:1,run:function(f){for(var g,e,k=(new Date).getTime()+this.maximum_run,p=this;0<this.to_run.length;){g=(new Date).getTime();if(g>=k)break;g=this.dequeue();e=this.dequeue();g.run_actions(e);if(f&&(f-=1,0===f)){this.to_run=[];window.TOONTALK.DISPLAY_UPDATES.update_display();return}}window.TOONTALK.DISPLAY_UPDATES.update_display();
setTimeout(function(){p.run(f)},0)}}}();window.TOONTALK.QUEUE=window.TOONTALK.queue.create();window.TOONTALK.UTILITIES=function(){return{get_style_property:function(f,g){if(f.currentStyle)return f.currentStyle[g];if(window.getComputedStyle)return document.defaultView.getComputedStyle(f,null).getPropertyValue(g)},get_style_numeric_property:function(f,g){var e=this.get_style_property(f,g),k;return"string"===typeof e?(k=e.indexOf("px"),0<=k&&(e=e.substring(0,k)),parseInt(e,10)):e},get_first_child_with_class:function(f,g){var e;for(e=f.firstChild;e;e=e.nextSibling)if(e.className===g)return e}}}();(function(f){var g;"undefined"===typeof exports?"function"===typeof define&&"object"===typeof define.amd&&define.amd?(g={},define(function(){return g})):g="undefined"!==typeof window?window:f:g=exports;(function(e){var f={greatest_common_divisor:function(a,b){if(1===b||1===a)return 1;for(var c;0!==b;){c=b;b=a%b;if(!isFinite(b))return 0;a=c}return a}};f.gcd=f.greatest_common_divisor;f.fromRandom=function(a){return Math.random()*(1<<a)>>>0};f.fromMillitime=function(){return+new Date};f.fromUnixtime=
function(){return 0.001*f.fromMillitime()|0};"undefined"!==typeof e&&(e.integer=f);(function(a){function b(a,d,f){if(f!==c)return a instanceof b?a:"undefined"===typeof a?e:b.parse(a);for(a=a||[];a.length&&!a[a.length-1];)--a.length;this._d=a;this._s=a.length?d||1:0}var c={};b._construct=function(a,d){return new b(a,d,c)};var d=1E7;b.base=d;b.base_log10=7;var e=new b([],0,c);b.ZERO=e;var f=new b([1],1,c);b.ONE=f;var g=new b(f._d,-1,c);b.M_ONE=g;b._0=e;b._1=f;b.small=[e,f,new b([2],1,c),new b([3],1,
c),new b([4],1,c),new b([5],1,c),new b([6],1,c),new b([7],1,c),new b([8],1,c),new b([9],1,c),new b([10],1,c),new b([11],1,c),new b([12],1,c),new b([13],1,c),new b([14],1,c),new b([15],1,c),new b([16],1,c),new b([17],1,c),new b([18],1,c),new b([19],1,c),new b([20],1,c),new b([21],1,c),new b([22],1,c),new b([23],1,c),new b([24],1,c),new b([25],1,c),new b([26],1,c),new b([27],1,c),new b([28],1,c),new b([29],1,c),new b([30],1,c),new b([31],1,c),new b([32],1,c),new b([33],1,c),new b([34],1,c),new b([35],
1,c),new b([36],1,c)];b.digits="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");b.prototype.toString=function(a){a=+a||10;if(2>a||36<a)throw Error("illegal radix "+a+".");if(0===this._s)return"0";if(10===a){a=0>this._s?"-":"";a+=this._d[this._d.length-1].toString();for(var c=this._d.length-2;0<=c;c--){for(var d=this._d[c].toString();7>d.length;)d="0"+d;a+=d}return a}c=b.digits;a=b.small[a];for(var d=this._s,q=this.abs(),e=[],f;0!==q._s;)f=q.divRem(a),q=f[0],f=f[1],e.push(c[f.valueOf()]);return(0>
d?"-":"")+e.reverse().join("")};b.radixRegex=[/^$/,/^$/,/^[01]*$/,/^[012]*$/,/^[0-3]*$/,/^[0-4]*$/,/^[0-5]*$/,/^[0-6]*$/,/^[0-7]*$/,/^[0-8]*$/,/^[0-9]*$/,/^[0-9aA]*$/,/^[0-9abAB]*$/,/^[0-9abcABC]*$/,/^[0-9a-dA-D]*$/,/^[0-9a-eA-E]*$/,/^[0-9a-fA-F]*$/,/^[0-9a-gA-G]*$/,/^[0-9a-hA-H]*$/,/^[0-9a-iA-I]*$/,/^[0-9a-jA-J]*$/,/^[0-9a-kA-K]*$/,/^[0-9a-lA-L]*$/,/^[0-9a-mA-M]*$/,/^[0-9a-nA-N]*$/,/^[0-9a-oA-O]*$/,/^[0-9a-pA-P]*$/,/^[0-9a-qA-Q]*$/,/^[0-9a-rA-R]*$/,/^[0-9a-sA-S]*$/,/^[0-9a-tA-T]*$/,/^[0-9a-uA-U]*$/,
/^[0-9a-vA-V]*$/,/^[0-9a-wA-W]*$/,/^[0-9a-xA-X]*$/,/^[0-9a-yA-Y]*$/,/^[0-9a-zA-Z]*$/];b.parse=function(a,d){function f(a){a=a.replace(/\s*[*xX]\s*10\s*(\^|\*\*)\s*/,"e");return a.replace(/^([+\-])?(\d+)\.?(\d*)[eE]([+\-]?\d+)$/,function(a,b,c,d,q){q=+q;var e=0>q,x=c.length+q;a=(e?c:d).length;q=(q=Math.abs(q))>=a?q-a+e:0;a=Array(q+1).join("0");c+=d;return(b||"")+(e?c=a+c:c+=a).substr(0,x+=e?a.length:0)+(x<c.length?"."+c.substr(x):"")})}a=a.toString();if("undefined"===typeof d||10===+d)a=f(a);var g=
RegExp("^([+\\-]?)("+("undefined"===typeof d?"0[xcb]":16==d?"0x":8==d?"0c":2==d?"0b":"")+")?([0-9a-z]*)(?:\\.\\d*)?$","i").exec(a);if(g){var B=g[1]||"+",n=g[2]||"",g=g[3]||"";if("undefined"===typeof d)d="0x"===n||"0X"===n?16:"0c"===n||"0C"===n?8:"0b"===n||"0B"===n?2:10;else if(2>d||36<d)throw Error("Illegal radix "+d+".");d=+d;if(!b.radixRegex[d].test(g))throw Error("Bad digit for radix "+d);g=g.replace(/^0+/,"").split("");if(0===g.length)return e;B="-"===B?-1:1;if(10==d){for(n=[];7<=g.length;)n.push(parseInt(g.splice(g.length-
b.base_log10,b.base_log10).join(""),10));n.push(parseInt(g.join(""),10));return new b(n,B,c)}n=e;d=b.small[d];for(var m=b.small,l=0;l<g.length;l++)n=n.multiply(d).add(m[parseInt(g[l],36)]);return new b(n._d,B,c)}throw Error("Invalid BigInteger format: "+a);};b.prototype.add=function(a){if(0===this._s)return b(a);a=b(a);if(0===a._s)return this;if(this._s!==a._s)return a=a.negate(),this.subtract(a);var e=this._d;a=a._d;for(var f=e.length,g=a.length,v=Array(Math.max(f,g)+1),n=Math.min(f,g),m=0,l=0;l<
n;l++)m=e[l]+a[l]+m,v[l]=m%d,m=m/d|0;g>f&&(e=a,f=g);for(l=n;m&&l<f;l++)m=e[l]+m,v[l]=m%d,m=m/d|0;for(m&&(v[l]=m);l<f;l++)v[l]=e[l];return new b(v,this._s,c)};b.prototype.negate=function(){return new b(this._d,-this._s|0,c)};b.prototype.abs=function(){return 0>this._s?this.negate():this};b.prototype.subtract=function(a){if(0===this._s)return b(a).negate();a=b(a);if(0===a._s)return this;if(this._s!==a._s)return a=a.negate(),this.add(a);var f=this;0>this._s&&(f=new b(a._d,1,c),a=new b(this._d,1,c));
var g=f.compareAbs(a);if(0===g)return e;if(0>g){var h=a;a=f;f=h}f=f._d;a=a._d;var h=f.length,u=a.length,n=Array(h),m=0,l,k;for(l=0;l<u;l++)k=f[l]-m-a[l],0>k?(k+=d,m=1):m=0,n[l]=k;for(l=u;l<h;l++){k=f[l]-m;if(0>k)k+=d;else{n[l++]=k;break}n[l]=k}for(;l<h;l++)n[l]=f[l];return new b(n,g,c)};(function(){function a(e,f){for(var g=e._d,x=g.slice(),v=0;;){var l=(g[v]||0)+1;x[v]=l%d;if(l<=d-1)break;++v}return new b(x,f,c)}function e(a,f){for(var g=a._d,x=g.slice(),v=0;;){var l=(g[v]||0)-1;if(0>l)x[v]=l+d;
else{x[v]=l;break}++v}return new b(x,f,c)}b.prototype.next=function(){switch(this._s){case 0:return f;case -1:return e(this,-1);default:return a(this,1)}};b.prototype.prev=function(){switch(this._s){case 0:return g;case -1:return a(this,-1);default:return e(this,1)}}})();b.prototype.compareAbs=function(a){if(this===a)return 0;if(!(a instanceof b)){if(!isFinite(a))return isNaN(a)?a:-1;a=b(a)}if(0===this._s)return 0!==a._s?-1:0;if(0===a._s)return 1;var c=this._d.length,d=a._d.length;if(c<d)return-1;
if(c>d)return 1;d=this._d;a=a._d;for(c-=1;0<=c;c--)if(d[c]!==a[c])return d[c]<a[c]?-1:1;return 0};b.prototype.compare=function(a){if(this===a)return 0;a=b(a);return 0===this._s?-a._s:this._s===a._s?this.compareAbs(a)*this._s:this._s};b.prototype.isUnit=function(){return this===f||this===g||1===this._d.length&&1===this._d[0]};b.prototype.multiply=function(a){if(0===this._s)return e;a=b(a);if(0===a._s)return e;if(this.isUnit())return 0>this._s?a.negate():a;if(a.isUnit())return 0>a._s?this.negate():
this;if(this===a)return this.square();var f=this._d.length>=a._d.length,g=(f?this:a)._d,f=(f?a:this)._d,h=g.length,u=f.length,n=h+u,m=Array(n),l;for(l=0;l<n;l++)m[l]=0;for(l=0;l<u;l++){for(var n=0,k=f[l],r=h+l,p,A=l;A<r;A++)p=m[A]+k*g[A-l]+n,n=p/d|0,m[A]=p%d|0;n&&(p=m[A]+n,m[A]=p%d)}return new b(m,this._s*a._s,c)};b.prototype.multiplySingleDigit=function(a){if(0===a||0===this._s)return e;if(1===a)return this;var f;if(1===this._d.length)return f=this._d[0]*a,f>=d?new b([f%d|0,f/d|0],1,c):new b([f],
1,c);if(2===a)return this.add(this);if(this.isUnit())return new b([a],1,c);var g=this._d,h=g.length;f=h+1;for(var u=Array(f),n=0;n<f;n++)u[n]=0;for(var m=n=0;m<h;m++)f=a*g[m]+n,n=f/d|0,u[m]=f%d|0;n&&(u[m]=n);return new b(u,1,c)};b.prototype.square=function(){if(0===this._s)return e;if(this.isUnit())return f;var a=this._d,g=a.length,h=Array(g+g+1),k,y,n,m;for(m=0;m<g;m++)n=2*m,k=a[m]*a[m],y=k/d|0,h[n]=k%d,h[n+1]=y;for(m=0;m<g;m++){y=0;n=2*m+1;for(var l=m+1;l<g;l++,n++)k=a[l]*a[m]*2+h[n]+y,y=k/d|0,
h[n]=k%d;n=g+m;k=y+h[n];y=k/d|0;h[n]=k%d;h[n+1]+=y}return new b(h,1,c)};b.prototype.quotient=function(a){return this.divRem(a)[0]};b.prototype.divide=b.prototype.quotient;b.prototype.remainder=function(a){return this.divRem(a)[1]};b.prototype.divRem=function(a){a=b(a);if(0===a._s)throw Error("Divide by zero");if(0===this._s)return[e,e];if(1===a._d.length)return this.divRemSmall(a._s*a._d[0]);switch(this.compareAbs(a)){case 0:return[this._s===a._s?f:g,e];case -1:return[e,this]}var h=this._s*a._s,k=
a.abs(),C=this._d,y=C.length,n=[],m,l=new b([],0,c);for(l._s=1;y;)if(l._d.unshift(C[--y]),0>l.compareAbs(a))n.push(0);else{if(0===l._s)m=0;else{var p=l._d.length;m=k._d.length;p=l._d[p-1]*d+l._d[p-2];m=k._d[m-1]*d+k._d[m-2];l._d.length>k._d.length&&(p=(p+1)*d);m=Math.ceil(p/m)}do{p=k.multiplySingleDigit(m);if(0>=p.compareAbs(l))break;m--}while(m);n.push(m);m&&(m=l.subtract(p),l._d=m._d.slice(),0===l._d.length&&(l._s=0))}return[new b(n.reverse(),h,c),new b(l._d,this._s,c)]};b.prototype.divRemSmall=
function(a){a=+a;if(0===a)throw Error("Divide by zero");var f=this._s*(0>a?-1:1);a=Math.abs(a);if(1>a||a>=d)throw Error("Argument out of range");if(0===this._s)return[e,e];if(1===a||-1===a)return[1===f?this.abs():new b(this._d,f,c),e];if(1===this._d.length){var g=new b([this._d[0]/a|0],1,c);a=new b([this._d[0]%a|0],1,c);0>f&&(g=g.negate());0>this._s&&(a=a.negate());return[g,a]}for(var h=this._d.slice(),g=Array(h.length),u=0,n=0,m=0,l;h.length;)u=u*d+h[h.length-1],u<a?(g[m++]=0,h.pop(),n=d*n+u):(l=
0===u?0:u/a|0,n=u-a*l,(g[m++]=l)?(h.pop(),u=n):h.pop());a=new b([n],1,c);0>this._s&&(a=a.negate());return[new b(g.reverse(),f,c),a]};b.prototype.isEven=function(){var a=this._d;return 0===this._s||0===a.length||0===a[0]%2};b.prototype.isOdd=function(){return!this.isEven()};b.prototype.sign=function(){return this._s};b.prototype.isPositive=function(){return 0<this._s};b.prototype.isNegative=function(){return 0>this._s};b.prototype.isZero=function(){return 0===this._s};b.prototype.exp10=function(a){a=
+a;if(0===a)return this;if(Math.abs(a)>Number(h))throw Error("exponent too large in BigInteger.exp10");if(0<a){for(var d=new b(this._d.slice(),this._s,c);7<=a;a-=7)d._d.unshift(0);if(0==a)return d;d._s=1;d=d.multiplySingleDigit(Math.pow(10,a));return 0>this._s?d.negate():d}if(-a>=7*this._d.length)return e;d=new b(this._d.slice(),this._s,c);for(a=-a;7<=a;a-=7)d._d.shift();return 0==a?d:d.divRemSmall(Math.pow(10,a))[0]};b.prototype.pow=function(a){if(this.isUnit())return 0<this._s?this:b(a).isOdd()?
this:this.negate();a=b(a);if(0===a._s)return f;if(0>a._s){if(0===this._s)throw Error("Divide by zero");return e}if(0===this._s)return e;if(a.isUnit())return this;if(0<a.compareAbs(h))throw Error("exponent too large in BigInteger.pow");for(var c=this,d=f,q=b.small[2];a.isPositive()&&(!a.isOdd()||(d=d.multiply(c),!a.isUnit()));)c=c.square(),a=a.quotient(q);return d};b.prototype.modPow=function(a,c){for(var d=f,q=this;a.isPositive();)a.isOdd()&&(d=d.multiply(q).remainder(c)),a=a.quotient(b.small[2]),
a.isPositive()&&(q=q.square().remainder(c));return d};b.prototype.log=function(){switch(this._s){case 0:return-Infinity;case -1:return NaN}var a=this._d.length;if(30>7*a)return Math.log(this.valueOf());var f=Math.ceil(30/7),e=this._d.slice(a-f);return Math.log((new b(e,1,c)).valueOf())+(a-f)*Math.log(d)};b.prototype.valueOf=function(){return parseInt(this.toString(),10)};b.prototype.toJSValue=function(){return parseInt(this.toString(),10)};var h=b(2147483647);b.MAX_EXP=h;(function(){function a(c){return function(a){return c.call(b(a))}}
function c(a){return function(c,d){return a.call(b(c),b(d))}}function d(a){return function(c,d,q){return a.call(b(c),b(d),b(q))}}(function(){var q,f,e="toJSValue isEven isOdd sign isZero isNegative abs isUnit square negate isPositive toString next prev log".split(" "),g="compare remainder divRem subtract add quotient divide multiply pow compareAbs".split(" "),v=["modPow"];for(q=0;q<e.length;q++)f=e[q],b[f]=a(b.prototype[f]);for(q=0;q<g.length;q++)f=g[q],b[f]=c(b.prototype[f]);for(q=0;q<v.length;q++)f=
v[q],b[f]=d(b.prototype[f]);b.exp10=function(a,c){return b(a).exp10(c)}})()})();a.BigInteger=b})("undefined"!==typeof e?e:this);var g={greatest_common_divisor:function(a,b){if(b.isUnit()||a.isUnit())return BigInteger.ONE;for(var c;!b.isZero();)c=b,b=a.remainder(b),a=c;return a},create:function(){return[0]},clone:function(a){for(var b=[],c=0,d=a.length;c<d;c++)b[c]=a[c];return b},copy:function(a,b){a=[];for(var c=0,d=b.length;c<d;c++)a[c]=b[c];return a},abs:function(a,b){a[0]=Math.abs(b[0]);return a},
str:function(a){return a[0].toString()},toInteger:function(a){return out[0]},fromInteger:function(a){return[parseInt(a)]}};g.ZERO=g.fromInteger(0);g.ONE=g.fromInteger(1);"undefined"!==typeof e&&(e.bigint=g);if(!z)var z=Array;if(!r)var r=Math.pow(2,56);if(!w)var w=16777216;var c={EPSILON:2E-16};c.MAX_LOOPS=w;c.create=function(){var a=new z(2);a[0]=0;a[1]=1;return a};c.clone=function(a){var b=new z(2);b[0]=a[0];b[1]=a[1];return b};c.fromValues=function(a,b){var d=new z(2);d[0]=a;d[1]=b;return c.normalize(d,
d)};c.copy=function(a,b){a[0]=b[0];a[1]=b[1];return a};c.set=function(a,b,d){a[0]=b;a[1]=d;return c.normalize(a,a)};c.abs=function(a,b){a[0]=Math.abs(b[0]);a[1]=b[1];return a};c.invert=function(a,b){var c=b[0];a[0]=b[1];a[1]=c;return a};c.reciprocal=c.invert;c.add=function(a,b,d){b[1]===d[1]?(a[0]=b[0]+d[0],a[1]=b[1]):(a[0]=b[0]*d[1]+d[0]*b[1],a[1]=b[1]*d[1]);return c.normalize(a,a)};c.subtract=function(a,b,d){b[1]===d[1]?(a[0]=b[0]-d[0],a[1]=b[1]):(a[0]=b[0]*d[1]-d[0]*b[1],a[1]=b[1]*d[1]);return c.normalize(a,
a)};c.sub=c.subtract;c.multiply=function(a,b,d){a[0]=b[0]*d[0];a[1]=b[1]*d[1];return c.normalize(a,a)};c.mul=c.multiply;c.mediant=function(a,b,d){a[0]=b[0]+d[0];a[1]=b[1]+d[1];return c.normalize(a,a)};c.divide=function(a,b,d){a[0]=b[0]*d[1];a[1]=b[1]*d[0];return c.normalize(a,a)};c.div=c.divide;c.equals=function(a,b){return 0===a[0]&&0===b[0]||0===a[1]&&0===b[1]?!0:a[0]===b[0]&&a[1]===b[1]};c.approximates=function(a,b){if(c.equals(a,b))return!0;var d=c.create();c.sub(d,a,b);c.abs(d,d);return c.isLessThan(d,
c.INFINITESIMAL)};c.isGreaterThan=function(a,b){return c.equals(a,b)?!1:a[0]*b[1]>b[0]*a[1]};c.isLessThan=function(a,b){return c.equals(a,b)?!1:a[0]*b[1]<b[0]*a[1]};c.isNegative=function(a){return 0>a[0]};c.min=function(a,b,d){c.isLessThan(b,d)?(a[0]=b[0],a[1]=b[1]):(a[0]=d[0],a[1]=d[1]);return a};c.max=function(a,b,d){c.isGreaterThan(b,d)?(a[0]=b[0],a[1]=b[1]):(a[0]=d[0],a[1]=d[1]);return a};c.scalar_multiply=function(a,b,d){a[0]=b[0]*d;a[1]=b[1];return c.normalize(a,a)};c.scalar_divide=function(a,
b,d){a[0]=b[0];a[1]=b[1]*d;return c.normalize(a,a)};c.normalize=function(a,b){if(isNaN(b[0])||isNaN(b[1])||0===b[0]&&0===b[1])return a[0]=0,a[1]=0,a;if(0===b[0])return a[0]=0,a[1]=1,a;if(0===b[1])return a[0]=1,a[1]=0,a;if(b[0]===b[1])return a[0]=1,a[1]=1,a;0<b[1]?(a[0]=b[0],a[1]=b[1]):(a[0]=-b[0],a[1]=-b[1]);var c=f.greatest_common_divisor(Math.abs(a[0]),a[1]);1<c&&(a[0]/=c,a[1]/=c);return a};c.opposite=function(a,b){a[0]=-b[0];a[1]=b[1];return a};c.negative=c.opposite;c.neg=c.opposite;c.power=function(a,
b,d){2===d?(a[0]=b[0]*b[0],a[1]=b[1]*b[1]):0<d?(a[0]=Math.pow(b[0],d),a[1]=Math.pow(b[1],d)):0>d?(d=Math.abs(d),a[0]=Math.pow(b[1],d),a[1]=Math.pow(b[0],d)):c.copy(a,c.ONE);return c.normalize(a,a)};c.pow=c.power;c.sqrt=function(a,b){return c.nthRoot(a,b,2)};c.nthRoot=function(a,b,d){if(c.equals(b,c.ZERO))return c.copy(a,c.ZERO);if(c.equals(b,c.ONE))return c.copy(a,c.ONE);if(c.equals(b,c.INFINITY))return c.copy(a,c.INFINITY);if(c.equals(b,c.INFINULL))return c.copy(a,c.INFINULL);var f=c.isNegative(b);
f&&(b[0]=-b[0]);a=c.copy(a,c.ONE);for(var e=[1,0,0,1],g=c.clone(c.ONE),h=c.MAX_LOOPS;!c.approximates(b,g)&&h--;)c.isLessThan(b,g)?(e[0]+=e[1],e[2]+=e[3]):(e[1]+=e[0],e[3]+=e[2]),a[0]=e[0]+e[1],a[1]=e[2]+e[3],c.pow(g,a,d);f&&(b[0]=-b[0],1===d%2&&c.neg(a,a));return a};c.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]};c.str=function(a){return 1===a[1]?a[0].toString():a[0]+"/"+a[1]};c.toDecimal=function(a){return a[0]/a[1]};c.dec=c.toDecimal;c.toInteger=function(a){return Math.round(c.toDecimal(a))};c.round=
c.toInteger;c.floor=function(a){return Math.floor(c.toDecimal(a))};c.ceil=function(a){return Math.ceil(c.toDecimal(a))};c.fromInteger_copy=function(a,b){a[0]=parseInt(b);a[1]=1;return a};c.fromInteger=function(a){return c.fromInteger_copy(c.create(),a)};c.fromIntegerInverse_copy=function(a,b){a[0]=1;a[1]=parseInt(b);0>a[1]&&(a[0]=-a[0],a[1]=-a[1]);return a};c.fromIntegerInverse=function(a){return c.fromIntegerInverse_copy(c.create(),a)};c.fromDecimal=function(a){return c.fromDecimal_copy(c.create(),
a)};c.fromDecimal_copy=function(a,b){b=parseFloat(b);if(isNaN(b))return c.copy(a,c.INFINULL);if(Infinity===b)return c.copy(a,c.INFINITY);if(Math.abs(b)<c.EPSILON)return c.copy(a,c.ZERO);if(Math.abs(b-1)<c.EPSILON)return c.copy(a,c.ONE);if(Math.abs(b%1)<c.EPSILON)return c.fromInteger_copy(a,b);if(Math.abs(1/b%1)<c.EPSILON)return c.fromIntegerInverse_copy(a,Math.round(1/b));c.copy(a,c.ONE);for(var d=[1,0,0,1],e=b,f=1,g=c.MAX_LOOPS;g--&&Math.abs(b-c.toDecimal(a))>c.EPSILON;)f=Math.floor(e),a[0]=f*d[0]+
d[2],a[1]=f*d[1]+d[3],e=1/(e-f),d[2]=d[0],d[3]=d[1],d[0]=a[0],d[1]=a[1];return a};c.fromRandom=function(a){a[0]=0xfffffffffffff*Math.random()<<0;a[1]=Math.abs(0xfffffffffffff*Math.random()<<0);return c.normalize(a,a)};c.sin=function(a,b){if(0===b[1])return c.copy(a,c.ZERO);c.scalar_multiply(a,b,2);var d=c.create();c.pow(d,b,2);c.add(d,d,c.ONE);c.divide(a,a,d);return a};c.cos=function(a,b){if(0===b[1])return c.neg(a,c.ONE);var d=c.create();c.pow(d,b,2);c.sub(a,c.ONE,d);var e=c.create();c.add(e,c.ONE,
d);c.divide(a,a,e);return a};c.tan=function(a,b){c.scalar_multiply(a,b,2);var d=c.create();c.pow(d,b,2);c.scalar_multiply(d,d,2);c.add(a,a,d);c.pow(d,b,4);c.sub(d,c.ONE,d);c.divide(a,a,d);return a};c.toEgyptian=function(a){a=c.clone(a);c.abs(a,a);var b=c.floor(a);b&&c.sub(a,a,c.fromInteger(b));if(!a[0])return b.toString();b||(b="");for(var d=1,e=c.create();1!==a[0];)d++,e=c.fromValues(1,d),c.isGreaterThan(a,e)&&(b&&(b+=" + "),b+=c.str(e),c.sub(a,a,e));return a?b?b+" + "+c.str(a):c.str(a):b?b:"0"};
c.toBabylonian=function(a){var b="",d=c.toDecimal(a);a=parseInt(d);for(var d=d-a,e=0,f=0;0<a;)(e=a%60)&&(b=e+" * 60^"+f+(b?" + ":"")+b),a=(a-e)/60,f++;for(f=-1;0<d;)d*=60,e=parseInt(d+1E-13),d-=e,-1E-13>d||(e&&(b+=(b?" + ":"")+e+" * 60^"+f),f--);return b?b:"0"};c.traceSternBrocot=function(a){var b="";if(c.equals(a,c.ZERO)||c.equals(a,c.ONE)||c.equals(a,c.INFINITY)||c.equals(a,c.INFINULL))return b;if(c.equals(a,c.ZERO))return c.copy(out,c.ZERO);if(c.equals(a,c.ONE))return c.copy(out,c.ONE);if(c.equals(a,
c.INFINITY))return c.copy(out,c.INFINITY);if(c.equals(a,c.INFINULL))return c.copy(out,c.INFINULL);a=c.clone(a);c.isNegative(a)&&(a[0]=-a[0]);for(var d=c.clone(c.ONE),e=[1,0,0,1],f=0,g=0,h=c.MAX_LOOPS;!c.approximates(a,d)&&h--;)c.isLessThan(a,d)?(e[0]+=e[1],e[2]+=e[3],g++,f&&(b+="R",1!==f&&(b+=f),f=0,b+=" ")):(e[1]+=e[0],e[3]+=e[2],f++,g&&(b+="L",1!==g&&(b+=g),g=0,b+=" ")),d[0]=e[0]+e[1],d[1]=e[2]+e[3];g?(b+="L",1!==g&&(b+=g)):f&&(b+="R",1!==f&&(b+=f));0>h&&(b+="...");return b};c.toContinuedFraction=
function(a,b){b="undefined"===typeof b?65536:parseInt(b);if(c.equals(a,c.ZERO))return[0];if(c.equals(a,c.ONE))return[1];if(c.equals(a,c.NEGONE))return[-1];if(c.equals(a,c.INFINITY))return[1,0];if(c.equals(a,c.INFINULL))return[0,0];var d=c.clone(a),e=c.isNegative(d);e&&(d[0]=-d[0]);for(var f=c.clone(c.ONE),g=[1,0,0,1],h=1,k=[0],p=k.length-1;!c.equals(d,f)&&b--;)c.isLessThan(d,f)?(-1===h?k[p]++:(h=-1,k.push(1),p++),g[0]+=g[1],g[2]+=g[3]):(1===h?k[p]++:(h=1,k.push(1),p++),g[1]+=g[0],g[3]+=g[2]),f[0]=
g[0]+g[1],f[1]=g[2]+g[3];0>b?k.push(0):k[p]++;if(e)for(var r in k)k[r]=-k[r];return k};c.fromContinuedFraction=function(a,b){c.fromInteger_copy(a,b[b.length-1]);for(var d=b.length-2;-1<d;d--)c.invert(a,a),c.add(a,c.fromInteger(b[d]),a);return a};c.dump=function(a){c.create();return"rat\t"+c.str(a)+"\n~\t"+c.toDecimal(a)+"\nCF:\t["+c.toContinuedFraction(a)+"]\n"};c.ZERO=c.fromInteger(0);c.ONE=c.fromInteger(1);c.NEGONE=c.fromInteger(-1);c.INFINITY=c.fromValues(1,0);c.INFINULL=c.fromValues(0,0);c.INFINITESIMAL=
c.clone([1,r]);c.PI=c.fromValues(1320192667429,420230377710);"undefined"!==typeof e&&(e.rat=c);if(!t)var t=new BigInteger("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF");if(!s)var s=1073741824;var d={EPSILON:2E-16};d.MAX_LOOPS=s;d.create=function(){var a=[];a[0]=BigInteger.ZERO;a[1]=BigInteger.ONE;return a};d.clone=function(a){var b=[];b[0]=a[0];b[1]=a[1];return b};d.fromValues=function(a,b){var c=[];c[0]=new BigInteger(a);c[1]=new BigInteger(b);return d.normalize(c,c)};d.copy=function(a,b){a[0]=b[0];a[1]=
b[1];return a};d.set=function(a,b,c){a[0]=b;a[1]=c;return d.normalize(a,a)};d.toRat=function(a,b){return c.set(a,b[0].toJSValue(),b[1].toJSValue())};d.fromRat=function(a,b){return d.set(a,BigInteger(b[0]),BigInteger(b[1]))};d.abs=function(a,b){a[0]=b[0].abs();a[1]=b[1];return a};d.invert=function(a,b){var c=b[0];a[0]=b[1];a[1]=c;return a};d.reciprocal=d.invert;d.add=function(a,b,c){0===b[1].compare(c[1])?(a[0]=b[0].add(c[0]),a[1]=b[1]):(a[0]=b[0].multiply(c[1]).add(c[0].multiply(b[1])),a[1]=b[1].multiply(c[1]));
return d.normalize(a,a)};d.subtract=function(a,b,c){0===b[1].compare(c[1])?(a[0]=b[0].subtract(c[0]),a[1]=b[1]):(a[0]=b[0].multiply(c[1]).subtract(c[0].multiply(b[1])),a[1]=b[1].multiply(c[1]));return d.normalize(a,a)};d.sub=d.subtract;d.multiply=function(a,b,c){a[0]=b[0].multiply(c[0]);a[1]=b[1].multiply(c[1]);return d.normalize(a,a)};d.mul=d.multiply;d.mediant=function(a,b,c){a[0]=b[0].add(c[0]);a[1]=b[1].add(c[1]);return d.normalize(a,a)};d.divide=function(a,b,c){a[0]=b[0].multiply(c[1]);a[1]=
b[1].multiply(c[0]);return d.normalize(a,a)};d.div=d.divide;d.equals=function(a,b){return a[0].isZero()&&b[0].isZero()||a[1].isZero()&&b[1].isZero()?!0:0===a[0].compare(b[0])&&0===a[1].compare(b[1])};d.approximates=function(a,b){if(d.equals(a,b))return!0;var c=d.create();d.sub(c,a,b);d.abs(c,c);return d.isLessThan(c,d.INFINITESIMAL)};d.isGreaterThan=function(a,b){return d.equals(a,b)?!1:0<a[0].multiply(b[1]).compare(b[0].multiply(a[1]))};d.isLessThan=function(a,b){return d.equals(a,b)?!1:0>a[0].multiply(b[1]).compare(b[0].multiply(a[1]))};
d.isNegative=function(a){return a[0].isNegative()};d.min=function(a,b,c){d.isLessThan(b,c)?(a[0]=b[0],a[1]=b[1]):(a[0]=c[0],a[1]=c[1]);return a};d.max=function(a,b,c){d.isGreaterThan(b,c)?(a[0]=b[0],a[1]=b[1]):(a[0]=c[0],a[1]=c[1]);return a};d.scalar_multiply=function(a,b,c){a[0]=b[0].multiply(c);a[1]=b[1];return d.normalize(a,a)};d.scalar_divide=function(a,b,c){a[0]=b[0];a[1]=b[1].multiply(c);return d.normalize(a,a)};d.normalize=function(a,b){if(b[0].isZero()||b[1].isZero())return b;if(0===b[0].compare(b[1]))return d.clone(d.ONE);
if(b[1].isNegative())a[0]=b[0].negate(),a[1]=b[1].negate();else if(a[0]=b[0],a[1]=b[1],a[1].isZero())return a;var c=g.greatest_common_divisor(a[0].abs(),a[1]);0<c.compare(BigInteger.ONE)&&(a[0]=a[0].quotient(c),a[1]=a[1].quotient(c));return a};d.opposite=function(a,b){a[0]=b[0].negate();a[1]=b[1];return a};d.negative=d.opposite;d.neg=d.opposite;d.power=function(a,b,c){2===c?(a[0]=b[0].square(),a[1]=b[1].square()):0<c?(a[0]=b[0].pow(c),a[1]=b[1].pow(c)):0>c?(c=Math.abs(c),a[0]=b[1].pow(c),a[1]=b[0].pow(c)):
d.copy(a,d.ONE);return a};d.pow=d.power;d.sqrt=function(a,b){return d.nthRoot(a,b,2)};d.nthRoot=function(a,b,c){if(d.equals(b,d.ZERO))return d.copy(a,d.ZERO);if(d.equals(b,d.ONE))return d.copy(a,d.ONE);if(d.equals(b,d.INFINITY))return d.copy(a,d.INFINITY);if(d.equals(b,d.INFINULL))return d.copy(a,d.INFINULL);var e=d.isNegative(b);e&&(b[0]=b[0].negate());d.copy(a,d.ONE);for(var f=[BigInteger(1),BigInteger(0),BigInteger(0),BigInteger(1)],g=d.clone(d.ONE),h=s;!d.approximates(b,g)&&h--;)d.isLessThan(b,
g)?(f[0]=f[0].add(f[1]),f[2]=f[2].add(f[3])):(f[1]=f[1].add(f[0]),f[3]=f[3].add(f[2])),a[0]=f[0].add(f[1]),a[1]=f[2].add(f[3]),d.pow(g,a,c);e&&(b[0]=b[0].negate(),1===c%2&&d.neg(a,a));return a};d.dot=function(a,b){return a[0].multiply(b[0]).add(a[1].multiply(b[1]))};d.str=function(a){return 0===a[1].compare(BigInteger.ONE)?a[0].toString():a[0].toString()+"/"+a[1].toString()};d.toDecimal=function(a){return a[0].toJSValue()/a[1].toJSValue()};d.dec=d.toDecimal;d.toInteger=function(a){return a[0].quotient(a[1]).toJSValue()};
d.round=d.toInteger;d.toBigInteger=function(a){return a[0].quotient(a[1])};d.floor=function(a){return Math.floor(d.toDecimal(a))};d.ceil=function(a){return Math.ceil(d.toDecimal(a))};d.fromInteger_copy=function(a,b){a[0]=BigInteger(b);a[1]=BigInteger.ONE;return a};d.fromInteger=function(a){return d.fromInteger_copy(d.create(),a)};d.fromIntegerInverse_copy=function(a,b){a[0]=BigInteger.ONE;a[1]=BigInteger(b);a[1].isNegative()&&(a[0]=a[0].negate(),a[1]=a[1].negate());return a};d.fromIntegerInverse=
function(a){return d.fromIntegerInverse_copy(d.create(),a)};d.fromDecimal=function(a){return d.fromDecimal_copy(d.create(),a)};d.fromDecimal_copy=function(a,b){b=parseFloat(b);if(isNaN(b))return d.copy(a,d.INFINULL);if(Infinity===b)return d.copy(a,d.INFINITY);if(Math.abs(b)<d.EPSILON)return d.copy(a,d.ZERO);if(Math.abs(b-1)<d.EPSILON)return d.copy(a,d.ONE);if(Math.abs(b%1)<d.EPSILON)return d.fromInteger_copy(a,b);if(Math.abs(1/b%1)<d.EPSILON)return d.fromIntegerInverse_copy(a,Math.round(1/b));d.copy(a,
d.ONE);for(var c=[BigInteger(1),BigInteger(0),BigInteger(0),BigInteger(1)],e=b,f=1,g=d.MAX_LOOPS;g--&&Math.abs(b-d.toDecimal(a))>d.EPSILON;)f=Math.floor(e),a[0]=BigInteger(f*c[0]+c[2]),a[1]=BigInteger(f*c[1]+c[3]),e=1/(e-f),c[2]=c[0],c[3]=c[1],c[0]=a[0],c[1]=a[1];return a};d.fromRandom=function(a){a[0]=BigInteger(0xfffffffffffff*Math.random()<<0);a[1]=BigInteger(Math.abs(0xfffffffffffff*Math.random()<<0));return d.normalize(a,a)};d.sin=function(a,b){if(b[1].isZero())return d.copy(a,d.ZERO);d.scalar_multiply(a,
b,2);var c=d.create();d.pow(c,b,2);d.add(c,c,d.ONE);d.divide(a,a,c);return a};d.cos=function(a,b){if(b[1].isZero())return d.neg(a,d.ONE);var c=d.create();d.pow(c,b,2);d.sub(a,d.ONE,c);var e=d.create();d.add(e,d.ONE,c);d.divide(a,a,e);return a};d.tan=function(a,b){d.scalar_multiply(a,b,2);var c=d.create();d.pow(c,b,2);d.scalar_multiply(c,c,2);d.add(a,a,c);d.pow(c,b,4);d.sub(c,d.ONE,c);d.divide(a,a,c);return a};d.toEgyptian=function(a){a=d.clone(a);d.abs(a,a);var b=d.floor(a);b&&d.sub(a,a,d.fromInteger(b));
if(!a[0])return b.toString();b||(b="");for(var c=1,e=d.create();1!==a[0];)c++,e=d.fromValues(1,c),d.isGreaterThan(a,e)&&(b&&(b+=" + "),b+=d.str(e),d.sub(a,a,e));return a?b?b+" + "+d.str(a):d.str(a):b?b:"0"};d.toBabylonian=function(a){var b="",c=d.toDecimal(a);a=parseInt(c);for(var c=c-a,e=0,f=0;0<a;)(e=a%60)&&(b=e+" * 60^"+f+(b?" + ":"")+b),a=(a-e)/60,f++;for(f=-1;0<c;)c*=60,e=parseInt(c+1E-13),c-=e,-1E-13>c||(e&&(b+=(b?" + ":"")+e+" * 60^"+f),f--);return b?b:"0"};d.traceSternBrocot=function(a){var b=
"";if(d.equals(a,d.ZERO)||d.equals(a,d.ONE)||d.equals(a,d.INFINITY)||d.equals(a,d.INFINULL))return b;a=d.clone(a);d.isNegative(a)&&(a[0]=a[0].negate());for(var c=d.clone(d.ONE),e=[BigInteger(1),BigInteger(0),BigInteger(0),BigInteger(1)],f=0,g=0,h=65536;!d.equals(a,c)&&h--;)d.isLessThan(a,c)?(e[0]=e[0].add(e[1]),e[2]=e[2].add(e[3]),g++,f&&(b+="R",1!==f&&(b+=f),f=0,b+=" ")):(e[1]=e[1].add(e[0]),e[3]=e[3].add(e[2]),f++,g&&(b+="L",1!==g&&(b+=g),g=0,b+=" ")),c[0]=e[0].add(e[1]),c[1]=e[2].add(e[3]);g?(b+=
"L",1!==g&&(b+=g)):f&&(b+="R",1!==f&&(b+=f));0>h&&(b+="...");return b};d.toContinuedFraction=function(a,b){b="undefined"===typeof b?65536:parseInt(b);if(d.equals(a,d.ZERO))return[0];if(d.equals(a,d.ONE))return[1];if(d.equals(a,d.NEGONE))return[-1];if(d.equals(a,d.INFINITY))return[1,0];if(d.equals(a,d.INFINULL))return[0,0];var c=d.clone(a),e=d.isNegative(c);e&&(c[0]=c[0].negate());for(var f=d.clone(d.ONE),g=[BigInteger(1),BigInteger(0),BigInteger(0),BigInteger(1)],h=1,k=[0],p=k.length-1;!d.equals(c,
f)&&b--;)d.isLessThan(c,f)?(-1===h?k[p]++:(h=-1,k.push(1),p++),g[0]=g[0].add(g[1]),g[2]=g[2].add(g[3])):(1===h?k[p]++:(h=1,k.push(1),p++),g[1]=g[1].add(g[0]),g[3]=g[3].add(g[2])),f[0]=g[0].add(g[1]),f[1]=g[2].add(g[3]);0>b?k.push(0):k[p]++;if(e)for(var r in k)k[r]=-k[r];return k};d.fromContinuedFraction=function(a,b){d.fromInteger_copy(a,b[b.length-1]);for(var c=b.length-2;-1<c;c--)d.invert(a,a),d.add(a,d.fromInteger(b[c]),a);return a};d.fromFactorial=function(a,b){if("undefined"!==typeof factorial.PREPARED[b])return d.fromInteger_copy(a,
factorial.PREPARED[b]);var c=factorial.PREPARED.length-1;for(d.fromInteger_copy(a,factorial.PREPARED[c]);c<b;)d.scalar_multiply(a,a,++c);return a};d.dump=function(a){return"bigrat\t"+d.str(a)+"\n~\t"+d.toDecimal(a)+"\nCF:\t["+d.toContinuedFraction(a)+"]\n"};d.ZERO=d.fromInteger(0);d.ONE=d.fromInteger(1);d.NEGONE=d.fromInteger(-1);d.INFINITY=d.fromValues(1,0);d.INFINULL=d.fromValues(0,0);d.INFINITESIMAL=d.clone([new BigInteger(1),t]);d.PI=d.fromValues("3141592653589793238462643383279502884197169399375105820974944592307816406286208998628034825342117067982148086513282306647093844609550582231725359408128481117450284102701938521105559644622948954930381964428810975665933446128475648233786783165271201909145648566923460348610454326648213393607260249141273724587",
"1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000");"undefined"!==typeof e&&(e.bigrat=d);var h=function(a,b){this.a=c.fromValues(parseInt(a),parseInt(b))};h.prototype.toString=function(){return c.str(this.a)};h.prototype.toContinuedFraction=function(a){return c.toContinuedFraction(this.a,
a)};h.prototype.invert=function(){return c.invert(this.a)};h.prototype.reciprocal=h.prototype.invert;h.prototype.add=function(a){var b=c.create();c.add(b,this.a,a.a);return new h(b[0],b[1])};h.prototype.plus=h.prototype.add;h.prototype.subtract=function(a){var b=c.create();c.sub(b,this.a,a.a);return new h(b[0],b[1])};h.prototype.sub=h.prototype.subtract;h.prototype.minus=h.prototype.subtract;h.prototype.multiply=function(a){var b=c.create();c.mul(b,this.a,a.a);return new h(b[0],b[1])};h.prototype.mul=
h.prototype.multiply;h.prototype.times=h.prototype.multiply;h.prototype.mediant=function(a){var b=c.create();c.mediant(b,this.a,a.a);return new h(b[0],b[1])};h.prototype.divide=function(a){var b=c.create();c.div(b,this.a,a.a);return new h(b[0],b[1])};h.prototype.div=h.prototype.divide;h.prototype.divided_by=h.prototype.divide;h.prototype.power=function(a){var b=c.create();c.pow(b,this.a,a);return new h(b[0],b[1])};h.prototype.pow=h.prototype.power;h.prototype.dump=function(){return c.dump(this.a)};
h.prototype.toRat=function(){return c.clone(this.a)};h.prototype.toDecimal=function(){return c.toDecimal(this.a)};h.fromRat=function(a){var b=new h;b.a[0]=a[0];b.a[1]=a[1];return b};h.fromInteger=function(a){return h.fromRat(c.fromInteger(a))};h.fromIntegerInverse=function(a){return h.fromRat(c.fromIntegerInverse(a))};h.fromDecimal=function(a){return h.fromRat(c.fromDecimal(a))};h.fromContinuedFraction=function(a){return h.fromRat(c.fromContinuedFraction(c.create(),a))};"undefined"!==typeof e&&(e.rational=
h)})(g)})(this);
